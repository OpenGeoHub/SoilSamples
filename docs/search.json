[
  {
    "path": "index.html",
    "id": "about",
    "chapter": "About",
    "heading": "About",
    "text": "",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "rationale",
    "chapter": "About",
    "heading": "Rationale",
    "text": "\npublic compendium global, regional, national \nsub-national soil samples /soil profile datasets (points \nObservations Measurements soil properties characteristics).\nDatasets listed , assuming compatible open data license, afterwards\nimported Global compilation soil chemical physical\nproperties soil classes \neventually used create better open soil information across countries.\nspecific objectives initiative :enable data digitization, import binding + harmonization,accelerate research collaboration networking,enable development accurate / usable global \nregional soil property class maps (typically published via\nhttps://OpenLandMap.org),",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "download-compiled-data",
    "chapter": "About",
    "heading": "Download compiled data",
    "text": "Compiled data (imported, standardized, quality-controlled) available\ndiversity standard formats:RDS file (native R data format);GPKG file (Geopackage file ready opened QGIS);files can downloaded /directory.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "add-your-own-data",
    "chapter": "About",
    "heading": "Add your own data",
    "text": "minimum requirements submit dataset inclusion \nOpenLandMap repository :License terms use clearly specified ,Complete consistent metadata can ensure correct\nstandardization harmonization steps ,least 50 unique spatial locations ,broken invalid URLs,Datasets satisfy listed minimum requirements might \nremoved. discover issue license, data description \nversion number dataset, please open Github\nissue.\nFigure 0.1: Soil profiles soil samples chemical physical properties global compilation. info see: https://gitlab.com/openlandmap/compiled-ess-point-data-sets.\nRecommended settings datasets :Peer-reviewed versions datasets (.e. dataset accompanied\npeer-reviewed publication) priority,Register dataset (use e.g. https://zenodo.org) assign DOI\nversion,Provide enough metadata can imported bind \ndata without errors,dataset compilation previously published datasets, please\nindicate description,Information outdated missing? Please open issue best \ncorrection pull\nrequest.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "existing-soil-data-projects-and-initiatives",
    "chapter": "About",
    "heading": "Existing soil data projects and initiatives",
    "text": "Multiple international organizations FAO’s Global Soil Partnership UNCCD’s Land Degredation Neutrality, European Commission similar,\nsupport soil data collation projects especially curation legacy soil data.\nexisting soil Observations Measurements (O&M) soil data initiatives include:FAO’s Data Hub,FAO’s Global SoilInformation System (GLOSIS),Fine Root Ecology Database (FRED),FLUXNET global network,Global database soil nematodes,Global soil macrofauna database,Global soil respiration database (SRDB),International Soil Modeling Consortium (ISMC),International Soil Moisture Network,International Soil Radiocarbon Database (ISRaD),International Soil Carbon Network (ISCN),LandPKS project,Long Term Ecological Research (LTER) Network sites,National Ecological Observatory Network (NEON),Open Soil Spectral Library (OSSL),Open Bodem Index,ORNL DAAC theme soil,Soils Data Harmonization (SoDaH),WoSIS Soil Profile Database,UN’s FAO hosts International Network Soil Information Institutions, \nrecommend joining actively contributing. INSII FAO’s Global Soil Partnership aim \ndeveloping hosting Global SoilInformation System (GLOSIS),\nalthough serve yet soil observations measurements.-depth inventory various national international soil datasets can found :Rossiter, D.G.,: Compendium Soil Geographical Databases",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "target-soil-variables",
    "chapter": "About",
    "heading": "Target soil variables",
    "text": "Soil variables interest include:Chemical soil properties:Soil organic carbon, total carbon, total nitrogen,Soil pH, effective Cation Exchange Capacity (eCEC),Soil sodicity (presence high proportion sodium ions relative cations),Macro-nutrients: extractable — potassium (K), calcium (Ca), sodium\n(Na), magnesium (Mg) similar,Micro-nutrients: phosphorus (P), sulfur (S), iron (Fe), zinc (Zn)\nsimilar,Soil pollutants, heavy metals similar,Electrical conductivity,Physical soil properties:Soil texture texture fractions: silt, clay sand, stone content,Bulk density, depth bedrock similar,Hydraulic conductivity, water content — Field Capacity (FC; amount water\nheld soil fully wetted free drainage stopped),\nPermanent Wilting Point (PWP; soil moisture condition plant \nobtain water wilt die), Plant Available Water Capacity (PAWC;\namount water field capacity permanent wilting point water holding capacity) \nsimilar,Soil temperature,Soil biological / biodiversity variables:Soil biomass,Soil micro-, meso-, macro- mega-fauna abundance,Soil biodiversity indices,Soil classification / taxonomy variables:Soil type,Soi suitability classes, soil fertility classes,Soil texture classes families,Soil absorbances / soil spectroscopy variables:Soil absorbance VIS-NIR MIR part spectra,",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "recommended-om-standards",
    "chapter": "About",
    "heading": "Recommended O&M standards",
    "text": "general rule thumb recommend contributors use following\ngeneral scheme organize Soil Observations & Measurements 3–4 main tables\nmetadata + legends organized tables:Soil site information (geographical coordinates, land use / land cover, soil classification etc),Soil horizon information (soil observations measurements specific soil layers / diagnostic horizons),Proximal soil sensing information including soil scans,making soil observations measurements recommend following USDA National Cooperative Soil Survey (NCSS) Soil\nCharacterization Database codes specification much possible. explained detail Kellogg Soil Survey Laboratory Methods Manual\nField Book Describing Sampling Soils.\nLikewise, FAO Guidelines soil description,\nFAO’s GSOC measurement, monitoring, reporting verification (MRV) protocol also explain \ndetail collect soil samples setup system monitoring soil organic carbon.recommended one , much possible, use international standards\nreferences. highly recommended protocols standards include:UUID generator tool generate unique ID’s unique soil sites, horizons, samples etc (convert existing local ID UUID, best use openssl::md5(local_id)),Open Location Codes generate geographic location codes,OGC standards prepare metadata exchange data across field / computer systems;ISO8601 save time date information,ISO3166 country / administrative codes,GPS WGS84 longitude latitude decimal degrees save location information,International DOI foundation refer specific dataset /publication,USDA soil classification system World Reference Base classify soils,USDA soil texture calculator determine share soil texture classes including texture--hand,Kellogg Soil Survey Laboratory Methods Manual reference physical chemical soil property determination laboratory,Soils Laboratory Manual, K-State Edition,GLOSOLAN Standard Operating Procedures (SOPs),Open Bodem Index specification,",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "contributing",
    "chapter": "About",
    "heading": "Contributing",
    "text": "Please feel free contribute entries. See GitHub\nrepository detailed\ninstructions.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "contributors",
    "chapter": "About",
    "heading": "Contributors",
    "text": "contribute, add also name Twitter, ORCID blog link\n:Tomislav Hengl, Jonathan Sanderman, Mario Antonio Guevara\nSantamaria,document based https://www.bigbookofr.com/ repository\nOscar Baruffa.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "disclaimer",
    "chapter": "About",
    "heading": "Disclaimer",
    "text": "data provided “”. OpenGeoHub foundation suppliers licensors hereby disclaim warranties kind, express implied, including, without limitation, warranties merchantability, fitness particular purpose non-infringement. Neither OpenGeoHub foundation suppliers licensors, makes warranty Website error free access thereto continuous uninterrupted. understand download , otherwise obtain content services , Website discretion risk.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "licence",
    "chapter": "About",
    "heading": "Licence",
    "text": "website/book free use, licensed Creative Commons Attribution-ShareAlike 4.0 International License.cite dataset please use:",
    "code": "@dataset{hengl_t_2023_4748499,\n  author       = {Hengl, T. and Gupta, S. and Minarik, R.},\n  title        = {{An Open Compendium of Soil Datasets: Soil Observations and Measurements}},\n  year         = 2023,\n  publisher    = {OpenGeoHub foundation},\n  address      = {Wageningen},\n  version      = {v0.2},\n  doi          = {10.5281/zenodo.4748499},\n  url          = {https://doi.org/10.5281/zenodo.4748499}\n}"
  },
  {
    "path": "index.html",
    "id": "literature",
    "chapter": "About",
    "heading": "Literature",
    "text": "connected publications initiatives describing collation\nimport legacy soil observations measurements might interest\n:Arrouays, D., Leenaars, J. G., Richer-de-Forges, . C., Adhikari,\nK., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil\nlegacy data rescue via GlobalSoilMap international \nnational initiatives.\nGeoResJ, 14, 1-19.Beillouin, D., Cardinael, R., Berre, D., Boyer, ., Corbeels, M.,\nFallot, ., … & Demenois, J. (2021). global overview studies\nland management, land‐use change, climate change effects\nsoil organic carbon. Global Change Biology. https://doi.org/10.1111/gcb.15998 Batjes, N. H., Ribeiro, E., van Oostrum, ., Leenaars, J., Hengl,\nT., & de Jesus, J. M. (2017). WoSIS: providing standardised soil\nprofile data world. Earth System Science Data, 9(1), 1. https://doi.org/10.5194/essd-9-1-2017 Billings, S. ., Lajtha, K., Malhotra, ., Berhe, . ., de Graaff, M. .,\nEarl, S., … & Wieder, W. (2021). Soil organic carbon just soil\nscientists: measurement recommendations diverse practitioners. Ecological Applications, 31(3), e02290. https://doi.org/10.1002/eap.2290Brown, G., Demeterio, W. Samuel-Rosa, . (2021). Towards open Soil Science. SciELO Perspective, 2021 [viewed 17 June 2021].Gupta, S., Hengl, T., Lehmann, P., Bonetti, S., & , D. (2021). SoilKsatDB:\nglobal database soil saturated hydraulic conductivity measurements \ngeoscience applications. Earth System Science Data, 13(4), 1593-1612.\nhttps://doi.org/10.5194/essd-13-1593-2021Hengl, T., MacMillan, R.., (2019). Predictive Soil Mapping \nR. OpenGeoHub foundation, Wageningen, \nNetherlands, 370 pages, https://soilmapper.org, ISBN:\n978-0-359-30635-0.Moorberg, C. J., & Crouse, D. . (2017). open‐source laboratory manual introductory, undergraduate soil science courses. Natural Sciences Education, 46(1), 1-8.Ramcharan, ., Hengl, T., Beaudette, D., & Wills, S. (2017). soil\nbulk density pedotransfer function based machine learning: case\nstudy NCSS soil characterization\ndatabase. Soil Science\nSociety America Journal, 81(6), 1279-1287.\nhttps://doi.org/10.2136/sssaj2016.12.0421Ros, G. H., Verweij, S. E., Janssen, S. J., De Haan, J., & Fujita, Y. (2022). Open Soil\nHealth Assessment Framework Facilitating Sustainable Soil Management. Environmental Science & Technology, 56(23), 17375-17384.Rossiter, D.G.,: Compendium Soil Geographical\nDatabases.",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "about-opengeohub",
    "chapter": "About",
    "heading": "About OpenGeoHub",
    "text": "OpenGeoHub foundation --profit research foundation\nlocated Wageningen, Netherlands. specifically promote\npublishing sharing Open Geographical Geoscientific Data,\nusing developing Open Source Software encouraging empowering\n-represented researchers e.g. ODA recipient countries\nfemale researchers. believe key measure quality \nresearch sciences (especially geographical information\nsciences) transparency reproducibility computer code\nused generate results (read : “Everyone right know\nhappening planet”).",
    "code": ""
  },
  {
    "path": "index.html",
    "id": "acknowledgments",
    "chapter": "About",
    "heading": "Acknowledgments",
    "text": "SoilSpec4GG USDA-funded Food Agriculture Cyberinformatics\nTools Coordinated Innovation Network NIFA Award #2020-67021-32467 project. brings together soil\nscientists, spectroscopists, informaticians, data scientists \nsoftware engineers overcome current bottlenecks\npreventing wider efficient use soil spectroscopy. info refer\n: https://soilspectroscopy.org/EcoDataCube.eu project co-financed European Union (CEF Telecom project 2018-EU-IA-0095).EarthMonitor.org project received funding European Union’s Horizon Europe research innovation programme grant agreement . 101059548.AI4SoilHealth.eu project received funding \nEuropean Union’s Horizon Europe research innovation programme grant\nagreement . 101086179.",
    "code": ""
  },
  {
    "path": "new-to-markdown.html",
    "id": "new-to-markdown",
    "chapter": "1 New to markdown",
    "heading": "1 New to markdown",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.",
    "code": ""
  },
  {
    "path": "new-to-markdown.html",
    "id": "clone-add-reference-submit-merge-request",
    "chapter": "1 New to markdown",
    "heading": "1.1 Clone, add reference, submit merge request…",
    "text": "add new dataset, please follow steps:Click edit button book homepage,Login Github.com select “Start pull-request”,Add new references 020-dataset_list.Rmd save,Commit push make pull\nrequest.received check followed instructions closely,\nreference appear document soon code merged master,\nFigure 1.1: Example pull request Github.com.\n’re new markdown want learn use , please refer tutorial.new R /pedometrics, please consider reading / installing:Kabacoff, R.., (2011) “R Action: Data Analysis Graphics R”. Manning publications, ISBN: 9781935182399, 472 pages.California Soil Resource Lab, (2017) “Open Source Software Tools Soil Scientists”, UC Davis.,RStudio,’d like roadmap guide R, look Oscar’s blogpost:https://oscarbaruffa.com/-roadmap--getting-started--r/",
    "code": ""
  },
  {
    "path": "new-to-markdown.html",
    "id": "video-course-getting-started-with-r",
    "chapter": "1 New to markdown",
    "heading": "1.2 Video Course: Getting started with R",
    "text": "prefer video instruction progress tracking:https://rfortherestofus.com/courses/getting-started/",
    "code": ""
  },
  {
    "path": "soil-data-communities-and-mailing-lists.html",
    "id": "soil-data-communities-and-mailing-lists",
    "chapter": "2 Soil data communities and mailing lists",
    "heading": "2 Soil data communities and mailing lists",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.follow progress soil data compilations consider connecting \nactive communities / registering mailing lists /discussion groups.",
    "code": ""
  },
  {
    "path": "soil-data-communities-and-mailing-lists.html",
    "id": "pedometrics-community",
    "chapter": "2 Soil data communities and mailing lists",
    "heading": "2.1 Pedometrics community",
    "text": "Pedometrics commission International Union Soil Sciences. can\nread pedometrics <www.pedometrics.org>. also Pedometrics\nmailing list \ncan ask technical questions.",
    "code": ""
  },
  {
    "path": "soil-data-communities-and-mailing-lists.html",
    "id": "digital-soil-mapping-community",
    "chapter": "2 Soil data communities and mailing lists",
    "heading": "2.2 Digital Soil Mapping community",
    "text": "Digital Soil Mapping community (Working Group International Union Soil Sciences (IUSS))\ncan accessed via home page <www.digitalsoilmapping.org> /\nvia Facebook group Digital Soil Mapping.",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "datasets",
    "chapter": "3 Datasets",
    "heading": "3 Datasets",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-datasets",
    "chapter": "3 Datasets",
    "heading": "3.1 Global Datasets",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "fine-root-ecology-database-fred-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.1 Fine Root Ecology Database: FRED (compilation)",
    "text": "Description: Originally plant root database also contains soil laboratory data\nsoil observations.📕 Iversen CM, McCormack ML, Baer JK, Powell , Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli , Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): Global Collection Root Trait Data Coincident Site, Vegetation, Edaphic, Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department Energy, Oak Ridge, Tennessee, U.S..🔗 Project website: https://roots.ornl.gov/📂 Data download URL: https://doi.org/10.25581/ornlsfa.014/1459186📍 Unique locations: 280📋 Unique complete rows: 858📝 Import steps: chemsprops.FRED",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-harmonized-dataset-of-soc-change-under-perennial-crops-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.2 Global Harmonized Dataset of SOC change under perennial crops (compilation)",
    "text": "Description: Soil Organic Carbon data various publications. Many missing\nyears PREVIOUS SOC SOIL CHARACTERISTICS.📕 Ledo, ., Hillier, J., Smith, P. et al. (2019) global, empirical, harmonised dataset soil organic carbon changes perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1🔗 Project website: https://africap.info/📂 Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2📍 Unique locations: 174📋 Unique complete rows: 1526📝 Import steps: chemsprops.SOCPDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-soil-respiration-db-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.3 Global Soil Respiration DB (compilation)",
    "text": "Description: database encompasses published studies report least one following data measured field (laboratory): annual soil respiration, mean seasonal soil respiration, seasonal annual partitioning soil respiration source fluxes, soil respiration temperature response (Q10), soil respiration 10 degrees C.📕 Bond-Lamberty, B. Thomson, . (2010). global database soil respiration data, Biogeosciences, 7, 1915-1926, https://doi.org/10.5194/bg-7-1915-2010🔗 Project website: https://github.com/bpbond/srdb/📂 Data download URL: https://github.com/bpbond/srdb/📍 Unique locations: 826📋 Unique complete rows: 1596📝 Import steps: chemsprops.SRDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "hydros-soil-hydraulic-functions-of-international-soils-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.4 HYDROS Soil hydraulic functions of international soils (compilation)",
    "text": "Description: Contains data base 173 soil hydrological data (raw data) 71 sites world (Asia, Africa, Australia America Europe). samples mainly collected measured part research projects. soils cover wide range texture classes dry bulk densities. data base consists water retention unsaturated hydraulic conductivity data.📕 Schindler, Uwe; Müller, Lothar (2015): Soil hydraulic functions \ninternational soils measured Extended Evaporation Method (EEM) HYPROP device, Leibniz-Zentrum für Agrarlandschaftsforschung (ZALF) e.V.[doi:10.4228/ZALF.2003.273]🔗 Project website:📂 Data download URL: http://dx.doi.org/10.4228/ZALF.2003.273📍 Unique locations: 71📋 Unique complete rows: 173📝 Import steps: chemsprops.HYDROS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "isric-wise-harmonized-soil-profile-data-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.5 ISRIC WISE harmonized soil profile data (compilation)",
    "text": "Description: ISRIC-WISE database holds selected site horizon data 10,250 soil profiles 149 countries. Profile data extracted wide range sources harmonized respect original (1974) revised (1988) Legend FAO-Unesco Soil Map World. Profiles described, sampled, analyzed according methods standards use originating countries. WISE specifically developed land-related applications continental global scales.📕 Batjes, N.H. (2009). Harmonized soil profile data applications global continental scales: updates WISE database. Soil Use Management 25(2):124-127. DOI:10.1111/j.1475-2743.2009.00202.x🔗 Project website: https:/isric.org📂 Data download URL: https://files.isric.org/public/wise/WD-WISE.zip📍 Unique locations: 6723📋 Unique complete rows: 23278📝 Import steps: chemsprops.WISE",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "isric-world-soil-reference-collection",
    "chapter": "3 Datasets",
    "heading": "3.1.6 ISRIC World Soil Reference Collection",
    "text": "Description: World Soil Reference Collection comprises 800 soil profiles\n70 countries detailed soil profile environmental data.📕 Batjes, N. H. (1995). homogenized soil data file global\nenvironmental research: subset FAO, ISRIC NRCS profiles (Version 1.0) (. 95/10b). ISRIC. / Van de Ven, T., & Tempel, P. (1994). ISIS 4.0: ISRIC Soil Information System: User Manual. ISRIC.🔗 Project website: https:/isis.isric.org📂 Data download URL: https:/isis.isric.org📍 Unique locations: 785📋 Unique complete rows: 5637📝 Import steps: hydrosprops.ISIS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-reforestation-opportunity-assessment-groa-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.7 Global Reforestation Opportunity Assessment (GROA) (compilation)",
    "text": "Description: data assembled Nature Conservancy team scientists 19 institutions quantify carbon sequestration naturally regenerating forests around world.📕 Cook-Patton, S. C., Leavitt, S. M., Gibbs, D., Harris, N. L., Lister, K., Anderson-Teixeira, K. J., … & Griscom, B. W. (2020). Mapping carbon accumulation potential global natural forest regrowth. Nature, 585(7826), 545-550. https://doi.org/10.1038/s41586-020-2686-x🔗 Project website: https://github.com/forc-db/groa📂 Data download URL: https://doi.org/10.5281/zenodo.3983644📍 Unique locations: 1921📋 Unique complete rows: 1921📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-icrafisric-soil-spectroscopy-library-icrafisric",
    "chapter": "3 Datasets",
    "heading": "3.1.8 Global ICRAF/ISRIC Soil Spectroscopy Library — (ICRAF/ISRIC)",
    "text": "Description: Globally Distributed Soil Spectral Library Mid Infrared Diffuse\nReflectance Spectra. MIR scans 785 profiles ISRIC World Soil Reference Collection.\nsamples 58 countries spanning Africa, Asia, Europe, North America, South America.\nData available CC-4.0 license.📕 World Agroforestry Centre, (2014). ICRAF/ISRIC spectral library, Soil-Plant Spectral Diagnostics laboratory, United\nNations Avenue, Nairobi, Kenya.🔗 Project website: https://www.worldagroforestry.org/sd/landhealth/soil-plant-spectral-diagnostics-laboratory/soil-spectra-library📂 Data download URL: https://files.isric.org/public//ICRAF-ISRICVNIRSoilDatabase.zip📍 Unique locations: 785📋 Unique complete rows:📝 Import steps: sslsprops.ICRAF_ISRIC",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-database-of-soil-saturated-hydraulic-conductivity-measurements-ksat-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.9 Global database of soil saturated hydraulic conductivity measurements — KSat (compilation)",
    "text": "Description: Contains total 13,258 Ksat measurements 1908 sites assembled published literature.📕 Gupta, S., Hengl, T., Lehmann, P., Bonetti, S., , D.: (2021) SoilKsatDB: global database soil saturated hydraulic conductivity measurements geoscience applications, Earth Syst. Sci. Data, 13, 1593–1612, https://doi.org/10.5194/essd-13-1593-2021.🔗 Project website:📂 Data download URL: https://doi.org/10.5281/zenodo.3752721📍 Unique locations: 1908📋 Unique complete rows:📝 Import steps: hydrosprops",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "global-database-of-soil-hydraulic-properties-gshp-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.10 Global database of soil hydraulic properties — GSHP (compilation)",
    "text": "Description: Contains total 15,153 soil water characteristics curve (SWCC) measurements 2659 sites assembled published literature.📕 Gupta, S., Papritz, ., Lehmann, P., Hengl, T., Bonetti, S., , D., (2020): GSHP: Global soil hydraulic properties database”. Manuscript submitted Scientific Data.🔗 Project website: https://github.com/ETHZ-repositories/GSHP-database📂 Data download URL: https://doi.org/10.5281/zenodo.5547338📍 Unique locations: 2659📋 Unique complete rows:📝 Import steps: GSHP-database",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "landpks-observations",
    "chapter": "3 Datasets",
    "heading": "3.1.11 LandPKS observations",
    "text": "Description: Data collected various people LandPKS App mobile\nphones (crowdsourced). Data limited quality usually laboratory data collected shared.📕 Herrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use Management Cloud Computing, Mobile Applications, Crowdsourcing. Journal Soil Water Conservation, 68(1), 5A-12A.🔗 Project website: http://portal.landpotential.org📂 Data download URL: http://portal.landpotential.org/#/landpksmap📍 Unique locations: 15326📋 Unique complete rows: 41644📝 Import steps: chemsprops.LandPKS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "mangrove-forest-soil-db-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.12 Mangrove forest soil DB (compilation)",
    "text": "Description: Point data set used produce global map mangrove forest\nsoil carbon 30 m spatial resolution.📕 Sanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). global map mangrove forest soil carbon 30 m spatial resolution. Environmental Research Letters, 13(5), 055002.🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/📂 Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT📍 Unique locations: 1568📋 Unique complete rows: 7718📝 Import steps: chemsprops.Mangroves",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "remnant-native-soc-database-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.13 Remnant native SOC database (compilation)",
    "text": "Description: Soil carbon profile data paired land use comparisons.📕 Sanderman, J., Hengl, T., & Fiske, G. J. (2017). Soil carbon debt 12,000 years human land use. Proceedings National Academy Sciences, 114(36), 9575-9580.🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/📂 Data download URL: https://doi.org/10.7910/DVN/QQQM8V/8MSBNI📍 Unique locations: 1604📋 Unique complete rows: 224📝 Import steps: chemsprops.RemnantSOC",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soils-data-harmonization-database-sodah-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.14 SOils DAta Harmonization database: SoDaH (compilation)",
    "text": "Description: SoDaH built several network science efforts \nUnited States. ’s aim provide open-access resource facilitate automate harmonization synthesis soil carbon data.📕 Wieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: SOils DAta Harmonization database, open-source synthesis soil data research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195🔗 Project website: https://lter.github.io/som-website📂 Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4📍 Unique locations: 1052📋 Unique complete rows: 20383📝 Import steps: chemsprops.SoDaH",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-health-db-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.15 Soil Health DB (compilation)",
    "text": "Description: database global soil health assessment. limited soil properties\navailable.📕 Jian, J., Du, X., & Stewart, R. D. (2020). database global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3.🔗 Project website: https://github.com/jinshijian/SoilHealthDB📂 Data download URL: https://github.com/jinshijian/SoilHealthDB📍 Unique locations: 88📋 Unique complete rows: 120📝 Import steps: chemsprops.SoilHealthDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-water-infiltration-global-database-swig-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.16 Soil Water Infiltration Global database — SWIG (compilation)",
    "text": "Description: Soil textural information (clay, silt, sand content) available 3842 5023 infiltration measurements.📕 Rahmati, M., Weihermüller, L., Vanderborght, J., Pachepsky, Y. .,\nMao, L., Sadeghi, S. H., … & Toth, B. (2018). Development analysis Soil Water Infiltration Global database. Earth Syst. Sci. Data, 10, 1237–1263.🔗 Project website:📂 Data download URL: https://doi.org/10.1594/PANGAEA.885492📍 Unique locations: 88📋 Unique complete rows: 120📝 Import steps: chemsprops.SWIG",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "unsoda-unsaturated-soil-hydraulic-database-compilation",
    "chapter": "3 Datasets",
    "heading": "3.1.17 UNSODA Unsaturated Soil Hydraulic Database (compilation)",
    "text": "Description: dataset contains measured soil water retention, hydraulic conductivity, water diffusivity data, well pedological information 790 soil samples around world.📕 Nemes, Attila; Schaap, Marcel; Leij, Feike J.; Wösten, J. Henk M.\n(2015). UNSODA 2.0: Unsaturated Soil Hydraulic Database. Database program indirect methods estimating unsaturated hydraulic properties. US Salinity Laboratory - ARS - USDA. https://doi.org/10.15482/USDA.ADC/1173246. / Børgesen, C. D., Jacobsen, O. H., Hansen, S., & Schaap, M. G. (2006). Soil hydraulic properties near saturation, improved conductivity model. Journal Hydrology, 324(1-4), 40-50. https://doi.org/10.1016/j.jhydrol.2005.09.014🔗 Project website:📂 Data download URL: Zip packages📍 Unique locations: 790📋 Unique complete rows:📝 Import steps: hydrosprops.UNSODA",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "worldwide-organic-soil-carbon-and-nitrogen-data",
    "chapter": "3 Datasets",
    "heading": "3.1.18 Worldwide organic soil carbon and nitrogen data",
    "text": "Description: global point data set organic soil carbon nitrogen data.\nPoor spatial location accuracy error often > 10 km. Bulk density many points \nestimated measured. Sampling year literature indicates:\n1965, 1974, 1976, 1978, 1979, 1984. samples come natural vegetation (undisturbed) areas.📕 Zinke, P. J., Millemann, R. E., & Boden, T. . (1986). Worldwide organic soil carbon nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory.🔗 Project website: https://cdiac.ess-dive.lbl.gov/📂 Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018📍 Unique locations: 1712📋 Unique complete rows: 3977📝 Import steps: chemsprops.ISCND",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "africa",
    "chapter": "3 Datasets",
    "heading": "3.2 Africa",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "africa-soil-profiles-database-compilation",
    "chapter": "3 Datasets",
    "heading": "3.2.1 Africa soil profiles database (compilation)",
    "text": "Description: compilation legacy soil profiles hundreds profiles.\nProduced purpose Africa Soil Information Services (AfSIS) project.📕 Leenaars, J. G., Van Oostrum, . J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. compilation georeferenced standardized legacy soil profile data Sub-Saharan Africa (dataset). Wageningen: ISRIC Report 2014/01.🔗 Project website: https://www.isric.org/projects/africa-soil-profiles-database-afsp📂 Data download URL: https://data.isric.org/📍 Unique locations: 15630📋 Unique complete rows: 60306📝 Import steps: chemsprops.AfSPDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "africa-soil-information-service-afsis1-soil-chemistry",
    "chapter": "3 Datasets",
    "heading": "3.2.2 Africa Soil Information Service (AfSIS1) Soil Chemistry",
    "text": "Description: Soil spectroscopy-based soil samples datasets. Produced World\nAgroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center \nInternational Earth Science Information Network (CIESIN), International Center\nTropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) \nRothamsted Research (RRES) purpose Africa Soil Information Services (AfSIS) project.\nMany samples collected period 2010–2018.📕 Towett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. ., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition soils Sub-Saharan Africa relationship soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002🔗 Project website: https://github.com/qedsoftware/afsis-soil-chem-tutorial📂 Data download URL: https://registry.opendata.aws/afsis/📍 Unique locations: 929📋 Unique complete rows: 4162📝 Import steps: chemsprops.AfSIS1",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "asia",
    "chapter": "3 Datasets",
    "heading": "3.3 Asia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "northern-circumpolar-permafrost-soil-profiles-compilation",
    "chapter": "3 Datasets",
    "heading": "3.3.1 Northern circumpolar permafrost soil profiles (compilation)",
    "text": "Description: Represents parts Russian Federation Canada.\ndata set consists significantly higher soil organic carbon concentrations.📕 Hugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). new data set estimating organic carbon storage 3 m depth soils northern circumpolar permafrost region. Earth System Science Data (Online), 5(2).🔗 Project website: https://bolin.su.se/data/ncscd/📂 Data download URL: http://dx.doi.org/10.5879/ECDS/00000002📍 Unique locations: 410📋 Unique complete rows: 7104📝 Import steps: chemsprops.NCSCD",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "australia-oceania",
    "chapter": "3 Datasets",
    "heading": "3.4 Australia & Oceania",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "europe",
    "chapter": "3 Datasets",
    "heading": "3.5 Europe",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "land-use-and-coverage-area-frame-survey-lucas-soil-20092012",
    "chapter": "3 Datasets",
    "heading": "3.5.1 Land Use and Coverage Area frame Survey: LUCAS soil 2009/2012",
    "text": "Description: Top-soil samples (0–20 cm). year 2012 additional\nsamples collected Romania Bulgaria.📕 Tóth, G., Jones, ., Montanarella, L., Alewell, C., Ballabio, C., Carre, F., … & Hermann, T. (2013). LUCAS Topsoil Survey—Methodology, Data Results. JRC Technical Reports. Luxembourg. Publications Office European Union, EUR26102 – Scientific Technical Research series – ISSN 1831-9424 (online); ISBN 978-92-79-32542-7; doi: 10.2788/97922.🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data📍 Unique locations: 21272📋 Unique complete rows: 21272📝 Import steps: chemsprops.LUCAS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "land-use-and-coverage-area-frame-survey-lucas-soil-2015",
    "chapter": "3 Datasets",
    "heading": "3.5.2 Land Use and Coverage Area frame Survey: LUCAS soil 2015",
    "text": "Description: Top-soil samples (0–20 cm).\ncurrently largest systematic soil sample dataset EU.📕 Orgiazzi, ., Ballabio, C., Panagos, P., Jones, ., & Fernandez-Ugalde, O. (2018). LUCAS Soil, largest expandable soil dataset Europe: review. European Journal Soil Science, 69(1), 140-153.🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data📍 Unique locations: 21859📋 Unique complete rows: 21859📝 Import steps: chemsprops.LUCAS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "land-use-and-coverage-area-frame-survey-lucas-soil-2018",
    "chapter": "3 Datasets",
    "heading": "3.5.3 Land Use and Coverage Area frame Survey: LUCAS soil 2018",
    "text": "Description: Top-soil samples (0–20 cm) collected 2018.\nSeveral additional soil properties added.📕 Orgiazzi, ., Ballabio, C., Panagos, P., Jones, ., & Fernandez-Ugalde, O. (2018). LUCAS Soil, largest expandable soil dataset Europe: review. European Journal Soil Science, 69(1), 140-153.🔗 Project website: https://esdac.jrc.ec.europa.eu/projects/lucas📂 Data download URL: https://esdac.jrc.ec.europa.eu/projects/lucas📍 Unique locations:📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "gemas-2009",
    "chapter": "3 Datasets",
    "heading": "3.5.4 GEMAS 2009",
    "text": "Description: Geochemical background threshold 53 chemical elements \nEuropean agricultural soil.📕 Reimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, ., Negrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background threshold 53 chemical elements European agricultural soil. Applied Geochemistry, 88, 302-318.🔗 Project website: http://gemas.geolba.ac./📂 Data download URL: http://gemas.geolba.ac./📍 Unique locations: 4026📋 Unique complete rows: 4131📝 Import steps: chemsprops.GEMAS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "north-and-central-america",
    "chapter": "3 Datasets",
    "heading": "3.6 North and Central America",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "south-america",
    "chapter": "3 Datasets",
    "heading": "3.7 South America",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "sistema-de-informacion-de-suelos-de-latinoamerica-sislac-compilation",
    "chapter": "3 Datasets",
    "heading": "3.7.1 Sistema de Informacion de Suelos de Latinoamerica: SISLAC (compilation)",
    "text": "Description: compilation legacy soil profiles majority Latin American\ncountries.📕 Alianza Mundial por el Suelo. 2013. Sistema de Informacion de Suelos de Latinoamerica (SISLAC). https://hdl.handle.net/10568/49611🔗 Project website: http://www.sislac.org/📂 Data download URL: http://54.229.242.119/sislac/es📍 Unique locations: 14606📋 Unique complete rows: 49994📝 Import steps: chemsprops.SISLAC",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "cifor-peatland-points-compilation",
    "chapter": "3 Datasets",
    "heading": "3.7.2 CIFOR peatland points (compilation)",
    "text": "Description: Peatland soil measurements (points) literature.📕 Murdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals peat tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452🔗 Project website: https://www.cifor.org/📂 Data download URL:📍 Unique locations:📋 Unique complete rows: 756📝 Import steps: chemsprops.Peatlands",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "national-datasets",
    "chapter": "3 Datasets",
    "heading": "3.8 National Datasets",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "australia",
    "chapter": "3 Datasets",
    "heading": "3.8.1 Australia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "csiro-national-soil-site-database-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.1.1 CSIRO National Soil Site Database (compilation)",
    "text": "Description: National legacy soil profile dataset. Compiled various projects.📕 CSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004.🔗 Project website: https://www.csiro.au/en/-business/Services/Enviro/Soil-archive📂 Data download URL: https://doi.org/10.25919/5eeb2a56eac12📍 Unique locations: 13826📋 Unique complete rows: 70791📝 Import steps: chemsprops.NatSoil",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "belgium",
    "chapter": "3 Datasets",
    "heading": "3.8.2 Belgium",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "aardewerk-vlaanderen-2010",
    "chapter": "3 Datasets",
    "heading": "3.8.2.1 AARDEWERK-Vlaanderen-2010",
    "text": "Description: Legacy soil profile dataset Flemish Region.📕 Beckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. / Ottoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001🔗 Project website: https://www.dov.vlaanderen.📂 Data download URL: https://www.dov.vlaanderen.📍 Unique locations: 6877📋 Unique complete rows: 41310📝 Import steps: chemsprops.Vlaanderen2010",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "brazil",
    "chapter": "3 Datasets",
    "heading": "3.8.3 Brazil",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "a-national-soil-profile-database-for-brazil-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.3.1 A National Soil Profile Database for Brazil (compilation)",
    "text": "Description: National compilation representative soil profiles. dataset \nused FEBR. Data comes primarily Radam project (Projeto Radambrasil, 1973–1986).📕 Cooper, M., Mendes, L. M. S., Silva, W. L. C., & Sparovek, G. (2005). national soil profile database Brazil available international scientists. Soil Science Society America Journal, 69(3), 649-652. https://doi.org/10.2136/sssaj2004.0140 / Benedetti, M. M., Curi, N., Sparovek, G., Carvalho Filho, ., & Silva, S. H. G. (2011). Updated Brazilian’s georeferenced soil database-improvement international scientific information exchanging. Embrapa, 1, 309-332.🔗 Project website:📂 Data download URL:📍 Unique locations: 5086📋 Unique complete rows: 10,034📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "brazilian-soil-spectral-library-bssl-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.3.2 Brazilian Soil Spectral Library — BSSL (compilation)",
    "text": "Description: Compilation SS data various projects.📕 Demattê, J. ., Dotto, . C., Paiva, . F., Sato, M. V., Dalmolin, R. S., Maria Socorro, B., … & Couto, H. T. Z. (2019). Brazilian Soil Spectral Library (BSSL): general view, application challenges. Geoderma, 354, 113793. https://doi.org/10.1016/j.geoderma.2019.05.043🔗 Project website: https://bibliotecaespectral.wixsite.com/english📂 Data download URL:📍 Unique locations:📋 Unique complete rows: 50,662📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "free-brazilian-repository-for-open-soil-data-febr-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.3.3 Free Brazilian Repository for Open Soil Data — febr (compilation)",
    "text": "Description: Soil legacy data various projects Brazil standardized bind together.📕 Samuel-Rosa, ., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data Brazil: geospatial data quality improve . Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430🔗 Project website: https://www.pedometria.org/febr/📂 Data download URL: https://www.pedometria.org/febr/📍 Unique locations: 6098📋 Unique complete rows: 7842📝 Import steps: chemsprops.FEBR",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "pronasolos---2020-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.3.4 PronaSolos - 2020 (compilation)",
    "text": "Description: Contains various soil samples (complete profiles, partial profiles, extra samples) Soil Database database (BDsolos). Spatial location accuracy variable: possible geographic coordinates available Free Brazilian Repository Open Soil Data (FEBR) used, otherwise locations assigned center municipality. Data set available publicly via PronaSolos Platform CC--NC license.📕 POLIDORO, J., COELHO, M., CARVALHO FILHO, . D., LUMBRERAS, J., de OLIVEIRA, . P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).🔗 Project website: https://geoportal.cprm.gov.br/pronasolos/📂 Data download URL: http://geoinfo.cnps.embrapa.br/documents/3013/download📍 Unique locations: 9113📋 Unique complete rows: 34,464📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "hydrophysical-database-for-brazilian-soils-hybras-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.3.5 Hydrophysical database for Brazilian soils — HYBRAS (compilation)",
    "text": "Description: Contains hydrophysical data Brazilian soils seeks consolidate water retention saturated hydraulic conductivity data together basic soil features methods determination hydraulic properties.📕 Ottoni, M. V., Ottoni Filho, T. B., Schaap, M. G., Lopes-Assad, M. L. R., & Rotunno Filho, O. C. (2018). Hydrophysical database Brazilian soils (HYBRAS) pedotransfer functions water retention. Vadose Zone Journal, 17(1).🔗 Project website: http://geosgb.cprm.gov.br/geosgb/📂 Data download URL: http://geosgb.cprm.gov.br/geosgb/downloads_en.html📍 Unique locations: 445📋 Unique complete rows:📝 Import steps: hydrosprops.HYBRAS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "canada",
    "chapter": "3 Datasets",
    "heading": "3.8.4 Canada",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "agriculture-and-agri-food-canada-national-pedon-database",
    "chapter": "3 Datasets",
    "heading": "3.8.4.1 Agriculture and Agri-Food Canada National Pedon Database",
    "text": "Description: Complete soil profile database. Legacy soil profiles collected \nvarious projects. -represents southern parts Canada / agricultural land.📕 Agriculture Agri-Food Canada National Pedon Database.🔗 Project website: https://open.canada.ca/data/en/📂 Data download URL: https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0📍 Unique locations: 3096📋 Unique complete rows: 15946📝 Import steps: chemsprops.NPDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "canadian-upland-forest-soil-profile-and-carbon-stocks-database",
    "chapter": "3 Datasets",
    "heading": "3.8.4.2 Canadian upland forest soil profile and carbon stocks database",
    "text": "Description: Upper lower limits horizons can negative convention\nCanada start counting soil depth mineral soil (hence O similar horizons\ncounted).📕 Shaw, C., Hilger, ., Filiatrault, M., & Kurz, W. (2018). Canadian upland forest soil profile carbon stocks database. Ecology, 99(4), 989-989. https://doi.org/10.1002/ecy.2159🔗 Project website:📂 Data download URL: Supplement file📍 Unique locations: 2347📋 Unique complete rows: 15162📝 Import steps: chemsprops.CUFS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "alberta-aesa-alberta-environmentally-sustainable-agriculture-soil-quality-benchmark-program",
    "chapter": "3 Datasets",
    "heading": "3.8.4.3 Alberta AESA (Alberta Environmentally Sustainable Agriculture) Soil Quality Benchmark Program",
    "text": "Description: Established 1998 provide monitoring network across Alberta 43 Ecodistricts. limited amount sampling locations (42 benchmark sites) revisited every year. reports Phosphorous shows significant changes time, SOC, total N, pH stay relatively constant across Alberta.📕 Cathcart, J., Mason, H., Sey, B. Heinz, J. Cannon, K. (2008). Nine Years Soil Quality Data\nAlberta Benchmark Program. Resource Sciences Branch, Alberta Agriculture Rural Development, Edmonton, Alberta, Canada. 84 pp.🔗 Project website: https://open.canada.ca/data/en/📂 Data download URL:📍 Unique locations: 130📋 Unique complete rows: 2484📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-texture-samples-provincial-ecoforest-map-of-quebec-canada",
    "chapter": "3 Datasets",
    "heading": "3.8.4.4 Soil texture samples provincial ecoforest map of Quebec, Canada",
    "text": "Description: Soil texture data 29,570 mineral soil samples 17,901 soil profiles model map particle size composition ecoforest polygons provincial ecoforest map Quebec, Canada.📕 Duchesne, L., Ouimet, R., (2021). Digital mapping soil texture ecoforest polygons Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685🔗 Project website:📂 Data download URL: https://doi.org/10.7717/peerj.11685/supp-1📍 Unique locations: 17,901📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "chile",
    "chapter": "3 Datasets",
    "heading": "3.8.5 Chile",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "chilean-soil-organic-carbon-database",
    "chapter": "3 Datasets",
    "heading": "3.8.5.1 Chilean Soil Organic Carbon database",
    "text": "Description: Soil carbon samples .📕 Pfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: Chilean Soil Organic Carbon database, multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457-468, https://doi.org/10.5194/essd-12-457-2020.🔗 Project website:📂 Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3📍 Unique locations: 12132📋 Unique complete rows: 16371📝 Import steps: chemsprops.CHLSOC",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "china-peoples-republic-of-china",
    "chapter": "3 Datasets",
    "heading": "3.8.6 China (People’s Republic of China)",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "china-data-set-of-soil-properties-for-land-surface-modeling",
    "chapter": "3 Datasets",
    "heading": "3.8.6.1 China data set of soil properties for land surface modeling",
    "text": "Description: National compilation representative soil profiles. point data \navailable publicly.📕 Shangguan, W., Dai, Y., Liu, B., Zhu, ., Duan, Q., Wu, L., … & Zhang, Y. (2013). China data set soil properties land surface modeling. Journal Advances Modeling Earth Systems, 5(2), 212-224. https://doi.org/10.1002/jame.20026🔗 Project website: http://globalchange.bnu.edu.cn/research/data📂 Data download URL:📍 Unique locations: 8979📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soter-soil-profiles-for-china",
    "chapter": "3 Datasets",
    "heading": "3.8.6.2 SOTER soil profiles for China",
    "text": "Description: Soil Terrain database China primary data includes also\nrepresentative soil profiles.📕 Dijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil landform properties LADA partner countries. ISRIC report 2008/06 GLADA report 2008/03, ISRIC — World Soil Information FAO, Wageningen.🔗 Project website: https://data.isric.org📂 Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip📍 Unique locations: 1430📋 Unique complete rows: 5105📝 Import steps: chemsprops.CNSOTER",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "croatia",
    "chapter": "3 Datasets",
    "heading": "3.8.7 Croatia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "croatian-soil-pedon-data",
    "chapter": "3 Datasets",
    "heading": "3.8.7.1 Croatian Soil Pedon data",
    "text": "Description: National legacy soil profile dataset. Somewhat -represents forest soils.📕 Martinovic J., (2000) “Tla u Hrvatskoj”, Monografija, Drzavna uprava za zastitu prirode okolisa, str. 269, Zagreb. ISBN: 9536793059 / Basic F., (2014) “Soils Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154🔗 Project website: http://www.haop.hr/📂 Data download URL: Complete document📍 Unique locations: 2169📋 Unique complete rows: 5746📝 Import steps: chemsprops.bpht",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "colombia",
    "chapter": "3 Datasets",
    "heading": "3.8.8 Colombia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-texture-dataset-based-on-sislac",
    "chapter": "3 Datasets",
    "heading": "3.8.8.1 Soil texture dataset (based on SISLAC)",
    "text": "Description: Texture fractions harmonized five standard depths (5, 15, 30, 60, 100 cm) using SISLAC soil profile data Colombia. Data set available CC license.📕 Varón-Ramírez, V. M., Araujo-Carrillo, G. ., & Guevara, M. (2022). Colombian soil texture: Building spatial ensemble model. Earth System Science Data Discussions, 1-30. https://doi.org/10.5194/essd-2021-437🔗 Project website: https://www.agrosavia.co/📂 Data download URL: https://dx.doi.org/10.6073/pasta/6dded07af834834ee21a134b247507fd📍 Unique locations: 4203📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "congo-democratic-republic-of",
    "chapter": "3 Datasets",
    "heading": "3.8.9 Congo, Democratic Republic of",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-spectral-library-for-central-africa-cassl",
    "chapter": "3 Datasets",
    "heading": "3.8.9.1 Soil spectral library for central Africa (CASSL)",
    "text": "Description: Contains 1,800 soil samples total carbon total N ten distinct geo-climatic regions throughout Congo Basin wider African Great Lakes region. Points spatially clustered around six core sampling regions.📕 Summerauer, L., Baumann, P., Ramirez-Lopez, L., Barthel, M., Bauters, M., Bukombe, B., … & Six, J. (2021). Filling key gap: soil infrared library central Africa. Soil Discussions, 1-28.🔗 Project website: https://github.com/laura-summerauer/ssl-central-africa📂 Data download URL: https://doi.org/10.5281/zenodo.4320395📍 Unique locations: 920📋 Unique complete rows: 1852📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "costa-rica",
    "chapter": "3 Datasets",
    "heading": "3.8.10 Costa Rica",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-profile-db-for-costa-rica",
    "chapter": "3 Datasets",
    "heading": "3.8.10.1 Soil Profile DB for Costa Rica",
    "text": "Description: National legacy soil profile database Costa Rica.📕 Mata, R., Vazquez, ., Rosales, ., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociacion Costarricense de la Ciencia del Suelo, San Jose, CRC. Escala, 1, 200000.🔗 Project website: http://www.cia.ucr.ac.cr📂 Data download URL: zip file📍 Unique locations: 472📋 Unique complete rows: 2042📝 Import steps: chemsprops.CostaRica",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "estonia",
    "chapter": "3 Datasets",
    "heading": "3.8.11 Estonia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "eco-hydrological-modelling-parameters-dataset-for-estonia-estsoil-eh",
    "chapter": "3 Datasets",
    "heading": "3.8.11.1 Eco-Hydrological modelling parameters dataset for Estonia (EstSoil-EH)",
    "text": "Description: Soil polygon map Estonia various derived grids. Point data (1,121 samples) publicly available can obtained contacting authors.📕 Kmoch, ., Kanal, ., Astover, ., Kull, ., Virro, H., Helm, ., Pärtel, M., Ostonen, ., Uuemaa, E. (2021). EstSoil-EH: high-resolution eco-hydrological modelling parameters dataset Estonia, Earth Syst. Sci. Data, 13, 83–97. https://doi.org/10.5194/essd-13-83-2021🔗 Project website: https://landscape-geoinformatics.ut.ee/estsoil-eh-dataset📂 Data download URL: https://doi.org/10.5281/zenodo.3473289📍 Unique locations: 3373📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "france",
    "chapter": "3 Datasets",
    "heading": "3.8.12 France",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "french-rmqs-soil-profile-and-monitoring-dataset-with-related-management-practices-data",
    "chapter": "3 Datasets",
    "heading": "3.8.12.1 French RMQS soil profile and monitoring dataset with related management practices data",
    "text": "Description: Full soil profiles results chemical physical analyses \nsoil profiles monitoring + results management practices related soil data.\nLocations points degraded minimum error 1 km avoid\nlegal issues land owners / farmers.📕 Saby, N. P. ., Chenu, J.-P., Szergi, T., Csorba, ., Bertuzzi, P., Toutain, B., … Creamer, R. (2020). French RMQS soil profile monitoring dataset related management practices data. Recherche Data Gouv. https://doi.org/10.15454/AIQ9WS / Saby, N. P. ., Thioulouse, J., Jolivet, C. C., Ratié, C., Boulonne, L., Bispo, ., & Arrouays, D. (2009). Multivariate analysis spatial patterns 8 trace elements using French soil monitoring network data. Science Total Environment, 407(21), 5644-5652. http://dx.doi.org/10.1016/j.scitotenv.2009.07.002🔗 Project website: https://landmarkproject.eu/📂 Data download URL: https://doi.org/10.15454/AIQ9WS📍 Unique locations: 2171📋 Unique complete rows: 4149📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "germany",
    "chapter": "3 Datasets",
    "heading": "3.8.13 Germany",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "stocks-of-organic-carbon-in-german-agricultural-soils-bze_lw",
    "chapter": "3 Datasets",
    "heading": "3.8.13.1 Stocks of organic carbon in German agricultural soils (BZE_LW)",
    "text": "Description: protection data privacy, coordinate randomly generated\nwithin radius 4-km around planned sampling point.📕 Poeplau, C., Jacobs, ., Don, ., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks organic carbon German agricultural soils—Key results first comprehensive inventory. Journal Plant Nutrition Soil Science, 183(6), 665-681.🔗 Project website: https://www.thuenen.de/de/ak/📂 Data download URL: https://doi.org/10.3220/DATA20200203151139📍 Unique locations: 3104📋 Unique complete rows: 17187📝 Import steps: chemsprops.BZE_LW",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "ghana",
    "chapter": "3 Datasets",
    "heading": "3.8.14 Ghana",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "national-soil-profile-legacy-db",
    "chapter": "3 Datasets",
    "heading": "3.8.14.1 National soil profile legacy DB",
    "text": "Description: Described literature yet imported AfSPDB.📕 Owusu, S., Yigini, Y., Olmedo, G. F., & Omuto, C. T. (2020). Spatial prediction soil organic carbon stocks Ghana using legacy data. Geoderma, 360, 114008.🔗 Project website:📂 Data download URL:📍 Unique locations:📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "ghansis-ghana-soil-information-services",
    "chapter": "3 Datasets",
    "heading": "3.8.14.2 GhanSIS (Ghana Soil Information Services)",
    "text": "Description: Soil samples (0-20 cm, 20-50 cm) collected within AfSIS-II project.\nCoordinates points available. Sample reference soil spectral data available CC-0 license.📕 Hengl, T., Miller, M..E., Križan, J. et al. (2021). African soil properties nutrients mapped 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils📂 Data download URL: https://doi.org/10.34725/DVN/SPRSFN📍 Unique locations:📋 Unique complete rows: 3013📝 Import steps: AfSIS2",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "ireland",
    "chapter": "3 Datasets",
    "heading": "3.8.15 Ireland",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "irish-soil-information-system",
    "chapter": "3 Datasets",
    "heading": "3.8.15.1 Irish Soil Information System",
    "text": "Description: National legacy soil profile dataset. 2012/2013, 246 profile pits sampled analysed part Irish Soil Information System project fill gaps description representative profile data Ireland. point data publicly available.📕 Creamer, R., & O’Sullivan, L. (Eds.). (2018). soils Ireland. Springer. ISBN: 9783319711898.🔗 Project website: http://soils.teagasc.ie/📂 Data download URL:📍 Unique locations: 246📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "iran-islamic-republic-of-iran",
    "chapter": "3 Datasets",
    "heading": "3.8.16 Iran (Islamic Republic of Iran)",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "iran-soil-profile-db",
    "chapter": "3 Datasets",
    "heading": "3.8.16.1 Iran soil profile DB",
    "text": "Description: National legacy soil profile dataset.📕 Mohammad, H. B. (2000). Soil resources use potentiality map Iran. Soil Water Research Institute, Teheran, Iran. / Dewan, M. L., & Famouri, J. (1964). soils Iran. Food Agriculture Organization United Nations.🔗 Project website:📂 Data download URL:📍 Unique locations: 1373📋 Unique complete rows: 4759📝 Import steps: chemsprops.IRANSPDB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "israel",
    "chapter": "3 Datasets",
    "heading": "3.8.17 Israel",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "the-national-soil-spectral-library-of-israel",
    "chapter": "3 Datasets",
    "heading": "3.8.17.1 The National Soil Spectral Library of Israel",
    "text": "Description: Compilation soil spectral data various projects.📕 NA🔗 Project website: https://www.modelfarm-aro.org/subject-areas/-national-soil-spectral-library--israel/?lang=en📂 Data download URL:📍 Unique locations:📋 Unique complete rows: 4000📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "nigeria",
    "chapter": "3 Datasets",
    "heading": "3.8.18 Nigeria",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "nigeria-legacy-soils-and-national-surveys-compilation",
    "chapter": "3 Datasets",
    "heading": "3.8.18.1 Nigeria Legacy soils and National surveys (compilation)",
    "text": "Description: Soil profile observation compiled Nigeria National Legacy data IITA Project sites. Submitted Tunrayo Alabi, CGIAR - Consortium Spatial Information (CGIAR-CSI). Overlaps Africa Soil profiles dataset.📕 Leenaars, J. G., Van Oostrum, . J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. compilation georeferenced standardized legacy soil profile data Sub-Saharan Africa (dataset). Wageningen: ISRIC Report 2014/01. / Akpa, S. ., Odeh, . O., Bishop, T. F., Hartemink, . E., & Amapu, . Y. (2016). Total soil organic carbon carbon sequestration potential Nigeria. Geoderma, 271, 202-215.🔗 Project website: https://www.africageoportal.com📂 Data download URL: https://www.africageoportal.com/datasets/CSI::legacy-soils--national-surveys/📍 Unique locations:📋 Unique complete rows: 2569📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "namibia",
    "chapter": "3 Datasets",
    "heading": "3.8.19 Namibia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "a-soter-database-for-namibia-namsoter",
    "chapter": "3 Datasets",
    "heading": "3.8.19.1 A SOTER database for Namibia: NAMSOTER",
    "text": "Description: Legacy soil profile dataset.📕 Coetzee, M. E. (2001). NAMSOTER, SOTER database Namibia. Agroecological Zoning, 458.🔗 Project website:📂 Data download URL:📍 Unique locations: 1014📋 Unique complete rows: 2953📝 Import steps: chemsprops.LandPKS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "scotland",
    "chapter": "3 Datasets",
    "heading": "3.8.20 Scotland",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "national-soils-inventory-for-scotland",
    "chapter": "3 Datasets",
    "heading": "3.8.20.1 National Soils Inventory for Scotland",
    "text": "Description: Legacy dataset. National Soil Inventory Scotland (NSIS 1978-88) dataset collected sampling points arranged 10 km grid across country. data set maintained distributed James Hutton Institute Ordnance Survey Open Data (Data).📕 Lilly, ., Bell, J.S., Hudson, G., Nolan, .J. & Towers. W. (Compilers) (2010). National soil inventory Scotland (NSIS_1); site location, sampling profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230🔗 Project website: http://soils.environment.gov.scot/📂 Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download📍 Unique locations: 721📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "slovenia",
    "chapter": "3 Datasets",
    "heading": "3.8.21 Slovenia",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-profiles-from-the-graphical-units-of-agricultural-land-gerk",
    "chapter": "3 Datasets",
    "heading": "3.8.21.1 Soil profiles from the Graphical Units of Agricultural Land (GERK)",
    "text": "Description: Legacy dataset. National Soil Inventory Slovenia (agricultural land ).📕 Vrščaj, B., Repe, B., Simončič, P., & Vrščaj, B. (2017). Soil Information. Soils Slovenia, 157-170. https://doi.org/10.1007/978-94-017-8585-3_7🔗 Project website: https://rkg.gov.si/vstop/📂 Data download URL: https://rkg.gov.si/vstop/📍 Unique locations: 1879📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "switzerland",
    "chapter": "3 Datasets",
    "heading": "3.8.22 Switzerland",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "swiss-national-soil-spectral-model-library",
    "chapter": "3 Datasets",
    "heading": "3.8.22.1 Swiss National Soil Spectral Model Library",
    "text": "Description: National SS library.📕 Baumann, P., Helfenstein, ., Gubler, ., Keller, ., Meuli, R. G., Wächter, D., … & Six, J. (2021). Developing Swiss soil spectral library local estimation monitoring. SOIL Discussions, 1-32. https://doi.org/10.5194/soil-2020-105🔗 Project website:📂 Data download URL:📍 Unique locations:📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "nabodat",
    "chapter": "3 Datasets",
    "heading": "3.8.22.2 NABODAT",
    "text": "Description: Swiss National soil information system (NABODAT). Proprietary data\ncan requested research purposes. Includes also Swiss Soil Monitoring Network (NABO).📕 Rehbein, K., van der Meer, M., Grob, U., Wegmann, F. Keller, . 2011. “Das Nationale Bodeninformationssystem NABODAT der Schweiz”. Berichte der DBG “Böden verstehen – Böden nutzen –Böden fit machen”, 3–9 September 2011, Berlin http://eprints.dbges.de / Keller, . (2013). National soil information systems support spatial planning procedures. disP-Planning Review, 49(1), 68-71. https://doi.org/10.1080/02513625.2013.799872🔗 Project website: https://www.nabodat.ch/📂 Data download URL:📍 Unique locations:📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "swiss-biodiversity-monitoring-bdm",
    "chapter": "3 Datasets",
    "heading": "3.8.22.3 Swiss Biodiversity Monitoring (BDM)",
    "text": "Description: Swiss Biodiversity Monitoring (BDM) soil samples. Focused monitoring soil bacterial communities.📕 Mayerhofer, J., Wächter, D., Calanca, P., Kohli, L., Roth, T., Meuli, R. G., & Widmer, F. (2021). Environmental anthropogenic factors shape major bacterial community types across complex mountain landscape switzerland. Frontiers microbiology, 12, 581430. https://doi.org/10.3389/fmicb.2021.581430🔗 Project website: https://www.biodiversitymonitoring.ch/index.php/en/home-footer📂 Data download URL:📍 Unique locations: 255📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "tanzania",
    "chapter": "3 Datasets",
    "heading": "3.8.23 Tanzania",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "tansis-afsis-ii",
    "chapter": "3 Datasets",
    "heading": "3.8.23.1 TanSIS (AfSIS-II)",
    "text": "Description: Tanzanian Soil Information Service. Coordinates points available\nhttps://registry.opendata.aws/afsis/. Sample data available CC-0 license.📕 Hengl, T., Miller, M..E., Križan, J. et al. (2021). African soil properties nutrients mapped 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils📂 Data download URL: https://doi.org/10.34725/DVN/XUDGJY📍 Unique locations:📋 Unique complete rows: 26,772📝 Import steps: AfSIS2",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "russian-federation",
    "chapter": "3 Datasets",
    "heading": "3.8.24 Russian Federation",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "the-unified-state-register-of-soil-resources-egrpr",
    "chapter": "3 Datasets",
    "heading": "3.8.24.1 The Unified State Register of Soil Resources: EGRPR",
    "text": "Description: documentation Russian .📕 Stolbovoy V.S., Molchanov E.N., Sheremet B.V. Morphogenetic basis unified state register soil resources Russia. Dokuchaev Soil Bulletin. 2016;(86):115-123. https://doi.org/10.19047/0136-1694-2016-86-115-123🔗 Project website:📂 Data download URL: http://egrpr.esoil.ru/content/1DB.html📍 Unique locations: 802📋 Unique complete rows: 4137📝 Import steps: chemsprops.EGRPR",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "uk",
    "chapter": "3 Datasets",
    "heading": "3.8.25 UK",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "landis-national-soils-inventory-nsi",
    "chapter": "3 Datasets",
    "heading": "3.8.25.1 LandIS / National Soils Inventory (NSI)",
    "text": "Description: National soil land use database. Proprietary dataset maintained Cranfield University.\nLandIS Registered Trademark.📕 Bradley, R. ., Milne, R., Bell, J., Lilly, ., Jordan, C., & Higgins, . (2005). soil carbon land use database United Kingdom. Soil use Management, 21(4), 363-369. https://doi.org/10.1079/SUM2005351 / Hallett, S.H., Sakrabani, R., Keay, C.. Hannam, J.. (2017). Developments Land Information Systems: Case studies land resource management capabilities options. Soil Use Management. http://doi.org/10.1111/sum.12380🔗 Project website: https://www.landis.org.uk/📂 Data download URL: https://www.landis.org.uk/soilsguide/series.cfm📍 Unique locations: 50,000+📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "usa",
    "chapter": "3 Datasets",
    "heading": "3.8.26 USA",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "national-cooperative-soil-survey-characterization-database",
    "chapter": "3 Datasets",
    "heading": "3.8.26.1 National Cooperative Soil Survey Characterization Database",
    "text": "Description: National Cooperative Soil Survey Characterization Database probably\ncomprehensive detailed soil profile dataset World. continuously\nmaintained USDA National Cooperative Soil Survey. Data available \nCC-0 license.📕 USDA-NRCS, (2016). General description NCSS Soil Characterization Data. USDA, Natural Resources Conservation Service. / O’Geen, ., Walkinshaw, M., & Beaudette, D. (2017). SoilWeb: multifaceted interface soil survey information. Soil Science Society America Journal, 81(4), 853-862. https://doi.org/10.2136/sssaj2016.11.0386n🔗 Project website: http://ncsslabdatamart.sc.egov.usda.gov/📂 Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/📍 Unique locations: 19861📋 Unique complete rows: 136011📝 Import steps: chemsprops.NCSS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "usda-national-soil-survey-centers-kellogg-soil-survey-laboratory-nssc-kssl",
    "chapter": "3 Datasets",
    "heading": "3.8.26.2 USDA National Soil Survey Center’s Kellogg Soil Survey Laboratory — (NSSC KSSL)",
    "text": "Description: MIR spectral library associated soil characterization database, now\nincludes >50,000 MIR spectra collected soils primarily United States. Currently available publicly use.📕 Seybold, C. ., Ferguson, R., Wysocki, D., Bailey, S., Anderson, J., Nester, B., … & Thomas, P. (2019). Application Mid‐Infrared Spectroscopy Soil Survey. Soil Science Society America Journal, 83(6), 1746-1759. https://doi.org/10.2136/sssaj2019.06.0205 / Sanderman, J., Savage, K., & Dangal, S. R. (2020). Mid‐infrared spectroscopy prediction soil health indicators United States. Soil Science Society America Journal, 84(1), 251-261. https://doi.org/10.1002/saj2.20009🔗 Project website: https://www.nrcs.usda.gov/wps/portal/nrcs/main/soils/research/📂 Data download URL:📍 Unique locations: 61103📋 Unique complete rows:📝 Import steps: sslsprops.KSSL",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "rapid-carbon-assessment-raca",
    "chapter": "3 Datasets",
    "heading": "3.8.26.3 Rapid Carbon Assessment: RaCA",
    "text": "Description: Locations site degraded due confidentiality \nreflect general position site.📕 Wills, S. et al. (2013) “Rapid carbon assessment (RaCA) methodology: Sampling Initial Summary. United States Department Agriculture.” Natural Resources Conservation Service, National Soil Survey Center.🔗 Project website: https://www.nrcs.usda.gov/survey/raca/📂 Data download URL: https://www.nrcs.usda.gov/wps/portal/nrcs/detailfull/soils/research/?cid=nrcs142p2_054164📍 Unique locations: 6332📋 Unique complete rows: 143006📝 Import steps: chemsprops.RaCa",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "usgs-geochemical-and-mineralogical-data-for-soils",
    "chapter": "3 Datasets",
    "heading": "3.8.26.4 USGS Geochemical and mineralogical data for soils",
    "text": "Description: Systematic geochemical mineralogical survey soil horizons analyzed using consistent set methods, sample spacing 1 per 1,600 sq km. Data available \nCC-0 license.📕 Smith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., Fey, D.L., (2013). Geochemical mineralogical data soils conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/ / Smith, D. B., W. F. Cannon, L. G. Woodruff (2011). national-scale geochemical mineralogical survey soils conterminous United States. Appl. Geochem., 26, S250–S255. https://doi.org/10.1016/j.apgeochem.2011.03.116.🔗 Project website: https://mrdata.usgs.gov/ds-801/📂 Data download URL: https://mrdata.usgs.gov/ds-801/📍 Unique locations: 4857📋 Unique complete rows: 9446📝 Import steps: chemsprops.USGS.NGS",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "the-forest-inventory-and-analysis-database-fiadb",
    "chapter": "3 Datasets",
    "heading": "3.8.26.5 The Forest Inventory and Analysis Database (FIADB)",
    "text": "Description: Systematic inventory forest plots.📕 Domke, G. M., Perry, C. H., Walters, B. F., Nave, L. E., Woodall, C. W., & Swanston, C. W. (2017). Toward inventory‐based estimates soil organic carbon forests United States. Ecological Applications, 27(4), 1223-1235. https://doi.org/10.1002/eap.1516/ / Forest Inventory Analysis, (2014). Forest Inventory Analysis Database: Database description user guide version 6.0.1 Phase 3. U.S. Department Agriculture, Forest Service. 182 p. [Online]. Available: https://www.fia.fs.fed.us/library/database-documentation/🔗 Project website: https://www.fia.fs.fed.us📂 Data download URL: https://apps.fs.usda.gov/fia/datamart/datamart.html📍 Unique locations: 5149📋 Unique complete rows: 23208📝 Import steps: chemsprops.FIADB",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "other-datasets",
    "chapter": "3 Datasets",
    "heading": "3.9 Other datasets",
    "text": "",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "permafrost-in-subarctic-canada",
    "chapter": "3 Datasets",
    "heading": "3.9.0.1 Permafrost in subarctic Canada",
    "text": "Description: dataset consists measurements bulk density, carbon nitrogen content soil profiles permafrost subarctic Canada. Soil cores sampled early summer 2013 2014. Data publicly available Open Government Licence.📕 Estop-Aragones, C.; Fisher, J.P.; Cooper, M..; Thierry, .; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, .P. (2016). Bulk density, carbon nitrogen content soil profiles permafrost subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952🔗 Project website: http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/📂 Data download URL: https://catalogue.ceh.ac.uk/documents/efa2a84b-3505-4221-a7da-12af3cdc1952📍 Unique locations:📋 Unique complete rows: 2932📝 Import steps:",
    "code": ""
  },
  {
    "path": "datasets.html",
    "id": "soil-hydraulic-dataset-for-qinghai-tibet-plateau",
    "chapter": "3 Datasets",
    "heading": "3.9.1 Soil-hydraulic dataset for Qinghai-Tibet Plateau",
    "text": "Description: Contains soil profile data depths 5 cm 25 cm 238 sampling sites high cold mountainous area, Northeastern Qinghai-Tibet Plateau. Includes soil hydraulic properties include clay, silt, sand, soil organic carbon, soil saturated hydraulic conductivity. Data available CC-license.📕 Tian, J., Zhang, B., Wang, X., & , C. (2022). situ observation dataset soil hydraulic properties soil moisture high cold mountainous area northeastern Qinghai-Tibet Plateau. Earth System Science Data Discussions, 1-29. https://doi.org/10.5194/essd-2022-21🔗 Project website: https://data.tpdc.ac.cn/📂 Data download URL: https://doi.org/10.5281/zenodo.5830583📍 Unique locations: 238📋 Unique complete rows:📝 Import steps:",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "soil-variables",
    "chapter": "4 Soil variables",
    "heading": "4 Soil variables",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "chemical-soil-variables",
    "chapter": "4 Soil variables",
    "heading": "4.1 Chemical soil variables",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "physical-soil-variables",
    "chapter": "4 Soil variables",
    "heading": "4.2 Physical soil variables",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "biological-soil-variables",
    "chapter": "4 Soil variables",
    "heading": "4.3 Biological soil variables",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "soil-classification",
    "chapter": "4 Soil variables",
    "heading": "4.4 Soil classification",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-variables.html",
    "id": "site-observations",
    "chapter": "4 Soil variables",
    "heading": "4.5 Site observations",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "soil-chemical-and-physical-properties",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5 Soil chemical and physical properties",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.Last update: 2023-05-10",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "overview",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.1 Overview",
    "text": "section describes import steps used produce global compilation soil\nlaboratory data chemical (physical) soil properties can \nused predictive soil mapping / modeling global regional scales.Read soil chemical properties, global soil profile sample data sets functionality:Arrouays, D., Leenaars, J. G., Richer-de-Forges, . C., Adhikari, K., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil legacy data rescue via GlobalSoilMap international national initiatives. GeoResJ, 14, 1-19.Batjes, N. H., Ribeiro, E., van Oostrum, ., Leenaars, J., Hengl, T., & de Jesus, J. M. (2017). WoSIS: providing standardised soil profile data world. Earth System Science Data, 9(1), 1.Hengl, T., MacMillan, R.., (2019). Predictive Soil Mapping R. OpenGeoHub foundation, Wageningen, Netherlands, 370 pages, www.soilmapper.org, ISBN: 978-0-359-30635-0.Rossiter, D.G.,: Compendium Soil Geographical Databases.",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "alt-text-specifications",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.2  Specifications",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "data-standards",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.2.0.1 Data standards",
    "text": "Metadata information: “Soil Survey Investigation Report . 42.” “Soil Survey Investigation Report . 45.”,Model DB: National Cooperative Soil Survey (NCSS) Soil Characterization Database,",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "target-variables",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.2.0.2 Target variables:",
    "text": "Targe variables listed:clay_tot_psa: Clay, Total % wt <2 mm soil fraction,silt_tot_psa: Silt, Total % wt <2 mm soil fraction,sand_tot_psa: Sand, Total % wt <2 mm soil fraction,oc: Carbon, Organic g/kg <2 mm soil fraction,oc_d: Soil organic carbon density kg/m3,c_tot: Carbon, Total g/kg <2 mm soil fraction,n_tot: Nitrogen, Total NCS g/kg <2 mm soil fraction,ph_kcl: pH, KCl Suspension <2 mm soil fraction,ph_h2o: pH, 1:1 Soil-Water Suspension <2 mm soil fraction,ph_cacl2: pH, CaCl2 Suspension <2 mm soil fraction,cec_sum: Cation Exchange Capacity, Summary, cmol(+)/kg <2 mm soil fraction,cec_nh4: Cation Exchange Capacity, NH4 prep, cmol(+)/kg <2 mm soil fraction,ecec: Cation Exchange Capacity, Effective, CMS derived value default, standa prep cmol(+)/kg <2 mm soil fraction,wpg2: Coarse fragments % wt >2 mm soil fraction,db_od: Bulk density (Oven Dry) g/cm3 (4A1h),ca_ext: Calcium, Extractable mg/kg <2 mm soil fraction (usually Mehlich3),mg_ext: Magnesium, Extractable mg/kg <2 mm soil fraction (usually Mehlich3),na_ext: Sodium, Extractable mg/kg <2 mm soil fraction (usually Mehlich3),k_ext: Potassium, Extractable mg/kg <2 mm soil fraction (usually Mehlich3),ec_satp: Electrical Conductivity, Saturation Extract dS/m <2 mm soil fraction,ec_12pre: Electrical Conductivity, Predict, 1:2 (w/w) dS/m <2 mm soil fraction,",
    "code": "\nsite.names = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \n               \"latitude_decimal_degrees\")\nhor.names = c(\"labsampnum\",\"site_key\",\"layer_sequence\",\"hzn_top\",\"hzn_bot\", \n              \"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \n              \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n## target structure:\ncol.names = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \n              \"latitude_decimal_degrees\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \n              \"hzn_bot\",\"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \n              \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \n              \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \n              \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \n              \"confidence_degree\", \"project_url\", \"citation_url\")"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "alt-text-data-import",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3  Data import",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "national-cooperative-soil-survey-characterization-database-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.1 National Cooperative Soil Survey Characterization Database",
    "text": "National Cooperative Soil Survey, (2020). National Cooperative Soil Survey Characterization Database. Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/O’Geen, ., Walkinshaw, M., & Beaudette, D. (2017). SoilWeb: multifaceted interface soil survey information. Soil Science Society America Journal, 81(4), 853-862. https://doi.org/10.2136/sssaj2016.11.0386nThis data set continuously updated.",
    "code": "\nif(!exists(\"chemsprops.NCSS\")){\n  ncss.site <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Site_Location.csv\", stringsAsFactors = FALSE)\n  ncss.layer <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Layer.csv\", stringsAsFactors = FALSE)\n  ncss.bdm <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Bulk_Density_and_Moisture.csv\", stringsAsFactors = FALSE)\n  ## multiple measurements\n  summary(as.factor(ncss.bdm$prep_code))\n  ncss.bdm.0 <- ncss.bdm[ncss.bdm$prep_code==\"S\",]\n  summary(ncss.bdm.0$db_od)\n  ## 0 BD values --- error!\n  ncss.carb <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Carbon_and_Extractions.csv\", stringsAsFactors = FALSE)\n  ncss.organic <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Organic.csv\", stringsAsFactors = FALSE)\n  ncss.pH <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_pH_and_Carbonates.csv\", stringsAsFactors = FALSE)\n  #str(ncss.pH)\n  #summary(ncss.pH$ph_h2o)\n  #summary(!is.na(ncss.pH$ph_h2o))\n  ncss.PSDA <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_PSDA_and_Rock_Fragments.csv\", stringsAsFactors = FALSE)\n  ncss.CEC <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_CEC_and_Bases.csv\")\n  ncss.salt <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Salt.csv\")\n  ncss.horizons <- plyr::join_all(list(ncss.bdm.0, ncss.layer, ncss.carb, ncss.organic[,c(\"labsampnum\", \"result_source_key\", \"c_tot\", \"n_tot\", \"db_od\", \"oc\")], ncss.pH, ncss.PSDA, ncss.CEC, ncss.salt), type = \"full\", by=\"labsampnum\")\n  #head(ncss.horizons)\n  nrow(ncss.horizons)\n  ncss.horizons$oc_d = signif(ncss.horizons$oc / 100 * ncss.horizons$db_od * 1000 * (100 - ifelse(is.na(ncss.horizons$wpg2), 0, ncss.horizons$wpg2))/100, 3)\n  ncss.horizons$ca_ext = signif(ncss.horizons$ca_nh4 * 200, 4)\n  ncss.horizons$mg_ext = signif(ncss.horizons$mg_nh4 * 121, 3)\n  ncss.horizons$na_ext = signif(ncss.horizons$na_nh4 * 230, 3)\n  ncss.horizons$k_ext = signif(ncss.horizons$k_nh4 * 391, 3)\n  #summary(ncss.horizons$oc_d)\n  ## Values <0!!\n  chemsprops.NCSS = plyr::join(ncss.site[,site.names], ncss.horizons[,hor.names], by=\"site_key\") \n  chemsprops.NCSS$site_obsdate = format(as.Date(chemsprops.NCSS$site_obsdate, format=\"%m/%d/%Y\"), \"%Y-%m-%d\")\n  chemsprops.NCSS$source_db = \"USDA_NCSS\"\n  #dim(chemsprops.NCSS)\n  chemsprops.NCSS$oc = chemsprops.NCSS$oc * 10\n  chemsprops.NCSS$n_tot = chemsprops.NCSS$n_tot * 10\n  #hist(log1p(chemsprops.NCSS$oc), breaks=45, col=\"gray\")\n  chemsprops.NCSS$confidence_degree = 1\n  chemsprops.NCSS$project_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  chemsprops.NCSS$citation_url = \"https://doi.org/10.2136/sssaj2016.11.0386n\"\n  chemsprops.NCSS = complete.vars(chemsprops.NCSS, sel=c(\"tex_psda\",\"oc\",\"clay_tot_psa\",\"ecec\",\"ph_h2o\",\"ec_12pre\",\"k_ext\"))\n  #rm(ncss.horizons)\n}\ndim(chemsprops.NCSS)\n#> [1] 136011     36\n#summary(!is.na(chemsprops.NCSS$oc))\n## texture classes need to be cleaned-up\nsummary(as.factor(chemsprops.NCSS$tex_psda))\n#>                               c               C              cl              CL \n#>            2391           10908              19           10158               5 \n#>             cos             CoS             COS            cosl            CoSL \n#>            2424               6               4            4543               2 \n#> Fine Sandy Loam              fs             fsl             FSL               l \n#>               1            2357           10701              16           17038 \n#>               L            lcos            LCoS             lfs              ls \n#>               2            2933               3            1805            3166 \n#>              LS            lvfs               s               S              sc \n#>               1             152            2958               1             601 \n#>             scl             SCL              si             sic             SiC \n#>            5456               5             854            7123              11 \n#>            sicl            SiCL             sil             SiL             SIL \n#>           13718              14           22230               4              28 \n#>              sl              SL             vfs            vfsl            VFSL \n#>            5547              13              64            2678               3 \n#>            NA's \n#>            6068"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "rapid-carbon-assessment-raca-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.2 Rapid Carbon Assessment (RaCA)",
    "text": "Soil Survey Staff. Rapid Carbon Assessment (RaCA) project. United States Department Agriculture, Natural Resources Conservation Service. Available online. June 1, 2013 (FY2013 official release). Data download URL: https://www.nrcs.usda.gov/wps/portal/nrcs/detailfull/soils/research/?cid=nrcs142p2_054164Note: Locations site degraded due confidentiality reflect general position site.Wills, S. et al. (2013) “Rapid carbon assessment (RaCA) methodology: Sampling Initial Summary. United States Department Agriculture.” Natural Resources Conservation Service, National Soil Survey Center.",
    "code": "\nif(!exists(\"chemsprops.RaCa\")){\n  raca.df <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/RaCA/RaCa_general_location.csv\", stringsAsFactors = FALSE)\n  names(raca.df)[1] = \"rcasiteid\"\n  raca.layer <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/RaCA/RaCA_samples_JULY2016.csv\", stringsAsFactors = FALSE)\n  raca.layer$longitude_decimal_degrees = plyr::join(raca.layer[\"rcasiteid\"], raca.df, match =\"first\")$Gen_long\n  raca.layer$latitude_decimal_degrees = plyr::join(raca.layer[\"rcasiteid\"], raca.df, match =\"first\")$Gen_lat\n  raca.layer$site_obsdate = \"2013\"\n  summary(raca.layer$Calc_SOC)\n  #plot(raca.layer[!duplicated(raca.layer$rcasiteid),c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\")])\n  #summary(raca.layer$SOC_pred1)\n  ## some strange groupings around small values\n  raca.layer$oc_d = signif(raca.layer$Calc_SOC / 100 * raca.layer$Bulkdensity * 1000 * (100 - ifelse(is.na(raca.layer$fragvolc), 0, raca.layer$fragvolc))/100, 3)\n  raca.layer$oc = raca.layer$Calc_SOC * 10\n  #summary(raca.layer$oc_d)\n  raca.h.lst <- c(\"rcasiteid\", \"lay_field_label1\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"Lab.Sample.No\", \"layer_Number\", \"TOP\", \"BOT\", \"hzname\", \"texture\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot_ncs\", \"n_tot_ncs\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"fragvolc\", \"Bulkdensity\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = raca.h.lst[which(!raca.h.lst %in% names(raca.layer))]\n  if(length(x.na)>0){ for(i in x.na){ raca.layer[,i] = NA } }\n  chemsprops.RaCA = raca.layer[,raca.h.lst]\n  chemsprops.RaCA$source_db = \"RaCA2016\"\n  chemsprops.RaCA$confidence_degree = 4\n  chemsprops.RaCA$project_url = \"https://www.nrcs.usda.gov/survey/raca/\"\n  chemsprops.RaCA$citation_url = \"https://www.nrcs.usda.gov/Internet/FSE_DOCUMENTS/nrcs142p2_052841.pdf\"\n  chemsprops.RaCA = complete.vars(chemsprops.RaCA, sel = c(\"oc\", \"fragvolc\"))\n}\n#> Joining by: rcasiteid\n#> Joining by: rcasiteid\ndim(chemsprops.RaCA)\n#> [1] 53664    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "national-geochemical-database-soil",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.3 National Geochemical Database Soil",
    "text": "Smith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., Fey, D.L., (2013). Geochemical \nmineralogical data soils conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/.Grossman, J. N. (2004). National Geochemical Survey-database documentation. U.S. Geological Survey Open-File Report 2004-1001. DOI:10.3133/ofr20041001.Note: NGS focuses stream-sediment samples, also contains many soil samples.",
    "code": "\nif(!exists(\"chemsprops.USGS.NGS\")){\n  ngs.points <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/site.txt\", sep=\",\")\n  ## 4857 pnts\n  ngs.layers <- lapply(c(\"top5cm.txt\", \"ahorizon.txt\", \"chorizon.txt\"), function(i){read.csv(paste0(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/\", i), sep=\",\")})\n  ngs.layers = plyr::rbind.fill(ngs.layers)\n  #dim(ngs.layers)\n  # 14571  126\n  #summary(ngs.layers$tot_carb_pct)\n  #lattice::xyplot(c_org_pct ~ c_tot_pct, ngs.layers, scales=list(x = list(log = 2), y = list(log = 2)))\n  #lattice::xyplot(c_org_pct ~ tot_clay_pct, ngs.layers, scales=list(y = list(log = 2)))\n  ngs.layers$c_tot = ngs.layers$c_tot_pct * 10\n  ngs.layers$oc = ngs.layers$c_org_pct * 10\n  ngs.layers$hzn_top = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][1]})\n  ngs.layers$hzn_bot = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][2]})\n  #summary(ngs.layers$tot_clay_pct)\n  #summary(ngs.layers$k_pct) ## very high numbers?\n  ## question is if the geochemical element results are compatible with e.g. k_ext?\n  t.ngs = c(\"lab_id\", \"site_id\", \"horizon\", \"hzn_top\", \"hzn_bot\", \"tot_clay_pct\", \"c_tot\", \"oc\")\n  ngs.m = plyr::join(ngs.points, ngs.layers[!is.na(ngs.layers$c_org_pct),t.ngs])\n  ngs.m$site_obsdate = as.Date(ngs.m$colldate, format=\"%Y-%m-%d\") \n  ngs.h.lst <- c(\"site_id\", \"quad\", \"site_obsdate\", \"longitude\", \"latitude\", \"lab_id\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"horizon\", \"tex_psda\", \"tot_clay_pct\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ngs.h.lst[which(!ngs.h.lst %in% names(ngs.m))]\n  if(length(x.na)>0){ for(i in x.na){ ngs.m[,i] = NA } }\n  chemsprops.USGS.NGS = ngs.m[,ngs.h.lst]\n  chemsprops.USGS.NGS$source_db = \"USGS.NGS\"\n  chemsprops.USGS.NGS$confidence_degree = 1\n  chemsprops.USGS.NGS$project_url = \"https://mrdata.usgs.gov/ds-801/\"\n  chemsprops.USGS.NGS$citation_url = \"https://pubs.usgs.gov/ds/801/\"\n  chemsprops.USGS.NGS = complete.vars(chemsprops.USGS.NGS, sel = c(\"tot_clay_pct\", \"oc\"), coords = c(\"longitude\", \"latitude\"))\n}\ndim(chemsprops.USGS.NGS)\n#> [1] 9446   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "forest-inventory-and-analysis-database-fiadb",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.4 Forest Inventory and Analysis Database (FIADB)",
    "text": "Domke, G. M., Perry, C. H., Walters, B. F., Nave, L. E., Woodall, C. W., & Swanston, C. W. (2017). Toward inventory‐based estimates soil organic carbon forests United States. Ecological Applications, 27(4), 1223-1235. https://doi.org/10.1002/eap.1516Forest Inventory Analysis, (2014). Forest Inventory Analysis Database: Database description\nuser guide version 6.0.1 Phase 3. U.S. Department Agriculture, Forest Service. 182 p.\n[Online]. Available: https://www.fia.fs.fed.us/library/database-documentation/Note: samples taken top-soil either 0–10.16 cm 10.16–20.32 cm.",
    "code": "\nif(!exists(\"chemsprops.FIADB\")){\n  fia.loc <- vroom::vroom(\"/mnt/diskstation/data/Soil_points/USA/FIADB/ENTIRE/PLOT.csv\")\n  fia.loc$site_id = paste(fia.loc$STATECD, fia.loc$COUNTYCD, fia.loc$PLOT, sep=\"_\")\n  fia.lab <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/FIADB/ENTIRE/SOILS_LAB.csv\")\n  fia.lab$site_id = paste(fia.lab$STATECD, fia.lab$COUNTYCD, fia.lab$PLOT, sep=\"_\")\n  ## 23,765 rows\n  fia.des <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/FIADB/ENTIRE/SOILS_SAMPLE_LOC.csv\")\n  fia.des$site_id = paste(fia.des$STATECD, fia.des$COUNTYCD, fia.des$PLOT, sep=\"_\")\n  #fia.lab$TXTRLYR1 = plyr::join(fia.lab[c(\"site_id\",\"INVYR\")], fia.des[c(\"site_id\",\"TXTRLYR1\",\"INVYR\")], match =\"first\")$TXTRLYR1\n  fia.lab$TXTRLYR2 = plyr::join(fia.lab[c(\"site_id\",\"INVYR\")], fia.des[c(\"site_id\",\"TXTRLYR2\",\"INVYR\")], match =\"first\")$TXTRLYR2\n  #summary(as.factor(fia.lab$TXTRLYR1))\n  fia.lab$tex_psda = factor(fia.lab$TXTRLYR2, labels = c(\"Organic\", \"Loamy\", \"Clayey\", \"Sandy\", \"Coarse sand\", \"Not measured\")) \n  #Code Description\n  # 0 Organic.\n  # 1 Loamy.\n  # 2 Clayey.\n  # 3 Sandy.\n  # 4 Coarse sand.\n  # 9 Not measured - make plot notes\n  fia.lab$FORFLTHK = plyr::join(fia.lab[c(\"site_id\",\"INVYR\")], fia.des[c(\"site_id\",\"FORFLTHK\",\"INVYR\")], match =\"first\")$FORFLTHK\n  #summary(fia.lab$FORFLTHK)\n  fia.lab$LTRLRTHK = plyr::join(fia.lab[c(\"site_id\",\"INVYR\")], fia.des[c(\"site_id\",\"LTRLRTHK\",\"INVYR\")], match =\"first\")$LTRLRTHK\n  fia.lab$tot_thk = rowSums(fia.lab[,c(\"FORFLTHK\", \"LTRLRTHK\")], na.rm=TRUE)\n  fia.lab$DPTHSBSL = plyr::join(fia.lab[c(\"site_id\",\"INVYR\")], fia.des[c(\"site_id\",\"DPTHSBSL\",\"INVYR\")], match =\"first\")$DPTHSBSL\n  #summary(fia.lab$DPTHSBSL)\n  sel.fia = fia.loc$site_id %in% fia.lab$site_id\n  #summary(sel.fia)\n  # 15,109\n  fia.loc = fia.loc[sel.fia, c(\"site_id\", \"LON\", \"LAT\")]\n  #summary(fia.lab$BULK_DENSITY)  ## some strange values for BD!\n  #quantile(fia.lab$BULK_DENSITY, c(0.02, 0.98), na.rm=TRUE)\n  #summary(fia.lab$C_ORG_PCT)\n  #summary(as.factor(fia.lab$LAYER_TYPE))\n  #lattice::xyplot(BULK_DENSITY ~ C_ORG_PCT, fia.lab, scales=list(x = list(log = 2)))\n  #dim(fia.lab)\n  # 14571  126\n  fia.lab$c_tot = fia.lab$C_ORG_PCT * 10\n  fia.lab$oc = fia.lab$C_TOTAL_PCT * 10\n  fia.lab$n_tot = fia.lab$N_TOTAL_PCT * 10\n  fia.lab$db_od = ifelse(fia.lab$BULK_DENSITY < 0.001 | fia.lab$BULK_DENSITY > 1.8, NA, fia.lab$BULK_DENSITY)\n  #lattice::xyplot(db_od ~ C_ORG_PCT, fia.lab, par.settings = list(plot.symbol = list(col=scales::alpha(\"black\", 0.6), fill=scales::alpha(\"red\", 0.6), pch=21, cex=0.6)), scales = list(x=list(log=TRUE, equispaced.log=FALSE)), ylab=\"Bulk density\", xlab=\"SOC wpct\")\n  #hist(fia.lab$db_od, breaks=45)\n  ## A lot of very small BD measurements\n  fia.lab$oc_d = signif(fia.lab$oc / 100 * fia.lab$db_od * 1000 * (100 - ifelse(is.na(fia.lab$COARSE_FRACTION_PCT), 0, fia.lab$COARSE_FRACTION_PCT))/100, 3)\n  #hist(fia.lab$oc_d, breaks=45, col=\"grey\")\n  fia.lab$hzn_top = ifelse(fia.lab$LAYER_TYPE==\"FF_TOTAL\" | fia.lab$LAYER_TYPE==\"L_ORG\", 0, NA)\n  fia.lab$hzn_bot = ifelse(fia.lab$LAYER_TYPE==\"FF_TOTAL\" | fia.lab$LAYER_TYPE==\"L_ORG\", fia.lab$tot_thk, NA)\n  fia.lab$hzn_top = ifelse(is.na(fia.lab$hzn_top) & (fia.lab$LAYER_TYPE==\"MIN_2\" | fia.lab$LAYER_TYPE==\"ORG_2\"), 10.2 + fia.lab$tot_thk, fia.lab$hzn_top)\n  fia.lab$hzn_bot = ifelse(is.na(fia.lab$hzn_bot) & (fia.lab$LAYER_TYPE==\"MIN_2\" | fia.lab$LAYER_TYPE==\"ORG_2\"), 20.3 + fia.lab$tot_thk, fia.lab$hzn_bot)\n  fia.lab$hzn_top = ifelse(is.na(fia.lab$hzn_top) & (fia.lab$LAYER_TYPE==\"MIN_1\" | fia.lab$LAYER_TYPE==\"ORG_1\"), 0 + fia.lab$tot_thk, fia.lab$hzn_top)\n  fia.lab$hzn_bot = ifelse(is.na(fia.lab$hzn_bot) & (fia.lab$LAYER_TYPE==\"MIN_1\" | fia.lab$LAYER_TYPE==\"ORG_1\"), 10.2 + fia.lab$tot_thk, fia.lab$hzn_bot) \n  #summary(fia.lab$EXCHNG_K) ## Negative values!\n  fia.m = plyr::join(fia.lab, fia.loc)\n  #fia.m = fia.m[!duplicated(as.factor(paste(fia.m$site_id, fia.m$INVYR, fia.m$LAYER_TYPE, sep=\"_\"))),]\n  fia.m$site_obsdate = as.Date(fia.m$SAMPLE_DATE, format=\"%Y-%m-%d\")\n  sel.d.fia = fia.m$site_obsdate < as.Date(\"1980-01-01\", format=\"%Y-%m-%d\")\n  fia.m$site_obsdate[which(sel.d.fia)] = NA\n  #hist(fia.m$site_obsdate, breaks=25)\n  fia.h.lst <- c(\"site_id\", \"usiteid\", \"site_obsdate\", \"LON\", \"LAT\", \"SAMPLE_ID\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"LAYER_TYPE\", \"tex_psda\", \"tot_clay_pct\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"PH_H2O\", \"PH_CACL2\", \"cec_sum\", \"cec_nh4\", \"ECEC\", \"COARSE_FRACTION_PCT\", \"db_od\", \"EXCHNG_CA\", \"EXCHNG_MG\", \"EXCHNG_NA\", \"EXCHNG_K\", \"ec_satp\", \"ec_12pre\")\n  x.na = fia.h.lst[which(!fia.h.lst %in% names(fia.m))]\n  if(length(x.na)>0){ for(i in x.na){ fia.m[,i] = NA } }\n  chemsprops.FIADB = fia.m[,fia.h.lst]\n  chemsprops.FIADB$source_db = \"FIADB\"\n  chemsprops.FIADB$confidence_degree = 2\n  chemsprops.FIADB$project_url = \"http://www.fia.fs.fed.us/\"\n  chemsprops.FIADB$citation_url = \"https://www.fia.fs.fed.us/library/database-documentation/\"\n  chemsprops.FIADB = complete.vars(chemsprops.FIADB, sel = c(\"PH_H2O\", \"oc\", \"EXCHNG_K\"), coords = c(\"LON\", \"LAT\"))\n  #str(unique(paste(chemsprops.FIADB$LON, chemsprops.FIADB$LAT, sep=\"_\")))\n}\ndim(chemsprops.FIADB)\n#> [1] 23208    36\n#write.csv(chemsprops.FIADB, \"/mnt/diskstation/data/Soil_points/USA/FIADB/fiadb_soil.pnts.csv\")"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "africa-soil-profiles-database",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.5 Africa soil profiles database",
    "text": "Leenaars, J. G., Van Oostrum, . J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. compilation georeferenced standardized legacy soil profile data Sub-Saharan Africa (dataset). Wageningen: ISRIC Report 2014/01; 2014. Data download URL: https://data.isric.org/",
    "code": "\nif(!exists(\"chemsprops.AfSPDB\")){\n  library(foreign)\n  afspdb.profiles <- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Profiles.dbf\", as.is=TRUE)\n  afspdb.layers <- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Layers.dbf\", as.is=TRUE)\n  afspdb.s.lst <- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\")\n  #summary(afspdb.layers$BlkDens)\n  ## add missing columns\n  for(j in 1:ncol(afspdb.layers)){ \n    if(is.numeric(afspdb.layers[,j])) { \n      afspdb.layers[,j] <- ifelse(afspdb.layers[,j] < 0, NA, afspdb.layers[,j]) \n    }\n  }\n  afspdb.layers$ca_ext = afspdb.layers$ExCa * 200\n  afspdb.layers$mg_ext = afspdb.layers$ExMg * 121\n  afspdb.layers$na_ext = afspdb.layers$ExNa * 230\n  afspdb.layers$k_ext = afspdb.layers$ExK * 391\n  #summary(afspdb.layers$k_ext)\n  afspdb.m = plyr::join(afspdb.profiles[,afspdb.s.lst], afspdb.layers)\n  afspdb.m$oc_d = signif(afspdb.m$OrgC * afspdb.m$BlkDens * (100 - ifelse(is.na(afspdb.m$CfPc), 0, afspdb.m$CfPc))/100, 3)\n  #summary(afspdb.m$T_Year)\n  afspdb.m$T_Year = ifelse(afspdb.m$T_Year < 0, NA, afspdb.m$T_Year)\n  afspdb.h.lst <- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\", \"LayerID\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"LabTxtr\", \"Clay\", \"Silt\", \"Sand\", \"OrgC\", \"oc_d\", \"TotC\", \"TotalN\", \"PHKCl\", \"PHH2O\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"EC\", \"ec_12pre\")\n  x.na = afspdb.h.lst[which(!afspdb.h.lst %in% names(afspdb.m))]\n  if(length(x.na)>0){ for(i in x.na){ afspdb.m[,i] = NA } }\n  chemsprops.AfSPDB = afspdb.m[,afspdb.h.lst]\n  chemsprops.AfSPDB$source_db = \"AfSPDB\"\n  chemsprops.AfSPDB$confidence_degree = 5\n  chemsprops.AfSPDB$project_url = \"https://www.isric.org/projects/africa-soil-profiles-database-afsp\"\n  chemsprops.AfSPDB$citation_url = \"https://www.isric.org/sites/default/files/isric_report_2014_01.pdf\"\n  chemsprops.AfSPDB = complete.vars(chemsprops.AfSPDB, sel = c(\"LabTxtr\",\"OrgC\",\"Clay\",\"Ecec\",\"PHH2O\",\"EC\",\"k_ext\"), coords = c(\"X_LonDD\", \"Y_LatDD\"))\n}\ndim(chemsprops.AfSPDB)\n#> [1] 60306    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "africa-soil-information-service-afsis-soil-chemistry",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.6 Africa Soil Information Service (AfSIS) Soil Chemistry",
    "text": "Towett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. ., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition soils Sub-Saharan Africa relationship soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002AfSIS Soil Chemistry produced World Agroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center International Earth Science Information Network (CIESIN), International Center Tropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) Rothamsted Research (RRES). Data download URL: https://registry.opendata.aws/afsis/",
    "code": "\nif(!exists(\"chemsprops.AfSIS1\")){\n  afsis1.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Georeferences/georeferences.csv\")\n  afsis1.xy$Sampling.date = 2011\n  afsis1.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  afsis1.hor = plyr::rbind.fill(lapply(afsis1.lst, read.csv))\n  tansis.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Georeferences/georeferences.csv\")\n  #summary(tansis.xy$Sampling.date)\n  tansis.xy$Sampling.date = 2018\n  tansis.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  tansis.hor = plyr::rbind.fill(lapply(tansis.lst, read.csv))\n  afsis1t.df = plyr::rbind.fill(list(plyr::join(afsis1.hor, afsis1.xy, by=\"SSN\"), plyr::join(tansis.hor, tansis.xy, by=\"SSN\")))\n  afsis1t.df$UpDpth = ifelse(afsis1t.df$Depth==\"sub\", 20, 0)\n  afsis1t.df$LowDpth = ifelse(afsis1t.df$Depth==\"sub\", 50, 20)\n  afsis1t.df$LayerNr = ifelse(afsis1t.df$Depth==\"sub\", 2, 1)\n  #summary(afsis1t.df$C...Org)\n  afsis1t.df$oc = rowMeans(afsis1t.df[,c(\"C...Org\", \"X.C\")], na.rm=TRUE) * 10\n  afsis1t.df$c_tot = afsis1t.df$Total.carbon\n  afsis1t.df$n_tot = rowMeans(afsis1t.df[,c(\"Total.nitrogen\", \"X.N\")], na.rm=TRUE) * 10\n  afsis1t.df$ph_h2o = rowMeans(afsis1t.df[,c(\"PH\", \"pH\")], na.rm=TRUE)\n  ## multiple texture fractons - which one is the total clay, sand, silt?\n  ## Clay content for water dispersed particles-recorded after 4 minutes of ultrasonication\n  #summary(afsis1t.df$Psa.w4clay)\n  #plot(afsis1t.df[,c(\"Longitude\", \"Latitude\")])\n  afsis1.h.lst <- c(\"SSN\", \"Site\", \"Sampling.date\", \"Longitude\", \"Latitude\", \"Soil.material\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"LabTxtr\", \"Psa.w4clay\", \"Psa.w4silt\", \"Psa.w4sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"PHKCl\", \"ph_h2o\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"M3.Mg\", \"M3.Na\", \"M3.K\", \"EC\", \"ec_12pre\")\n  x.na = afspdb.h.lst[which(!afsis1.h.lst %in% names(afsis1t.df))]\n  if(length(x.na)>0){ for(i in x.na){ afsis1t.df[,i] = NA } }\n  chemsprops.AfSIS1 = afsis1t.df[,afsis1.h.lst]\n  chemsprops.AfSIS1$source_db = \"AfSIS1\"\n  chemsprops.AfSIS1$confidence_degree = 2\n  chemsprops.AfSIS1$project_url = \"https://registry.opendata.aws/afsis/\"\n  chemsprops.AfSIS1$citation_url = \"https://doi.org/10.1016/j.geodrs.2015.06.002\"\n  chemsprops.AfSIS1 = complete.vars(chemsprops.AfSIS1, sel = c(\"Psa.w4clay\",\"oc\",\"ph_h2o\",\"M3.K\"), coords = c(\"Longitude\", \"Latitude\"))\n}\ndim(chemsprops.AfSIS1)\n#> [1] 4162   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "fine-root-ecology-database-fred",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.7 Fine Root Ecology Database (FRED)",
    "text": "Iversen CM, McCormack ML, Baer JK, Powell , Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli , Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): Global Collection Root Trait Data Coincident Site, Vegetation, Edaphic, Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department Energy, Oak Ridge, Tennessee, U.S.. Access -line : https://doi.org/10.25581/ornlsfa.014/1459186.",
    "code": "\nif(!exists(\"chemsprops.FRED\")){\n  Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  fred = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", skip = 10, col_names=FALSE)\n  ## 57,190 x 1,164\n  #nm.fred = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Column_Definitions_20210423-091040.csv\", header=TRUE)\n  nm.fred0 = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", nrows=2)\n  names(fred) = make.names(t(nm.fred0)[,1])\n  ## 1164 columns!\n  fred.h.lst = c(\"Notes_Row.ID\", \"Data.source_DOI\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"Soil.horizon\", \"Soil.texture\", \"Soil.texture_Fraction.clay\", \"Soil.texture_Fraction.silt\", \"Soil.texture_Fraction.sand\", \"Soil.organic.C.content\", \"oc_d\", \"c_tot\", \"Soil.N.content\", \"ph_kcl\", \"Soil.pH_Water\", \"Soil.pH_Salt\", \"Soil.cation.exchange.capacity..CEC.\", \"cec_nh4\", \"Soil.effective.cation.exchange.capacity..ECEC.\", \"wpg2\", \"Soil.bulk.density\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  fred$site_obsdate = as.integer(rowMeans(fred[,c(\"Sample.collection_Year.ending.collection\", \"Sample.collection_Year.beginning.collection\")], na.rm=TRUE))\n  #summary(fred$site_obsdate)\n  fred$longitude_decimal_degrees = ifelse(is.na(fred$Longitude), fred$Longitude_Estimated, fred$Longitude)\n  fred$latitude_decimal_degrees = ifelse(is.na(fred$Latitude), fred$Latitude_Estimated, fred$Latitude)\n  #names(fred)[grep(\"Notes_Row\", names(fred))]\n  #summary(fred[,grep(\"clay\", names(fred))])\n  #summary(fred[,grep(\"cation.exchange\", names(fred))])\n  #summary(fred[,grep(\"organic.C\", names(fred))])\n  #summary(fred$Soil.organic.C.content)\n  #summary(fred$Soil.bulk.density)\n  #summary(as.factor(fred$Soil.horizon))\n  fred$hzn_bot = ifelse(is.na(fred$Soil.depth_Lower.sampling.depth), fred$Soil.depth - 5, fred$Soil.depth_Lower.sampling.depth)\n  fred$hzn_top = ifelse(is.na(fred$Soil.depth_Upper.sampling.depth), fred$Soil.depth + 5, fred$Soil.depth_Upper.sampling.depth)\n  fred$oc_d = signif(fred$Soil.organic.C.content / 1000 * fred$Soil.bulk.density * 1000, 3)\n  #summary(fred$oc_d)  \n  x.na = fred.h.lst[which(!fred.h.lst %in% names(fred))]\n  if(length(x.na)>0){ for(i in x.na){ fred[,i] = NA } }\n  chemsprops.FRED = fred[,fred.h.lst]\n  #plot(chemsprops.FRED[,4:5])\n  chemsprops.FRED$source_db = \"FRED\"\n  chemsprops.FRED$confidence_degree = 5\n  chemsprops.FRED$project_url = \"https://roots.ornl.gov/\"\n  chemsprops.FRED$citation_url = \"https://doi.org/10.25581/ornlsfa.014/1459186\"\n  chemsprops.FRED = complete.vars(chemsprops.FRED, sel = c(\"Soil.organic.C.content\", \"Soil.texture_Fraction.clay\", \"Soil.pH_Water\"))\n  ## many duplicates\n}\ndim(chemsprops.FRED)\n#> [1] 858  36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "global-root-traits-groot-database-compilation",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.8 Global root traits (GRooT) database (compilation)",
    "text": "Guerrero‐Ramírez, N. R., Mommer, L., Freschet, G. T., Iversen, C. M., McCormack, M. L., Kattge, J., … & Weigelt, . (2021). Global root traits (GRooT) database. Global ecology biogeography, 30(1), 25-37. https://dx.doi.org/10.1111/geb.13179",
    "code": "\nif(!exists(\"chemsprops.GROOT\")){\n  #Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  GROOT = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/GRooT/GRooTFullVersion.csv\")\n  ## 114,222 x 73\n  c(\"locationID\", \"GRooTID\", \"originalID\", \"source\", \"year\", \"decimalLatitude\", \"decimalLongitud\", \"soilpH\", \"soilTexture\", \"soilCarbon\", \"soilNitrogen\", \"soilPhosphorus\", \"soilCarbonToNitrogen\", \"soilBaseCationSaturation\", \"soilCationExchangeCapacity\", \"soilOrganicMatter\", \"soilWaterGravimetric\", \"soilWaterVolumetric\")\n  #summary(GROOT$soilCarbon)\n  #summary(!is.na(GROOT$soilCarbon))\n  #summary(GROOT$soilOrganicMatter)\n  #summary(GROOT$soilNitrogen)\n  #summary(GROOT$soilpH)\n  #summary(as.factor(GROOT$soilTexture))\n  #lattice::xyplot(soilCarbon ~ soilpH, GROOT, par.settings = list(plot.symbol = list(col=scales::alpha(\"black\", 0.6), fill=scales::alpha(\"red\", 0.6), pch=21, cex=0.6)), scales = list(y=list(log=TRUE, equispaced.log=FALSE)), ylab=\"SOC\", xlab=\"pH\")\n  GROOT$site_obsdate = as.Date(paste0(GROOT$year, \"-01-01\"), format=\"%Y-%m-%d\")\n  GROOT$hzn_top = 0\n  GROOT$hzn_bot = 30\n  GROOT.h.lst = c(\"locationID\", \"originalID\", \"site_obsdate\", \"decimalLongitud\", \"decimalLatitude\", \"GRooTID\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"soilTexture\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"soilCarbon\", \"oc_d\", \"c_tot\", \"soilNitrogen\", \"ph_kcl\", \"soilpH\", \"ph_cacl2\", \"soilCationExchangeCapacity\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = GROOT.h.lst[which(!GROOT.h.lst %in% names(GROOT))]\n  if(length(x.na)>0){ for(i in x.na){ GROOT[,i] = NA } }\n  chemsprops.GROOT = GROOT[,GROOT.h.lst]\n  chemsprops.GROOT$source_db = \"GROOT\"\n  chemsprops.GROOT$confidence_degree = 8\n  chemsprops.GROOT$project_url = \"https://groot-database.github.io/GRooT/\"\n  chemsprops.GROOT$citation_url = \"https://dx.doi.org/10.1111/geb.13179\"\n  chemsprops.GROOT = complete.vars(chemsprops.GROOT, sel = c(\"soilCarbon\", \"soilpH\"), coords = c(\"decimalLongitud\", \"decimalLatitude\"))\n}\ndim(chemsprops.GROOT)\n#> [1] 718  36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "global-soil-respiration-db",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.9 Global Soil Respiration DB",
    "text": "Bond-Lamberty, B. Thomson, . (2010). global database soil respiration data, Biogeosciences, 7, 1915–1926, https://doi.org/10.5194/bg-7-1915-2010",
    "code": "\nif(!exists(\"chemsprops.SRDB\")){\n  srdb = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SRDB/srdb-data.csv\")\n  ## 10366 x 85\n  srdb.h.lst = c(\"Site_ID\", \"Notes\", \"Study_midyear\", \"Longitude\", \"Latitude\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psd\", \"Soil_clay\", \"Soil_silt\", \"Soil_sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Soil_BD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  #summary(srdb$Study_midyear)\n  srdb$hzn_bot = ifelse(is.na(srdb$C_soildepth), 100, srdb$C_soildepth)\n  srdb$hzn_top = 0\n  #summary(srdb$Soil_clay)\n  #summary(srdb$C_soilmineral)\n  srdb$oc_d = signif(srdb$C_soilmineral / 1000 / (srdb$hzn_bot/100), 3)\n  #summary(srdb$oc_d) \n  #summary(srdb$Soil_BD)\n  srdb$oc = srdb$oc_d / srdb$Soil_BD\n  #summary(srdb$oc)\n  x.na = srdb.h.lst[which(!srdb.h.lst %in% names(srdb))]\n  if(length(x.na)>0){ for(i in x.na){ srdb[,i] = NA } }\n  chemsprops.SRDB = srdb[,srdb.h.lst]\n  #plot(chemsprops.SRDB[,4:5])\n  chemsprops.SRDB$source_db = \"SRDB\"\n  chemsprops.SRDB$confidence_degree = 5\n  chemsprops.SRDB$project_url = \"https://github.com/bpbond/srdb/\"\n  chemsprops.SRDB$citation_url = \"https://doi.org/10.5194/bg-7-1915-2010\"\n  chemsprops.SRDB = complete.vars(chemsprops.SRDB, sel = c(\"oc\", \"Soil_clay\", \"Soil_BD\"), coords = c(\"Longitude\", \"Latitude\"))\n}\ndim(chemsprops.SRDB)\n#> [1] 1596   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "soils-data-harmonization-database-sodah",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.10 SOils DAta Harmonization database (SoDaH)",
    "text": "Wieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: SOils DAta Harmonization database, open-source synthesis soil data research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195. Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4",
    "code": "\nif(!exists(\"chemsprops.SoDaH\")){\n  sodah.hor = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SoDaH/521_soils_data_harmonization_6e8416fa0c9a2c2872f21ba208e6a919.csv\")\n  #head(sodah.hor)\n  #summary(sodah.hor$coarse_frac)\n  #summary(sodah.hor$lyr_soc)\n  #summary(sodah.hor$lyr_som_WalkleyBlack/1.724)\n  #summary(as.factor(sodah.hor$observation_date))\n  sodah.hor$site_obsdate = as.integer(substr(sodah.hor$observation_date, 1, 4))\n  sodah.hor$oc = ifelse(is.na(sodah.hor$lyr_soc), sodah.hor$lyr_som_WalkleyBlack/1.724, sodah.hor$lyr_soc) * 10\n  sodah.hor$n_tot = sodah.hor$lyr_n_tot * 10\n  sodah.hor$oc_d = signif(sodah.hor$oc / 1000 * sodah.hor$bd_samp * 1000 * (100 - ifelse(is.na(sodah.hor$coarse_frac), 0, sodah.hor$coarse_frac))/100, 3)\n  sodah.hor$site_key = paste(sodah.hor$network, sodah.hor$location_name, sep=\"_\")\n  sodah.hor$labsampnum = make.unique(paste(sodah.hor$network, sodah.hor$location_name, sodah.hor$L1, sep=\"_\"))\n  #summary(sodah.hor$oc_d)\n  sodah.h.lst = c(\"site_key\", \"data_file\", \"observation_date\", \"long\", \"lat\", \"labsampnum\", \"layer_sequence\", \"layer_top\", \"layer_bot\", \"hzn\", \"profile_texture_class\", \"clay\", \"silt\", \"sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"coarse_frac\", \"bd_samp\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  x.na = sodah.h.lst[which(!sodah.h.lst %in% names(sodah.hor))]\n  if(length(x.na)>0){ for(i in x.na){ sodah.hor[,i] = NA } }\n  chemsprops.SoDaH = sodah.hor[,sodah.h.lst]\n  #plot(chemsprops.SoDaH[,4:5])\n  chemsprops.SoDaH$source_db = \"SoDaH\"\n  chemsprops.SoDaH$confidence_degree = 3\n  chemsprops.SoDaH$project_url = \"https://lter.github.io/som-website\"\n  chemsprops.SoDaH$citation_url = \"https://doi.org/10.5194/essd-2020-195\"\n  chemsprops.SoDaH = complete.vars(chemsprops.SoDaH, sel = c(\"oc\", \"clay\", \"ph_h2o\"), coords = c(\"long\", \"lat\"))\n}\ndim(chemsprops.SoDaH)\n#> [1] 20383    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "isric-wise-harmonized-soil-profile-data",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.11 ISRIC WISE harmonized soil profile data",
    "text": "Batjes, N.H. (2019). Harmonized soil profile data applications global continental scales: updates WISE database. Soil Use Management 5:124–127. Data download URL: https://files.isric.org/public/wise/WD-WISE.zip",
    "code": "\nif(!exists(\"chemsprops.WISE\")){\n  wise.site <- read.table(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_SITE.csv\", sep=\",\", header=TRUE, stringsAsFactors = FALSE, fill=TRUE)\n  wise.s.lst <- c(\"WISE3_id\", \"PITREF\", \"DATEYR\", \"LONDD\", \"LATDD\")\n  wise.site$LONDD = as.numeric(wise.site$LONDD)\n  wise.site$LATDD = as.numeric(wise.site$LATDD)\n  wise.layer <- read.table(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_HORIZON.csv\", sep=\",\", header=TRUE, stringsAsFactors = FALSE, fill=TRUE)\n  wise.layer$ca_ext = signif(wise.layer$EXCA * 200, 4)\n  wise.layer$mg_ext = signif(wise.layer$EXMG * 121, 3)\n  wise.layer$na_ext = signif(wise.layer$EXNA * 230, 3)\n  wise.layer$k_ext = signif(wise.layer$EXK * 391, 3)\n  wise.layer$oc_d = signif(wise.layer$ORGC / 1000 * wise.layer$BULKDENS * 1000 * (100 - ifelse(is.na(wise.layer$GRAVEL), 0, wise.layer$GRAVEL))/100, 3)\n  wise.h.lst <- c(\"WISE3_ID\", \"labsampnum\", \"HONU\", \"TOPDEP\", \"BOTDEP\", \"DESIG\", \"tex_psda\", \"CLAY\", \"SILT\", \"SAND\", \"ORGC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKCL\", \"PHH2O\", \"PHCACL2\", \"CECSOIL\", \"cec_nh4\", \"ecec\", \"GRAVEL\" , \"BULKDENS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ECE\", \"ec_12pre\")\n  x.na = wise.h.lst[which(!wise.h.lst %in% names(wise.layer))]\n  if(length(x.na)>0){ for(i in x.na){ wise.layer[,i] = NA } }\n  chemsprops.WISE = merge(wise.site[,wise.s.lst], wise.layer[,wise.h.lst], by.x=\"WISE3_id\", by.y=\"WISE3_ID\")\n  chemsprops.WISE$source_db = \"ISRIC_WISE\"\n  chemsprops.WISE$confidence_degree = 4\n  chemsprops.WISE$project_url = \"https://isric.org\"\n  chemsprops.WISE$citation_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"\n  chemsprops.WISE = complete.vars(chemsprops.WISE, sel = c(\"ORGC\",\"CLAY\",\"PHH2O\",\"CECSOIL\",\"k_ext\"), coords = c(\"LONDD\", \"LATDD\"))\n}\ndim(chemsprops.WISE)\n#> [1] 23278    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "gemas",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.12 GEMAS",
    "text": "Reimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, ., Négrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background threshold 53 chemical elements European agricultural soil. Applied Geochemistry, 88, 302-318. Data download URL: http://gemas.geolba.ac./",
    "code": "\nif(!exists(\"chemsprops.GEMAS\")){\n  gemas.samples <- read.csv(\"/mnt/diskstation/data/Soil_points/EU/GEMAS/GEMAS.csv\", stringsAsFactors = FALSE)\n  ## GEMAS, agricultural soil, 0-20 cm, air dried, <2 mm, aqua regia Data from ACME, total C, TOC, CEC, ph_CaCl2\n  gemas.samples$hzn_top = 0\n  gemas.samples$hzn_bot = 20\n  gemas.samples$oc = gemas.samples$TOC * 10\n  #summary(gemas.samples$oc)\n  gemas.samples$c_tot = gemas.samples$C_tot * 10\n  gemas.samples$site_obsdate = 2009\n  gemas.h.lst <- c(\"ID\", \"COUNRTY\", \"site_obsdate\", \"XCOO\", \"YCOO\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"TYPE\", \"tex_psda\", \"clay\", \"silt\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = gemas.h.lst[which(!gemas.h.lst %in% names(gemas.samples))]\n  if(length(x.na)>0){ for(i in x.na){ gemas.samples[,i] = NA } }\n  chemsprops.GEMAS <- gemas.samples[,gemas.h.lst]\n  chemsprops.GEMAS$source_db = \"GEMAS_2009\"\n  chemsprops.GEMAS$confidence_degree = 2\n  chemsprops.GEMAS$project_url = \"http://gemas.geolba.ac.at/\"\n  chemsprops.GEMAS$citation_url = \"https://doi.org/10.1016/j.apgeochem.2017.01.021\"\n  chemsprops.GEMAS = complete.vars(chemsprops.GEMAS, sel = c(\"oc\",\"clay\",\"pH_CaCl2\"), coords = c(\"XCOO\", \"YCOO\"))\n}\ndim(chemsprops.GEMAS)\n#> [1] 4131   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "lucas-soil",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.13 LUCAS soil",
    "text": "Orgiazzi, ., Ballabio, C., Panagos, P., Jones, ., & Fernández‐Ugalde, O. (2018). LUCAS Soil, largest expandable soil dataset Europe: review. European Journal Soil Science, 69(1), 140-153. Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data",
    "code": "\nif(!exists(\"chemsprops.LUCAS\")){\n  lucas.samples <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_TOPSOIL_v1.xlsx\", sheet = 1)\n  lucas.samples$site_obsdate <- \"2009\"\n  #summary(lucas.samples$N)\n  lucas.ro <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Romania.xlsx\", sheet = 1)\n  lucas.ro$site_obsdate <- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.ro))]\n  lucas.ro = plyr::rename(lucas.ro, replace=c(\"Soil.ID\"=\"sample_ID\", \"GPS_X_LONG\"=\"GPS_LONG\", \"GPS_Y_LAT\"=\"GPS_LAT\", \"pHinH2O\"=\"pH_in_H2O\", \"pHinCaCl2\"=\"pH_in_CaCl\"))\n  lucas.bu <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Bulgaria.xlsx\", sheet = 1)\n  lucas.bu$site_obsdate <- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.bu))]\n  #lucas.ch <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_2015_Topsoil_data_of_Switzerland-with-coordinates.xlsx_.xlsx\", sheet = 1, startRow = 2)\n  #lucas.ch = plyr::rename(lucas.ch, replace=c(\"Soil_ID\"=\"sample_ID\", \"GPS_.LAT\"=\"GPS_LAT\", \"pH.in.H2O\"=\"pH_in_H2O\", \"pH.in.CaCl2\"=\"pH_in_CaCl\", \"Calcium.carbonate/.g.kg–1\"=\"CaCO3\", \"Silt/.g.kg–1\"=\"silt\", \"Sand/.g.kg–1\"=\"sand\", \"Clay/.g.kg–1\"=\"clay\", \"Organic.carbon/.g.kg–1\"=\"OC\"))\n  ## Double readings?\n  lucas.t = plyr::rbind.fill(list(lucas.samples, lucas.ro, lucas.bu))\n  lucas.h.lst <- c(\"POINT_ID\", \"usiteid\", \"site_obsdate\", \"GPS_LONG\", \"GPS_LAT\", \"sample_ID\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"clay\", \"silt\", \"sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_in_H2O\", \"pH_in_CaCl\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas.h.lst[which(!lucas.h.lst %in% names(lucas.t))]\n  if(length(x.na)>0){ for(i in x.na){ lucas.t[,i] = NA } }\n  chemsprops.LUCAS <- lucas.t[,lucas.h.lst]\n  chemsprops.LUCAS$source_db = \"LUCAS_2009\"\n  chemsprops.LUCAS$hzn_top <- 0\n  chemsprops.LUCAS$hzn_bot <- 20\n  chemsprops.LUCAS$confidence_degree = 2\n  chemsprops.LUCAS$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS = complete.vars(chemsprops.LUCAS, sel = c(\"OC\",\"clay\",\"pH_in_H2O\"), coords = c(\"GPS_LONG\", \"GPS_LAT\"))\n}\ndim(chemsprops.LUCAS)\n#> [1] 21272    36\nif(!exists(\"chemsprops.LUCAS2\")){\n  #lucas2015.samples <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.xlsx\", sheet = 1)\n  lucas2015.xy = readOGR(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.shp\")\n  #head(as.data.frame(lucas2015.xy))\n  lucas2015.xy = as.data.frame(lucas2015.xy)\n  ## https://www.aqion.de/site/130\n  ## 1 mS/m = 100 mS/cm | 1 dS/m = 1 mS/cm = 1 mS/m / 100\n  lucas2015.xy$ec_satp = lucas2015.xy$EC / 100\n  lucas2015.h.lst <- c(\"Point_ID\", \"LC0_Desc\", \"site_obsdate\", \"coords.x1\", \"coords.x2\", \"sample_ID\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_H20\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas2015.h.lst[which(!lucas2015.h.lst %in% names(lucas2015.xy))]\n  if(length(x.na)>0){ for(i in x.na){ lucas2015.xy[,i] = NA } }\n  chemsprops.LUCAS2 <- lucas2015.xy[,lucas2015.h.lst]\n  chemsprops.LUCAS2$source_db = \"LUCAS_2015\"\n  chemsprops.LUCAS2$hzn_top <- 0\n  chemsprops.LUCAS2$hzn_bot <- 20\n  chemsprops.LUCAS2$site_obsdate <- \"2015\"\n  chemsprops.LUCAS2$confidence_degree = 2\n  chemsprops.LUCAS2$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS2$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS2 = complete.vars(chemsprops.LUCAS2, sel = c(\"OC\",\"Clay\",\"pH_H20\"), coords = c(\"coords.x1\", \"coords.x2\"))\n}\ndim(chemsprops.LUCAS2)\n#> [1] 21859    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "mangrove-forest-soil-db",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.14 Mangrove forest soil DB",
    "text": "Sanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). global map mangrove forest soil carbon 30 m spatial resolution. Environmental Research Letters, 13(5), 055002. Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT",
    "code": "\nif(!exists(\"chemsprops.Mangroves\")){\n  mng.profs <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_sites.csv\", skip=1)\n  mng.hors <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_horizons.csv\", skip=1)\n  mngALL = plyr::join(mng.hors, mng.profs, by=c(\"Site.name\"))\n  mngALL$oc = mngALL$OC_final * 10\n  mngALL$oc_d = mngALL$CD_calc * 1000\n  mngALL$hzn_top = mngALL$U_depth * 100\n  mngALL$hzn_bot = mngALL$L_depth * 100\n  mngALL$wpg2 = 0\n  #summary(mngALL$BD_reported) ## some very high values 3.26 t/m3\n  mngALL$Year = ifelse(is.na(mngALL$Year_sampled), mngALL$Years_collected, mngALL$Year_sampled)\n  mng.col = c(\"Site.name\", \"Site..\", \"Year\", \"Longitude_Adjusted\", \"Latitude_Adjusted\", \"labsampnum\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD_reported\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")  \n  x.na = mng.col[which(!mng.col %in% names(mngALL))]\n  if(length(x.na)>0){ for(i in x.na){ mngALL[,i] = NA } }\n  chemsprops.Mangroves = mngALL[,mng.col]\n  chemsprops.Mangroves$source_db = \"MangrovesDB\"\n  chemsprops.Mangroves$confidence_degree = 4\n  chemsprops.Mangroves$project_url = \"http://maps.oceanwealth.org/mangrove-restoration/\"\n  chemsprops.Mangroves$citation_url = \"https://doi.org/10.1088/1748-9326/aabe1c\"\n  chemsprops.Mangroves = complete.vars(chemsprops.Mangroves, sel = c(\"oc\",\"BD_reported\"), coords = c(\"Longitude_Adjusted\", \"Latitude_Adjusted\"))\n  #head(chemsprops.Mangroves)\n  #levels(as.factor(mngALL$OK.to.release.))\n  mng.rm = chemsprops.Mangroves$Site.name[chemsprops.Mangroves$Site.name %in% mngALL$Site.name[grep(\"N\", mngALL$OK.to.release., ignore.case = FALSE)]]\n}\ndim(chemsprops.Mangroves)\n#> [1] 7734   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "cifor-peatland-points",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.15 CIFOR peatland points",
    "text": "Peatland soil measurements (points) literature described :Murdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals peat tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452",
    "code": "\nif(!exists(\"chemsprops.Peatlands\")){\n  cif.hors <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR.csv\")\n  #summary(cif.hors$BD..g.cm..)\n  #summary(cif.hors$SOC)\n  cif.hors$oc = cif.hors$SOC * 10\n  cif.hors$wpg2 = 0\n  cif.hors$c_tot = cif.hors$TOC.content.... * 10\n  cif.hors$oc_d = cif.hors$C.density..kg.C.m..\n  cif.hors$site_obsdate = as.integer(substr(cif.hors$year, 1, 4))-1\n  cif.col = c(\"SOURCEID\", \"usiteid\", \"site_obsdate\", \"modelling.x\", \"modelling.y\", \"labsampnum\", \"layer_sequence\", \"Upper\", \"Lower\", \"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD..g.cm..\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cif.col[which(!cif.col %in% names(cif.hors))]\n  if(length(x.na)>0){ for(i in x.na){ cif.hors[,i] = NA } }\n  chemsprops.Peatlands = cif.hors[,cif.col]\n  chemsprops.Peatlands$source_db = \"CIFOR\"\n  chemsprops.Peatlands$confidence_degree = 4\n  chemsprops.Peatlands$project_url = \"https://www.cifor.org/\"\n  chemsprops.Peatlands$citation_url = \"https://doi.org/10.17528/cifor/006452\"\n  chemsprops.Peatlands = complete.vars(chemsprops.Peatlands, sel = c(\"oc\",\"BD..g.cm..\"), coords = c(\"modelling.x\", \"modelling.y\"))  \n}\ndim(chemsprops.Peatlands)\n#> [1] 756  36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "landpks-observations-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.16 LandPKS observations",
    "text": "Herrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use Management Cloud Computing, Mobile Applications, Crowdsourcing. Journal Soil Water Conservation, 68(1), 5A-12A. Data download URL: http://portal.landpotential.org/#/landpksmap",
    "code": "\nif(!exists(\"chemsprops.LandPKS\")){\n  pks = read.csv(\"/mnt/diskstation/data/Soil_points/INT/LandPKS/Export_LandInfo_Data.csv\", stringsAsFactors = FALSE)\n  #str(pks)\n  pks.hor = data.frame(rock_fragments = c(pks$rock_fragments_layer_0_1cm,\n                                          pks$rock_fragments_layer_1_10cm,\n                                          pks$rock_fragments_layer_10_20cm,\n                                          pks$rock_fragments_layer_20_50cm,\n                                          pks$rock_fragments_layer_50_70cm,\n                                          pks$rock_fragments_layer_70_100cm,\n                                          pks$rock_fragments_layer_100_120cm), \n                       tex_field = c(pks$texture_layer_0_1cm, \n                                     pks$texture_layer_1_10cm, \n                                     pks$texture_layer_10_20cm, \n                                     pks$texture_layer_20_50cm, \n                                     pks$texture_layer_50_70cm, \n                                     pks$texture_layer_70_100cm, \n                                     pks$texture_layer_100_120cm))\n  pks.hor$hzn_top = c(rep(0, nrow(pks)), \n                      rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)))\n  pks.hor$hzn_bot = c(rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)), \n                      rep(120, nrow(pks)))\n  pks.hor$longitude_decimal_degrees = rep(pks$longitude, 7)\n  pks.hor$latitude_decimal_degrees = rep(pks$latitude, 7)\n  pks.hor$site_obsdate = rep(pks$modified_date, 7)\n  pks.hor$site_key = rep(pks$id, 7)\n  #summary(as.factor(pks.hor$tex_field))\n  tex.tr = data.frame(tex_field=c(\"CLAY\", \"CLAY LOAM\", \"LOAM\", \"LOAMY SAND\", \"SAND\", \"SANDY CLAY\", \"SANDY CLAY LOAM\", \"SANDY LOAM\", \"SILT LOAM\", \"SILTY CLAY\", \"SILTY CLAY LOAM\"), \n                      clay_tot_psa=c(62.4, 34.0, 19.0, 5.8, 3.3, 41.7, 27.0, 10.0, 13.1, 46.7, 34.0), \n                      silt_tot_psa=c(17.8, 34.0, 40.0, 12.0, 5.0, 6.7, 13.0, 25.0, 65.7, 46.7, 56.0), \n                      sand_tot_psa=c(19.8, 32.0, 41.0, 82.2, 91.7, 51.6, 60.0, 65.0, 21.2, 6.7, 10.0))\n  pks.hor$clay_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$clay_tot_psa\n  pks.hor$silt_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$silt_tot_psa\n  pks.hor$sand_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$sand_tot_psa\n  #summary(as.factor(pks.hor$rock_fragments))\n  pks.hor$wpg2 = ifelse(pks.hor$rock_fragments==\">60%\", 65, ifelse(pks.hor$rock_fragments==\"35-60%\", 47.5, ifelse(pks.hor$rock_fragments==\"15-35%\", 25, ifelse(pks.hor$rock_fragments==\"1-15%\" | pks.hor$rock_fragments==\"0-15%\", 7.5, ifelse(pks.hor$rock_fragments==\"0-1%\", 0.5, NA)))))\n  #head(pks.hor)\n  #plot(pks.hor[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  pks.col = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_field\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = pks.col[which(!pks.col %in% names(pks.hor))]\n  if(length(x.na)>0){ for(i in x.na){ pks.hor[,i] = NA } }\n  chemsprops.LandPKS = pks.hor[,pks.col]\n  chemsprops.LandPKS$source_db = \"LandPKS\"\n  chemsprops.LandPKS$confidence_degree = 8\n  chemsprops.LandPKS$project_url = \"http://portal.landpotential.org\"\n  chemsprops.LandPKS$citation_url = \"https://doi.org/10.2489/jswc.68.1.5A\"\n  chemsprops.LandPKS = complete.vars(chemsprops.LandPKS, sel = c(\"clay_tot_psa\",\"wpg2\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))\n}\ndim(chemsprops.LandPKS)\n#> [1] 41644    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "egrpr",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.17 EGRPR",
    "text": "Russian Federation: Unified State Register Soil Resources (EGRPR). Data download URL: http://egrpr.esoil.ru/content/1DB.html",
    "code": "\nif(!exists(\"chemsprops.EGRPR\")){\n  russ.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Russia/EGRPR/Russia_EGRPR_soil_pedons.csv\")\n  russ.HOR$SOURCEID = paste(russ.HOR$CardID, russ.HOR$SOIL_ID, sep=\"_\")\n  russ.HOR$wpg2 = russ.HOR$TEXTSTNS\n  russ.HOR$SNDPPT <- russ.HOR$TEXTSAF + russ.HOR$TEXSCM\n  russ.HOR$SLTPPT <- russ.HOR$TEXTSIC + russ.HOR$TEXTSIM + 0.8 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  russ.HOR$CLYPPT <- russ.HOR$TEXTCL + 0.2 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  ## Correct texture fractions:\n  sumTex <- rowSums(russ.HOR[,c(\"SLTPPT\",\"CLYPPT\",\"SNDPPT\")])\n  russ.HOR$SNDPPT <- russ.HOR$SNDPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$SLTPPT <- russ.HOR$SLTPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$oc <- rowMeans(data.frame(x1=russ.HOR$CORG * 10, x2=russ.HOR$ORGMAT/1.724 * 10), na.rm=TRUE)\n  russ.HOR$oc_d = signif(russ.HOR$oc / 1000 * russ.HOR$DVOL * 1000 * (100 - ifelse(is.na(russ.HOR$wpg2), 0, russ.HOR$wpg2))/100, 3)\n  russ.HOR$n_tot <- russ.HOR$NTOT * 10\n  russ.HOR$ca_ext = russ.HOR$EXCA * 200\n  russ.HOR$mg_ext = russ.HOR$EXMG * 121\n  russ.HOR$na_ext = russ.HOR$EXNA * 230\n  russ.HOR$k_ext = russ.HOR$EXK * 391\n  ## Sampling year not available but with high confidence <2000\n  russ.HOR$site_obsdate = \"1982\"\n  russ.sel.h <- c(\"SOURCEID\", \"SOIL_ID\", \"site_obsdate\", \"LONG\", \"LAT\", \"labsampnum\", \"HORNMB\", \"HORTOP\", \"HORBOT\", \"HISMMN\", \"tex_psda\", \"CLYPPT\", \"SLTPPT\", \"SNDPPT\", \"oc\", \"oc_d\", \"c_tot\", \"NTOT\", \"PHSLT\", \"PHH2O\", \"ph_cacl2\", \"CECST\", \"cec_nh4\", \"ecec\", \"wpg2\", \"DVOL\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = russ.sel.h[which(!russ.sel.h %in% names(russ.HOR))]\n  if(length(x.na)>0){ for(i in x.na){ russ.HOR[,i] = NA } }\n  chemsprops.EGRPR = russ.HOR[,russ.sel.h]\n  chemsprops.EGRPR$source_db = \"Russia_EGRPR\"\n  chemsprops.EGRPR$confidence_degree = 2\n  chemsprops.EGRPR$project_url = \"http://egrpr.esoil.ru/\"\n  chemsprops.EGRPR$citation_url = \"https://doi.org/10.19047/0136-1694-2016-86-115-123\"\n  chemsprops.EGRPR <- complete.vars(chemsprops.EGRPR, sel=c(\"oc\", \"CLYPPT\"), coords = c(\"LONG\", \"LAT\"))\n}\ndim(chemsprops.EGRPR)\n#> [1] 4437   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "canada-national-pedon-db",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.18 Canada National Pedon DB",
    "text": "Agriculture Agri-Food Canada National Pedon Database. Data download URL: https://open.canada.ca/data/en/",
    "code": "\nif(!exists(\"chemsprops.NPDB\")){\n  NPDB.nm = c(\"NPDB_V2_sum_source_info.csv\",\"NPDB_V2_sum_chemical.csv\", \"NPDB_V2_sum_horizons_raw.csv\", \"NPDB_V2_sum_physical.csv\")\n  NPDB.HOR = plyr::join_all(lapply(paste0(\"/mnt/diskstation/data/Soil_points/Canada/NPDB/\", NPDB.nm), read.csv), type = \"full\")\n  NPDB.HOR$HISMMN = paste0(NPDB.HOR$HZN_MAS, NPDB.HOR$HZN_SUF, NPDB.HOR$HZN_MOD)\n  NPDB.HOR$CARB_ORG[NPDB.HOR$CARB_ORG==9] <- NA\n  NPDB.HOR$N_TOTAL[NPDB.HOR$N_TOTAL==9] <- NA\n  NPDB.HOR$oc = NPDB.HOR$CARB_ORG * 10\n  NPDB.HOR$oc_d = signif(NPDB.HOR$oc / 1000 * NPDB.HOR$BULK_DEN * 1000 * (100 - ifelse(is.na(NPDB.HOR$VC_SAND), 0, NPDB.HOR$VC_SAND))/100, 3)\n  NPDB.HOR$ca_ext = NPDB.HOR$EXCH_CA * 200\n  NPDB.HOR$mg_ext = NPDB.HOR$EXCH_MG * 121\n  NPDB.HOR$na_ext = NPDB.HOR$EXCH_NA * 230\n  NPDB.HOR$k_ext = NPDB.HOR$EXCH_K * 391\n  npdb.sel.h = c(\"PEDON_ID\", \"usiteid\", \"CAL_YEAR\", \"DD_LONG\", \"DD_LAT\", \"labsampnum\", \"layer_sequence\", \"U_DEPTH\", \"L_DEPTH\", \"HISMMN\", \"tex_psda\", \"T_CLAY\", \"T_SILT\", \"T_SAND\", \"oc\", \"oc_d\", \"c_tot\", \"N_TOTAL\", \"ph_kcl\", \"PH_H2O\", \"PH_CACL2\", \"CEC\", \"cec_nh4\", \"ecec\", \"VC_SAND\", \"BULK_DEN\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = npdb.sel.h[which(!npdb.sel.h %in% names(NPDB.HOR))]\n  if(length(x.na)>0){ for(i in x.na){ NPDB.HOR[,i] = NA } }\n  chemsprops.NPDB = NPDB.HOR[,npdb.sel.h]\n  chemsprops.NPDB$source_db = \"Canada_NPDB\"\n  chemsprops.NPDB$confidence_degree = 2\n  chemsprops.NPDB$project_url = \"https://open.canada.ca/data/en/\"\n  chemsprops.NPDB$citation_url = \"https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\"\n  chemsprops.NPDB <- complete.vars(chemsprops.NPDB, sel=c(\"oc\", \"PH_H2O\", \"T_CLAY\"), coords = c(\"DD_LONG\", \"DD_LAT\"))\n}\ndim(chemsprops.NPDB)\n#> [1] 15946    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "canadian-upland-forest-soil-profile-and-carbon-stocks-database-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.19 Canadian upland forest soil profile and carbon stocks database",
    "text": "Shaw, C., Hilger, ., Filiatrault, M., & Kurz, W. (2018). Canadian upland forest soil profile carbon stocks database. Ecology, 99(4), 989-989. Data download URL: https://esajournals.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fecy.2159&file=ecy2159-sup-0001-DataS1.zip*Organic horizons negative values, first mineral soil horizon value 0 cm, mineral soil horizons positive values. needs corrected values can bind international sets.",
    "code": "\nif(!exists(\"chemsprops.CUFS\")){\n  ## Reading of the .dat file was tricky \n  cufs.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/PROFILES.csv\", stringsAsFactors = FALSE)\n  cufs.HOR$LOWER_HZN_LIMIT =cufs.HOR$UPPER_HZN_LIMIT + cufs.HOR$HZN_THICKNESS\n  ## Correct depth (Canadian data can have negative depths for soil horizons):\n  z.min.cufs <- ddply(cufs.HOR, .(LOCATION_ID), summarize, aggregated = min(UPPER_HZN_LIMIT, na.rm=TRUE))\n  z.shift.cufs <- join(cufs.HOR[\"LOCATION_ID\"], z.min.cufs, type=\"left\")$aggregated\n  ## fixed shift\n  z.shift.cufs <- ifelse(z.shift.cufs>0, 0, z.shift.cufs)\n  cufs.HOR$hzn_top <- cufs.HOR$UPPER_HZN_LIMIT - z.shift.cufs\n  cufs.HOR$hzn_bot <- cufs.HOR$LOWER_HZN_LIMIT - z.shift.cufs\n  cufs.SITE = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/SITES.csv\", stringsAsFactors = FALSE)\n  cufs.HOR$longitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LONGITUDE\n  cufs.HOR$latitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LATITUDE\n  cufs.HOR$site_obsdate = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$YEAR_SAMPLED\n  cufs.HOR$usiteid = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$RELEASE_SOURCE_SITEID\n  #summary(cufs.HOR$ORG_CARB_PCT)\n  #hist(cufs.HOR$ORG_CARB_PCT, breaks=45)\n  cufs.HOR$oc = cufs.HOR$ORG_CARB_PCT*10\n  #cufs.HOR$c_tot = cufs.HOR$oc + ifelse(is.na(cufs.HOR$CARBONATE_CARB_PCT), 0, cufs.HOR$CARBONATE_CARB_PCT*10)\n  cufs.HOR$n_tot = cufs.HOR$TOT_NITRO_PCT*10\n  cufs.HOR$ca_ext = cufs.HOR$EXCH_Ca * 200\n  cufs.HOR$mg_ext = cufs.HOR$EXCH_Mg * 121\n  cufs.HOR$na_ext = cufs.HOR$EXCH_Na * 230\n  cufs.HOR$k_ext = cufs.HOR$EXCH_K * 391\n  cufs.HOR$ph_cacl2 = cufs.HOR$pH\n  cufs.HOR$ph_cacl2[!cufs.HOR$pH_H2O_CACL2==\"CACL2\"] = NA\n  cufs.HOR$ph_h2o = cufs.HOR$pH\n  cufs.HOR$ph_h2o[!cufs.HOR$pH_H2O_CACL2==\"H2O\"] = NA\n  #summary(cufs.HOR$CF_VOL_PCT) ## is NA == 0??\n  cufs.HOR$wpg2 = ifelse(cufs.HOR$CF_CORR_FACTOR==1, 0, cufs.HOR$CF_VOL_PCT)\n  cufs.HOR$oc_d = signif(cufs.HOR$oc / 1000 * cufs.HOR$BULK_DENSITY * 1000 * (100 - ifelse(is.na(cufs.HOR$wpg2), 0, cufs.HOR$wpg2))/100, 3)\n  cufs.sel.h = c(\"LOCATION_ID\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"HZN_SEQ_NO\", \"hzn_top\", \"hzn_bot\", \"HORIZON\", \"TEXT_CLASS\", \"CLAY_PCT\", \"SILT_PCT\", \"SAND_PCT\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"CEC_CALCULATED\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK_DENSITY\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELEC_COND\", \"ec_12pre\")\n  x.na = cufs.sel.h[which(!cufs.sel.h %in% names(cufs.HOR))]\n  if(length(x.na)>0){ for(i in x.na){ cufs.HOR[,i] = NA } }\n  chemsprops.CUFS = cufs.HOR[,cufs.sel.h]\n  chemsprops.CUFS$source_db = \"Canada_CUFS\"\n  chemsprops.CUFS$confidence_degree = 1\n  chemsprops.CUFS$project_url = \"https://cfs.nrcan.gc.ca/publications/centre/nofc\"\n  chemsprops.CUFS$citation_url = \"https://doi.org/10.1002/ecy.2159\"\n  chemsprops.CUFS <- complete.vars(chemsprops.CUFS, sel=c(\"oc\", \"ph_h2o\", \"CLAY_PCT\"))\n}\ndim(chemsprops.CUFS)\n#> [1] 15162    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "permafrost-in-subarctic-canada-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.20 Permafrost in subarctic Canada",
    "text": "Estop-Aragones, C.; Fisher, J.P.; Cooper, M..; Thierry, .; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, .P. (2016). Bulk density, carbon nitrogen content soil profiles permafrost subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952. Data download URL:",
    "code": "\nif(!exists(\"chemsprops.CAPERM\")){\n  caperm.HOR = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Canada/NorthCanada/Bulk_density_CandNcontent_profiles_all_sites.csv\")\n  #measurements::conv_unit(\"-99 36 15.7\", from = \"deg_min_sec\", to = \"dec_deg\")\n  #caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", gsub('\\\"W', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_West, \"UTF-8\", \"UTF-8\", sub=' ')), fixed = TRUE)), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", caperm.HOR$Cordinates_West), from = \"deg_min_sec\", to = \"dec_deg\"))\n  #caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(gsub('\\\"N', '', gsub('o', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_North, \"UTF-8\", \"UTF-8\", sub=' '))), fixed = TRUE), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(caperm.HOR$Cordinates_North, from = \"deg_min_sec\", to = \"dec_deg\"))\n  #plot(caperm.HOR[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  caperm.HOR$site_obsdate = \"2013\"\n  caperm.HOR$site_key = make.unique(caperm.HOR$Soil.core)\n  #summary(as.factor(caperm.HOR$Soil_depth_cm))\n  caperm.HOR$hzn_top = caperm.HOR$Soil_depth_cm-1\n  caperm.HOR$hzn_bot = caperm.HOR$Soil_depth_cm+1\n  caperm.HOR$db_od = caperm.HOR$Bulk_density_gdrysoil_cm3wetsoil\n  caperm.HOR$oc = caperm.HOR$Ccontent_percentage_on_drymass * 10\n  caperm.HOR$n_tot = caperm.HOR$Ncontent_percentage_on_drymass * 10\n  caperm.HOR$oc_d = signif(caperm.HOR$oc / 1000 * caperm.HOR$db_od * 1000, 3)\n  x.na = col.names[which(!col.names %in% names(caperm.HOR))]\n  if(length(x.na)>0){ for(i in x.na){ caperm.HOR[,i] = NA } }\n  chemsprops.CAPERM = caperm.HOR[,col.names]\n  chemsprops.CAPERM$source_db = \"Canada_subarctic\"\n  chemsprops.CAPERM$confidence_degree = 2\n  chemsprops.CAPERM$project_url = \"http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/\"\n  chemsprops.CAPERM$citation_url = \"https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952\"\n  chemsprops.CAPERM <- complete.vars(chemsprops.CAPERM, sel=c(\"oc\", \"n_tot\"))\n}\ndim(chemsprops.CAPERM)\n#> [1] 1180   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "soter-china-soil-profiles",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.21 SOTER China soil profiles",
    "text": "Dijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil landform properties LADA partner countries. ISRIC report 2008/06 GLADA report 2008/03, ISRIC – World Soil Information FAO, Wageningen. Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip",
    "code": "\nif(!exists(\"chemsprops.CNSOTER\")){\n  sot.sites = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Profile.csv\")\n  sot.horizons = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Horizon.csv\")\n  sot.HOR = plyr::join_all(list(sot.sites, sot.horizons), type = \"full\")\n  sot.HOR$oc = sot.HOR$SOCA * 10\n  sot.HOR$ca_ext = sot.HOR$EXCA * 200\n  sot.HOR$mg_ext = sot.HOR$EXMG * 121\n  sot.HOR$na_ext = sot.HOR$EXNA * 230\n  sot.HOR$k_ext = sot.HOR$EXCK * 391\n  ## upper depth missing needs to be derived manually\n  sot.HOR$hzn_top = NA\n  sot.HOR$hzn_top[2:nrow(sot.HOR)] <- sot.HOR$HBDE[1:(nrow(sot.HOR)-1)]\n  sot.HOR$hzn_top <- ifelse(sot.HOR$hzn_top > sot.HOR$HBDE, 0, sot.HOR$hzn_top)\n  sot.HOR$hzn_top <- ifelse(sot.HOR$HONU==1 & is.na(sot.HOR$hzn_top), 0, sot.HOR$hzn_top)\n  sot.HOR$oc_d = signif(sot.HOR$oc / 1000 * sot.HOR$BULK * 1000 * (100 - ifelse(is.na(sot.HOR$SDVC), 0, sot.HOR$SDVC))/100, 3)\n  sot.sel.h = c(\"PRID\", \"PDID\", \"SAYR\", \"LNGI\", \"LATI\", \"labsampnum\", \"HONU\", \"hzn_top\",\"HBDE\",\"HODE\", \"PSCL\", \"CLPC\", \"STPC\", \"SDTO\", \"oc\", \"oc_d\", \"TOTC\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"SDVC\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = sot.sel.h[which(!sot.sel.h %in% names(sot.HOR))]\n  if(length(x.na)>0){ for(i in x.na){ sot.HOR[,i] = NA } }\n  chemsprops.CNSOT = sot.HOR[,sot.sel.h]\n  chemsprops.CNSOT$source_db = \"China_SOTER\"\n  chemsprops.CNSOT$confidence_degree = 8\n  chemsprops.CNSOT$project_url = \"https://www.isric.org/explore/soter\"\n  chemsprops.CNSOT$citation_url = \"https://isric.org/sites/default/files/isric_report_2008_06.pdf\"\n  chemsprops.CNSOT <- complete.vars(chemsprops.CNSOT, sel=c(\"TOTC\", \"PHAQ\", \"CLPC\"), coords = c(\"LNGI\", \"LATI\"))\n}\n#> Joining by: PRID, INFR\ndim(chemsprops.CNSOT)\n#> [1] 5105   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "sislac",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.22 SISLAC",
    "text": "Sistema de Información de Suelos de Latinoamérica (SISLAC), Data download URL: http://54.229.242.119/sislac/es",
    "code": "\nif(!exists(\"chemsprops.SISLAC\")){\n  sis.hor = read.csv(\"/mnt/diskstation/data/Soil_points/SA/SISLAC/sislac_profiles_es.csv\", stringsAsFactors = FALSE)\n  #str(sis.hor)\n  ## SOC for Urugvay do not match the original soil profile data (see e.g. http://www.mgap.gub.uy/sites/default/files/multimedia/skmbt_c45111090914030.pdf)\n  ## compare with:\n  #sis.hor[sis.hor$perfil_id==\"23861\",]\n  ## Subset to SISINTA/WOSIS points:\n  cor.sel = c(grep(\"WoSIS\", paste(sis.hor$perfil_numero)), grep(\"SISINTA\", paste(sis.hor$perfil_numero)))\n  #length(cor.sel)\n  sis.hor = sis.hor[cor.sel,]\n  #summary(sis.hor$analitico_carbono_organico_c)\n  sis.hor$oc = sis.hor$analitico_carbono_organico_c * 10\n  sis.hor$oc_d = signif(sis.hor$oc / 1000 * sis.hor$analitico_densidad_aparente * 1000 * (100 - ifelse(is.na(sis.hor$analitico_gravas), 0, sis.hor$analitico_gravas))/100, 3)\n  #summary(sis.hor$analitico_base_k)\n  #summary(as.factor(sis.hor$perfil_fecha))\n  sis.sel.h = c(\"perfil_id\", \"perfil_numero\", \"perfil_fecha\", \"perfil_ubicacion_longitud\", \"perfil_ubicacion_latitud\", \"id\", \"layer_sequence\", \"profundidad_superior\", \"profundidad_inferior\", \"hzn_desgn\", \"tex_psda\", \"analitico_arcilla\", \"analitico_limo_2_50\", \"analitico_arena_total\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"analitico_ph_kcl\", \"analitico_ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"analitico_gravas\", \"analitico_densidad_aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"analitico_conductividad\", \"ec_12pre\")\n  x.na = sis.sel.h[which(!sis.sel.h %in% names(sis.hor))]\n  if(length(x.na)>0){ for(i in x.na){ sis.hor[,i] = NA } }\n  chemsprops.SISLAC = sis.hor[,sis.sel.h]\n  chemsprops.SISLAC$source_db = \"SISLAC\"\n  chemsprops.SISLAC$confidence_degree = 4\n  chemsprops.SISLAC$project_url = \"http://54.229.242.119/sislac/es\"\n  chemsprops.SISLAC$citation_url = \"https://hdl.handle.net/10568/49611\"\n  chemsprops.SISLAC <- complete.vars(chemsprops.SISLAC, sel=c(\"oc\",\"analitico_ph_kcl\",\"analitico_arcilla\"), coords = c(\"perfil_ubicacion_longitud\", \"perfil_ubicacion_latitud\"))\n}\ndim(chemsprops.SISLAC)\n#> [1] 49994    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "febr",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.23 FEBR",
    "text": "Samuel-Rosa, ., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data Brazil: geospatial data quality improve . Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430Free Brazilian Repository Open Soil Data – febr. Data download URL: http://www.ufsm.br/febr/",
    "code": "\nif(!exists(\"chemsprops.FEBR\")){\n  #library(febr)\n  ## download up-to-date copy of data\n  #febr.lab = febr::layer(dataset = \"all\", variable=\"all\")\n  #febr.lab = febr::observation(dataset = \"all\")\n  febr.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Brasil/FEBR/febr-superconjunto.csv\", stringsAsFactors = FALSE, dec = \",\", sep = \";\")\n  #head(febr.hor)\n  #summary(febr.hor$carbono)\n  #summary(febr.hor$ph)\n  #summary(febr.hor$dsi) ## bulk density of total soil\n  febr.hor$clay_tot_psa = febr.hor$argila /10\n  febr.hor$sand_tot_psa = febr.hor$areia /10\n  febr.hor$silt_tot_psa = febr.hor$silte /10\n  febr.hor$wpg2 = (1000-febr.hor$terrafina)/10\n  febr.hor$oc_d = signif(febr.hor$carbono / 1000 * febr.hor$dsi * 1000 * (100 - ifelse(is.na(febr.hor$wpg2), 0, febr.hor$wpg2))/100, 3)\n  febr.sel.h <- c(\"observacao_id\", \"usiteid\", \"observacao_data\", \"coord_x\", \"coord_y\", \"sisb_id\", \"camada_id\", \"profund_sup\", \"profund_inf\", \"camada_nome\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"carbono\", \"oc_d\", \"c_tot\", \"nitrogenio\", \"ph_kcl\", \"ph\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"dsi\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ce\", \"ec_12pre\")\n  x.na = febr.sel.h[which(!febr.sel.h %in% names(febr.hor))]\n  if(length(x.na)>0){ for(i in x.na){ febr.hor[,i] = NA } }\n  chemsprops.FEBR = febr.hor[,febr.sel.h]\n  chemsprops.FEBR$source_db = \"FEBR\"\n  chemsprops.FEBR$confidence_degree = 4\n  chemsprops.FEBR$project_url = \"http://www.ufsm.br/febr/\"\n  chemsprops.FEBR$citation_url = \"https://doi.org/10.1590/1678-992x-2017-0430\"\n  chemsprops.FEBR <- complete.vars(chemsprops.FEBR, sel=c(\"carbono\",\"ph\",\"clay_tot_psa\",\"dsi\"), coords = c(\"coord_x\", \"coord_y\"))\n}\ndim(chemsprops.FEBR)\n#> [1] 7842   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "pronasolos",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.24 PRONASOLOS",
    "text": "POLIDORO, J., COELHO, M., CARVALHO FILHO, . D., LUMBRERAS, J., de OLIVEIRA, . P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).Download URL: http://geoinfo.cnps.embrapa.br/documents/3013/download",
    "code": "\nif(!exists(\"chemsprops.PRONASOLOS\")){\n  pronas.hor = as.data.frame(sf::read_sf(\"/mnt/diskstation/data/Soil_points/Brasil/Pronasolos/Perfis_PronaSolos_20201202v2.shp\"))\n  ## 34,464 rows\n  #head(pronas.hor)\n  #summary(as.numeric(pronas.hor$carbono_or))\n  #summary(as.numeric(pronas.hor$densidade_))\n  #summary(as.numeric(pronas.hor$argila))\n  #summary(as.numeric(pronas.hor$cascalho))\n  #summary(as.numeric(pronas.hor$ph_h2o))\n  #summary(as.numeric(pronas.hor$complexo_2))\n  ## A lot of errors / typos e.g. very high values and 0 values!!\n  #pronas.hor$data_colet[1:50]\n  pronas.in.name = c(\"sigla\", \"codigo_pon\", \"data_colet\", \"gcs_latitu\", \"gcs_longit\", \"simbolo_ho\", \"profundida\", \n                     \"profundi_1\", \"cascalho\", \"areia_tota\", \"silte\", \"argila\", \"densidade_\", \"ph_h2o\", \"ph_kcl\", \n                     \"complexo_s\", \"complexo_1\", \"complexo_2\", \"complexo_3\", \"valor_s\", \"carbono_or\", \"nitrogenio\",\n                     \"condutivid\", \"classe_tex\")\n  #pronas.in.name[which(!pronas.in.name %in% names(pronas.hor))]\n  pronas.x = as.data.frame(pronas.hor[,pronas.in.name])\n  pronas.out.name = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\",\n                      \"hzn_desgn\", \"hzn_bot\", \"hzn_top\", \"wpg2\", \"sand_tot_psa\", \"silt_tot_psa\", \n                      \"clay_tot_psa\", \"db_od\", \"ph_h2o\", \"ph_kcl\", \"ca_ext\",\n                      \"mg_ext\", \"k_ext\", \"na_ext\", \"cec_sum\", \"oc\", \"n_tot\", \"ec_satp\", \"tex_psda\")\n  ## translate values\n  pronas.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(pronas.in.name)))\n  pronas.fun.lst[[which(pronas.in.name==\"sigla\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"codigo_pon\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"data_colet\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"simbolo_ho\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"classe_tex\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_s\")]] = \"as.numeric(x)*200\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_1\")]] = \"as.numeric(x)*121\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_2\")]] = \"as.numeric(x)*391\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_3\")]] = \"as.numeric(x)*230\"\n  pronas.fun.lst[[which(pronas.in.name==\"areia_tota\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"silte\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"argila\")]] = \"round(as.numeric(x)/10, 1)\"\n  ## save translation rules:\n  write.csv(data.frame(pronas.in.name, pronas.out.name, unlist(pronas.fun.lst)), \"pronas_soilab_transvalues.csv\")\n  pronas.soil = transvalues(pronas.x, pronas.out.name, pronas.in.name, pronas.fun.lst)\n  pronas.soil$oc_d = signif(pronas.soil$oc / 1000 * pronas.soil$db_od * 1000 * (100 - ifelse(is.na(pronas.soil$wpg2), 0, pronas.soil$wpg2))/100, 3)\n  x.na = col.names[which(!col.names %in% names(pronas.soil))]\n  if(length(x.na)>0){ for(i in x.na){ pronas.soil[,i] = NA } }\n  chemsprops.PRONASOLOS = pronas.soil[,col.names]\n  chemsprops.PRONASOLOS$source_db = \"PRONASOLOS\"\n  chemsprops.PRONASOLOS$confidence_degree = 2\n  chemsprops.PRONASOLOS$project_url = \"https://geoportal.cprm.gov.br/pronasolos/\"\n  chemsprops.PRONASOLOS$citation_url = \"https://www.infoteca.cnptia.embrapa.br/infoteca/handle/doc/1135056\"\n  chemsprops.PRONASOLOS <- complete.vars(chemsprops.PRONASOLOS, sel=c(\"oc\",\"ph_h2o\",\"clay_tot_psa\"))\n}\ndim(chemsprops.PRONASOLOS)\n#> [1] 31747    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "soil-profile-db-for-costa-rica-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.25 Soil Profile DB for Costa Rica",
    "text": "Mata, R., Vázquez, ., Rosales, ., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociación Costarricense de la Ciencia del Suelo, San José, CRC. Escala, 1, 200000. Data download URL: http://www.cia.ucr.ac.cr/wp-content/recursosnaturales/Base%20perfiles%20de%20suelos%20v1.1.rarMata-Chinchilla, R., & Castro-Chinchilla, J. (2019). Geoportal de suelos de Costa Rica como Bien Público al servicio del país. Revista Tecnología En Marcha, 32(7), Pág. 51-56. https://doi.org/10.18845/tm.v32i7.4259",
    "code": "\nif(!exists(\"chemsprops.CostaRica\")){\n  cr.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Costa_Rica/Base_de_datos_version_1.2.3.csv\", stringsAsFactors = FALSE)\n  #plot(cr.hor[,c(\"X\",\"Y\")], pch=\"+\", asp=1)\n  cr.hor$usiteid = paste(cr.hor$Provincia, cr.hor$Cantón, cr.hor$Id, sep=\"_\")\n  #summary(cr.hor$Corg.)\n  cr.hor$oc = cr.hor$Corg. * 10\n  cr.hor$Densidad.Aparente = as.numeric(paste0(cr.hor$Densidad.Aparente))\n  #summary(cr.hor$K)\n  cr.hor$ca_ext = cr.hor$Ca * 200\n  cr.hor$mg_ext = cr.hor$Mg * 121\n  #cr.hor$na_ext = cr.hor$Na * 230\n  cr.hor$k_ext = cr.hor$K * 391\n  cr.hor$wpg2 = NA\n  cr.hor$oc_d = signif(cr.hor$oc / 1000 * cr.hor$Densidad.Aparente * 1000 * (100 - ifelse(is.na(cr.hor$wpg2), 0, cr.hor$wpg2))/100, 3)\n  cr.sel.h = c(\"Id\", \"usiteid\", \"Fecha\", \"X\", \"Y\", \"labsampnum\", \"horizonte\", \"prof_inicio\", \"prof_final\", \"id_hz\", \"Clase.Textural\", \"ARCILLA\", \"LIMO\", \"ARENA\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pHKCl\", \"pH_H2O\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Densidad.Aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cr.sel.h[which(!cr.sel.h %in% names(cr.hor))]\n  if(length(x.na)>0){ for(i in x.na){ cr.hor[,i] = NA } }\n  chemsprops.CostaRica = cr.hor[,cr.sel.h]\n  chemsprops.CostaRica$source_db = \"CostaRica\"\n  chemsprops.CostaRica$confidence_degree = 4\n  chemsprops.CostaRica$project_url = \"http://www.cia.ucr.ac.cr\"\n  chemsprops.CostaRica$citation_url = \"https://doi.org/10.18845/tm.v32i7.42\"\n  chemsprops.CostaRica <- complete.vars(chemsprops.CostaRica, sel=c(\"oc\",\"pH_H2O\",\"ARCILLA\",\"Densidad.Aparente\"), coords = c(\"X\", \"Y\"))\n}\ndim(chemsprops.CostaRica)\n#> [1] 2042   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "iran-soil-profile-db-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.26 Iran soil profile DB",
    "text": "Dewan, M. L., & Famouri, J. (1964). soils Iran. Food Agriculture Organization United Nations.Hengl, T., Toomanian, N., Reuter, H. ., & Malakouti, M. J. (2007). Methods interpolate soil categorical variables profile observations: Lessons Iran. Geoderma, 140(4), 417-427.Mohammad, H. B. (2000). Soil resources use potentiality map Iran. Soil Water Research Institute, Teheran, Iran.",
    "code": "\nif(!exists(\"chemsprops.IRANSPDB\")){\n  na.s = c(\"?\",\"\",\"?.\",\"??\", -2147483647, -1.00e+308, \"<NA>\")\n  iran.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbana.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:12]\n  names(iran.hor) = c(\"site_key\", \"hzn_desgn\", \"hzn_top\", \"hzn_bot\", \"ph_h2o\", \"ec_satp\", \"oc\", \"CACO\", \"PBS\", \"sand_tot_psa\", \"silt_tot_psa\", \"clay_tot_psa\")\n  iran.hor$hzn_top = ifelse(is.na(iran.hor$hzn_top) & iran.hor$hzn_desgn==\"A\", 0, iran.hor$hzn_top)\n  iran.hor2 = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbhor.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:8]\n  names(iran.hor2) = c(\"site_key\", \"layer_sequence\", \"DESI\", \"hzn_top\", \"hzn_bot\", \"M_colour\", \"tex_psda\", \"hzn_desgn\")\n  iran.site = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sgdb.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)\n  names(iran.site) = c(\"usiteid\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\", \"FAO\", \"Tax\", \"site_key\")\n  iran.db = plyr::join_all(list(iran.site, iran.hor, iran.hor2))\n  iran.db$oc = iran.db$oc * 10\n  #summary(iran.db$oc)\n  x.na = col.names[which(!col.names %in% names(iran.db))]\n  if(length(x.na)>0){ for(i in x.na){ iran.db[,i] = NA } }\n  chemsprops.IRANSPDB = iran.db[,col.names]\n  chemsprops.IRANSPDB$source_db = \"Iran_SPDB\"\n  chemsprops.IRANSPDB$confidence_degree = 4\n  chemsprops.IRANSPDB$project_url = \"\"\n  chemsprops.IRANSPDB$citation_url = \"https://doi.org/10.1016/j.geoderma.2007.04.022\"\n  chemsprops.IRANSPDB <- complete.vars(chemsprops.IRANSPDB, sel=c(\"oc\",\"ph_h2o\",\"clay_tot_psa\"))\n}\ndim(chemsprops.IRANSPDB)\n#> [1] 4759   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "northern-circumpolar-permafrost-soil-profiles",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.27 Northern circumpolar permafrost soil profiles",
    "text": "Hugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). new data set estimating organic carbon storage 3 m depth soils northern circumpolar permafrost region. Earth System Science Data (Online), 5(2). Data download URL: http://dx.doi.org/10.5879/ECDS/00000002",
    "code": "\nif(!exists(\"chemsprops.NCSCD\")){\n  ncscd.hors <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/NCSCD/Harden_etal_2012_Hugelius_etal_2013_cleaned_data.csv\", stringsAsFactors = FALSE)\n  ncscd.hors$oc = as.numeric(ncscd.hors$X.C)*10\n  #summary(ncscd.hors$oc)\n  #hist(ncscd.hors$Layer.thickness.cm, breaks = 45)\n  ncscd.hors$Layer.thickness.cm = ifelse(ncscd.hors$Layer.thickness.cm<0, NA, ncscd.hors$Layer.thickness.cm)\n  ncscd.hors$hzn_bot = ncscd.hors$Basal.Depth.cm + ncscd.hors$Layer.thickness.cm\n  ncscd.hors$db_od = as.numeric(ncscd.hors$bulk.density.g.cm.3)\n  ## Can we assume no coarse fragments?\n  ncscd.hors$wpg2 = 0\n  ncscd.hors$oc_d = signif(ncscd.hors$oc / 1000 * ncscd.hors$db_od * 1000 * (100 - ifelse(is.na(ncscd.hors$wpg2), 0, ncscd.hors$wpg2))/100, 3)\n  ## very high values >40 kg/m3\n  ncscd.hors$site_obsdate = format(as.Date(ncscd.hors$Sample.date, format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  #summary(ncscd.hors$db_od)\n  ncscd.col = c(\"Profile.ID\", \"citation\", \"site_obsdate\", \"Long\", \"Lat\", \"labsampnum\", \"layer_sequence\", \"Basal.Depth.cm\", \"hzn_bot\", \"Horizon.type\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ncscd.col[which(!ncscd.col %in% names(ncscd.hors))]\n  if(length(x.na)>0){ for(i in x.na){ ncscd.hors[,i] = NA } }\n  chemsprops.NCSCD = ncscd.hors[,ncscd.col]\n  chemsprops.NCSCD$source_db = \"NCSCD\"\n  chemsprops.NCSCD$confidence_degree = 10\n  chemsprops.NCSCD$project_url = \"https://bolin.su.se/data/ncscd/\"\n  chemsprops.NCSCD$citation_url = \"https://doi.org/10.5194/essd-5-393-2013\"\n  chemsprops.NCSCD = complete.vars(chemsprops.NCSCD, sel = c(\"oc\",\"db_od\"), coords = c(\"Long\", \"Lat\"))  \n}\ndim(chemsprops.NCSCD)\n#> [1] 7104   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "csiro-national-soil-site-database",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.28 CSIRO National Soil Site Database",
    "text": "CSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004. Data download URL: https://doi.org/10.25919/5eeb2a56eac12 (available upon request)Searle, R. (2014). Australian site data collation support GlobalSoilMap. GlobalSoilMap: Basis global spatial soil information system, 127.",
    "code": "\nif(!exists(\"chemsprops.NatSoil\")){\n  library(Hmisc) \n  cmdb <- mdb.get(\"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612.mdb\")\n  #str(cmdb$SITES)\n  au.obs = cmdb$OBSERVATIONS[,c(\"s.id\", \"o.location.notes\", \"o.date.desc\", \"o.latitude.GDA94\", \"o.longitude.GDA94\")]\n  au.obs = au.obs[!is.na(au.obs$o.longitude.GDA94),]\n  coordinates(au.obs) <- ~o.longitude.GDA94+o.latitude.GDA94\n  proj4string(au.obs) <- CRS(\"+proj=longlat +ellps=GRS80 +no_defs\")\n  au.xy <- data.frame(spTransform(au.obs, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  #plot(au.xy[,c(\"o.longitude.GDA94\", \"o.latitude.GDA94\")])\n  ## all variables in one column and need to be sorted based on the lab method\n  #summary(cmdb$LAB_METHODS$LABM.SHORT.NAME)\n  #write.csv(cmdb$LAB_METHODS, \"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612_lab_methods.csv\")\n  lab.tbl = list(\n          c(\"6_DC\", \"6A1\", \"6A1_UC\", \"6B1\", \"6B2\", \"6B2a\", \"6B2b\", \"6B3\", \"6B4\", \"6B4a\", \"6B4b\", \"6Z\"), # %\n          c(\"6B3a\"), # g/kg\n          c(\"6H4\", \"6H4_SCaRP\"), # %\n          c(\"7_C_B\", \"7_NR\", \"7A1\", \"7A2\", \"7A2a\", \"7A2b\", \"7A3\", \"7A4\", \"7A5\", \"7A6\", \"7A6a\", \"7A6b\", \"7A6b_MCLW\"),  # g/kg\n          c(\"4A1\", \"4_NR\", \"4A_C_2.5\", \"4A_C_1\", \"4G1\"),\n          c(\"4C_C_1\", \"4C1\", \"4C2\", \"23A\"),\n          c(\"4B_C_2.5\", \"4B1\", \"4B2\"),\n          c(\"P10_NR_C\", \"P10_HYD_C\", \"P10_PB_C\", \"P10_PB1_C\", \"P10_CF_C\", \"P10_I_C\"),\n          c(\"P10_NR_Z\", \"P10_HYD_Z\", \"P10_PB_Z\", \"P10_PB1_Z\", \"P10_CF_Z\", \"P10_I_Z\"),\n          c(\"P10_NR_S\", \"P10_HYD_S\", \"P10_PB_S\", \"P10_PB1_S\", \"P10_CF_S\", \"P10_I_S\"),\n          c(\"15C1modCEC\", \"15_HSK_CEC\", \"15J_CEC\"),\n          c(\"15I1\", \"15I2\", \"15I3\", \"15I4\", \"15D3_CEC\"),\n          c(\"15_BASES\", \"15_NR\", \"15J_H\", \"15J1\"),\n          c(\"2Z2_Grav\", \"P10_GRAV\"),\n          c(\"503.08a\", \"P3A_NR\", \"P3A1\", \"P3A1_C4\", \"P3A1_CLOD\", \"P3A1_e\"),\n          c(\"18F1_CA\"),\n          c(\"18F1_MG\"),\n          c(\"18F1_NA\"),\n          c(\"18F1_K\", \"18F2\", \"18A1mod\", \"18_NR\", \"18A1\", \"18A1_NR\", \"18B1\", \"18B2\"),\n          c(\"3_C_B\", \"3_NR\", \"3A_TSS\"),\n          c(\"3A_C_2.5\", \"3A1\")\n          )\n  names(lab.tbl) = c(\"oc\", \"ocP\", \"c_tot\", \"n_tot\", \"ph_h2o\", \"ph_kcl\", \"ph_cacl2\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  val.lst = lapply(1:length(lab.tbl), function(i){x <- cmdb$LAB_RESULTS[cmdb$LAB_RESULTS$labm.code %in% lab.tbl[[i]], c(\"agency.code\", \"proj.code\", \"s.id\", \"o.id\", \"h.no\", \"labr.value\")]; names(x)[6] <- names(lab.tbl)[i]; return(x) })\n  names(val.lst) = names(lab.tbl)\n  val.lst$oc$oc = val.lst$oc$oc * 10\n  names(val.lst$ocP)[6] = \"oc\"\n  val.lst$oc <- rbind(val.lst$oc, val.lst$ocP)\n  val.lst$ocP = NULL\n  #summary(val.lst$oc$oc)\n  #str(val.lst, max.level = 1)\n  for(i in 1:length(val.lst)){ val.lst[[i]]$h.id <- paste(val.lst[[i]]$agency.code, val.lst[[i]]$proj.code, val.lst[[i]]$s.id, val.lst[[i]]$o.id, val.lst[[i]]$h.no, sep=\"_\") }\n  au.hor <- plyr::join_all(lapply(val.lst, function(x){x[,6:7]}), match=\"first\")\n  #str(as.factor(au.hor$h.id))\n  cmdb$HORIZONS$h.id = paste(cmdb$HORIZONS$agency.code, cmdb$HORIZONS$proj.code, cmdb$HORIZONS$s.id, cmdb$HORIZONS$o.id, cmdb$HORIZONS$h.no, sep=\"_\")\n  cmdb$HORIZONS$hzn_desgn = paste(cmdb$HORIZONS$h.desig.master, cmdb$HORIZONS$h.desig.subdiv, cmdb$HORIZONS$h.desig.suffix, sep=\"\")\n  au.horT <- plyr::join_all(list(cmdb$HORIZONS[,c(\"h.id\",\"s.id\",\"h.no\",\"h.texture\",\"hzn_desgn\",\"h.upper.depth\",\"h.lower.depth\")], au.hor, au.xy))\n  au.horT$site_obsdate = format(as.Date(au.horT$o.date.desc, format=\"%d%m%Y\"), \"%Y-%m-%d\")\n  au.horT$sand_tot_psa = ifelse(is.na(au.horT$sand_tot_psa), 100-(au.horT$clay_tot_psa + au.horT$silt_tot_psa), au.horT$sand_tot_psa)\n  au.horT$hzn_top = au.horT$h.upper.depth*100\n  au.horT$hzn_bot = au.horT$h.lower.depth*100\n  au.horT$oc_d = signif(au.horT$oc / 1000 * au.horT$db_od * 1000 * (100 - ifelse(is.na(au.horT$wpg2), 0, au.horT$wpg2))/100, 3)\n  au.cols.n = c(\"s.id\", \"o.location.notes\", \"site_obsdate\", \"o.longitude.GDA94\", \"o.latitude.GDA94\", \"h.id\", \"h.no\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"h.texture\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = au.cols.n[which(!au.cols.n %in% names(au.horT))]\n  if(length(x.na)>0){ for(i in x.na){ au.horT[,i] = NA } }\n  chemsprops.NatSoil = au.horT[,au.cols.n]\n  chemsprops.NatSoil$source_db = \"CSIRO_NatSoil\"\n  chemsprops.NatSoil$confidence_degree = 4\n  chemsprops.NatSoil$project_url = \"https://www.csiro.au/en/Do-business/Services/Enviro/Soil-archive\"\n  chemsprops.NatSoil$citation_url = \"https://doi.org/10.25919/5eeb2a56eac12\"\n  chemsprops.NatSoil = complete.vars(chemsprops.NatSoil, sel = c(\"oc\",\"db_od\",\"clay_tot_psa\",\"ph_h2o\"), coords = c(\"o.longitude.GDA94\", \"o.latitude.GDA94\"))  \n}\ndim(chemsprops.NatSoil)\n#> [1] 70791    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "namsoter",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.29 NAMSOTER",
    "text": "Coetzee, M. E. (2001). NAMSOTER, SOTER database Namibia. Agroecological Zoning, 458.Coetzee, M. E. (2009). Chemical characterisation soils East Central Namibia (Doctoral dissertation, Stellenbosch: University Stellenbosch).",
    "code": "\nif(!exists(\"chemsprops.NAMSOTER\")){\n  nam.profs <- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_profiles.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  nam.hors <- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_horizons.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  #summary(nam.hors$TOTN)\n  #summary(nam.hors$TOTC)\n  nam.hors$hzn_top <- NA\n  nam.hors$hzn_top <- ifelse(nam.hors$HONU==1, 0, nam.hors$hzn_top)\n  h.lst <- lapply(1:7, function(x){which(nam.hors$HONU==x)})\n  for(i in 2:7){\n    sel <- match(nam.hors$PRID[h.lst[[i]]], nam.hors$PRID[h.lst[[i-1]]])\n    nam.hors$hzn_top[h.lst[[i]]] <- nam.hors$HBDE[h.lst[[i-1]]][sel]\n  }\n  nam.hors$HBDE <- ifelse(is.na(nam.hors$HBDE), nam.hors$hzn_top+50, nam.hors$HBDE)\n  #summary(nam.hors$HBDE)\n  namALL = plyr::join(nam.hors, nam.profs, by=c(\"PRID\"))\n  namALL$k_ext = namALL$EXCK * 391\n  namALL$ca_ext = namALL$EXCA * 200\n  namALL$mg_ext = namALL$EXMG * 121\n  namALL$na_ext = namALL$EXNA * 230\n  #summary(namALL$MINA)\n  namALL$BULK <- ifelse(namALL$BULK>2.4, NA, namALL$BULK)\n  namALL$wpg2 = ifelse(namALL$MINA==\"D\", 80, ifelse(namALL$MINA==\"A\", 60, ifelse(namALL$MINA==\"M\", 25, ifelse(namALL$MINA==\"C\", 10, ifelse(namALL$MINA==\"V\", 1, ifelse(namALL$MINA==\"F\", 2.5, ifelse(namALL$MINA==\"M/A\", 40, ifelse(namALL$MINA==\"C/M\", 15, 0))))))))\n  #hist(namALL$wpg2)\n  namALL$oc_d = signif(namALL$TOTC / 1000 * namALL$BULK * 1000 * (100 - ifelse(is.na(namALL$wpg2), 0, namALL$wpg2))/100, 3)\n  #summary(namALL$oc_d)\n  #summary(namALL$PHAQ) ## very high ph\n  namALL$site_obsdate = 2000\n  nam.col = c(\"PRID\", \"SLID\", \"site_obsdate\", \"LONG\", \"LATI\", \"labsampnum\", \"HONU\", \"hzn_top\", \"HBDE\", \"HODE\", \"PSCL\", \"CLPC\", \"STPC\", \"SDTO\", \"TOTC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELCO\", \"ec_12pre\")\n  x.na = nam.col[which(!nam.col %in% names(namALL))]\n  if(length(x.na)>0){ for(i in x.na){ namALL[,i] = NA } }\n  chemsprops.NAMSOTER = namALL[,nam.col]\n  chemsprops.NAMSOTER$source_db = \"NAMSOTER\"\n  chemsprops.NAMSOTER$confidence_degree = 2\n  chemsprops.NAMSOTER$project_url = \"\"\n  chemsprops.NAMSOTER$citation_url = \"https://edepot.wur.nl/485173\"\n  chemsprops.NAMSOTER = complete.vars(chemsprops.NAMSOTER, sel = c(\"TOTC\",\"CLPC\",\"PHAQ\"), coords = c(\"LONG\", \"LATI\"))  \n}\ndim(chemsprops.NAMSOTER)\n#> [1] 2953   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "worldwide-organic-soil-carbon-and-nitrogen-data-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.30 Worldwide organic soil carbon and nitrogen data",
    "text": "Zinke, P. J., Millemann, R. E., & Boden, T. . (1986). Worldwide organic soil carbon nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory. Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018Zinke, P. J., Millemann, R. E., & Boden, T. . (1986). Worldwide organic soil carbon nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory. Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018Note: poor spatial location accuracy .e. <10 km. Bulk density many points estimated measured. Sampling year literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. samples come natural vegetation (undisturbed) areas.Note: poor spatial location accuracy .e. <10 km. Bulk density many points estimated measured. Sampling year literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. samples come natural vegetation (undisturbed) areas.",
    "code": "\nif(!exists(\"chemsprops.ISCND\")){\n  ndp.profs <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISCND/ndp018.csv\", na.strings = c(\"-9999\", \"?\", \"NA\"), stringsAsFactors = FALSE)\n  names(ndp.profs) = c(\"PROFILE\", \"CODE\", \"CARBON\", \"NITROGEN\", \"LAT\", \"LONG\", \"ELEV\", \"SOURCE\", \"HOLDRIGE\", \"OLSON\", \"PARENT\")\n  for(j in c(\"CARBON\",\"NITROGEN\",\"ELEV\")){  ndp.profs[,j] <- as.numeric(ndp.profs[,j])   }\n  #summary(ndp.profs$CARBON)\n  lat.s  <- grep(\"S\", ndp.profs$LAT) # lat.n <- grep(\"N\", ndp.profs$LAT)\n  ndp.profs$latitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LAT))\n  ndp.profs$latitude_decimal_degrees[lat.s] = ndp.profs$latitude_decimal_degrees[lat.s] * -1\n  lon.w <- grep(\"W\", ndp.profs$LONG) # lon.e  <- grep(\"E\", ndp.profs$LONG, fixed = TRUE)\n  ndp.profs$longitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LONG))\n  ndp.profs$longitude_decimal_degrees[lon.w] = ndp.profs$longitude_decimal_degrees[lon.w] * -1\n  #plot(ndp.profs[,c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\")])\n  ndp.profs$hzn_top = 0; ndp.profs$hzn_bot = 100\n  ## Sampling years from the doc: 1965, 1974, 1976, 1978, 1979, 1984 \n  ndp.profs$site_obsdate = \"1982\"\n  ndp.col = c(\"PROFILE\", \"CODE\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"CARBON\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ndp.col[which(!ndp.col %in% names(ndp.profs))]\n  if(length(x.na)>0){ for(i in x.na){ ndp.profs[,i] = NA } }\n  chemsprops.ISCND = ndp.profs[,ndp.col]\n  chemsprops.ISCND$source_db = \"ISCND\"\n  chemsprops.ISCND$confidence_degree = 8\n  chemsprops.ISCND$project_url = \"https://iscn.fluxdata.org/data/\"\n  chemsprops.ISCND$citation_url = \"https://dx.doi.org/10.3334/CDIAC/lue.ndp018\"\n  chemsprops.ISCND = complete.vars(chemsprops.ISCND, sel = c(\"CARBON\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))  \n}\ndim(chemsprops.ISCND)\n#> [1] 3977   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "interior-alaska-carbon-and-nitrogen-stocks",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.31 Interior Alaska Carbon and Nitrogen stocks",
    "text": "Manies, K., Waldrop, M., Harden, J. (2020): Generalized models estimate carbon nitrogen stocks organic soil horizons Interior Alaska, Earth Syst. Sci. Data, 12, 1745–1757, https://doi.org/10.5194/essd-12-1745-2020, Data download URL: https://doi.org/10.5066/P960N1F9",
    "code": "\nif(!exists(\"chemsprops.Alaska\")){\n  al.gps <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Site_GPS_coordinates_v1-1.csv\", stringsAsFactors = FALSE)\n  ## Different datums!\n  #summary(as.factor(al.gps$Datum))\n  al.gps1 = al.gps[al.gps$Datum==\"NAD83\",]\n  coordinates(al.gps1) = ~ Longitude + Latitude\n  proj4string(al.gps1) = \"+proj=longlat +datum=NAD83\"\n  al.gps0 = spTransform(al.gps1, CRS(\"+proj=longlat +datum=WGS84\"))\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Longitude\"] = al.gps0@coords[,1]\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Latitude\"] = al.gps0@coords[,2]\n  al.gps$site = al.gps$Site\n  al.hor <- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Generalized_models_for_CandN_Alaska_v1-1.csv\", stringsAsFactors = FALSE)\n  al.hor$hzn_top = al.hor$depth - as.numeric(al.hor$thickness)\n  al.hor$site_obsdate = format(as.Date(al.hor$date, format = \"%m/%d/%Y\"), \"%Y-%m-%d\")\n  al.hor$oc = as.numeric(al.hor$carbon) * 10\n  al.hor$n_tot = as.numeric(al.hor$nitrogen) * 10\n  al.hor$oc_d = as.numeric(al.hor$Cdensity) * 1000\n  #summary(al.hor$oc_d)\n  al.horA = plyr::join(al.hor, al.gps, by=c(\"site\"))\n  al.col = c(\"profile\", \"description\", \"site_obsdate\", \"Longitude\", \"Latitude\", \"sampleID\", \"layer_sequence\", \"hzn_top\", \"depth\", \"Hcode\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BDfine\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = al.col[which(!al.col %in% names(al.horA))]\n  if(length(x.na)>0){ for(i in x.na){ al.horA[,i] = NA } }\n  chemsprops.Alaska = al.horA[,al.col]\n  chemsprops.Alaska$source_db = \"Alaska_interior\"\n  chemsprops.Alaska$confidence_degree = 1\n  chemsprops.Alaska$project_url = \"https://www.usgs.gov/centers/gmeg\"\n  chemsprops.Alaska$citation_url = \"https://doi.org/10.5194/essd-12-1745-2020\"\n  chemsprops.Alaska = complete.vars(chemsprops.Alaska, sel = c(\"oc\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))  \n}\ndim(chemsprops.Alaska)\n#> [1] 3882   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "croatian-soil-pedon-data-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.32 Croatian Soil Pedon data",
    "text": "Martinović J., (2000) “Tla u Hrvatskoj”, Monografija, Državna uprava za zaštitu prirode okoliša, str. 269, Zagreb. ISBN: 9536793059Bašić F., (2014) “Soils Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154",
    "code": "\nif(!exists(\"chemsprops.bpht\")){\n  bpht.site <- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_sites_1997.csv\", stringsAsFactors = FALSE)\n  bpht.hors <- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_1997.csv\", stringsAsFactors = FALSE)\n  ## filter typos\n  for(j in c(\"GOR\", \"DON\", \"MKP\", \"PH1\", \"PH2\", \"MSP\", \"MP\", \"MG\", \"HUM\", \"EXTN\", \"EXTP\", \"EXTK\", \"CAR\")){\n    bpht.hors[,j] = as.numeric(bpht.hors[,j])\n  }\n  ## Convert to the USDA standard\n  bpht.hors$sand_tot_psa <- bpht.hors$MSP * 0.8 + bpht.hors$MKP\n  bpht.hors$silt_tot_psa <- bpht.hors$MP + bpht.hors$MSP * 0.2\n  bpht.hors$oc <- signif(bpht.hors$HUM/1.724 * 10, 3)\n  ## summary(bpht.hors$sand_tot_psa)\n  bpht.s.lst <- c(\"site_key\", \"UZORAK\", \"Cro16.30_X\", \"Cro16.30_Y\", \"FITOC\", \"STIJENA\", \"HID_DREN\", \"DUBINA\")\n  bpht.hor = plyr::join(bpht.site[,bpht.s.lst], bpht.hors)\n  bpht.hor$wpg2 = bpht.hor$STIJENA\n  bpht.hor$DON <- ifelse(is.na(bpht.hor$DON), bpht.hor$GOR+50, bpht.hor$DON)\n  bpht.hor$depth <- bpht.hor$GOR + (bpht.hor$DON - bpht.hor$GOR)/2\n  bpht.hor = bpht.hor[!is.na(bpht.hor$depth),]\n  bpht.hor$wpg2[which(bpht.hor$GOR<30)] <- bpht.hor$wpg2[which(bpht.hor$GOR<30)]*.3\n  bpht.hor$sample_key = make.unique(paste(bpht.hor$PEDOL_ID, bpht.hor$OZN, sep=\"_\"))\n  bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"] <- bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"]/10\n  ## convert N, P, K\n  #summary(bpht.hor$EXTK) -- measurements units?\n  bpht.hor$p_ext = bpht.hor$EXTP * 4.364\n  bpht.hor$k_ext = bpht.hor$EXTK * 8.3013\n  bpht.hor = bpht.hor[!is.na(bpht.hor$`Cro16.30_X`),]\n  ## coordinates:\n  bpht.pnts = SpatialPointsDataFrame(bpht.hor[,c(\"Cro16.30_X\",\"Cro16.30_Y\")], bpht.hor[\"site_key\"], proj4string = CRS(\"+proj=tmerc +lat_0=0 +lon_0=16.5 +k=0.9999 +x_0=2500000 +y_0=0 +ellps=bessel +towgs84=550.499,164.116,475.142,5.80967,2.07902,-11.62386,0.99999445824 +units=m\"))\n  bpht.pnts.ll <- spTransform(bpht.pnts, CRS(\"+proj=longlat +datum=WGS84\"))\n  bpht.hor$longitude_decimal_degrees = bpht.pnts.ll@coords[,1]\n  bpht.hor$latitude_decimal_degrees = bpht.pnts.ll@coords[,2] \n  bpht.h.lst <- c('site_key', 'OZ_LIST_PROF', 'UZORAK', 'longitude_decimal_degrees', 'latitude_decimal_degrees', 'labsampnum', 'layer_sequence', 'GOR', 'DON', 'OZN', 'TT', 'MG', 'silt_tot_psa', 'sand_tot_psa', 'oc', 'oc_d', 'c_tot', 'EXTN', 'PH2', 'PH1', 'ph_cacl2', 'cec_sum', 'cec_nh4', 'ecec', 'wpg2', 'db_od', 'ca_ext', 'mg_ext', 'na_ext', 'k_ext', 'ec_satp', 'ec_12pre')\n  x.na = bpht.h.lst[which(!bpht.h.lst %in% names(bpht.hor))]\n  if(length(x.na)>0){ for(i in x.na){ bpht.hor[,i] = NA } }\n  chemsprops.bpht = bpht.hor[,bpht.h.lst]\n  chemsprops.bpht$source_db = \"Croatian_Soil_Pedon\"\n  chemsprops.bpht$confidence_degree = 1\n  chemsprops.bpht$project_url = \"http://www.haop.hr/\"\n  chemsprops.bpht$citation_url = \"https://books.google.nl/books?id=k_a2MgAACAAJ\"\n  chemsprops.bpht = complete.vars(chemsprops.bpht, sel = c(\"oc\",\"MG\",\"PH1\",\"k_ext\"))\n}\ndim(chemsprops.bpht)\n#> [1] 5746   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "remnant-native-soc-database",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.33 Remnant native SOC database",
    "text": "Sanderman, J., (2017) “Remnant native SOC database release.xlsx”, Soil carbon profile data paired land use comparisons, https://doi.org/10.7910/DVN/QQQM8V/8MSBNI, Harvard Dataverse, V1",
    "code": "\nif(!exists(\"chemsprops.RemnantSOC\")){\n  rem.hor <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 3)\n  rem.site <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 2)\n  rem.ref <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 4)\n  rem.site = plyr::join(rem.site, rem.ref[,c(\"Source.No.\",\"DOI\",\"Sample_year\")], by=c(\"Source.No.\"))\n  rem.site$Site = rem.site$Site.ID\n  rem.horA = plyr::join(rem.hor, rem.site, by=c(\"Site\"))\n  rem.horA$hzn_top = rem.horA$'U_depth.(m)'*100\n  rem.horA$hzn_bot = rem.horA$'L_depth.(m)'*100\n  rem.horA$db_od = ifelse(is.na(as.numeric(rem.horA$'measured.BD.(Mg/m3)')), as.numeric(rem.horA$'estimated.BD.(Mg/m3)'), as.numeric(rem.horA$'measured.BD.(Mg/m3)'))\n  rem.horA$oc_d = signif(rem.horA$'OC.(g/kg)' * rem.horA$db_od, 3)\n  #summary(rem.horA$oc_d)\n  rem.col = c(\"Source.No.\", \"Site\", \"Sample_year\", \"Longitude\", \"Latitude\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"OC.(g/kg)\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = rem.col[which(!rem.col %in% names(rem.horA))]\n  if(length(x.na)>0){ for(i in x.na){ rem.horA[,i] = NA } }\n  chemsprops.RemnantSOC = rem.horA[,rem.col]\n  chemsprops.RemnantSOC$source_db = \"WHRC_remnant_SOC\"\n  chemsprops.RemnantSOC$confidence_degree = 8\n  chemsprops.RemnantSOC$project_url = \"https://www.woodwellclimate.org/research-area/carbon/\"\n  chemsprops.RemnantSOC$citation_url = \"http://dx.doi.org/10.1073/pnas.1706103114\"\n  chemsprops.RemnantSOC = complete.vars(chemsprops.RemnantSOC, sel = c(\"OC.(g/kg)\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))  \n}\ndim(chemsprops.RemnantSOC)\n#> [1] 1604   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "soil-health-db",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.34 Soil Health DB",
    "text": "Jian, J., Du, X., & Stewart, R. D. (2020). database global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3. Data download URL: https://github.com/jinshijian/SoilHealthDBNote: information available column names (https://www.nature.com/articles/s41597-020-0356-3/tables/3) detailed explanation missing.",
    "code": "\nif(!exists(\"chemsprops.SoilHealthDB\")){\n  shdb.hor <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/SoilHealthDB/SoilHealthDB_V2.xlsx\", sheet = 1, na.strings = c(\"NA\", \"NotAvailable\", \"Not-available\"))\n  #summary(as.factor(shdb.hor$SamplingDepth))\n  shdb.hor$hzn_top = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][1] }))\n  shdb.hor$hzn_bot = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][2] }))\n  shdb.hor$hzn_top = ifelse(is.na(shdb.hor$hzn_top), 0, shdb.hor$hzn_top)\n  shdb.hor$hzn_bot = ifelse(is.na(shdb.hor$hzn_bot), 15, shdb.hor$hzn_bot)\n  shdb.hor$oc = as.numeric(shdb.hor$BackgroundSOC) * 10\n  shdb.hor$oc_d = signif(shdb.hor$oc * shdb.hor$SoilBD, 3)\n  for(j in c(\"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"SoilpH\")){   shdb.hor[,j]  <- as.numeric(shdb.hor[,j])   }\n  #summary(shdb.hor$oc_d)\n  shdb.col = c(\"StudyID\", \"ExperimentID\", \"SamplingYear\", \"Longitude\", \"Latitude\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"Texture\", \"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"SoilpH\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"SoilBD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = shdb.col[which(!shdb.col %in% names(shdb.hor))]\n  if(length(x.na)>0){ for(i in x.na){ shdb.hor[,i] = NA } }\n  chemsprops.SoilHealthDB = shdb.hor[,shdb.col]\n  chemsprops.SoilHealthDB$source_db = \"SoilHealthDB\"\n  chemsprops.SoilHealthDB$confidence_degree = 8\n  chemsprops.SoilHealthDB$project_url = \"https://github.com/jinshijian/SoilHealthDB\"\n  chemsprops.SoilHealthDB$citation_url = \"https://doi.org/10.1038/s41597-020-0356-3\"\n  chemsprops.SoilHealthDB = complete.vars(chemsprops.SoilHealthDB, sel = c(\"ClayPerc\", \"SoilpH\", \"oc\"), coords = c(\"Longitude\", \"Latitude\"))  \n}\ndim(chemsprops.SoilHealthDB)\n#> [1] 120  36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "global-harmonized-dataset-of-soc-change-under-perennial-crops",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.35 Global Harmonized Dataset of SOC change under perennial crops",
    "text": "Ledo, ., Hillier, J., Smith, P. et al. (2019) global, empirical, harmonised dataset soil organic carbon changes perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1. Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2Note: Many missing years PREVIOUS SOC SOIL CHARACTERISTICS.",
    "code": "\nif(!exists(\"chemsprops.SOCPDB\")){\n  library(\"readxl\")\n  socpdb <- readxl::read_excel(\"/mnt/diskstation/data/Soil_points/INT/SOCPDB/SOC_perennials_DATABASE.xls\", skip=1, sheet = 1)\n  #names(socpdb)\n  #summary(as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(is.na(as.numeric(socpdb$year_measure)), as.numeric(socpdb$yearPpub)-5, as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(socpdb$year_measure<1960, NA, socpdb$year_measure)\n  socpdb$depth_current = socpdb$soil_to_cm_current - socpdb$soil_from_cm_current\n  socpdb = socpdb[socpdb$depth_current>5,]\n  socpdb$SOC_g_kg_current = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)), as.numeric(socpdb$SOC_Mg_ha_current) / (socpdb$depth_current/100 * as.numeric(socpdb$bulk_density_Mg_m3_current) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_current))\n  socpdb$depth_previous = socpdb$soil_to_cm_previous - socpdb$soil_from_cm_previous\n  socpdb$SOC_g_kg_previous = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)), as.numeric(socpdb$SOC_Mg_ha_previous) / (socpdb$depth_previous/100 * as.numeric(socpdb$Bulkdensity_previous) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_previous))\n  hor.b = which(names(socpdb) %in% c(\"ID\", \"plotID\", \"Longitud\", \"Latitud\", \"year_measure\", \"years_since_luc\", \"USDA\", \"original_source\"))\n  socpdb1 = socpdb[,c(hor.b, grep(\"_current\", names(socpdb)))]\n  #summary(as.numeric(socpdb1$years_since_luc))\n  ## 10 yrs median\n  socpdb1$site_obsdate = socpdb1$year_measure\n  socpdb2 = socpdb[,c(hor.b, grep(\"_previous\", names(socpdb)))]\n  socpdb2$site_obsdate = socpdb2$year_measure - ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10, as.numeric(socpdb2$years_since_luc))\n  colnames(socpdb2) <- sub(\"_previous\", \"_current\", colnames(socpdb2))\n  nm.socpdb = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"hzn_top\", \"hzn_bot\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"ph_h2o\", \"db_od\")\n  sel.socdpb1 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"bulk_density_Mg_m3_current\")\n  sel.socdpb2 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"Bulkdensity_current\")   \n  socpdbALL = as.data.frame(dplyr::bind_rows(lapply(list(socpdb1[,sel.socdpb1], socpdb2[,sel.socdpb2]), function(i){ dplyr::mutate_all(setNames(i, nm.socpdb), as.character) })))\n  for(j in 1:ncol(socpdbALL)){ socpdbALL[,j] <- as.numeric(socpdbALL[,j]) }\n  #summary(socpdbALL$oc) ## mean = 15\n  #summary(socpdbALL$db_od)\n  #summary(socpdbALL$ph_h2o)\n  socpdbALL$oc_d = signif(socpdbALL$oc * socpdbALL$db_od, 3)\n  #summary(socpdbALL$oc_d)\n  x.na = col.names[which(!col.names %in% names(socpdbALL))]\n  if(length(x.na)>0){ for(i in x.na){ socpdbALL[,i] = NA } }\n  chemsprops.SOCPDB <- socpdbALL[,col.names]\n  chemsprops.SOCPDB$source_db = \"SOCPDB\"\n  chemsprops.SOCPDB$confidence_degree = 5\n  chemsprops.SOCPDB$project_url = \"https://africap.info/\"\n  chemsprops.SOCPDB$citation_url = \"https://doi.org/10.1038/s41597-019-0062-1\"\n  chemsprops.SOCPDB = complete.vars(chemsprops.SOCPDB, sel = c(\"oc\",\"ph_h2o\",\"clay_tot_psa\"))\n}\ndim(chemsprops.SOCPDB)\n#> [1] 1526   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "stocks-of-organic-carbon-in-german-agricultural-soils-bze_lw-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.36 Stocks of organic carbon in German agricultural soils (BZE_LW)",
    "text": "Poeplau, C., Jacobs, ., Don, ., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks organic carbon German agricultural soils—Key results first comprehensive inventory. Journal Plant Nutrition Soil Science, 183(6), 665-681. https://doi.org/10.1002/jpln.202000113. Data download URL: https://doi.org/10.3220/DATA20200203151139Note: protection data privacy, coordinate randomly generated within radius 4-km around planned sampling point. data hence probably suitable spatial analysis, predictive soil mapping.",
    "code": "\nif(!exists(\"chemsprops.BZE_LW\")){\n  site.de <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/SITE.xlsx\", sheet = 1)\n  site.de$site_obsdate = format(as.Date(paste0(\"01-\", site.de$Sampling_month, \"-\", site.de$Sampling_year), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.de.xy = site.de[,c(\"PointID\",\"xcoord\",\"ycoord\")]\n  ## 3104\n  coordinates(site.de.xy) <- ~xcoord+ycoord\n  proj4string(site.de.xy) <- CRS(\"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\")\n  site.de.ll <- data.frame(spTransform(site.de.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.de$longitude_decimal_degrees = site.de.ll[,2]\n  site.de$latitude_decimal_degrees = site.de.ll[,3]\n  hor.de <- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1)\n  #hor.de = plyr::join(openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1), openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/HORIZON_DATA.xlsx\", sheet = 1), by=\"PointID\")\n  ## 17,189 rows\n  horALL.de = plyr::join(hor.de, site.de, by=\"PointID\")\n  ## Sand content [Mass-%]; grain size 63-2000µm (DIN ISO 11277)\n  horALL.de$sand_tot_psa <- horALL.de$gS + horALL.de$mS + horALL.de$fS + 0.2 * horALL.de$gU\n  horALL.de$silt_tot_psa <- horALL.de$fU + horALL.de$mU + 0.8 * horALL.de$gU\n  ## Convert millisiemens/meter [mS/m] to microsiemens/centimeter [μS/cm, uS/cm]\n  horALL.de$ec_satp = horALL.de$EC_H2O / 10\n  hor.sel.de <- c(\"PointID\", \"Main.soil.type\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"layer_sequence\", \"Layer.upper.limit\", \"Layer.lower.limit\", \"hzn_desgn\", \"Soil.texture.class\", \"Clay\", \"silt_tot_psa\", \"sand_tot_psa\", \"TOC\", \"oc_d\", \"TC\", \"TN\", \"ph_kcl\", \"pH_H2O\", \"pH_CaCl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"Rock.fragment.fraction\", \"BD_FS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  #summary(horALL.de$TOC) ## mean = 12.3\n  #summary(horALL.de$BD_FS) ## mean = 1.41\n  #summary(horALL.de$pH_H2O)\n  horALL.de$oc_d = signif(horALL.de$TOC * horALL.de$BD_FS * (1-horALL.de$Rock.fragment.fraction/100), 3)\n  #summary(horALL.de$oc_d)\n  x.na = hor.sel.de[which(!hor.sel.de %in% names(horALL.de))]\n  if(length(x.na)>0){ for(i in x.na){ horALL.de[,i] = NA } }\n  chemsprops.BZE_LW <- horALL.de[,hor.sel.de]\n  chemsprops.BZE_LW$source_db = \"BZE_LW\"\n  chemsprops.BZE_LW$confidence_degree = 3\n  chemsprops.BZE_LW$project_url = \"https://www.thuenen.de/de/ak/\"\n  chemsprops.BZE_LW$citation_url = \"https://doi.org/10.1002/jpln.202000113\"\n  chemsprops.BZE_LW = complete.vars(chemsprops.BZE_LW, sel = c(\"TOC\", \"pH_H2O\", \"Clay\"))\n}\ndim(chemsprops.BZE_LW)\n#> [1] 17187    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "aardewerk-vlaanderen-2010-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.37 AARDEWERK-Vlaanderen-2010",
    "text": "Beckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. Data download URL: https://www.dov.vlaanderen./geonetwork/home/api/records/78e15dd4-8070-4220-afac-258ea040fb30Ottoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001",
    "code": "\nif(!exists(\"chemsprops.Vlaanderen2010\")){\n  site.vl <- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Profiel.csv\")\n  site.vl$site_obsdate = format(as.Date(sapply(site.vl$Profilering_Datum, function(i){strsplit(i, \" \")[[1]][1]}), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.vl.xy = site.vl[,c(\"ID\",\"Coordinaat_Lambert72_X\",\"Coordinaat_Lambert72_Y\")]\n  ## 7020\n  site.vl.xy = site.vl.xy[complete.cases(site.vl.xy),]\n  coordinates(site.vl.xy) <- ~Coordinaat_Lambert72_X+Coordinaat_Lambert72_Y\n  proj4string(site.vl.xy) <- CRS(\"+init=epsg:31300\")\n  site.vl.ll <- data.frame(spTransform(site.vl.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.vl$longitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$Coordinaat_Lambert72_X\n  site.vl$latitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$Coordinaat_Lambert72_Y\n  site.vl$Profiel_ID = site.vl$ID\n  hor.vl <- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Horizont.csv\")\n  ## 42,529 rows\n  horALL.vl = plyr::join(hor.vl, site.vl, by=\"Profiel_ID\")\n  horALL.vl$oc = horALL.vl$Humus*10 /1.724\n  summary(horALL.vl$oc) ## mean = 7.8\n  #summary(horALL.vl$pH_H2O)\n  horALL.vl$hzn_top <- rowSums(horALL.vl[,c(\"Diepte_grens_boven1\", \"Diepte_grens_boven2\")], na.rm=TRUE)/2\n  horALL.vl$hzn_bot <- rowSums(horALL.vl[,c(\"Diepte_grens_onder1\",\"Diepte_grens_onder2\")], na.rm=TRUE)/2\n  horALL.vl$sand_tot_psa <- horALL.vl$T50_100 + horALL.vl$T100_200 + horALL.vl$T200_500 + horALL.vl$T500_1000 + horALL.vl$T1000_2000\n  horALL.vl$silt_tot_psa <- horALL.vl$T2_10 + horALL.vl$T10_20 + horALL.vl$T20_50\n  horALL.vl$tex_psda = paste0(horALL.vl$HorizontTextuur_code1, horALL.vl$HorizontTextuur_code2)\n  ## some corrupt coordinates\n  horALL.vl <- horALL.vl[horALL.vl$latitude_decimal_degrees > 50.6,]\n  hor.sel.vl <- c(\"Profiel_ID\", \"Bodemgroep\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"labsampnum\", \"Hor_nr\", \"hzn_top\", \"hzn_bot\", \"Naam\", \"tex_psda\", \"T0_2\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pH_KCl\", \"pH_H2O\", \"ph_cacl2\", \"Sorptiecapaciteit_Totaal\", \"cec_nh4\", \"ecec\", \"Tgroter_dan_2000\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = hor.sel.vl[which(!hor.sel.vl %in% names(horALL.vl))]\n  if(length(x.na)>0){ for(i in x.na){ horALL.vl[,i] = NA } }\n  chemsprops.Vlaanderen <- horALL.vl[,hor.sel.vl]\n  chemsprops.Vlaanderen$source_db = \"Vlaanderen\"\n  chemsprops.Vlaanderen$confidence_degree = 2\n  chemsprops.Vlaanderen$project_url = \"https://www.dov.vlaanderen.be\"\n  chemsprops.Vlaanderen$citation_url = \"https://doi.org/10.1016/j.geoderma.2015.04.001\"\n  chemsprops.Vlaanderen = complete.vars(chemsprops.Vlaanderen, sel = c(\"oc\", \"pH_H2O\", \"T0_2\"))\n}\ndim(chemsprops.Vlaanderen)\n#> [1] 41310    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "chilean-soil-organic-carbon-database-1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.38 Chilean Soil Organic Carbon database",
    "text": "Pfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: Chilean Soil Organic Carbon database, multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457–468, https://doi.org/10.5194/essd-12-457-2020. Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3",
    "code": "\nif(!exists(\"chemsprops.CHLSOC\")){\n  chl.hor <- read.csv(\"/mnt/diskstation/data/Soil_points/Chile/CHLSOC/CHLSOC_v1.0.csv\", stringsAsFactors = FALSE)\n  #summary(chl.hor$oc)\n  chl.hor$oc = chl.hor$oc*10\n  #summary(chl.hor$bd)\n  chl.hor$oc_d = signif(chl.hor$oc  * chl.hor$bd * (100 - ifelse(is.na(chl.hor$crf), 0, chl.hor$crf))/100, 3)\n  #summary(chl.hor$oc_d)\n  chl.col = c(\"ProfileID\", \"usiteid\", \"year\", \"long\", \"lat\", \"labsampnum\", \"layer_sequence\", \"top\", \"bottom\", \"hzn_desgn\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"crf\", \"bd\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = chl.col[which(!chl.col %in% names(chl.hor))]\n  if(length(x.na)>0){ for(i in x.na){ chl.hor[,i] = NA } }\n  chemsprops.CHLSOC = chl.hor[,chl.col]\n  chemsprops.CHLSOC$source_db = \"Chilean_SOCDB\"\n  chemsprops.CHLSOC$confidence_degree = 4\n  chemsprops.CHLSOC$project_url = \"https://doi.org/10.17605/OSF.IO/NMYS3\"\n  chemsprops.CHLSOC$citation_url = \"https://doi.org/10.5194/essd-12-457-2020\"\n  chemsprops.CHLSOC = complete.vars(chemsprops.CHLSOC, sel = c(\"oc\", \"bd\"), coords = c(\"long\", \"lat\"))\n}\ndim(chemsprops.CHLSOC)\n#> [1] 16371    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "scotland-nsis_1",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.39 Scotland (NSIS_1)",
    "text": "Lilly, ., Bell, J.S., Hudson, G., Nolan, .J. & Towers. W. (Compilers) (2010). National soil inventory Scotland (NSIS_1); site location, sampling profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230. Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download",
    "code": "\nif(!exists(\"chemsprops.ScotlandNSIS1\")){\n  sco.xy = read.csv(\"/mnt/diskstation/data/Soil_points/Scotland/NSIS_10km.csv\")\n  coordinates(sco.xy) = ~ easting + northing\n  proj4string(sco.xy) = \"EPSG:27700\"\n  sco.ll = as.data.frame(spTransform(sco.xy, CRS(\"EPSG:4326\")))\n  sco.ll$site_obsdate = as.numeric(sapply(sco.ll$profile_da, function(x){substr(x, nchar(x)-3, nchar(x))}))\n  #hist(sco.ll$site_obsdate[sco.ll$site_obsdate>1000])\n  ## no points after 1990!!\n  #summary(sco.ll$exch_k)\n  sco.in.name = c(\"profile_id\", \"site_obsdate\", \"easting\", \"northing\", \"horz_top\", \"horz_botto\", \n                  \"horz_symb\", \"sample_id\", \"texture_ps\",\n                  \"sand_int\", \"silt_int\", \"clay\", \"carbon\", \"nitrogen\", \"ph_h2o\", \"exch_ca\", \n                  \"exch_mg\", \"exch_na\", \"exch_k\", \"sum_cation\")\n  #sco.in.name[which(!sco.in.name %in% names(sco.ll))]\n  sco.x = as.data.frame(sco.ll[,sco.in.name])\n  #sco.x = sco.x[!sco.x$sample_id==0,]\n  #summary(sco.x$carbon)\n  sco.out.name = c(\"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\",\n                     \"hzn_bot\", \"hzn_top\", \"hzn_desgn\", \"labsampnum\", \"tex_psda\", \"sand_tot_psa\", \"silt_tot_psa\", \n                      \"clay_tot_psa\", \"oc\", \"n_tot\", \"ph_h2o\", \"ca_ext\",\n                      \"mg_ext\", \"na_ext\", \"k_ext\", \"cec_sum\")\n  ## translate values\n  sco.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(sco.in.name)))\n  sco.fun.lst[[which(sco.in.name==\"profile_id\")]] = \"paste(x)\"\n  sco.fun.lst[[which(sco.in.name==\"exch_ca\")]] = \"as.numeric(x)*200\"\n  sco.fun.lst[[which(sco.in.name==\"exch_mg\")]] = \"as.numeric(x)*121\"\n  sco.fun.lst[[which(sco.in.name==\"exch_k\")]] = \"as.numeric(x)*391\"\n  sco.fun.lst[[which(sco.in.name==\"exch_na\")]] = \"as.numeric(x)*230\"\n  sco.fun.lst[[which(sco.in.name==\"carbon\")]] = \"as.numeric(x)*10\"\n  sco.fun.lst[[which(sco.in.name==\"nitrogen\")]] = \"as.numeric(x)*10\"\n  ## save translation rules:\n  write.csv(data.frame(sco.in.name, sco.out.name, unlist(sco.fun.lst)), \"scotland_soilab_transvalues.csv\")\n  sco.soil = transvalues(sco.x, sco.out.name, sco.in.name, sco.fun.lst)\n  x.na = col.names[which(!col.names %in% names(sco.soil))]\n  if(length(x.na)>0){ for(i in x.na){ sco.soil[,i] = NA } }\n  chemsprops.ScotlandNSIS1 = sco.soil[,col.names]\n  chemsprops.ScotlandNSIS1$source_db = \"ScotlandNSIS1\"\n  chemsprops.ScotlandNSIS1$confidence_degree = 2\n  chemsprops.ScotlandNSIS1$project_url = \"http://soils.environment.gov.scot/\"\n  chemsprops.ScotlandNSIS1$citation_url = \"https://doi.org/10.5281/zenodo.4650230\"\n  chemsprops.ScotlandNSIS1 = complete.vars(chemsprops.ScotlandNSIS1, sel = c(\"oc\", \"ph_h2o\", \"clay_tot_psa\"))\n}\ndim(chemsprops.ScotlandNSIS1)\n#> [1] 2977   36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "ecoforest-map-of-quebec-canada",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.40 Ecoforest map of Quebec, Canada",
    "text": "Duchesne, L., Ouimet, R., (2021). Digital mapping soil texture ecoforest polygons Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685. Data download URL: https://doi.org/10.7717/peerj.11685/supp-1",
    "code": "\nif(!exists(\"chemsprops.QuebecTEX\")){\n  que.xy = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/Quebec/RawData.csv\")\n  #summary(as.factor(que.xy$Horizon))\n  ## horizon depths were not measured - we assume 15-30 and 30-80\n  que.xy$hzn_top = ifelse(que.xy$Horizon==\"B\", 15, 30)\n  que.xy$hzn_bot = ifelse(que.xy$Horizon==\"B\", 30, 80)\n  que.xy$site_key = que.xy$usiteid\n  que.xy$latitude_decimal_degrees = que.xy$Latitude\n  que.xy$longitude_decimal_degrees = que.xy$Longitude\n  que.xy$hzn_desgn = que.xy$Horizon\n  que.xy$sand_tot_psa = que.xy$PC_Sand\n  que.xy$silt_tot_psa = que.xy$PC_Silt\n  que.xy$clay_tot_psa = que.xy$PC_Clay\n  x.na = col.names[which(!col.names %in% names(que.xy))]\n  if(length(x.na)>0){ for(i in x.na){ que.xy[,i] = NA } }\n  chemsprops.QuebecTEX = que.xy[,col.names]\n  chemsprops.QuebecTEX$source_db = \"QuebecTEX\"\n  chemsprops.QuebecTEX$confidence_degree = 4\n  chemsprops.QuebecTEX$project_url = \"\"\n  chemsprops.QuebecTEX$citation_url = \"https://doi.org/10.7717/peerj.11685\"\n  chemsprops.QuebecTEX = complete.vars(chemsprops.QuebecTEX, sel = c(\"clay_tot_psa\"))\n}\ndim(chemsprops.QuebecTEX)\n#> [1] 26648    36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "pseudo-observations",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.3.0.41 Pseudo-observations",
    "text": "Pseudo-observations using simulated points (world deserts)potential large soil profile DBs interest:Shangguan, W., Dai, Y., Liu, B., Zhu, ., Duan, Q., Wu, L., … & Chen, D. (2013). China data set soil properties land surface modeling. Journal Advances Modeling Earth Systems, 5(2), 212-224.Salković, E., Djurović, ., Knežević, M., Popović-Bugarin, V., & Topalović, . (2018). Digitization mapping national legacy soil data Montenegro. Soil Water Research, 13(2), 83-89. https://doi.org/10.17221/81/2017-SWR",
    "code": "\nif(!exists(\"chemsprops.SIM\")){\n  ## 0 soil organic carbon + 98% sand content (deserts)\n  load(\"deserts.pnt.rda\")\n  nut.sim <- as.data.frame(spTransform(deserts.pnt, CRS(\"+proj=longlat +datum=WGS84\")))\n  nut.sim[,1] <- NULL\n  nut.sim <- plyr::rename(nut.sim, c(\"x\"=\"longitude_decimal_degrees\", \"y\"=\"latitude_decimal_degrees\"))\n  nr = nrow(nut.sim)\n  nut.sim$site_key <- paste(\"Simulated\", 1:nr, sep=\"_\")\n  ## insert zeros for all nutrients except for the once we are not sure:\n  ## http://www.decodedscience.org/chemistry-sahara-sand-elements-dunes/45828\n  sim.vars = c(\"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ecec\", \"clay_tot_psa\", \"mg_ext\", \"k_ext\")\n  nut.sim[,sim.vars] <- 0\n  nut.sim$silt_tot_psa = 2\n  nut.sim$sand_tot_psa = 98\n  nut.sim$hzn_top = 0\n  nut.sim$hzn_bot = 30\n  nut.sim$db_od = 1.55\n  nut.sim2 = nut.sim\n  nut.sim2$silt_tot_psa = 1\n  nut.sim2$sand_tot_psa = 99\n  nut.sim2$hzn_top = 30\n  nut.sim2$hzn_bot = 60\n  nut.sim2$db_od = 1.6\n  nut.simA = rbind(nut.sim, nut.sim2)\n  #str(nut.simA)\n  nut.simA$source_db = \"Simulated\"\n  nut.simA$confidence_degree = 10\n  x.na = col.names[which(!col.names %in% names(nut.simA))]\n  if(length(x.na)>0){ for(i in x.na){ nut.simA[,i] = NA } }\n  chemsprops.SIM = nut.simA[,col.names]\n  chemsprops.SIM$project_url = \"https://gitlab.com/openlandmap/\"\n  chemsprops.SIM$citation_url = \"https://gitlab.com/openlandmap/compiled-ess-point-data-sets/\"\n}\ndim(chemsprops.SIM)\n#> [1] 718  36"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "alt-text-bind-all-datasets",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.4  Bind all datasets",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "bind-and-clean-up",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.4.0.1 Bind and clean-up",
    "text": "Clean typos physically impossible values:Fill-missing depths:Summary number points per data source:Add unique row identifierand unique location based Open Location Code:Remove points falling sea similar:",
    "code": "\nls(pattern=glob2rx(\"chemsprops.*\"))\n#>  [1] \"chemsprops.AfSIS1\"        \"chemsprops.AfSPDB\"       \n#>  [3] \"chemsprops.Alaska\"        \"chemsprops.bpht\"         \n#>  [5] \"chemsprops.BZE_LW\"        \"chemsprops.CAPERM\"       \n#>  [7] \"chemsprops.CHLSOC\"        \"chemsprops.CNSOT\"        \n#>  [9] \"chemsprops.CostaRica\"     \"chemsprops.CUFS\"         \n#> [11] \"chemsprops.EGRPR\"         \"chemsprops.FEBR\"         \n#> [13] \"chemsprops.FIADB\"         \"chemsprops.FRED\"         \n#> [15] \"chemsprops.GEMAS\"         \"chemsprops.GROOT\"        \n#> [17] \"chemsprops.IRANSPDB\"      \"chemsprops.ISCND\"        \n#> [19] \"chemsprops.LandPKS\"       \"chemsprops.LUCAS\"        \n#> [21] \"chemsprops.LUCAS2\"        \"chemsprops.Mangroves\"    \n#> [23] \"chemsprops.NAMSOTER\"      \"chemsprops.NatSoil\"      \n#> [25] \"chemsprops.NCSCD\"         \"chemsprops.NCSS\"         \n#> [27] \"chemsprops.NPDB\"          \"chemsprops.Peatlands\"    \n#> [29] \"chemsprops.PRONASOLOS\"    \"chemsprops.QuebecTEX\"    \n#> [31] \"chemsprops.RaCA\"          \"chemsprops.RemnantSOC\"   \n#> [33] \"chemsprops.ScotlandNSIS1\" \"chemsprops.SIM\"          \n#> [35] \"chemsprops.SISLAC\"        \"chemsprops.SOCPDB\"       \n#> [37] \"chemsprops.SoDaH\"         \"chemsprops.SoilHealthDB\" \n#> [39] \"chemsprops.SRDB\"          \"chemsprops.USGS.NGS\"     \n#> [41] \"chemsprops.Vlaanderen\"    \"chemsprops.WISE\"\ntot_sprops = dplyr::bind_rows(lapply(ls(pattern=glob2rx(\"chemsprops.*\")), function(i){ mutate_all(setNames(get(i), col.names), as.character) }))\n## convert to numeric:\nfor(j in c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"layer_sequence\", \n           \"hzn_top\", \"hzn_bot\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \n           \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \n           \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \n           \"ec_satp\", \"ec_12pre\")){\n  tot_sprops[,j] = as.numeric(tot_sprops[,j])\n}\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n#head(tot_sprops)\ntex.rm = rowSums(tot_sprops[,c(\"clay_tot_psa\", \"sand_tot_psa\", \"silt_tot_psa\")])\nsummary(tex.rm)\n#>     Min.  1st Qu.   Median     Mean  3rd Qu.     Max.     NA's \n#> -2997.00   100.00   100.00    99.39   100.00   500.00   274336\nfor(j in c(\"clay_tot_psa\", \"sand_tot_psa\", \"silt_tot_psa\", \"wpg2\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>100|tot_sprops[,j]<0, NA, tot_sprops[,j])\n  tot_sprops[,j] = ifelse(tex.rm<99|is.na(tex.rm)|tex.rm>101, NA, tot_sprops[,j])\n}\nfor(j in c(\"ph_h2o\",\"ph_kcl\",\"ph_cacl2\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>12|tot_sprops[,j]<2, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$db_od)\nfor(j in c(\"db_od\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>2.4|tot_sprops[,j]<0.05, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$oc)\nfor(j in c(\"oc\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>800|tot_sprops[,j]<0, NA, tot_sprops[,j])\n}\n## soil layer depth (middle)\ntot_sprops$hzn_depth = tot_sprops$hzn_top + (tot_sprops$hzn_bot-tot_sprops$hzn_top)/2\nsummary(is.na(tot_sprops$hzn_depth))\n#>    Mode   FALSE    TRUE \n#> logical  766689    5465\n## Note: large number of horizons without a depth\ntot_sprops = tot_sprops[!is.na(tot_sprops$hzn_depth),]\n#quantile(tot_sprops$hzn_depth, c(0.01,0.99), na.rm=TRUE)\ntot_sprops$hzn_depth = ifelse(tot_sprops$hzn_depth<0, 10, ifelse(tot_sprops$hzn_depth>800, 800, tot_sprops$hzn_depth))\n#hist(tot_sprops$hzn_depth, breaks=45)\nsummary(as.factor(tot_sprops$source_db))\n#>              AfSIS1              AfSPDB     Alaska_interior              BZE_LW \n#>                4162               60277                3880               17187 \n#>         Canada_CUFS         Canada_NPDB    Canada_subarctic       Chilean_SOCDB \n#>               15162               14900                1180               16358 \n#>         China_SOTER               CIFOR           CostaRica Croatian_Soil_Pedon \n#>                5105                 561                2029                5746 \n#>       CSIRO_NatSoil                FEBR               FIADB                FRED \n#>               70688                7804               23208                 625 \n#>          GEMAS_2009               GROOT           Iran_SPDB               ISCND \n#>                4131                 718                4677                3977 \n#>          ISRIC_WISE             LandPKS          LUCAS_2009          LUCAS_2015 \n#>               23278               41644               21272               21859 \n#>         MangrovesDB            NAMSOTER               NCSCD          PRONASOLOS \n#>                7733                2941                7082               31655 \n#>           QuebecTEX            RaCA2016        Russia_EGRPR       ScotlandNSIS1 \n#>               26648               53663                4437                2977 \n#>           Simulated              SISLAC              SOCPDB               SoDaH \n#>                 718               49416                1526               17766 \n#>        SoilHealthDB                SRDB           USDA_NCSS            USGS.NGS \n#>                 120                1596              135671                9398 \n#>          Vlaanderen    WHRC_remnant_SOC \n#>               41310                1604\ntot_sprops$uuid = openssl::md5(make.unique(paste(\"OpenLandMap\", tot_sprops$site_key, tot_sprops$layer_sequence, sep=\"_\")))\ntot_sprops$olc_id = olctools::encode_olc(tot_sprops$latitude_decimal_degrees, tot_sprops$longitude_decimal_degrees, 11)\nlength(levels(as.factor(tot_sprops$olc_id)))\n#> [1] 205687\n## 205,620\ntot_sprops.pnts = tot_sprops[!duplicated(tot_sprops$olc_id),c(\"site_key\", \"source_db\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"site_obsdate\", \"olc_id\", \"project_url\", \"citation_url\")]\ncoordinates(tot_sprops.pnts) <- ~ longitude_decimal_degrees + latitude_decimal_degrees\nproj4string(tot_sprops.pnts) <- \"EPSG:4326\"\nif(!exists(\"ov.sprops\")){\n  #mask = terra::rast(\"./layers1km/lcv_landmask_esacci.lc.l4_c_1km_s0..0cm_2000..2015_v1.0.tif\")\n  mask = terra::rast(\"/mnt/diskstation/data/LandGIS/layers250m/lcv_landmask_esacci.lc.l4_c_250m_s0..0cm_2000..2015_v1.0.tif\")\n  ov.sprops <- terra::extract(mask, terra::vect(tot_sprops.pnts)) ## TAKES 2 mins\n  summary(as.factor(ov.sprops[,2]))\n  if(sum(is.na(ov.sprops[,2]))>0 | sum(ov.sprops[,2]==2)>0){\n    rem.lst = which(is.na(ov.sprops[,2]) | ov.sprops[,2]==2 | ov.sprops[,2]==4)\n    rem.sp = tot_sprops.pnts$site_key[rem.lst]\n    tot_sprops.pnts = tot_sprops.pnts[-rem.lst,]\n  }\n}\n## final number of unique spatial locations:\nnrow(tot_sprops.pnts)\n#> [1] 205687\n## 203,107"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "histogram-plots",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.4.0.2 Histogram plots",
    "text": "mind datasets represent top-soil (e.g. LUCAS) \ncover whole soil depth, hence higher mean values regions (Europe) \nconsidered within context diverse soil depths.Note: FIADB includes litter soil samples taken fixed depths. Canada\ndataset also shows SOC content peatlands.Note: SOC (%) SOC density (kg/m3) almost linear relationship (curving toward fixed value),\nexcept organic soils (especially litter) relationship slightly shifted.Note: seems apparent correlation soil pH soil depth.",
    "code": "\nlibrary(ggplot2)\nggplot(tot_sprops, aes(x=source_db, y=log1p(oc))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 195328 rows containing non-finite values (stat_boxplot).\nsel.db = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"Canada_NPDB\", \"FIADB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"hzn_depth\", y = \"oc\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"SOC wprm\", xlab=\"depth in cm\")\nggplot(tot_sprops, aes(x=source_db, y=db_od)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 537198 rows containing non-finite values (stat_boxplot).\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"oc\", y = \"db_od\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, ylab=\"Bulk density\", xlab=\"SOC wprm\")\nggplot(tot_sprops, aes(x=source_db, y=log1p(oc_d))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning in log1p(oc_d): NaNs produced\n\n#> Warning in log1p(oc_d): NaNs produced\n#> Warning: Removed 561232 rows containing non-finite values (stat_boxplot).\nsel.db0 = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"oc\", y = \"oc_d\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, xlab=\"SOC wprm\", ylab=\"SOC kg/m3\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"oc\", y = \"n_tot\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, xlab=\"SOC wprm\", ylab=\"N total wprm\")\nggplot(tot_sprops, aes(x=source_db, y=ph_h2o)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 270562 rows containing non-finite values (stat_boxplot).\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\"),], x = \"ph_kcl\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", xlab=\"soil pH KCl\", ylab=\"soil pH H2O\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"hzn_depth\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"soil pH H2O\", xlab=\"depth in cm\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\"),], x = \"ph_h2o\", y = \"cec_sum\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"CEC\", xlab=\"soil pH H2O\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"ph_h2o\", y = \"oc\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC wprm\", xlab=\"soil pH H2O\")\nggplot(tot_sprops, aes(x=source_db, y=clay_tot_psa)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 279635 rows containing non-finite values (stat_boxplot).\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], y = \"clay_tot_psa\", x = \"sand_tot_psa\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", ylab=\"clay %\", xlab=\"sand %\")\nggplot(tot_sprops, aes(x=source_db, y=log1p(cec_sum))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning in log1p(cec_sum): NaNs produced\n\n#> Warning in log1p(cec_sum): NaNs produced\n#> Warning: Removed 514240 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=log1p(n_tot))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning in log1p(n_tot): NaNs produced\n\n#> Warning in log1p(n_tot): NaNs produced\n#> Warning: Removed 446028 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=log1p(k_ext))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning in log1p(k_ext): NaNs produced\n\n#> Warning in log1p(k_ext): NaNs produced\n#> Warning: Removed 523010 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=log1p(ec_satp))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 608509 rows containing non-finite values (stat_boxplot).\nsprops_yrs = tot_sprops[!is.na(tot_sprops$site_obsdate),c(\"site_obsdate\", \"source_db\", \"oc\")]\nsprops_yrs$year = as.numeric(substr(x=sprops_yrs$site_obsdate, 1, 4))\n#> Warning: NAs introduced by coercion\nsprops_yrs$year = ifelse(sprops_yrs$year <1960, NA, ifelse(sprops_yrs$year>2024, NA, sprops_yrs$year))\nggplot(sprops_yrs, aes(x=source_db, y=year)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 70644 rows containing non-finite values (stat_boxplot).\nopenair::scatterPlot(sprops_yrs[sprops_yrs$source_db %in% sel.db0,], y = \"oc\", x = \"year\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC wprm\", xlab=\"Sampling year\")"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "convert-to-wide-format",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.4.0.3 Convert to wide format",
    "text": "Add layer_sequence missing since needed able convert wide\nformat:Convert long table wide table format depth gets unique column\n(note: computational / time-consuming step usually):Write soil profiles using wide format:",
    "code": "\n#summary(tot_sprops$layer_sequence)\ntot_sprops$dsiteid = paste(tot_sprops$source_db, tot_sprops$site_key, tot_sprops$site_obsdate, sep=\"_\")\nif(!exists(\"l.s1\")){\n  library(dplyr)\n  ## Note: takes >2 mins\n  l.s1 <- tot_sprops[,c(\"dsiteid\",\"hzn_depth\")] %>% group_by(dsiteid) %>% mutate(layer_sequence.f = data.table::frank(hzn_depth, ties.method = \"first\"))\n  tot_sprops$layer_sequence.f = ifelse(is.na(tot_sprops$layer_sequence), l.s1$layer_sequence.f, tot_sprops$layer_sequence)\n  tot_sprops$layer_sequence.f = ifelse(tot_sprops$layer_sequence.f>6, 6, tot_sprops$layer_sequence.f)\n}\nif(!exists(\"tot_sprops.w\")){\n  library(data.table)\n  tot_sprops.w = data.table::dcast( as.data.table(tot_sprops), \n                formula = olc_id ~ layer_sequence.f, \n                value.var = c(\"uuid\", hor.names[-which(hor.names %in% c(\"site_key\", \"layer_sequence\"))]), \n                ## \"labsampnum\", \"hzn_desgn\", \"tex_psda\" \n                #fun=function(x){ mean(x, na.rm=TRUE) }, \n                ## Note: does not work for characters\n                fun=function(x){ x[1] },\n                verbose = FALSE)\n  ## remove \"0\" layers added automatically but containing no values\n  tot_sprops.w = tot_sprops.w[,grep(\"*_0$\", colnames(tot_sprops.w)):=NULL]\n}\ntot_sprops_w.pnts = tot_sprops.pnts\ntot_sprops_w.pnts@data = plyr::join(tot_sprops.pnts@data, tot_sprops.w)\n#> Joining by: olc_id\nsel.rm.pnts  <- tot_sprops_w.pnts$source_db==\"LUCAS_2009\" | tot_sprops_w.pnts$source_db==\"LUCAS_2015\" | tot_sprops_w.pnts$site_key %in% mng.rm | tot_sprops_w.pnts$site_key %in% rem.sp\nout.gpkg = \"./out/gpkg/sol_chem.pnts_horizons.gpkg\"\n#unlink(out.gpkg)\nif(!file.exists(out.gpkg)){\n  writeOGR(tot_sprops_w.pnts[!sel.rm.pnts,], \"./out/gpkg/sol_chem.pnts_horizons.gpkg\", \"sol_chem.pnts_horizons\", drive=\"GPKG\")\n}"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "save-rds-files",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.4.0.4 Save RDS files",
    "text": "Remove points allowed distributed publicly:Plot Goode Homolozine projection save final objects:\n(#fig:sol_chem.pnts_sites)Soil profiles soil samples chemical physical properties global compilation.\nFig. 1: Soil profiles soil samples chemical physical properties global compilation.",
    "code": "\nsel.rm  <- tot_sprops$source_db==\"LUCAS_2009\" | tot_sprops$source_db==\"LUCAS_2015\" | tot_sprops$site_key %in% mng.rm | tot_sprops$site_key %in% rem.sp\ntot_sprops.s = tot_sprops[!sel.rm,] \nif(!file.exists(\"./img/sol_chem.pnts_sites.png\")){\n  tot_sprops.pnts_sf <- st_as_sf(tot_sprops.pnts[1], crs=4326)\n  plot_gh(tot_sprops.pnts_sf, out.pdf=\"./img/sol_chem.pnts_sites.pdf\")\n  ## extremely slow --- takes 15mins\n  system(\"pdftoppm ./img/sol_chem.pnts_sites.pdf ./img/sol_chem.pnts_sites -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_chem.pnts_sites.png ./img/sol_chem.pnts_sites.png\")\n}"
  },
  {
    "path": "soil-chemical-and-physical-properties.html",
    "id": "save-final-analysis-ready-objects",
    "chapter": "5 Soil chemical and physical properties",
    "heading": "5.5 Save final analysis-ready objects:",
    "text": "Save temp object:",
    "code": "\nsaveRDS.gz(tot_sprops.s, \"./out/rds/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops.pnts, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_sites.rds\")\n#library(farff)\n#writeARFF(tot_sprops.s, \"./out/arff/sol_chem.pnts_horizons.arff\", overwrite = TRUE)\n## compressed CSV\nwrite.csv(tot_sprops.s, file=gzfile(\"./out/csv/sol_chem.pnts_horizons.csv.gz\"))\n## regression matrix:\n#saveRDS.gz(rm.sol, \"./out/rds/sol_chem.pnts_horizons_rm.rds\")\nsave.image.pigz(file=\"soilchem.RData\")\n## rmarkdown::render(\"Index.rmd\")"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "soil-physical-and-hydrological-properties",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6 Soil physical and hydrological properties",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.Last update: 2023-05-10",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "overview-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.1 Overview",
    "text": "section describes import steps used produce global compilation soil\nlaboratory data physicals hydraulic soil properties can \nused predictive soil mapping / modeling global regional scales.Read computing soil hydraulic / physical properties R:Gupta, S., Hengl, T., Lehmann, P., Bonetti, S., , D. SoilKsatDB: global soil saturated hydraulic conductivity measurements geoscience applications. Earth Syst. Sci. Data Discuss., https://doi.org/10.5194/essd-2020-149, review, 2021.de Sousa, D. F., Rodrigues, S., de Lima, H. V., & Chagas, L. T. (2020). R software packages tool evaluating soil physical hydraulic properties. Computers Electronics Agriculture, 168, 105077.",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "alt-text-specifications-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.2  Specifications",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "data-standards-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.2.0.1 Data standards",
    "text": "Metadata information: “Soil Survey Investigation Report . 42.” “Soil Survey Investigation Report . 45.”Model DB: National Cooperative Soil Survey (NCSS) Soil Characterization Database",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "target-variables-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.2.0.2 Target variables:",
    "text": "db_13b: Bulk density (33kPa) g/cm3 <2mm soil fraction,db: Bulk density (unknown method) g/cm3 <2mm soil fraction,COLEws: Coefficient Linear Extensibility (COLE) whole soil ratio <2mm soil fraction,w6clod: Water Content 6 kPa <2mm % wt <2mm soil fraction,w10cld: Water Content 10 kPa <2mm % wt <2mm soil fraction,w3cld: Water Content 33 kPa <2mm % vol <2mm soil fraction (Field Capacity),w15l2: Water Content 1500 kPa <2mm % vol <2mm soil fraction (Permanent Wilting Point),w15bfm: Water Content 1500 kPa moist <2mm % wt <2mm soil fraction,adod: Air-Dry/Oven-Dry ratio <2mm soil fraction,wrd_ws13: Water Retention Difference whole soil, 1500-kPa suction upper limit usually 33-kPa cm3 / cm-3 <2mm soil fraction,cec7_cly: CEC-7/Clay ratio ratio <2mm soil fraction,w15cly: CEC/Clay ratio 1500 kPa ratio <2mm soil fraction,tex_psda: Texture Determined, PSDA factor <2mm soil fraction,clay_tot_psa: Total Clay, <0.002 mm (<2 µm) % wt <2mm soil fraction,silt_tot_psa: Total Silt, 0.002-0.05 mm % wt <2mm soil fraction,sand_tot_psa: Total Sand, 0.05-2.0 mm % wt <2mm soil fraction,wpg2: Coarse fragments >2-mm weight fraction % wt <2mm soil fraction,hzn_top: top (upper) depth layer centimeters. cm <2mm soil fraction,hzn_bot: bottom (lower) depth layer centimeters. cm <2mm soil fraction,oc_v: Organic carbon (unknown method) % wt <2mm soil fraction,ph_kcl: pH, 1N KCl ratio <2mm soil fraction,ph_h2o_v: pH water (unknown method) <2mm soil fraction,cec_sum: Sum Cations (CEC-8.2) cmol(+)/kg <2mm soil fraction,cec_nh4: NH4OAc, pH 7 (CEC-7) cmol(+)/kg <2mm soil fraction,ksat_field: Field-estimated Saturated Hydraulic Conductivity cm/day <2mm soil fraction,ksat_lab: Laboratory-estimated Saturated Hydraulic Conductivity cm/day <2mm soil fraction,variable names adjusted (e.g. ph_h2o ph_h2o_na) include unknown method variables different laboratory methods can seamlessly merged.Conversion VWC MWC based formula (landon1991handbook?; benham1998field?; vanReeuwijk1993procedures?):VWC (%v/v) = MWC (% weight ) * bulk density (kg/m3)",
    "code": "\nsite.names = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"location_accuracy_min\", \"location_accuracy_max\")\nhor.names = c(\"labsampnum\",\"site_key\",\"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\",\"db_13b\", \"db_od\", \"COLEws\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"ph_kcl\", \"ph_h2o\", \"cec_sum\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\")\n## target structure:\ncol.names = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"db_13b\", \"db_od\", \"COLEws\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"ph_kcl\", \"ph_h2o\", \"cec_sum\", \"cec_nh4\", \"wpg2\",  \"ksat_lab\", \"ksat_field\", \"source_db\", \"confidence_degree\", \"project_url\", \"citation_url\")"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "alt-text-data-import-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3  Data import",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "ncss-characterization-database",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.1 NCSS Characterization Database",
    "text": "National Cooperative Soil Survey, (2020). National Cooperative Soil Survey Characterization Database. http://ncsslabdatamart.sc.egov.usda.gov/",
    "code": "\nif(!exists(\"hydrosprops.NCSS\")){\n  ncss.site <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Site_Location.csv\", stringsAsFactors = FALSE)\n  #str(ncss.site)  \n  ## Location accuracy unknown but we assume 100m\n  ncss.site$location_accuracy_max = NA\n  ncss.site$location_accuracy_min = 100\n  ncss.layer <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Layer.csv\", stringsAsFactors = FALSE)\n  ncss.bdm <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Bulk_Density_and_Moisture.csv\", stringsAsFactors = FALSE)\n  #summary(as.factor(ncss.bdm$prep_code))\n  ncss.bdm.0 <- ncss.bdm[ncss.bdm$prep_code==\"S\",]\n  #summary(ncss.bdm.0$db_od)\n  ## 0 values --- error!\n  ncss.carb <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Carbon_and_Extractions.csv\", stringsAsFactors = FALSE)\n  ncss.organic <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_Organic.csv\", stringsAsFactors = FALSE)\n  ncss.pH <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_pH_and_Carbonates.csv\", stringsAsFactors = FALSE)\n  #str(ncss.pH)\n  #summary(!is.na(ncss.pH$ph_h2o))\n  ncss.PSDA <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_PSDA_and_Rock_Fragments.csv\", stringsAsFactors = FALSE)\n  ncss.CEC <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_CEC_and_Bases.csv\")\n  ncss.horizons <- plyr::join_all(list(ncss.bdm.0, ncss.layer, ncss.carb, ncss.organic, ncss.pH, ncss.PSDA, ncss.CEC), type = \"left\", by=\"labsampnum\")\n  #head(ncss.horizons)\n  nrow(ncss.horizons)\n  ncss.horizons$ksat_lab = NA; ncss.horizons$ksat_field = NA \n  hydrosprops.NCSS = plyr::join(ncss.site[,site.names], ncss.horizons[,hor.names], by=\"site_key\")\n  ## soil organic carbon:\n  #summary(!is.na(hydrosprops.NCSS$oc)) \n  #summary(!is.na(hydrosprops.NCSS$ph_h2o)) \n  #summary(!is.na(hydrosprops.NCSS$ph_kcl)) \n  hydrosprops.NCSS$source_db = \"USDA_NCSS\"\n  #str(hydrosprops.NCSS)\n  #hist(hydrosprops.NCSS$w3cld[hydrosprops.NCSS$w3cld<150], breaks=45, col=\"gray\")\n  ## ERROR: MANY VALUES >100%\n  ## fills in missing BD values using formula from Köchy, Hiederer, and Freibauer (2015)\n  db.f = ifelse(is.na(hydrosprops.NCSS$db_13b), -0.31*log(hydrosprops.NCSS$oc)+1.38, hydrosprops.NCSS$db_13b)\n  db.f[db.f<0.02 | db.f>2.87] = NA\n  ## Convert to volumetric % to match most of world data sets:\n  hydrosprops.NCSS$w3cld = hydrosprops.NCSS$w3cld * db.f\n  hydrosprops.NCSS$w15l2 = hydrosprops.NCSS$w15l2 * db.f\n  hydrosprops.NCSS$w10cld = hydrosprops.NCSS$w10cld * db.f\n  #summary(as.factor(hydrosprops.NCSS$tex_psda))\n  ## texture classes need to be cleaned up!\n  ## check WRC values for sandy soils\n  #hydrosprops.NCSS[which(!is.na(hydrosprops.NCSS$w3cld) & hydrosprops.NCSS$sand_tot_psa>95)[1:10],]\n  ## check WRC values for ORGANIC soils\n  #hydrosprops.NCSS[which(!is.na(hydrosprops.NCSS$w3cld) & hydrosprops.NCSS$oc>12)[1:10],]\n  ## w3cld > 100?\n  hydrosprops.NCSS$confidence_degree = 1\n  hydrosprops.NCSS$project_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  hydrosprops.NCSS$citation_url = \"https://doi.org/10.2136/sssaj2016.11.0386n\"\n  hydrosprops.NCSS = complete.vars(hydrosprops.NCSS)\n  saveRDS.gz(hydrosprops.NCSS, \"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/hydrosprops.NCSS.rds\")\n}\ndim(hydrosprops.NCSS)\n#> [1] 113991     40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "africa-soil-profiles-database-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.2 Africa soil profiles database",
    "text": "Leenaars, J. G., Van OOstrum, . J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. compilation georeferenced standardized legacy soil profile data Sub-Saharan Africa (dataset). Wageningen: ISRIC Report 2014/01; 2014.",
    "code": "\nif(!exists(\"hydrosprops.AfSPDB\")){\n  require(foreign)\n  afspdb.profiles <- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Profiles.dbf\", as.is=TRUE)\n  ## approximate location error\n  afspdb.profiles$location_accuracy_min = afspdb.profiles$XYAccur * 1e5\n  afspdb.profiles$location_accuracy_min = ifelse(afspdb.profiles$location_accuracy_min < 20, NA, afspdb.profiles$location_accuracy_min)\n  afspdb.profiles$location_accuracy_max = NA\n  afspdb.layers <- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Layers.dbf\", as.is=TRUE)\n  ## select columns of interest:\n  afspdb.s.lst <- c(\"ProfileID\", \"usiteid\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\", \"location_accuracy_min\", \"location_accuracy_max\")\n  ## Convert to weight content\n  #summary(afspdb.layers$BlkDens)\n  ## select layers\n  afspdb.h.lst <- c(\"LayerID\", \"ProfileID\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"db_13b\", \"BlkDens\", \"COLEws\", \"VMCpF18\", \"VMCpF20\", \"VMCpF25\", \"VMCpF42\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"LabTxtr\", \"Clay\", \"Silt\", \"Sand\", \"OrgC\", \"PHKCl\", \"PHH2O\", \"CecSoil\", \"cec_nh4\", \"CfPc\", \"ksat_lab\", \"ksat_field\")\n  ## add missing columns\n  for(j in c(\"usiteid\")){  afspdb.profiles[,j] = NA }\n  for(j in c(\"db_13b\", \"COLEws\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"cec_nh4\", \"ksat_lab\", \"ksat_field\")){  afspdb.layers[,j] = NA }\n  hydrosprops.AfSPDB = plyr::join(afspdb.profiles[,afspdb.s.lst], afspdb.layers[,afspdb.h.lst])\n  for(j in 1:ncol(hydrosprops.AfSPDB)){ \n    if(is.numeric(hydrosprops.AfSPDB[,j])) { hydrosprops.AfSPDB[,j] <- ifelse(hydrosprops.AfSPDB[,j] < -200, NA, hydrosprops.AfSPDB[,j]) }\n  }\n  hydrosprops.AfSPDB$source_db = \"AfSPDB\"\n  hydrosprops.AfSPDB$confidence_degree = 5\n  hydrosprops.AfSPDB$OrgC = hydrosprops.AfSPDB$OrgC/10\n  #summary(hydrosprops.AfSPDB$OrgC)\n  hydrosprops.AfSPDB$project_url = \"https://www.isric.org/projects/africa-soil-profiles-database-afsp\"\n  hydrosprops.AfSPDB$citation_url = \"https://www.isric.org/sites/default/files/isric_report_2014_01.pdf\"  \n  hydrosprops.AfSPDB = complete.vars(hydrosprops.AfSPDB, sel = c(\"VMCpF25\", \"VMCpF42\"), coords = c(\"X_LonDD\", \"Y_LatDD\"))\n  saveRDS.gz(hydrosprops.AfSPDB, \"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/hydrosprops.AfSPDB.rds\")\n}\ndim(hydrosprops.AfSPDB)\n#> [1] 10720    40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "isric-isis",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.3 ISRIC ISIS",
    "text": "Batjes, N. H. (1995). homogenized soil data file global environmental research: subset FAO, ISRIC NRCS profiles (Version 1.0) (. 95/10b). ISRIC.Van de Ven, T., & Tempel, P. (1994). ISIS 4.0: ISRIC Soil Information System: User Manual. ISRIC.",
    "code": "\nif(!exists(\"hydrosprops.ISIS\")){\n  isis.xy <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/Sites.csv\", stringsAsFactors = FALSE)\n  #str(isis.xy)\n  isis.des <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/SitedescriptionResults.csv\", stringsAsFactors = FALSE)\n  isis.site <- data.frame(site_key=isis.xy$Id, usiteid=paste(isis.xy$CountryISO, isis.xy$SiteNumber, sep=\"\"))\n  id0.lst = c(236,235,224)\n  nm0.lst = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"site_obsdate\")\n  isis.site.l = plyr::join_all(lapply(1:length(id0.lst), function(i){plyr::rename(subset(isis.des, ValueId==id0.lst[i])[,c(\"SampleId\",\"Value\")], replace=c(\"SampleId\"=\"site_key\", \"Value\"=paste(nm0.lst[i])))}), type = \"full\")\n  isis.site.df = join(isis.site, isis.site.l)\n  for(j in nm0.lst){ isis.site.df[,j] <- as.numeric(isis.site.df[,j]) }\n  isis.site.df[isis.site.df$usiteid==\"CI2\",\"latitude_decimal_degrees\"] = 5.883333\n  #str(isis.site.df)\n  isis.site.df$location_accuracy_min = 100\n  isis.site.df$location_accuracy_max = NA\n  isis.smp <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/AnalyticalSamples.csv\", stringsAsFactors = FALSE)\n  isis.ana <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/AnalyticalResults.csv\", stringsAsFactors = FALSE)\n  #str(isis.ana)\n  isis.class <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/ClassificationResults.csv\", stringsAsFactors = FALSE)\n  isis.hor <- data.frame(labsampnum=isis.smp$Id, hzn_top=isis.smp$Top, hzn_bot=isis.smp$Bottom, site_key=isis.smp$SiteId)\n  isis.hor$hzn_bot <- as.numeric(gsub(\">\", \"\", isis.hor$hzn_bot))\n  #str(isis.hor)\n  id.lst = c(1,2,22,4,28,31,32,14,34,38,39,42)\n  nm.lst = c(\"ph_h2o\",\"ph_kcl\",\"wpg2\",\"oc\",\"sand_tot_psa\",\"silt_tot_psa\",\"clay_tot_psa\",\"cec_sum\",\"db_od\",\"w10cld\",\"w3cld\", \"w15l2\")\n  #str(as.numeric(isis.ana$Value[isis.ana$ValueId==38]))\n  isis.hor.l = plyr::join_all(lapply(1:length(id.lst), function(i){plyr::rename(subset(isis.ana, ValueId==id.lst[i])[,c(\"SampleId\",\"Value\")], replace=c(\"SampleId\"=\"labsampnum\", \"Value\"=paste(nm.lst[i])))}), type = \"full\")\n  #summary(as.numeric(isis.hor.l$w3cld))\n  isis.hor.df = join(isis.hor, isis.hor.l)\n  isis.hor.df = isis.hor.df[!duplicated(isis.hor.df$labsampnum),]\n  #summary(as.numeric(isis.hor.df$w3cld))\n  for(j in nm.lst){ isis.hor.df[,j] <- as.numeric(isis.hor.df[,j]) }\n  #str(isis.hor.df)\n  ## add missing columns\n  for(j in c(\"layer_sequence\", \"hzn_desgn\", \"tex_psda\", \"COLEws\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"cec_nh4\", \"db_13b\", \"w6clod\", \"ksat_lab\", \"ksat_field\")){  isis.hor.df[,j] = NA }\n  which(!hor.names %in% names(isis.hor.df))\n  hydrosprops.ISIS <- join(isis.site.df[,site.names], isis.hor.df[,hor.names], type=\"left\")\n  hydrosprops.ISIS$source_db = \"ISRIC_ISIS\"\n  hydrosprops.ISIS$confidence_degree = 1\n  hydrosprops.ISIS$project_url = \"https://isis.isric.org\"\n  hydrosprops.ISIS$citation_url = \"https://www.isric.org/sites/default/files/isric_report_1995_10b.pdf\"\n  hydrosprops.ISIS = complete.vars(hydrosprops.ISIS)\n  saveRDS.gz(hydrosprops.ISIS, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_ISIS/hydrosprops.ISIS.rds\")\n}\ndim(hydrosprops.ISIS)\n#> [1] 1176   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "isric-wise",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.4 ISRIC WISE",
    "text": "Batjes, N.H. (2019). Harmonized soil profile data applications global continental scales: updates WISE database. Soil Use Management 5:124–127.",
    "code": "\nif(!exists(\"hydrosprops.WISE\")){\n  wise.SITE <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_SITE.csv\", stringsAsFactors=FALSE)\n  #summary(as.factor(wise.SITE$LONLAT_ACC))\n  wise.SITE$location_accuracy_min = ifelse(wise.SITE$LONLAT_ACC==\"D\", 1e5/2, ifelse(wise.SITE$LONLAT_ACC==\"S\", 30, ifelse(wise.SITE$LONLAT_ACC==\"M\", 1800/2, NA)))\n  wise.SITE$location_accuracy_max = NA\n  wise.HORIZON <- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_HORIZON.csv\")\n  wise.s.lst <- c(\"WISE3_id\", \"SOURCE_ID\", \"DATEYR\", \"LONDD\", \"LATDD\", \"location_accuracy_min\", \"location_accuracy_max\")\n  ## Volumetric values\n  #summary(wise.HORIZON$BULKDENS)\n  #summary(wise.HORIZON$VMC1)\n  wise.HORIZON$WISE3_id = wise.HORIZON$WISE3_ID\n  wise.h.lst <- c(\"labsampnum\", \"WISE3_id\", \"HONU\", \"TOPDEP\", \"BOTDEP\", \"DESIG\", \"db_13b\", \"BULKDENS\", \"COLEws\", \"w6clod\", \"VMC1\", \"VMC2\", \"VMC3\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"CLAY\", \"SILT\", \"SAND\", \"ORGC\", \"PHKCL\", \"PHH2O\", \"CECSOIL\", \"cec_nh4\", \"GRAVEL\", \"ksat_lab\", \"ksat_field\")\n  ## add missing columns\n  for(j in c(\"labsampnum\", \"db_13b\", \"COLEws\", \"w15bfm\", \"w6clod\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"cec_nh4\", \"ksat_lab\", \"ksat_field\")){  wise.HORIZON[,j] = NA }\n  hydrosprops.WISE = plyr::join(wise.SITE[,wise.s.lst], wise.HORIZON[,wise.h.lst])\n  for(j in 1:ncol(hydrosprops.WISE)){ \n    if(is.numeric(hydrosprops.WISE[,j])) { hydrosprops.WISE[,j] <- ifelse(hydrosprops.WISE[,j] < -200, NA, hydrosprops.WISE[,j]) }\n  }\n  hydrosprops.WISE$ORGC = hydrosprops.WISE$ORGC/10\n  hydrosprops.WISE$source_db = \"ISRIC_WISE\"\n  hydrosprops.WISE$project_url = \"https://isric.org\"\n  hydrosprops.WISE$citation_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"\n  hydrosprops.WISE <- complete.vars(hydrosprops.WISE, sel=c(\"VMC2\", \"VMC3\"), coords = c(\"LONDD\", \"LATDD\"))\n  hydrosprops.WISE$confidence_degree = 5\n  #summary(hydrosprops.WISE$VMC3)\n  saveRDS.gz(hydrosprops.WISE, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/hydrosprops.WISE.rds\")\n}\ndim(hydrosprops.WISE)\n#> [1] 1325   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "fine-root-ecology-database-fred-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.5 Fine Root Ecology Database (FRED)",
    "text": "Iversen CM, Powell , McCormack ML, Blackwood CB, Freschet GT, Kattge J, Roumet C, Stover DB, Soudzilovskaia NA, Valverde-Barrantes OJ, van Bodegom PM, Violle C. 2018. Fine-Root Ecology Database (FRED): Global Collection Root Trait Data Coincident Site, Vegetation, Edaphic, Climatic Data, Version 2. Oak Ridge National Laboratory, TES SFA, U.S. Department Energy, Oak Ridge, Tennessee, U.S.. Access -line : https://doi.org/10.25581/ornlsfa.012/1417481.",
    "code": "\nif(!exists(\"hydrosprops.FRED\")){\n  fred = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED2_20180518.csv\", skip = 5, header=FALSE)\n  names(fred) = names(read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED2_20180518.csv\", nrows=1, header=TRUE))\n  fred.h.lst = c(\"Notes_Row.ID\", \"Data.source_DOI\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"Soil.horizon\", \"db_13b\", \"Soil.bulk.density\", \"COLEws\", \"w6clod\", \"w10cld\", \"Soil.water_Volumetric.content\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"Soil.texture\", \"Soil.texture_Fraction.clay\", \"Soil.texture_Fraction.silt\", \"Soil.texture_Fraction.sand\", \"Soil.organic.C.content\", \"ph_kcl\", \"Soil.pH_Water\", \"Soil.cation.exchange.capacity..CEC.\", \"cec_nh4\", \"wpg2\",  \"ksat_lab\", \"ksat_field\")\n  #summary(fred$Soil.water_Volumetric.content)\n  #summary(fred$Soil.water_Storage.capacity)\n  fred$site_obsdate = rowMeans(fred[,c(\"Sample.collection_Year.ending.collection\", \"Sample.collection_Year.beginning.collection\")], na.rm=TRUE)\n  #summary(fred$site_obsdate)\n  fred$longitude_decimal_degrees = ifelse(is.na(fred$Longitude), fred$Longitude_Estimated, fred$Longitude)\n  fred$latitude_decimal_degrees = ifelse(is.na(fred$Latitude), fred$Latitude_Estimated, fred$Latitude)\n  #summary(as.factor(fred$Soil.horizon))\n  fred$hzn_bot = ifelse(is.na(fred$Soil.depth_Lower.sampling.depth), fred$Soil.depth - 5, fred$Soil.depth_Lower.sampling.depth)\n  fred$hzn_top = ifelse(is.na(fred$Soil.depth_Upper.sampling.depth), fred$Soil.depth + 5, fred$Soil.depth_Upper.sampling.depth)\n  x.na = fred.h.lst[which(!fred.h.lst %in% names(fred))]\n  if(length(x.na)>0){ for(i in x.na){ fred[,i] = NA } }\n  hydrosprops.FRED = fred[,fred.h.lst]\n  #plot(hydrosprops.FRED[,4:5])\n  hydrosprops.FRED$source_db = \"FRED\"\n  hydrosprops.FRED$confidence_degree = 5\n  hydrosprops.FRED$project_url = \"https://roots.ornl.gov/\"\n  hydrosprops.FRED$citation_url = \"https://doi.org/10.25581/ornlsfa.012/1417481\"\n  hydrosprops.FRED = complete.vars(hydrosprops.FRED, sel = c(\"Soil.water_Volumetric.content\", \"Soil.texture_Fraction.clay\"))\n  saveRDS.gz(hydrosprops.FRED, \"/mnt/diskstation/data/Soil_points/INT/FRED/hydrosprops.FRED.rds\")\n}\ndim(hydrosprops.FRED)\n#> [1] 3761   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "egrpr-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.6 EGRPR",
    "text": "Russian Federation: Unified State Register Soil Resources (EGRPR).",
    "code": "\nif(!exists(\"hydrosprops.EGRPR\")){\n  russ.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Russia/EGRPR/Russia_EGRPR_soil_pedons.csv\")\n  russ.HOR$SOURCEID = paste(russ.HOR$CardID, russ.HOR$SOIL_ID, sep=\"_\")\n  russ.HOR$SNDPPT <- russ.HOR$TEXTSAF + russ.HOR$TEXSCM\n  russ.HOR$SLTPPT <- russ.HOR$TEXTSIC + russ.HOR$TEXTSIM + 0.8 * russ.HOR$TEXTSIF\n  russ.HOR$CLYPPT <- russ.HOR$TEXTCL + 0.2 * russ.HOR$TEXTSIF\n  ## Correct texture fractions:\n  sumTex <- rowSums(russ.HOR[,c(\"SLTPPT\",\"CLYPPT\",\"SNDPPT\")])\n  russ.HOR$SNDPPT <- russ.HOR$SNDPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$SLTPPT <- russ.HOR$SLTPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$oc <- russ.HOR$ORGMAT/1.724\n  ## add missing columns\n  for(j in c(\"site_obsdate\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"db_13b\", \"COLEws\", \"w15bfm\", \"w6clod\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\")){  russ.HOR[,j] = NA }\n  russ.sel.h = c(\"SOURCEID\", \"SOIL_ID\", \"site_obsdate\", \"LONG\", \"LAT\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"HORNMB\", \"HORTOP\", \"HORBOT\", \"HISMMN\", \"db_13b\", \"DVOL\", \"COLEws\", \"w6clod\", \"WR10\", \"WR33\", \"WR1500\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"CLYPPT\", \"SLTPPT\", \"SNDPPT\", \"oc\", \"PHSLT\", \"PHH2O\", \"CECST\", \"cec_nh4\", \"wpg2\",\"ksat_lab\", \"ksat_field\")\n  hydrosprops.EGRPR = russ.HOR[,russ.sel.h]\n  hydrosprops.EGRPR$source_db = \"Russia_EGRPR\"\n  hydrosprops.EGRPR$confidence_degree = 2\n  hydrosprops.EGRPR$project_url = \"http://egrpr.esoil.ru/\"\n  hydrosprops.EGRPR$citation_url = \"https://doi.org/10.19047/0136-1694-2016-86-115-123\"\n  hydrosprops.EGRPR <- complete.vars(hydrosprops.EGRPR, sel=c(\"WR33\", \"WR1500\"), coords = c(\"LONG\", \"LAT\"))\n  #summary(hydrosprops.EGRPR$WR1500)\n  saveRDS.gz(hydrosprops.EGRPR, \"/mnt/diskstation/data/Soil_points/Russia/EGRPR/hydrosprops.EGRPR.rds\")\n}\ndim(hydrosprops.EGRPR)\n#> [1] 1138   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "spade-2",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.7 SPADE-2",
    "text": "Hannam J.., Hollis, J.M., Jones, R.J.., Bellamy, P.H., Hayes, S.E., Holden, ., Van Liedekerke, M.H. Montanarella, L. (2009). SPADE-2: soil profile analytical database Europe, Version 2.0 Beta Version March 2009. Unpublished Report, 27pp.Kristensen, J. ., Balstrøm, T., Jones, R. J. ., Jones, ., Montanarella, L., Panagos, P., Breuning-Madsen, H.: Development harmonised soil profile analytical database Europe: resource supporting regional soil management, SOIL, 5, 289–301, https://doi.org/10.5194/soil-5-289-2019, 2019.",
    "code": "\nif(!exists(\"hydrosprops.SPADE2\")){\n  spade.PLOT <- read.csv(\"/mnt/diskstation/data/Soil_points/EU/SPADE/DAT_PLOT.csv\")\n  #str(spade.PLOT)\n  spade.HOR <- read.csv(\"/mnt/diskstation/data/Soil_points/EU/SPADE/DAT_HOR.csv\")\n  spade.PLOT = spade.PLOT[!spade.PLOT$LON_COOR_V>180 & spade.PLOT$LAT_COOR_V>20,]\n  #plot(spade.PLOT[,c(\"LON_COOR_V\",\"LAT_COOR_V\")])\n  spade.PLOT$location_accuracy_min = 100\n  spade.PLOT$location_accuracy_max = NA\n  #site.names = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\")\n  spade.PLOT$ProfileID = paste(spade.PLOT$CNTY_C, spade.PLOT$PLOT_ID, sep=\"_\")\n  spade.PLOT$T_Year = 2009\n  spade.s.lst <- c(\"PLOT_ID\", \"ProfileID\", \"T_Year\", \"LON_COOR_V\", \"LAT_COOR_V\", \"location_accuracy_min\", \"location_accuracy_max\")\n  ## standardize:\n  spade.HOR$SLTPPT <- spade.HOR$SILT1_V + spade.HOR$SILT2_V\n  spade.HOR$SNDPPT <- spade.HOR$SAND1_V + spade.HOR$SAND2_V + spade.HOR$SAND3_V\n  spade.HOR$PHIKCL <- NA\n  spade.HOR$PHIKCL[which(spade.HOR$PH_M %in% \"A14\")] <- spade.HOR$PH_V[which(spade.HOR$PH_M %in% \"A14\")]\n  spade.HOR$PHIHO5 <- NA\n  spade.HOR$PHIHO5[which(spade.HOR$PH_M %in% \"A12\")] <- spade.HOR$PH_V[which(spade.HOR$PH_M %in% \"A12\")]\n  #summary(spade.HOR$BD_V)\n  for(j in c(\"site_obsdate\", \"layer_sequence\", \"db_13b\", \"COLEws\", \"w15bfm\", \"w6clod\", \"w10cld\", \"adod\", \"wrd_ws13\", \"w15bfm\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"cec_nh4\", \"ksat_lab\", \"ksat_field\")){  spade.HOR[,j] = NA }\n  spade.h.lst = c(\"HOR_ID\",\"PLOT_ID\",\"layer_sequence\",\"HOR_BEG_V\",\"HOR_END_V\",\"HOR_NAME\",\"db_13b\", \"BD_V\", \"COLEws\", \"w6clod\", \"w10cld\", \"WCFC_V\", \"WC4_V\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"CLAY_V\", \"SLTPPT\", \"SNDPPT\", \"OC_V\", \"PHIKCL\", \"PHIHO5\", \"CEC_V\", \"cec_nh4\", \"GRAV_C\", \"ksat_lab\", \"ksat_field\")\n  hydrosprops.SPADE2 = plyr::join(spade.PLOT[,spade.s.lst], spade.HOR[,spade.h.lst])\n  hydrosprops.SPADE2$source_db = \"SPADE2\"\n  hydrosprops.SPADE2$confidence_degree = 15\n  hydrosprops.SPADE2$project_url = \"https://esdac.jrc.ec.europa.eu/content/soil-profile-analytical-database-2\"\n  hydrosprops.SPADE2$citation_url = \"https://doi.org/10.1016/j.landusepol.2011.07.003\"\n  hydrosprops.SPADE2 <- complete.vars(hydrosprops.SPADE2, sel=c(\"WCFC_V\", \"WC4_V\"), coords = c(\"LON_COOR_V\",\"LAT_COOR_V\"))\n  #summary(hydrosprops.SPADE2$WC4_V)\n  #summary(is.na(hydrosprops.SPADE2$WC4_V))\n  #hist(hydrosprops.SPADE2$WC4_V, breaks=45, col=\"gray\")\n  saveRDS.gz(hydrosprops.SPADE2, \"/mnt/diskstation/data/Soil_points/EU/SPADE/hydrosprops.SPADE2.rds\")\n}\ndim(hydrosprops.SPADE2)\n#> [1] 1182   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "canada-national-pedon-database",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.8 Canada National Pedon Database",
    "text": "Agriculture Agri-Food Canada National Pedon Database.",
    "code": "\nif(!exists(\"hydrosprops.NPDB\")){\n  NPDB.nm = c(\"NPDB_V2_sum_source_info.csv\",\"NPDB_V2_sum_chemical.csv\", \"NPDB_V2_sum_horizons_raw.csv\", \"NPDB_V2_sum_physical.csv\")\n  NPDB.HOR = plyr::join_all(lapply(paste0(\"/mnt/diskstation/data/Soil_points/Canada/NPDB/\", NPDB.nm), read.csv), type = \"full\")\n  #str(NPDB.HOR)\n  #summary(NPDB.HOR$BULK_DEN)\n  ## 0 values -> ERROR!\n  ## add missing columns\n  NPDB.HOR$HISMMN = paste0(NPDB.HOR$HZN_MAS, NPDB.HOR$HZN_SUF, NPDB.HOR$HZN_MOD)\n  for(j in c(\"usiteid\", \"location_accuracy_max\", \"layer_sequence\", \"labsampnum\", \"db_13b\", \"COLEws\", \"w15bfm\", \"w6clod\", \"w10cld\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"cec_nh4\", \"ph_kcl\", \"ksat_lab\", \"ksat_field\")){  NPDB.HOR[,j] = NA }\n  npdb.sel.h = c(\"PEDON_ID\", \"usiteid\", \"CAL_YEAR\", \"DD_LONG\", \"DD_LAT\", \"CONF_METRS\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"U_DEPTH\", \"L_DEPTH\", \"HISMMN\", \"db_13b\", \"BULK_DEN\", \"COLEws\", \"w6clod\", \"w10cld\", \"RETN_33KP\", \"RETN_1500K\", \"RETN_HYGR\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"T_CLAY\", \"T_SILT\", \"T_SAND\", \"CARB_ORG\", \"ph_kcl\", \"PH_H2O\", \"CEC\", \"cec_nh4\", \"VC_SAND\", \"ksat_lab\", \"ksat_field\")\n  hydrosprops.NPDB = NPDB.HOR[,npdb.sel.h]\n  hydrosprops.NPDB$source_db = \"Canada_NPDB\"\n  hydrosprops.NPDB$confidence_degree = 1\n  hydrosprops.NPDB$project_url = \"https://open.canada.ca/data/en/\"\n  hydrosprops.NPDB$citation_url = \"https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\"\n  hydrosprops.NPDB <- complete.vars(hydrosprops.NPDB, sel=c(\"RETN_33KP\", \"RETN_1500K\"), coords = c(\"DD_LONG\", \"DD_LAT\"))\n  saveRDS.gz(hydrosprops.NPDB, \"/mnt/diskstation/data/Soil_points/Canada/NPDB/hydrosprops.NPDB.rds\")\n}\ndim(hydrosprops.NPDB)\n#> [1] 404  40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "eth-imported-data-from-literature",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.9 ETH imported data from literature",
    "text": "Digitized soil hydraulic measurements literature ETH Soil Terrestrial Environmental Physics.",
    "code": "\nif(!exists(\"hydrosprops.ETH\")){\n  xlsxFile = list.files(pattern=\"Global_soil_water_tables.xlsx\", full.names = TRUE, recursive = TRUE)\n  wb = openxlsx::getSheetNames(xlsxFile)\n  eth.tbl = plyr::rbind.fill(\n    openxlsx::read.xlsx(xlsxFile, sheet = \"ETH_imported_literature\"), \n    openxlsx::read.xlsx(xlsxFile, sheet = \"ETH_imported_literature_more\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"ETH_extra_data set\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"Tibetan_plateau\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"Belgium_Vereecken_data\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"Australia_dataset\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"Florida_Soils_Ksat\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"China_dataset\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"Sand_dunes_Siberia_database\"),\n    openxlsx::read.xlsx(xlsxFile, sheet = \"New_data_4_03\")\n  )\n  #dim(eth.tbl)\n  #summary(as.factor(eth.tbl$reference_source))\n  ## Data quality tables\n  lab.ql = openxlsx::read.xlsx(xlsxFile, sheet = \"Quality_per_site_key\")\n  lab.cd = plyr::join(eth.tbl[\"site_key\"], lab.ql)$confidence_degree\n  eth.tbl$confidence_degree = ifelse(is.na(eth.tbl$confidence_degree), lab.cd, eth.tbl$confidence_degree)\n  #summary(as.factor(eth.tbl$confidence_degree))\n  ## missing columns\n  for(j in c(\"usiteid\", \"labsampnum\", \"layer_sequence\", \"db_13b\", \"COLEws\", \"adod\", \"wrd_ws13\", \"w15bfm\", \"w15cly\", \"cec7_cly\", \"w6clod\", \"w10cld\", \"ph_kcl\", \"cec_sum\", \"cec_nh4\", \"wpg2\", \"project_url\", \"citation_url\")){ eth.tbl[,j] = NA }\n  hydrosprops.ETH = eth.tbl[,col.names]\n  col.names[which(!col.names %in% names(eth.tbl))]\n  hydrosprops.ETH$project_url = \"https://step.ethz.ch/\"\n  hydrosprops.ETH$citation_url = \"https://doi.org/10.5194/essd-2020-149\"\n  hydrosprops.ETH = complete.vars(hydrosprops.ETH)\n  #hist(hydrosprops.ETH$w15l2, breaks=45, col=\"gray\")\n  #hist(log1p(hydrosprops.ETH$ksat_lab), breaks=45, col=\"gray\")\n  saveRDS.gz(hydrosprops.ETH, \"/mnt/diskstation/data/Soil_points/INT/hydrosprops.ETH.rds\")\n}\ndim(hydrosprops.ETH)\n#> [1] 9023   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "hybras",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.10 HYBRAS",
    "text": "Ottoni, M. V., Ottoni Filho, T. B., Schaap, M. G., Lopes-Assad, M. L. R., & Rotunno Filho, O. C. (2018). Hydrophysical database Brazilian soils (HYBRAS) pedotransfer functions water retention. Vadose Zone Journal, 17(1).",
    "code": "\nif(!exists(\"hydrosprops.HYBRAS\")){\n  hybras.HOR = openxlsx::read.xlsx(xlsxFile, sheet = \"HYBRAS.V1_integrated_tables_RAW\")\n  #str(hybras.HOR)\n  ## some points had only UTM coordinates and had to be manually coorected\n  ## subset to unique values:\n  hybras.HOR = hybras.HOR[!duplicated(hybras.HOR$site_key),]\n  #summary(hybras.HOR$bulk_den)\n  #hist(hybras.HOR$ksat, breaks=35, col=\"grey\")\n  ## add missing columns\n  for(j in c(\"usiteid\", \"layer_sequence\", \"labsampnum\", \"db_13b\", \"COLEws\", \"w15bfm\", \"w6clod\", \"w10cld\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"cec_sum\", \"cec_nh4\", \"ph_kcl\", \"ph_h2o\", \"ksat_field\", \"uuid\")){  hybras.HOR[,j] = NA }\n  hybras.HOR$w3cld = rowMeans(hybras.HOR[,c(\"theta20\",\"theta50\")], na.rm = TRUE)\n  hybras.sel.h = c(\"site_key\", \"usiteid\", \"year\", \"LongitudeOR\", \"LatitudeOR\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"top_depth\", \"bot_depth\", \"horizon\", \"db_13b\", \"bulk_den\", \"COLEws\", \"w6clod\", \"theta10\", \"w3cld\", \"theta15000\", \"satwat\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"clay\", \"silt\", \"sand\", \"org_carb\", \"ph_kcl\", \"ph_h2o\", \"cec_sum\", \"cec_nh4\", \"vc_sand\", \"ksat\", \"ksat_field\")\n  hydrosprops.HYBRAS = hybras.HOR[,hybras.sel.h]\n  hydrosprops.HYBRAS$source_db = \"HYBRAS\"\n  hydrosprops.HYBRAS$confidence_degree = 1\n  for(i in c(\"theta10\", \"w3cld\", \"theta15000\", \"satwat\")){ hydrosprops.HYBRAS[,i] = hydrosprops.HYBRAS[,i]*100 }\n  #summary(hydrosprops.HYBRAS$theta10)\n  #summary(hydrosprops.HYBRAS$satwat)\n  #hist(hydrosprops.HYBRAS$theta10, breaks=45, col=\"gray\")\n  #hist(log1p(hydrosprops.HYBRAS$ksat), breaks=45, col=\"gray\")\n  #summary(!is.na(hydrosprops.HYBRAS$ksat))\n  hydrosprops.HYBRAS$project_url = \"http://www.cprm.gov.br/en/Hydrology/Research-and-Innovation/HYBRAS-4208.html\"\n  hydrosprops.HYBRAS$citation_url = \"https://doi.org/10.2136/vzj2017.05.0095\"\n  hydrosprops.HYBRAS <- complete.vars(hydrosprops.HYBRAS, sel=c(\"w3cld\", \"theta15000\", \"ksat\", \"ksat_field\"), coords = c(\"LongitudeOR\", \"LatitudeOR\"))\n  saveRDS.gz(hydrosprops.HYBRAS, \"/mnt/diskstation/data/Soil_points/INT/HYBRAS/hydrosprops.HYBRAS.rds\")\n}\ndim(hydrosprops.HYBRAS)\n#> [1] 814  40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "unsoda",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.11 UNSODA",
    "text": "Nemes, Attila; Schaap, Marcel; Leij, Feike J.; Wösten, J. Henk M. (2015). UNSODA 2.0: Unsaturated Soil Hydraulic Database. Database program indirect methods estimating unsaturated hydraulic properties. US Salinity Laboratory - ARS - USDA. https://doi.org/10.15482/USDA.ADC/1173246. Accessed 2020-06-08.",
    "code": "\nif(!exists(\"hydrosprops.UNSODA\")){\n  unsoda.LOC = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/general_c.csv\")\n  #unsoda.LOC = unsoda.LOC[!unsoda.LOC$Lat==0,]\n  #plot(unsoda.LOC[,c(\"Long\",\"Lat\")])\n  unsoda.SOIL = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/soil_properties.csv\")\n  #summary(unsoda.SOIL$k_sat)\n  ## Soil water retention in lab:\n  tmp.hyd = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/lab_drying_h-t.csv\")\n  #str(tmp.hyd)\n  tmp.hyd = tmp.hyd[!is.na(tmp.hyd$preshead),]\n  tmp.hyd$theta = tmp.hyd$theta*100\n  #head(tmp.hyd)\n  pr.lst = c(6,10,33,15000)\n  cl.lst = c(\"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\")\n  tmp.hyd.tbl = data.frame(code=unique(tmp.hyd$code), w6clod=NA, w10cld=NA, w3cld=NA, w15l2=NA)\n  for(i in 1:length(pr.lst)){\n    tmp.hyd.tbl[,cl.lst[i]] = plyr::join(tmp.hyd.tbl, tmp.hyd[which(tmp.hyd$preshead==pr.lst[i]),c(\"code\",\"theta\")], match=\"first\")$theta\n  }\n  #head(tmp.hyd.tbl)\n  ## ksat\n  kst.lev = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/comment_lab_sat_cond.csv\", na.strings=c(\"\",\"NA\",\"No comment\"))\n  kst.met = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/methodology.csv\", na.strings=c(\"\",\"NA\",\"No comment\"))\n  kst.met$comment_lsc = paste(plyr::join(kst.met[c(\"comment_lsc_ID\")], kst.lev)$comment_lsc)\n  kst.met$comment_lsc[which(kst.met$comment_lsc==\"NA\")] = NA\n  kst.fld = read.csv(\"/mnt/diskstation/data/Soil_points/INT/UNSODA/comment_field_sat_cond.csv\", na.strings=c(\"\",\"NA\",\"No comment\"))\n  kst.met$comment_fsc = paste(plyr::join(kst.met[c(\"comment_fsc_ID\")], kst.fld)$comment_fsc)\n  kst.met$comment_fsc[which(kst.met$comment_fsc==\"NA\")] = NA\n  summary(as.factor(kst.met$comment_lsc))\n  kst.met$comment_met = ifelse(is.na(kst.met$comment_lsc)&!is.na(kst.met$comment_fsc), paste(\"field\", kst.met$comment_fsc), paste(\"lab\", kst.met$comment_lsc))\n  unsoda.SOIL$comment_met = paste(plyr::join(unsoda.SOIL[c(\"code\")], kst.met)$comment_met)\n  #summary(as.factor(unsoda.SOIL$comment_met))\n  sel.fld = unsoda.SOIL$comment_met %in% c(\"field Double ring infiltrometer\",\"field Ponding\", \"field Steady infiltration\")\n  unsoda.SOIL$ksat_lab[which(!sel.fld)] = unsoda.SOIL$k_sat[which(!sel.fld)]\n  unsoda.SOIL$ksat_field[is.na(unsoda.SOIL$ksat_lab)] = unsoda.SOIL$k_sat[is.na(unsoda.SOIL$ksat_lab)]\n  unsoda.col = join_all(list(unsoda.LOC, unsoda.SOIL, tmp.hyd.tbl))\n  #head(unsoda.col)\n  #summary(unsoda.col$OM_content)\n  unsoda.col$oc = signif(unsoda.col$OM_content/1.724, 4)\n  for(j in c(\"usiteid\", \"location_accuracy_min\", \"location_accuracy_max\", \"layer_sequence\", \"labsampnum\", \"db_13b\", \"COLEws\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"cec_nh4\", \"ph_kcl\", \"wpg2\")){  unsoda.col[,j] = NA }\n  unsoda.sel.h = c(\"code\", \"usiteid\", \"date\", \"Long\", \"Lat\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"depth_upper\", \"depth_lower\", \"horizon\", \"db_13b\", \"bulk_density\", \"COLEws\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"Texture\", \"Clay\", \"Silt\", \"Sand\", \"oc\", \"ph_kcl\", \"pH\", \"CEC\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\")\n  hydrosprops.UNSODA = unsoda.col[,unsoda.sel.h]\n  hydrosprops.UNSODA$source_db = \"UNSODA\"\n  ## corrected coordinates:\n  unsoda.ql = openxlsx::read.xlsx(xlsxFile, sheet = \"UNSODA_degree\")\n  hydrosprops.UNSODA$confidence_degree = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$confidence_degree\n  hydrosprops.UNSODA$Texture = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$tex_psda\n  hydrosprops.UNSODA$location_accuracy_min = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$location_accuracy_min\n  hydrosprops.UNSODA$location_accuracy_max = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$location_accuracy_max\n  ## replace coordinates\n  unsoda.Long = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$Improved_long\n  unsoda.Lat = plyr::join(hydrosprops.UNSODA[\"code\"], unsoda.ql)$Improved_lat\n  hydrosprops.UNSODA$Long = ifelse(is.na(unsoda.Long), hydrosprops.UNSODA$Long, unsoda.Long)\n  hydrosprops.UNSODA$Lat = ifelse(is.na(unsoda.Long), hydrosprops.UNSODA$Lat, unsoda.Lat)\n  #hist(hydrosprops.UNSODA$w15l2, breaks=45, col=\"gray\")\n  #hist(hydrosprops.UNSODA$ksat_lab, breaks=45, col=\"gray\")\n  unsoda.rem = hydrosprops.UNSODA$code %in% unsoda.ql$code[is.na(unsoda.ql$additional_information)]\n  #summary(unsoda.rem)\n  hydrosprops.UNSODA = hydrosprops.UNSODA[unsoda.rem,]\n  ## texture fractions sometimes need to be multiplied by 100!\n  #hydrosprops.UNSODA[hydrosprops.UNSODA$code==2220,]\n  sum.tex.1 = rowSums(hydrosprops.UNSODA[,c(\"Clay\", \"Silt\", \"Sand\")], na.rm = TRUE)\n  sum.tex.r = which(sum.tex.1<1.2 & sum.tex.1>0)\n  for(j in c(\"Clay\", \"Silt\", \"Sand\")){\n    hydrosprops.UNSODA[sum.tex.r,j] = hydrosprops.UNSODA[sum.tex.r,j] * 100\n  }\n  hydrosprops.UNSODA$project_url = \"https://data.nal.usda.gov/dataset/unsoda-20-unsaturated-soil-hydraulic-database-database-and-program-indirect-methods-estimating-unsaturated-hydraulic-properties\"\n  hydrosprops.UNSODA$citation_url = \"https://doi.org/10.15482/USDA.ADC/1173246\"\n  hydrosprops.UNSODA <- complete.vars(hydrosprops.UNSODA, coords = c(\"Long\", \"Lat\"))\n  saveRDS.gz(hydrosprops.UNSODA, \"/mnt/diskstation/data/Soil_points/INT/UNSODA/hydrosprops.UNSODA.rds\")\n}\ndim(hydrosprops.UNSODA)\n#> [1] 298  40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "hydros",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.12 HYDROS",
    "text": "Schindler, Uwe; Müller, Lothar (2015): Soil hydraulic functions international soils measured Extended Evaporation Method (EEM) HYPROP device, Leibniz-Zentrum für Agrarlandschaftsforschung (ZALF) e.V.[doi: 10.4228/ZALF.2003.273]",
    "code": "\nif(!exists(\"hydrosprops.HYDROS\")){\n  hydros.tbl = read.csv(\"/mnt/diskstation/data/Soil_points/INT/HydroS/int_rawret.csv\", sep=\"\\t\", stringsAsFactors = FALSE, dec = \",\")\n  hydros.tbl = hydros.tbl[!is.na(hydros.tbl$TENSION),]\n  #summary(hydros.tbl$TENSION)\n  hydros.tbl$TENSIONc = cut(hydros.tbl$TENSION, breaks=c(1,5,8,15,30,40,1000,15001))\n  #summary(hydros.tbl$TENSIONc)\n  hydros.tbl$WATER_CONTENT = hydros.tbl$WATER_CONTENT\n  #summary(hydros.tbl$WATER_CONTENT)\n  #head(hydros.tbl)\n  pr2.lst = c(\"(5,8]\", \"(8,15]\",\"(30,40]\",\"(1e+03,1.5e+04]\")\n  cl.lst = c(\"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\")\n  hydros.tbl.df = data.frame(SITE_ID=unique(hydros.tbl$SITE_ID), w6clod=NA, w10cld=NA, w3cld=NA, w15l2=NA)\n  for(i in 1:length(pr2.lst)){\n    hydros.tbl.df[,cl.lst[i]] = plyr::join(hydros.tbl.df, hydros.tbl[which(hydros.tbl$TENSIONc==pr2.lst[i]),c(\"SITE_ID\",\"WATER_CONTENT\")], match=\"first\")$WATER_CONTENT\n  }\n  #head(hydros.tbl.df)\n  ## properties:\n  hydros.soil = read.csv(\"/mnt/diskstation/data/Soil_points/INT/HydroS/int_basicdata.csv\", sep=\"\\t\", stringsAsFactors = FALSE, dec = \",\")\n  #head(hydros.soil)\n  #plot(hydros.soil[,c(\"H\",\"R\")])\n  hydros.col = plyr::join(hydros.soil, hydros.tbl.df)\n  #summary(hydros.col$OMC)\n  hydros.col$oc = hydros.col$OMC/1.724\n  hydros.col$location_accuracy_min = 100\n  hydros.col$location_accuracy_max = NA\n  for(j in c(\"layer_sequence\", \"db_13b\", \"COLEws\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"ph_kcl\", \"ph_h2o\", \"cec_sum\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\")){  hydros.col[,j] = NA }\n  hydros.sel.h = c(\"SITE_ID\", \"SITE\", \"SAMP_DATE\", \"H\", \"R\", \"location_accuracy_min\", \"location_accuracy_max\", \"SAMP_NO\", \"layer_sequence\", \"TOP_DEPTH\", \"BOT_DEPTH\", \"HORIZON\", \"db_13b\", \"BULK_DENSITY\", \"COLEws\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"ph_kcl\", \"ph_h2o\", \"cec_sum\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\")\n  hydros.sel.h[which(!hydros.sel.h %in% names(hydros.col))]\n  hydrosprops.HYDROS = hydros.col[,hydros.sel.h]\n  hydrosprops.HYDROS$source_db = \"HydroS\"\n  hydrosprops.HYDROS$confidence_degree = 1\n  hydrosprops.HYDROS$project_url = \"http://dx.doi.org/10.4228/ZALF.2003.273\"\n  hydrosprops.HYDROS$citation_url = \"https://doi.org/10.18174/odjar.v3i1.15763\"\n  hydrosprops.HYDROS <- complete.vars(hydrosprops.HYDROS, coords = c(\"H\",\"R\"))\n  saveRDS.gz(hydrosprops.HYDROS, \"/mnt/diskstation/data/Soil_points/INT/HYDROS/hydrosprops.HYDROS.rds\")\n}\ndim(hydrosprops.HYDROS)\n#> [1] 153  40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "swig",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.13 SWIG",
    "text": "Rahmati, M., Weihermüller, L., Vanderborght, J., Pachepsky, Y. ., Mao, L., Sadeghi, S. H., … & Toth, B. (2018). Development analysis Soil Water Infiltration Global database. Earth Syst. Sci. Data, 10, 1237–1263.",
    "code": "\nif(!exists(\"hydrosprops.SWIG\")){\n  meta.tbl = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SWIG/Metadata.csv\", skip = 1, fill = TRUE, blank.lines.skip=TRUE, flush=TRUE, stringsAsFactors=FALSE)\n  swig.xy = read.table(\"/mnt/diskstation/data/Soil_points/INT/SWIG/Locations.csv\", sep=\";\", dec = \",\", stringsAsFactors=FALSE, header=TRUE, na.strings = c(\"-\",\"\",\" \"), fill = TRUE)\n  swig.xy$x = as.numeric(gsub(\",\", \".\", swig.xy$x))\n  swig.xy$y = as.numeric(gsub(\",\", \".\", swig.xy$y))\n  swig.xy = swig.xy[,1:8]\n  names(swig.xy)[3] = \"EndDataset\"\n  library(tidyr)\n  swig.xyf = tidyr::fill(swig.xy, c(\"Dataset\",\"EndDataset\"))\n  swig.xyf$N = swig.xyf$EndDataset - swig.xyf$Dataset + 1\n  swig.xyf$N = ifelse(swig.xyf$N<1,1,swig.xyf$N)\n  swig.xyf = swig.xyf[!is.na(swig.xyf$y),]\n  #plot(swig.xyf[,c(\"x\",\"y\")])\n  swig.xyf.df = swig.xyf[rep(seq_len(nrow(swig.xyf)), swig.xyf$N),]\n  rn = sapply(row.names(swig.xyf.df), function(i){as.numeric(strsplit(i, \"\\\\.\")[[1]][2])})\n  swig.xyf.df$Code = rowSums(data.frame(rn, swig.xyf.df$Dataset), na.rm = TRUE)\n  ## bind together\n  swig.col = plyr::join(swig.xyf.df[,c(\"Code\",\"x\",\"y\")], meta.tbl)\n  ## aditional values for ksat\n  swig2.tbl = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SWIG/Statistics.csv\", fill = TRUE, blank.lines.skip=TRUE, sep=\";\", dec = \",\", flush=TRUE, stringsAsFactors=FALSE)\n  #hist(log1p(as.numeric(swig2.tbl$Ks..cm.hr.)), breaks=45, col=\"gray\")\n  swig.col$Ks..cm.hr. = as.numeric(plyr::join(swig.col[\"Code\"], swig2.tbl[c(\"Code\",\"Ks..cm.hr.\")])$Ks..cm.hr.)\n  swig.col$Ks..cm.hr. = ifelse(swig.col$Ks..cm.hr. * 24 <= 0.01, NA, swig.col$Ks..cm.hr.)\n  swig.col$Ksat = ifelse(is.na(swig.col$Ksat), swig.col$Ks..cm.hr., swig.col$Ksat)\n  for(j in c(\"usiteid\", \"site_obsdate\", \"labsampnum\", \"layer_sequence\", \"hzn_desgn\", \"db_13b\", \"COLEws\", \"adod\", \"wrd_ws13\", \"w15bfm\", \"w15cly\", \"cec7_cly\", \"w6clod\", \"w10cld\", \"ph_kcl\", \"cec_nh4\", \"ksat_lab\")){ swig.col[,j] = NA }\n  ## depths are missing?\n  swig.col$hzn_top = 0\n  swig.col$hzn_bot = 20\n  swig.col$location_accuracy_min = NA\n  swig.col$location_accuracy_max = NA\n  swig.col$w15l2 = swig.col$PWP * 100\n  swig.col$w3cld = swig.col$FC * 100\n  swig.sel.h = c(\"Code\", \"usiteid\", \"site_obsdate\", \"x\", \"y\", \"location_accuracy_min\", \"location_accuracy_max\", \"labsampnum\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"db_13b\", \"Db\", \"COLEws\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\", \"cec7_cly\", \"w15cly\", \"Texture.Class\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"ph_kcl\", \"pH\", \"CEC\", \"cec_nh4\", \"Gravel\", \"ksat_lab\", \"Ksat\")\n  swig.sel.h[which(!swig.sel.h %in% names(swig.col))]\n  hydrosprops.SWIG = swig.col[,swig.sel.h]\n  hydrosprops.SWIG$source_db = \"SWIG\"\n  hydrosprops.SWIG$Ksat = hydrosprops.SWIG$Ksat * 24 ## convert to days\n  #hist(hydrosprops.SWIG$w3cld, breaks=45, col=\"gray\")\n  #hist(log1p(hydrosprops.SWIG$Ksat), breaks=25, col=\"gray\")\n  #summary(hydrosprops.SWIG$Ksat); summary(hydrosprops.UNSODA$ksat_lab)\n  ## confidence degree\n  SWIG.ql = openxlsx::read.xlsx(xlsxFile, sheet = \"SWIG_database_Confidence_degree\")\n  hydrosprops.SWIG$confidence_degree = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$confidence_degree\n  hydrosprops.SWIG$location_accuracy_min = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$location_accuracy_min\n  hydrosprops.SWIG$location_accuracy_max = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$location_accuracy_max\n  #summary(as.factor(hydrosprops.SWIG$confidence_degree))\n  ## replace coordinates\n  SWIG.Long = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$Improved_long\n  SWIG.Lat = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$Improved_lat\n  hydrosprops.SWIG$x = ifelse(is.na(SWIG.Long), hydrosprops.SWIG$x, SWIG.Long)\n  hydrosprops.SWIG$y = ifelse(is.na(SWIG.Long), hydrosprops.SWIG$y, SWIG.Lat)\n  hydrosprops.SWIG$Texture.Class = plyr::join(hydrosprops.SWIG[\"Code\"], SWIG.ql)$tex_psda\n  swig.lab = SWIG.ql$Code[which(SWIG.ql$Ksat_Method %in% c(\"Constant head method\", \"Constant Head Method\", \"Falling head method\"))]\n  hydrosprops.SWIG$ksat_lab[hydrosprops.SWIG$Code %in% swig.lab] = hydrosprops.SWIG$Ksat[hydrosprops.SWIG$Code %in% swig.lab]\n  hydrosprops.SWIG$Ksat[hydrosprops.SWIG$Code %in% swig.lab] = NA\n  ## remove duplicates\n  swig.rem = hydrosprops.SWIG$Code %in% SWIG.ql$Code[is.na(SWIG.ql$additional_information)]\n  #summary(swig.rem)\n  #Mode   FALSE    TRUE \n  #logical     200    6921 \n  hydrosprops.SWIG = hydrosprops.SWIG[swig.rem,]\n  hydrosprops.SWIG = hydrosprops.SWIG[!duplicated(hydrosprops.SWIG$Code),]\n  ## remove all ksat values < 0.01 ?\n  #summary(hydrosprops.SWIG$Ksat < 0.01)\n  hydrosprops.SWIG$project_url = \"https://soil-modeling.org/resources-links/data-portal/swig\"\n  hydrosprops.SWIG$citation_url = \"https://doi.org/10.5194/essd-10-1237-2018\"\n  hydrosprops.SWIG <- complete.vars(hydrosprops.SWIG, sel=c(\"w15l2\",\"w3cld\",\"ksat_lab\",\"Ksat\"), coords=c(\"x\",\"y\"))\n  saveRDS.gz(hydrosprops.SWIG, \"/mnt/diskstation/data/Soil_points/INT/SWIG/hydrosprops.SWIG.rds\")\n}\ndim(hydrosprops.SWIG)\n#> [1] 3676   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "pseudo-points",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.3.0.14 Pseudo-points",
    "text": "Pseudo-observations using simulated points (world deserts)",
    "code": "\nif(!exists(\"hydrosprops.SIM\")){\n  ## 0 soil organic carbon + 98% sand content (deserts)\n  sprops.SIM = readRDS(\"/mnt/diskstation/data/LandGIS/training_points/soil_props/sprops.SIM.rds\")\n  sprops.SIM$w10cld = 3.1\n  sprops.SIM$w3cld = 1.2\n  sprops.SIM$w15l2 = 0.8\n  sprops.SIM$tex_psda = \"sand\"\n  sprops.SIM$usiteid = sprops.SIM$lcv_admin0_fao.gaul_c_250m_s0..0cm_2015_v1.0\n  sprops.SIM$longitude_decimal_degrees = sprops.SIM$x\n  sprops.SIM$latitude_decimal_degrees = sprops.SIM$y\n  ## Very approximate values for Ksat for shifting sand:\n  tax.r = raster::extract(raster(\"/mnt/diskstation/data/LandGIS/archive/predicted250m/sol_grtgroup_usda.soiltax_c_250m_s0..0cm_1950..2017_v0.1.tif\"), sprops.SIM[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  tax.leg = read.csv(\"/mnt/diskstation/data/LandGIS/archive/predicted250m/sol_grtgroup_usda.soiltax_c_250m_s0..0cm_1950..2017_v0.1.tif.csv\")\n  tax.ksat_lab = aggregate(eth.tbl$ksat_lab, by=list(Group=eth.tbl$tax_grtgroup), FUN=mean, na.rm=TRUE)\n  tax.ksat_lab.sd = aggregate(eth.tbl$ksat_lab, by=list(Group=eth.tbl$tax_grtgroup), FUN=sd, na.rm=TRUE)\n  tax.ksat_field = aggregate(eth.tbl$ksat_field, by=list(Group=eth.tbl$tax_grtgroup), FUN=mean, na.rm=TRUE)\n  tax.leg$ksat_lab = join(tax.leg, tax.ksat_lab)$x\n  tax.leg$ksat_field = join(tax.leg, tax.ksat_field)$x\n  tax.sel = c(\"cryochrepts\",\"cryorthods\",\"torripsamments\",\"haplustolls\",\"torrifluvents\")\n  sprops.SIM$ksat_field = join(data.frame(site_key=sprops.SIM$site_key, Number=tax.r), tax.leg[tax.leg$Group %in% tax.sel,])$ksat_field\n  sprops.SIM$ksat_lab = join(data.frame(site_key=sprops.SIM$site_key, Number=tax.r), tax.leg[tax.leg$Group %in% tax.sel,])$ksat_lab\n  #summary(sprops.SIM$ksat_lab)\n  #summary(sprops.SIM$ksat_field)\n  #View(sprops.SIM)\n  for(j in col.names[which(!col.names %in% names(sprops.SIM))]){  sprops.SIM[,j]  <- NA }\n  sprops.SIM$project_url = \"https://gitlab.com/openlandmap/global-layers\"\n  sprops.SIM$citation_url = \"\"\n  hydrosprops.SIM = sprops.SIM[,col.names]\n  hydrosprops.SIM$confidence_degree = 30\n  saveRDS.gz(hydrosprops.SIM, \"/mnt/diskstation/data/Soil_points/INT/hydrosprops.SIM.rds\")\n}\ndim(hydrosprops.SIM)\n#> [1] 8133   40"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "alt-text-bind-all-datasets-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4  Bind all datasets",
    "text": "",
    "code": ""
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "bind-and-clean-up-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.1 Bind and clean-up",
    "text": "Bind tables / rename columns necessary:Add unique row identifierand unique location based Open Location Code:",
    "code": "\nls(pattern=glob2rx(\"hydrosprops.*\"))\n#>  [1] \"hydrosprops.AfSPDB\" \"hydrosprops.EGRPR\"  \"hydrosprops.ETH\"   \n#>  [4] \"hydrosprops.FRED\"   \"hydrosprops.HYBRAS\" \"hydrosprops.HYDROS\"\n#>  [7] \"hydrosprops.ISIS\"   \"hydrosprops.NCSS\"   \"hydrosprops.NPDB\"  \n#> [10] \"hydrosprops.SIM\"    \"hydrosprops.SPADE2\" \"hydrosprops.SWIG\"  \n#> [13] \"hydrosprops.UNSODA\" \"hydrosprops.WISE\"\ntot_sprops = dplyr::bind_rows(lapply(ls(pattern=glob2rx(\"hydrosprops.*\")), function(i){ mutate_all(setNames(get(i), col.names), as.character) }))\n## convert to numeric:\nfor(j in c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"location_accuracy_min\", \"location_accuracy_max\", \"layer_sequence\", \"hzn_top\",\"hzn_bot\", \"oc\", \"ph_h2o\", \"ph_kcl\", \"db_od\", \"clay_tot_psa\", \"sand_tot_psa\",\"silt_tot_psa\", \"wpg2\", \"db_13b\", \"COLEws\", \"w15cly\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\", \"w15bfm\", \"adod\", \"wrd_ws13\",\"cec7_cly\", \"cec_sum\", \"cec_nh4\", \"ksat_lab\",\"ksat_field\")){\n  tot_sprops[,j] = as.numeric(tot_sprops[,j])\n}\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n\n#> Warning: NAs introduced by coercion\n#head(tot_sprops)\n## rename some columns:\ntot_sprops = plyr::rename(tot_sprops, replace = c(\"db_od\" = \"db\", \"ph_h2o\" = \"ph_h2o_v\", \"oc\" = \"oc_v\"))\nsummary(as.factor(tot_sprops$source_db))\n#>                    AfSPDB      Australian_ksat_data         Belgian_ksat_data \n#>                     10720                       118                       145 \n#>               Canada_NPDB           China_ksat_data            ETH_literature \n#>                       404                       209                      1954 \n#>         Florida_ksat_data                      FRED                    HYBRAS \n#>                      6532                      3761                       814 \n#>                    HydroS                ISRIC_ISIS                ISRIC_WISE \n#>                       153                      1176                      1325 \n#>              Russia_EGRPR                 SIMULATED                    SPADE2 \n#>                      1138                      8133                      1182 \n#>                      SWIG Tibetan_plateau_ksat_data                    UNSODA \n#>                      3676                        65                       298 \n#>                 USDA_NCSS \n#>                    113991\ntot_sprops$uuid = uuid::UUIDgenerate(use.time=TRUE, n=nrow(tot_sprops))\ntot_sprops$olc_id = olctools::encode_olc(tot_sprops$latitude_decimal_degrees, tot_sprops$longitude_decimal_degrees, 11)\nlength(levels(as.factor(tot_sprops$olc_id)))\n#> [1] 25075"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "quality-control-spatial-locations",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.2 Quality-control spatial locations",
    "text": "Unique locations:Remove points falling sea similar:",
    "code": "\ntot_sprops.pnts = tot_sprops[!duplicated(tot_sprops$olc_id),c(\"site_key\", \"source_db\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"site_obsdate\", \"olc_id\", \"project_url\", \"citation_url\")]\ncoordinates(tot_sprops.pnts) <- ~ longitude_decimal_degrees + latitude_decimal_degrees\nproj4string(tot_sprops.pnts) <- \"+init=epsg:4326\"\nif(!exists(\"ov.sprops\")){\n  #mask = terra::rast(\"./layers1km/lcv_landmask_esacci.lc.l4_c_1km_s0..0cm_2000..2015_v1.0.tif\")\n  mask = terra::rast(\"/mnt/diskstation/data/LandGIS/layers250m/lcv_landmask_esacci.lc.l4_c_250m_s0..0cm_2000..2015_v1.0.tif\")\n  ov.sprops <- terra::extract(mask, terra::vect(tot_sprops.pnts))\n  summary(as.factor(ov.sprops[,2]))\n  if(sum(is.na(ov.sprops[,2]))>0 | sum(ov.sprops[,2]==2)>0){\n    rem.lst = which(is.na(ov.sprops[,2]) | ov.sprops[,2]==2 | ov.sprops[,2]==4)\n    rem.sp = tot_sprops.pnts$site_key[rem.lst]\n    tot_sprops.pnts = tot_sprops.pnts[-rem.lst,]\n  } else {\n    rem.sp = NA\n  }\n}\n## final number of unique spatial locations:\nnrow(tot_sprops.pnts)\n#> [1] 25075"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "clean-up",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.3 Clean-up",
    "text": "Clean typos physically impossible values:",
    "code": "\nfor(j in c(\"clay_tot_psa\", \"sand_tot_psa\", \"silt_tot_psa\", \"wpg2\", \"w6clod\", \"w10cld\", \"w3cld\", \"w15l2\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>100|tot_sprops[,j]<0, NA, tot_sprops[,j])\n}\nfor(j in c(\"ph_h2o_v\",\"ph_kcl\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>12|tot_sprops[,j]<2, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$db_od)\nfor(j in c(\"db\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>2.4|tot_sprops[,j]<0.05, NA, tot_sprops[,j])\n}\n#summary(tot_sprops$ksat_lab)\nfor(j in c(\"ksat_lab\",\"ksat_field\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j] <=0, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$oc)\nfor(j in c(\"oc_v\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]>90|tot_sprops[,j]<0, NA, tot_sprops[,j])\n}\ntot_sprops$hzn_depth = tot_sprops$hzn_top + (tot_sprops$hzn_bot-tot_sprops$hzn_top)/2\n#tot_sprops = tot_sprops[!is.na(tot_sprops$hzn_depth),]\n## texture fractions check:\nsum.tex.T = rowSums(tot_sprops[,c(\"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\")], na.rm = TRUE)\nwhich(sum.tex.T<1.2 & sum.tex.T>0)\n#>  [1]   9334   9979  12371  22431  22441  81311  81312  81313  93971 150217\nfor(i in which(sum.tex.T<1.2 & sum.tex.T>0)){\n  for(j in c(\"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\")){\n    tot_sprops[i,j] <- NA \n  }\n}"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "histogram-plots-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.4 Histogram plots",
    "text": "",
    "code": "\nlibrary(ggplot2)\n#ggplot(tot_sprops[tot_sprops$w15l2<100,], aes(x=source_db, y=w15l2)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\nggplot(tot_sprops[tot_sprops$w3cld<100,], aes(x=source_db, y=w3cld)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 68935 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=db)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 69588 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=ph_h2o_v)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 122423 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=log10(ksat_field+1))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 144683 rows containing non-finite values (stat_boxplot).\nggplot(tot_sprops, aes(x=source_db, y=log1p(ksat_lab))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n#> Warning: Removed 139595 rows containing non-finite values (stat_boxplot)."
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "convert-to-wide-format-1",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.5 Convert to wide format",
    "text": "Add layer_sequence missing since needed able convert wide\nformat:Convert long table wide table format depth gets unique column:Write soil profiles using wide format:",
    "code": "\n#summary(tot_sprops$layer_sequence)\ntot_sprops$dsiteid = paste(tot_sprops$source_db, tot_sprops$site_key, tot_sprops$site_obsdate, sep=\"_\")\nif(!exists(\"l.s1\")){\n  library(dplyr)\n  ## Note: takes >1 min\n  l.s1 <- tot_sprops[,c(\"olc_id\",\"hzn_depth\")] %>% group_by(olc_id) %>% mutate(layer_sequence.f = data.table::frank(hzn_depth, ties.method = \"first\"))\n  tot_sprops$layer_sequence.f = ifelse(is.na(tot_sprops$layer_sequence), l.s1$layer_sequence.f, tot_sprops$layer_sequence)\n  tot_sprops$layer_sequence.f = ifelse(tot_sprops$layer_sequence.f>6, 6, tot_sprops$layer_sequence.f)\n}\nif(!exists(\"tot_sprops.w\")){\n  library(data.table)\n  hor.names.s = c(\"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"db\", \"w6clod\", \"w3cld\", \"w15l2\", \"adod\", \"wrd_ws13\", \"tex_psda\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc_v\", \"ph_kcl\", \"ph_h2o_v\", \"cec_sum\", \"cec_nh4\", \"wpg2\", \"ksat_lab\", \"ksat_field\", \"uuid\")\n  tot_sprops.w = data.table::dcast( as.data.table(tot_sprops), \n                formula = olc_id ~ layer_sequence.f, \n                value.var = hor.names.s, \n                fun=function(x){ x[1] },\n                verbose = FALSE)\n}\ntot_sprops_w.pnts = tot_sprops.pnts\ntot_sprops_w.pnts@data = plyr::join(tot_sprops.pnts@data, tot_sprops.w)\n#> Joining by: olc_id\nsel.rm.pnts  <- tot_sprops_w.pnts$site_key %in% rem.sp\nunlink(\"./out/gpkg/sol_hydro.pnts_horizons.gpkg\")\nwriteOGR(tot_sprops_w.pnts[!sel.rm.pnts,], \"./out/gpkg/sol_hydro.pnts_horizons.gpkg\", \"sol_hydro.pnts_horizons\", drive=\"GPKG\")"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "ksat-dataset",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.6 Ksat dataset:",
    "text": "",
    "code": "\nsel.compl = !is.na(tot_sprops$longitude_decimal_degrees) & !is.na(tot_sprops$w3cld) & !is.na(tot_sprops$ph_h2o_v) & !is.na(tot_sprops$clay_tot_psa) & !is.na(tot_sprops$oc_v)\nsummary(sel.compl)\n#>    Mode   FALSE    TRUE \n#> logical  131042   24752\n## complete ksat_field points\ntot_sprops.pnts.C = tot_sprops[!is.na(tot_sprops$longitude_decimal_degrees) & !is.na(tot_sprops$latitude_decimal_degrees) & (!is.na(tot_sprops$ksat_lab) | !is.na(tot_sprops$ksat_field)) & !tot_sprops$source_db == \"SIMULATED\",]\nsum.NA = sapply(tot_sprops.pnts.C, function(i){sum(is.na(i))})\ntot_sprops.pnts.C = tot_sprops.pnts.C[,!sum.NA==nrow(tot_sprops.pnts.C)]\ntot_sprops.pnts.C$w10cld = NULL\ntot_sprops.pnts.C$w6clod = NULL\ntot_sprops.pnts.C$w15bfm = NULL\ntot_sprops.pnts.C$site_obsdate = NULL\ntot_sprops.pnts.C$confidence_degree = NULL\ntot_sprops.pnts.C$cec_sum = NULL\ntot_sprops.pnts.C$wpg2 = NULL\ntot_sprops.pnts.C$uuid = NULL\ndim(tot_sprops.pnts.C)\n#> [1] 13258    25"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "rds-files",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.4.0.7 RDS files",
    "text": "Plot Goode Homolozine projection save final objects:\n(#fig:sol_hydro.pnts_sites)Soil profiles soil samples physical hydraulic soil properties properties global compilation.\nFig. 1: Soil profiles soil samples physical hydraulic soil properties properties global compilation.\n(#fig:sol_ksat.pnts_sites)Soil profiles soil samples Ksat measurements global compilation\nFig. 2: Soil profiles soil samples Ksat measurements global compilation.",
    "code": "\nif(!file.exists(\"./img/sol_hydro.pnts_sites.png\")){\n  tot_sprops.pnts_sf <- st_as_sf(tot_sprops.pnts[1])\n  plot_gh(tot_sprops.pnts_sf, out.pdf=\"./img/sol_hydro.pnts_sites.pdf\")\n  system(\"pdftoppm ./img/sol_hydro.pnts_sites.pdf ./img/sol_hydro.pnts_sites -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_hydro.pnts_sites.png ./img/sol_hydro.pnts_sites.png\")\n}\nif(!file.exists(\"./img/sol_ksat.pnts_sites.png\")){\n  sel.ks = which(tot_sprops.pnts$location_id %in% tot_sprops.pnts.C$location_id)\n  tot_spropsC.pnts_sf <- st_as_sf(tot_sprops.pnts[sel.ks, 1])\n  plot_gh(tot_spropsC.pnts_sf, out.pdf=\"./img/sol_ksat.pnts_sites.pdf\")\n  system(\"pdftoppm ./img/sol_ksat.pnts_sites.pdf ./img/sol_ksat.pnts_sites -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_ksat.pnts_sites.png ./img/sol_ksat.pnts_sites.png\")\n}"
  },
  {
    "path": "soil-physical-and-hydrological-properties.html",
    "id": "alt-text-overlay-www.openlandmap.org-layers",
    "chapter": "6 Soil physical and hydrological properties",
    "heading": "6.5  Overlay www.OpenLandMap.org layers",
    "text": "Load tiling system (1 degree grid representing global land mask) run spatial overlay parallel:Save final analysis-ready objects:Save temp object:",
    "code": "\nif(!exists(\"rm.sol\")){\n  tile.pol = readOGR(\"./tiles/global_tiling_100km_grid.gpkg\")\n  #length(tile.pol)\n  ov.sol <- extract.tiled(obj=tot_sprops.pnts, tile.pol=tile.pol, path=\"/data/tt/LandGIS/grid250m\", ID=\"ID\", cpus=64)\n  ## Valid predictors:\n  pr.vars = unique(unlist(sapply(c(\"fapar\", \"landsat\", \"lc100\", \"mod09a1\", \"mod11a2\", \"alos.palsar\", \"sm2rain\", \"irradiation_solar.atlas\", \"usgs.ecotapestry\", \"floodmap.500y\", \"bioclim\", \"water.table.depth_deltares\", \"snow.prob_esacci\", \"water.vapor_nasa.eo\", \"wind.speed_terraclimate\", \"merit.dem_m\", \"merit.hydro_m\", \"cloud.fraction_earthenv\", \"water.occurance_jrc\", \"wetlands.cw_upmc\", \"pb2002\"), function(i){names(ov.sol)[grep(i, names(ov.sol))]})))\n  str(pr.vars)\n  ## 349\n  #saveRDS.gz(ov.sol, \"/mnt/diskstation/data/Soil_points/ov.sol_hydro.pnts_horizons.rds\")\n  #ov.sol <- readRDS.gz(\"/mnt/diskstation/data/Soil_points/ov.sol_hydro.pnts_horizons.rds\")\n  ## Final regression matrix:\n  rm.sol = plyr::join(tot_sprops, ov.sol[,c(\"olc_id\", pr.vars)])\n  ## check that there are no duplicates\n  sum(duplicated(rm.sol$uuid))\n  rm.ksat = rm.sol[(!is.na(rm.sol$ksat_lab) | !is.na(rm.sol$ksat_field)),]\n}\ndim(rm.sol)\nsaveRDS.gz(tot_sprops, \"./out/rds/sol_hydro.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops.pnts, \"/mnt/diskstation/data/Soil_points/sol_hydro.pnts_sites.rds\")\n## reorder columns\ntot_sprops.pnts.C$ID = 1:nrow(tot_sprops.pnts.C)\ntot_sprops.pnts.C = tot_sprops.pnts.C[,c(which(names(tot_sprops.pnts.C)==\"ID\"), which(!names(tot_sprops.pnts.C)==\"ID\"))]\nsaveRDS.gz(tot_sprops.pnts.C, \"./out/rds/sol_ksat.pnts_horizons.rds\")\n#library(farff)\n#writeARFF(tot_sprops, \"./out/arff/sol_hydro.pnts_horizons.arff\", overwrite = TRUE)\n#writeARFF(tot_sprops.pnts.C, \"./out/arff/sol_ksat.pnts_horizons.arff\", overwrite = TRUE)\n## compressed CSV\nwrite.csv(tot_sprops, file=gzfile(\"./out/csv/sol_hydro.pnts_horizons.csv.gz\"))\nwrite.csv(tot_sprops.pnts.C, file=gzfile(\"./out/csv/sol_ksat.pnts_horizons.csv.gz\"), row.names = FALSE)\nsaveRDS.gz(rm.sol, \"./out/rds/sol_hydro.pnts_horizons_rm.rds\")\nsaveRDS.gz(rm.ksat, \"./out/rds/sol_ksat.pnts_horizons_rm.rds\")\n#rm(rm.sol); gc()\nsave.image.pigz(file=\"soilhydro.RData\")\n## rmarkdown::render(\"Index.rmd\")"
  },
  {
    "path": "wrb-soil-types.html",
    "id": "wrb-soil-types",
    "chapter": "7 WRB soil types",
    "heading": "7 WRB soil types",
    "text": "reading work--progress Open Compendium Soil Sample Soil Profile Datasets. chapter currently draft version, peer-review publication pending. can find polished first edition https://opengeohub.github.io/SoilSamples/.",
    "code": ""
  },
  {
    "path": "wrb-soil-types.html",
    "id": "overview-2",
    "chapter": "7 WRB soil types",
    "heading": "7.1 Overview",
    "text": "section describes import steps used produce global compilation \nFAO’s IUSS’s World Reference Base (WRB) observations soil types.\nClasses either used -translated local international system.\nCorrelation tables available folder ./correlation based \nvarious literature sources. Correlation trivial often 1:1 \ntypically use 2–3 options translating soil types (Krasilnikov, Arnold, Marti, & Shoba, 2009). Output compilations \navailable folder ./.\nPlease refer dataset version / DOI ensure full reproducibility modeling.dataset currently used produce soil type maps world\nvarious spatial resolutions. add new dataset please open new issue merge request.",
    "code": ""
  },
  {
    "path": "wrb-soil-types.html",
    "id": "wosis-point-datasets",
    "chapter": "7 WRB soil types",
    "heading": "7.2 WoSIS point datasets",
    "text": "currently several global datasets reference distribution WRB\nclasses. building training points predictive soil type mapping \ncomprehensive dataset seems World Soil Information Service (WoSIS) soil profile database (available via:\nhttps://www.isric.org/explore/wosis) (Batjes, Ribeiro, & Van Oostrum, 2020).can download --date snapshot --date WOSIS Geopackage file directly\nusing ISRIC’s Web Feature Service.\nexample snapshot downloaded 10-April-2023:WRB soil types can generate combining multiple columns:finally gives 30,000 soil points soil classification:can write summary distribution soil types using:clean-, can prepare harmonized legend now consistently\nWRB soil types level great-group + prefix soil points\nlocation accuracy worse 1 km:can now considered analysis-ready point dataset h_wrb4 \nharmonized value soil type:",
    "code": "\nwosis = sf::read_sf(\"/mnt/landmark/HWSDv2/wosis_latest_profiles.gpkg\")\nsummary(as.factor(wosis$cwrb_version))\nwosis$wrb4 = paste0(ifelse(is.na(wosis$cwrb_prefix_qualifier), \"\", paste0(wosis$cwrb_prefix_qualifier, \" \")), wosis$cwrb_reference_soil_group, ifelse(is.na(wosis$cwrb_suffix_qualifier), \"\", paste0(\" \", wosis$cwrb_suffix_qualifier)))\nsummary(as.factor(wosis$wrb4), maxsum=20)\nwosis.wrb = wosis[!wosis$wrb4==\"NA\", c(\"profile_id\", \"geom_accuracy\", \"latitude\", \"longitude\", \"wrb4\", \"dataset_id\")]\nstr(wosis.wrb)\n#plot(wosis.wrb[,c(\"longitude\",\"latitude\")])\nxs0 = summary(as.factor(wosis.wrb$wrb4), maxsum = length(levels(as.factor(wosis.wrb$wrb4))))\nwrite.csv(data.frame(WRB=attr(xs0, \"names\"), count=xs0), \"./correlation/wosis.wrb_summary.csv\")\nh.wosis = read.csv(\"./correlation/WOSIS_WRB_legend.csv\")\nh.wosis$wrb4 = h.wosis$WRB\nwosis.wrb$h_wrb4 = plyr::join(as.data.frame(wosis.wrb[\"wrb4\"]), h.wosis)$h_wrb4\n## copy values\nwosis.wrb2 = wosis.wrb\nwosis.wrb2$h_wrb4 = plyr::join(as.data.frame(wosis.wrb2[\"wrb4\"]), h.wosis)$h_wrb4.2\n#summary(as.factor(wosis.wrb$h_wrb4))\n#str(levels(as.factor(wosis.wrb$h_wrb4)))\n## remove points with poor location accuracy\nh.wosis.wrb = rbind(\n     as.data.frame(wosis.wrb[!(is.na(wosis.wrb$h_wrb4)|wosis.wrb$h_wrb4==\"\"|wosis.wrb$geom_accuracy>0.08334),]), \n     as.data.frame(wosis.wrb2[!(is.na(wosis.wrb2$h_wrb4)|wosis.wrb2$h_wrb4==\"\"|wosis.wrb2$geom_accuracy>0.08334),]))\nh.wosis.wrb$source_db = h.wosis.wrb$dataset_id\ndim(h.wosis.wrb)\nsaveRDS.gz(h.wosis.wrb, \"./correlation/h.wosis.wrb.rds\")\nh.wosis.wrb = readRDS(\"./correlation/h.wosis.wrb.rds\")\nhead(h.wosis.wrb)\n#>   profile_id geom_accuracy latitude longitude      wrb4\n#> 1      47431      0.000100   6.5875    2.1525  Planosol\n#> 2      47478      0.010000   6.5875    2.1900  Planosol\n#> 3      47503      0.000100   6.5875    2.2262  Planosol\n#> 4      47596      0.000100   6.8733    2.3458   Acrisol\n#> 5      52678      0.000278   1.0700   34.9000  Vertisol\n#> 6      52686      0.000278   0.9400   34.9500 Ferralsol\n#>                   dataset_id                  geom           h_wrb4\n#> 1  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.1525 6.5875) Eutric Planosols\n#> 2  {AF-AfSP,BJSOTER,WD-WISE}   POINT (2.19 6.5875) Eutric Planosols\n#> 3  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.2262 6.5875) Eutric Planosols\n#> 4  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.3458 6.8733)  Haplic Acrisols\n#> 5 {AF-AfSP,KE-SOTER,WD-WISE}     POINT (34.9 1.07) Haplic Vertisols\n#> 6 {AF-AfSP,KE-SOTER,WD-WISE}    POINT (34.95 0.94) Geric Ferralsols\n#>                    source_db\n#> 1  {AF-AfSP,BJSOTER,WD-WISE}\n#> 2  {AF-AfSP,BJSOTER,WD-WISE}\n#> 3  {AF-AfSP,BJSOTER,WD-WISE}\n#> 4  {AF-AfSP,BJSOTER,WD-WISE}\n#> 5 {AF-AfSP,KE-SOTER,WD-WISE}\n#> 6 {AF-AfSP,KE-SOTER,WD-WISE}"
  },
  {
    "path": "wrb-soil-types.html",
    "id": "hwsdv2",
    "chapter": "7 WRB soil types",
    "heading": "7.3 HWSDv2",
    "text": "disadvantage using legacy soil profiles, however, often\nspatially clustered .e. large gaps exists almost data available. applies especially\nAfrican Asian continents. increase spatial coverage training points \nglobal soil type mapping, can add points generated global soil polygon map\ne.g. Harmonized World Soil Database (HWSD) (FAO & IIASA, 2023).\ncan done three steps: first, prepare summary WRB soil types HWSDv2:./correlation/hwsd2_summary.csv table now shows frequent soil types\nworld based HWSDv2. Note, primarily expert-based \nunknown uncertainty / confidence, used caution, unlike WoSIS \nlegacy soil profiles based actual soil observations fieldwork.Second, can prepare raster layer can use randomly draw training points\nusing probability sampling e.g. Simple Random Sampling.\nwant draw samples equal area space, good idea convert \noriginal HWSD raster IGH projection:Now can sample random points projected raster using terra package functionality (Hijmans, 2019).\ngenerate 100,000 random points, although principle can later subset points much less\npoints needed.can harmonize values using correlation legend:now also harmonized column h_wrb4 compatible column produced\nusing WoSIS points:summary prepared two point datasets WoSIS HSWDv2.\nWoSIS actual observations soil types considered ground-truth.\nHWSDv2 contains WRB 2022 version soil types per mapping unit, \npotentially variable accuracy used fill gaps training data.\nmanually adjust harmonize classes either outdated (old WRB versions)\nmissing prefix / suffix.many point datasets WRB classification compatible classification\nadded list training points. list recent\ndatasets soil types import add WoSIS produce --date\ncompilation soil training data.",
    "code": "\nhwsd <- mdb.get(\"/mnt/landmark/HWSDv2/HWSD2.mdb\")\n#str(hwsd)\nwrb.leg = hwsd$D_WRB4\n#str(wrb.leg)\nwrb.leg$WRB4 = wrb.leg$CODE\nlayer = hwsd$HWSD2_LAYERS[,c(\"HWSD2.SMU.ID\", \"WRB4\")]\nlayer$VALUE = plyr::join(layer, wrb.leg[c(\"VALUE\",\"WRB4\")], match=\"first\")$VALUE\nxs = summary(as.factor(layer$VALUE), maxsum = nrow(wrb.leg))\nwrite.csv(data.frame(WRB4=attr(xs, \"names\"), count=xs), \"./correlation/hwsd2_summary.csv\")\nrgdal::GDALinfo(\"/mnt/landmark/HWSDv2/HWSD2.bil\")\n## 1km resolution\nte = c(-20037508,-6728980, 20037508, 8421750)\ngh.prj = \"+proj=igh +ellps=WGS84 +units=m +no_defs\"\nsystem(paste0('gdalwarp /mnt/landmark/HWSDv2/HWSD2.bil /mnt/landmark/HWSDv2/HWSD2_gh_1km.tif -r \\\"near\\\" \n      --config CHECK_WITH_INVERT_PROJ TRUE -t_srs \\\"', gh.prj, \n      '\\\" -co \\\"COMPRESS=DEFLATE\\\" -tr 1000 1000 -overwrite -te ', \n      paste(te, collapse = \" \")))\nrnd.hwsd = terra::spatSample(terra::rast(\"/mnt/landmark/HWSDv2/HWSD2_gh_1km.tif\"), \n                             size=1e5, method=\"random\", na.rm=TRUE, xy=TRUE)\n## merge and make WRB4 layer\nnames(rnd.hwsd)[3] = \"HWSD2.SMU.ID\"\nrnd.hwsd$WRB4 = plyr::join(rnd.hwsd, layer[c(\"HWSD2.SMU.ID\",\"VALUE\")], match=\"first\")$VALUE\nrnd.sf = sf::st_as_sf(rnd.hwsd, coords = c(1,2), crs=gh.prj)\nrnd.ll <- rnd.sf %>% sf::st_transform(4326)\nunlink(\"./correlation/sim_hwsdv2_pnts.gpkg\")\nsf::write_sf(rnd.ll, \"./correlation/sim_hwsdv2_pnts.gpkg\", driver = \"GPKG\")\nsaveRDS(rnd.ll, \"./correlation/sim_hwsdv2_pnts.rds\")\nrnd.ll = readRDS(\"./correlation/sim_hwsdv2_pnts.rds\")\nh.hwsd = read.csv(\"./correlation/HWSDv2_WRB_legend.csv\")\nhwsd.wrb = as.data.frame(cbind(rnd.ll, sf::st_coordinates(rnd.ll)))\nhwsd.wrb = plyr::rename(hwsd.wrb, c(\"X\"=\"longitude\", \"Y\"=\"latitude\"))\nhwsd.wrb$h_wrb4 = plyr::join(hwsd.wrb, h.hwsd)$h_wrb4\n#> Joining by: WRB4\nhwsd.wrb$source_db = \"HWSDv2\"\nhwsd.wrb$profile_id = paste0(\"SIM\", 1:nrow(hwsd.wrb))\n## subset to complete points\nhwsd.wrb = hwsd.wrb[!is.na(hwsd.wrb$WRB4),]\nhead(hwsd.wrb)\n#>   HWSD2.SMU.ID               WRB4  longitude latitude\n#> 1         1467    Ferric Lixisols   8.290244 13.93512\n#> 2        11321         Anthrosols  82.118452 41.73180\n#> 3        26612 Calcaric Cambisols  33.212770 15.03106\n#> 4        16664   Eutric Cambisols  38.366071 10.60237\n#> 5         3387    Cambic Cryosols -64.448944 55.92456\n#> 6        11805    Haplic Acrisols 118.358546 25.82881\n#>                     geometry             h_wrb4 source_db profile_id\n#> 1  POINT (8.290244 13.93512)    Ferric Lixisols    HWSDv2       SIM1\n#> 2   POINT (82.11845 41.7318)               <NA>    HWSDv2       SIM2\n#> 3  POINT (33.21277 15.03106) Calcaric Cambisols    HWSDv2       SIM3\n#> 4  POINT (38.36607 10.60237)   Eutric Cambisols    HWSDv2       SIM4\n#> 5 POINT (-64.44894 55.92456)    Cambic Cryosols    HWSDv2       SIM5\n#> 6  POINT (118.3585 25.82881)    Haplic Acrisols    HWSDv2       SIM6"
  },
  {
    "path": "wrb-soil-types.html",
    "id": "additional-point-datasets-with-wrb-classes",
    "chapter": "7 WRB soil types",
    "heading": "7.4 Additional point datasets with WRB classes",
    "text": "addition WoSIS HWSDv2, can also add additional point datasets\nyet included global compilation potentially contain ground-truth\nobservations soil types.\nexample, can use point observations coming land-surface observations e.g. \nrepresent shifting sand bare-rock areas. example, global land cover validation data\nsets produced photo-interpretation high resolution satellite imagery\n(e.g. 20 cm spatial resolution) often contain useful observations shifting sand,\npermanent ice bare-rocks (Tsendbazar et al., 2021). specific surface materials\noften missing systematically -represented legacy soil profile datasets.\nexample almost 6000 observations bare rock shifting sands:Note define Shifting sands additional category soil type \narbitrarily either masked (controversially) classified different soil types.\nconsider consistent map shifting sands separate category land.Another dataset interesting soil type mapping legacy soil observations\nfocused tropical peatlands, published literature, digitized manually (Gumbricht et al., 2017; Hengl, 2016):Peatlands inaccessible tropical soil types often -represented hence \ndataset helps reduce bias -representing tropical soils.Croatian soil profile database also contains soil types still FAO\nclassification system (Antonić, Pernar, & Jelaska, 2003):Legacy soil observations Italy (Righini, Costantini, & Sulli, 2001; Vecchio, Barberis, & Bourlot, 2002):German agricultural soil inventory dataset (Poeplau et al., 2020):French RMQS soil profile monitoring dataset (Saby et al., 2020):",
    "code": "\nlc.xy = readRDS(\"./correlation/photointerpretation_leptosol.rds\")\nsummary(as.factor(lc.xy$h_wrb4))\n#> Lithic Leptosols   Shifting sands \n#>             3928             2156\npeat.xy = read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR_v1.csv\", na.strings = c(\"\", \"NA\"))\npeat.xy = plyr::rename(peat.xy, c(\"TAXNWRB\"=\"h_wrb4\", \"modelling.x\"=\"longitude\", \"modelling.y\"=\"latitude\", \"SOURCEID\"=\"profile_id\"))\npeat.xy$source_db = \"CIFOR_peatlands\"\npeat.xy = peat.xy[!is.na(peat.xy$longitude) & !is.na(peat.xy$h_wrb4), c(\"profile_id\", \"source_db\",\"longitude\", \"latitude\", \"h_wrb4\")]\nhr.xy = readRDS(\"./correlation/hrspdb_pnts.rds\")\nhr.xy2 = hr.xy[,-which(names(hr.xy) == \"h_wrb4\")]\nhr.xy2 = plyr::rename(hr.xy2, c(\"h_wrb4.2\"=\"h_wrb4\"))\nit.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Italy.rds\")\nit.xy = plyr::rename(it.xy, c(\"wrb2015\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"long\"=\"longitude\"))\nit.xy$source_db = \"Italian_SPDB\"\nde.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Germany.rds\")\nde.xy = plyr::rename(de.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"PointID\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nde.xy$Specific.soil.subtype = NULL\nde.xy$source_db = \"BZE_LW\"\nde.xy2 = de.xy[,-which(names(de.xy) == \"h_wrb4\")]\nde.xy2 = plyr::rename(de.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))\nfr.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_France.rds\")\nfr.xy = plyr::rename(fr.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nfr.xy$signific_ger_95 = NULL\nfr.xy$source_db = \"RMQS1\"\nfr.xy2 = fr.xy[,-which(names(fr.xy) == \"h_wrb4\")]\nfr.xy2 = plyr::rename(fr.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))"
  },
  {
    "path": "wrb-soil-types.html",
    "id": "final-compilation-of-analysis-ready-points",
    "chapter": "7 WRB soil types",
    "heading": "7.5 Final compilation of analysis-ready points",
    "text": "Multiple imported point datasets can finally combined single global\nconsistent analysis-ready training dataset (limit max 20,000 simulated points):can clean-systematic naming issues common many soil DBs:gives total 70,000 training points WRB soil type. Note correlation\ndifferent national systems trivial hence always check\nfolder ./correlation see soil types possibly incorrectly\ncorrelated. Also, IUSS FAO kind maintain World Reference Base (WRB),\ntable correlating various versions WRB often trivial \nsomewhat improvise (ignore issue) soil types changed time.\n(#fig:sol_wrb.pnts_profiles)global compilation soil profiles WRB soil type classification.\n\n(#fig:sol_wrb.pnts_tot.profiles)global compilation soil profiles WRB soil type classification: subset actual soil profiles.\ncan export final training points Geopackage file using e.g.:",
    "code": "\nsel.cn = c(\"profile_id\",\"latitude\", \"longitude\", \"h_wrb4\", \"source_db\")\ntr.pnts = plyr::rbind.fill(list(h.wosis.wrb[, sel.cn], \n      hwsd.wrb[sample.int(2e4, n = nrow(hwsd.wrb)), sel.cn],\n      lc.xy, hr.xy2[, sel.cn], \n      peat.xy[, sel.cn],\n      hr.xy[, sel.cn],\n      it.xy[, sel.cn], de.xy[, sel.cn], de.xy2[, sel.cn], \n      fr.xy[, sel.cn], fr.xy2[, sel.cn]))\ntr.pnts$h_wrb4 = gsub(\",\", \" \", tr.pnts$h_wrb4)\ntr.pnts$h_wrb4 = gsub(\"distric\", \"dystric\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol \", \"sols \", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol$\", \"sols\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = ifelse(tr.pnts$h_wrb4==\"\", NA, tr.pnts$h_wrb4)\n## subset to complete points:\ntr.pnts = tr.pnts[!is.na(tr.pnts$h_wrb4)&!is.na(tr.pnts$longitude),]\nwrb.pnts_profiles_sf <- sf::st_as_sf(tr.pnts, coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_profiles.png\")){\n  plot_gh(wrb.pnts_profiles_sf, out.pdf=\"./img/sol_wrb.pnts_profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_profiles.pdf ./img/sol_wrb.pnts_profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_profiles.png ./img/sol_wrb.pnts_profiles.png\")\n}\nwrb.pnts_profilesL_sf <- sf::st_as_sf(tr.pnts[!(tr.pnts$source_db %in% c(\"HWSDv2\", \"GlobalLCV\")),], coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_tot.profiles.png\")){\n  plot_gh(wrb.pnts_profilesL_sf, out.pdf=\"./img/sol_wrb.pnts_tot.profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_tot.profiles.pdf ./img/sol_wrb.pnts_tot.profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_tot.profiles.png ./img/sol_wrb.pnts_tot.profiles.png\")\n}\nsf::write_sf(sf::st_as_sf(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \n                          coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\"), \n      paste0(\"./out/gpkg/sol_wrb.pnts_profiles.gpkg\"), driver = \"GPKG\")\nsaveRDS(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \"./out/rds/sol_wrb.pnts_profiles.rds\")\n#save.image.pigz(file=\"soilwrb.RData\")"
  },
  {
    "path": "references.html",
    "id": "references",
    "chapter": "8 References",
    "heading": "8 References",
    "text": "",
    "code": ""
  },
  {
    "objectID": "index.html#rationale",
    "href": "index.html#rationale",
    "title": "About",
    "section": "Rationale",
    "text": "Rationale\nThis is a public compendium of global, regional, national and sub-national soil samples and/or soil profile datasets (points with Observations and Measurements of soil properties and characteristics). Datasets listed here, assuming compatible open data license, are afterwards imported into the Global compilation of soil chemical and physical properties and soil classes and eventually used to create a better open soil information across countries. The specific objectives of this initiative are:\n\nTo enable data digitization, import and binding + harmonization,\n\nTo accelerate research collaboration and networking,\n\nTo enable development of more accurate / more usable global and regional soil property and class maps (typically published via https://OpenLandMap.org),",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#download-compiled-data",
    "href": "index.html#download-compiled-data",
    "title": "About",
    "section": "",
    "text": "Compiled data (imported, standardized, quality-controlled) is available through a diversity of standard formats:\n\nRDS file (native R data format);\nGPKG file (Geopackage file ready to be opened in QGIS);\n\nAll files can be downloaded from the /out directory.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#add-your-own-data",
    "href": "index.html#add-your-own-data",
    "title": "About",
    "section": "",
    "text": "The minimum requirements to submit a dataset for inclusion to the OpenLandMap repository are:\n\nLicense and terms of use clearly specified AND,\n\nComplete and consistent metadata that can ensure correct standardization and harmonization steps AND,\n\nAt least 50 unique spatial locations AND,\n\nNo broken or invalid URLs,\n\nData sets that do NOT satisfy the above listed minimum requirements might be removed. If you discover an issue with license, data description or version number of a dataset, please open a Github issue.\n\n\n\n\n\nSoil profiles and soil samples with chemical and physical properties global compilation preview.\n\n\n\n\nRecommended settings for all datasets are:\n\nPeer-reviewed versions of the datasets (i.e. a dataset accompanied with a peer-reviewed publication) should have the priority,\n\nRegister your dataset (use e.g. https://zenodo.org) and assign a DOI to each version,\n\nProvide enough metadata so that it can be imported and bind with other data without errors,\n\nIf your dataset is a compilation of previously published datasets, please indicate in the description,\n\nInformation outdated or missing? Please open an issue or best do a correction and then a pull request.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#existing-soil-data-projects-and-initiatives",
    "href": "index.html#existing-soil-data-projects-and-initiatives",
    "title": "About",
    "section": "",
    "text": "Multiple international organizations from FAO’s Global Soil Partnership to UNCCD’s Land Degredation Neutrality, European Commission and similar, support soil data collation projects and especially curation of the legacy soil data. Some existing soil Observations and Measurements (O&M) soil data initiatives include:\n\nFAO’s Data Hub,\n\nFAO’s Global SoilInformation System (GLOSIS),\n\nFine Root Ecology Database (FRED),\n\nFLUXNET global network,\n\nGlobal database of soil nematodes,\n\nGlobal soil macrofauna database,\n\nGlobal soil respiration database (SRDB),\n\nInternational Soil Modeling Consortium (ISMC),\n\nInternational Soil Moisture Network,\n\nInternational Soil Radiocarbon Database (ISRaD),\n\nInternational Soil Carbon Network (ISCN),\n\nLandPKS project,\n\nLong Term Ecological Research (LTER) Network sites,\n\nNational Ecological Observatory Network (NEON),\n\nOpen Soil Spectral Library (OSSL),\n\nOpen Bodem Index,\n\nORNL DAAC theme soil,\n\nSoils Data Harmonization (SoDaH),\n\nWoSIS Soil Profile Database,\n\nUN’s FAO hosts International Network of Soil Information Institutions, which we recommend joining and actively contributing. INSII and FAO’s Global Soil Partnership aim at developing and hosting Global SoilInformation System (GLOSIS), although this does not serve yet any soil observations and measurements.\nA more in-depth inventory of all various national and international soil datasets can be found in:\n\nRossiter, D.G.,: Compendium of Soil Geographical Databases",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#target-soil-variables",
    "href": "index.html#target-soil-variables",
    "title": "About",
    "section": "",
    "text": "Soil variables of interest include:\n\nChemical soil properties:\n\n\nSoil organic carbon, total carbon, total nitrogen,\nSoil pH, effective Cation Exchange Capacity (eCEC),\nSoil sodicity (presence of a high proportion of sodium ions relative to other cations),\nMacro-nutrients: extractable — potassium (K), calcium (Ca), sodium (Na), magnesium (Mg) and similar,\nMicro-nutrients: phosphorus (P), sulfur (S), iron (Fe), zinc (Zn) and similar,\nSoil pollutants, heavy metals and similar,\nElectrical conductivity,\n\n\nPhysical soil properties:\n\n\nSoil texture and texture fractions: silt, clay and sand, stone content,\nBulk density, depth to bedrock and similar,\nHydraulic conductivity, water content — Field Capacity (FC; the amount of water held in the soil after it has been fully wetted and free drainage has stopped), Permanent Wilting Point (PWP; the soil moisture condition at which the plant could not obtain water and would wilt and die), Plant Available Water Capacity (PAWC; the amount of water between field capacity and permanent wilting point water holding capacity) and similar,\nSoil temperature,\n\n\nSoil biological / biodiversity variables:\n\n\nSoil biomass,\nSoil micro-, meso-, macro- and mega-fauna abundance,\nSoil biodiversity indices,\n\n\nSoil classification / taxonomy variables:\n\n\nSoil type,\nSoi suitability classes, soil fertility classes,\nSoil texture classes and families,\n\n\nSoil absorbances / soil spectroscopy variables:\n\n\nSoil absorbance in VIS-NIR and MIR part of spectra,",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#recommended-om-standards",
    "href": "index.html#recommended-om-standards",
    "title": "About",
    "section": "",
    "text": "As a general rule of thumb we recommend all contributors to use the following general scheme to organize Soil Observations & Measurements with 3–4 main tables and metadata + legends organized in other tables:\n\nSoil site information (geographical coordinates, land use / land cover, soil classification etc),\nSoil horizon information (soil observations and measurements specific to soil layers / diagnostic horizons),\nProximal soil sensing information including soil scans,\n\nFor making soil observations and measurements we recommend following the USDA National Cooperative Soil Survey (NCSS) Soil Characterization Database codes and specification as much as possible. These are explained in detail in the Kellogg Soil Survey Laboratory Methods Manual and The Field Book for Describing and Sampling Soils. Likewise, FAO Guidelines for soil description, and the FAO’s GSOC measurement, monitoring, reporting and verification (MRV) protocol also explain in detail how to collect soil samples and setup a system for monitoring soil organic carbon.\nIt is recommended that one should, as much as possible, use the international standards and references. Some highly recommended protocols and standards include:\n\nUUID generator tool to generate unique ID’s for unique soil sites, horizons, samples etc (to convert an existing local ID to UUID, best use openssl::md5(local_id)),\nOpen Location Codes to generate geographic location codes,\nOGC standards to prepare metadata and exchange data across field / computer systems;\nISO8601 to save time and date information,\nISO3166 for country / administrative codes,\nGPS and WGS84 longitude and latitude in decimal degrees to save the location information,\nInternational DOI foundation to refer to specific dataset and/or publication,\nUSDA soil classification system and World Reference Base to classify soils,\nUSDA soil texture calculator to determine and share soil texture classes including texture-by-hand,\nKellogg Soil Survey Laboratory Methods Manual for reference physical and chemical soil property determination in laboratory,\nSoils Laboratory Manual, K-State Edition,\nGLOSOLAN Standard Operating Procedures (SOPs),\n\nOpen Bodem Index specification,",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#contributing",
    "href": "index.html#contributing",
    "title": "About",
    "section": "",
    "text": "Please feel free to contribute entries. See GitHub repository for more detailed instructions.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#contributors",
    "href": "index.html#contributors",
    "title": "About",
    "section": "",
    "text": "If you contribute, add also your name and Twitter, ORCID or blog link below:\nTomislav Hengl, Jonathan Sanderman, Mario Antonio Guevara Santamaria,\nThis document is based on the https://www.bigbookofr.com/ repository by Oscar Baruffa.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#disclaimer",
    "href": "index.html#disclaimer",
    "title": "About",
    "section": "",
    "text": "The data is provided “as is”. OpenGeoHub foundation and its suppliers and licensors hereby disclaim all warranties of any kind, express or implied, including, without limitation, the warranties of merchantability, fitness for a particular purpose and non-infringement. Neither OpenGeoHub foundation nor its suppliers and licensors, makes any warranty that the Website will be error free or that access thereto will be continuous or uninterrupted. You understand that you download from, or otherwise obtain content or services through, the Website at your own discretion and risk.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#licence",
    "href": "index.html#licence",
    "title": "About",
    "section": "",
    "text": "This website/book is free to use, and is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License.\nPlease note that each input data set might have a different license than indicated above. We have done our best to track down all licenses and terms of use, however, if you think that your data set has been imported incorrectly or should not be used to produce derivative works, please contact us and we will correct asap.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#literature",
    "href": "index.html#literature",
    "title": "About",
    "section": "",
    "text": "Some other connected publications and initiatives describing collation and import of legacy soil observations and measurements that might interest you:\n\nArrouays, D., Leenaars, J. G., Richer-de-Forges, A. C., Adhikari, K., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil legacy data rescue via GlobalSoilMap and other international and national initiatives. GeoResJ, 14, 1-19.\n\nBeillouin, D., Cardinael, R., Berre, D., Boyer, A., Corbeels, M., Fallot, A., … & Demenois, J. (2021). A global overview of studies about land management, land‐use change, and climate change effects on soil organic carbon. Global Change Biology. https://doi.org/10.1111/gcb.15998 \nBatjes, N. H., Ribeiro, E., van Oostrum, A., Leenaars, J., Hengl, T., & de Jesus, J. M. (2017). WoSIS: providing standardised soil profile data for the world. Earth System Science Data, 9(1), 1. https://doi.org/10.5194/essd-9-1-2017 \nBillings, S. A., Lajtha, K., Malhotra, A., Berhe, A. A., de Graaff, M. A., Earl, S., … & Wieder, W. (2021). Soil organic carbon is not just for soil scientists: measurement recommendations for diverse practitioners. Ecological Applications, 31(3), e02290. https://doi.org/10.1002/eap.2290\n\nBrown, G., Demeterio, W. and Samuel-Rosa, A. (2021). Towards a more open Soil Science. SciELO in Perspective, 2021 [viewed 17 June 2021].\nGupta, S., Hengl, T., Lehmann, P., Bonetti, S., & Or, D. (2021). SoilKsatDB: global database of soil saturated hydraulic conductivity measurements for geoscience applications. Earth System Science Data, 13(4), 1593-1612. https://doi.org/10.5194/essd-13-1593-2021\n\nHengl, T., MacMillan, R.A., (2019). Predictive Soil Mapping with R. OpenGeoHub foundation, Wageningen, the Netherlands, 370 pages, https://soilmapper.org, ISBN: 978-0-359-30635-0.\n\nMoorberg, C. J., & Crouse, D. A. (2017). An open‐source laboratory manual for introductory, undergraduate soil science courses. Natural Sciences Education, 46(1), 1-8.\n\nRamcharan, A., Hengl, T., Beaudette, D., & Wills, S. (2017). A soil bulk density pedotransfer function based on machine learning: A case study with the NCSS soil characterization database. Soil Science Society of America Journal, 81(6), 1279-1287. https://doi.org/10.2136/sssaj2016.12.0421\nRos, G. H., Verweij, S. E., Janssen, S. J., De Haan, J., & Fujita, Y. (2022). An Open Soil Health Assessment Framework Facilitating Sustainable Soil Management. Environmental Science & Technology, 56(23), 17375-17384.\nRossiter, D.G.,: Compendium of Soil Geographical Databases.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#about-opengeohub",
    "href": "index.html#about-opengeohub",
    "title": "About",
    "section": "",
    "text": "OpenGeoHub foundation is a not-for-profit research foundation located in Wageningen, the Netherlands. We specifically promote publishing and sharing of Open Geographical and Geoscientific Data, using and developing Open Source Software and encouraging and empowering under-represented researchers e.g. those from ODA recipient countries and female researchers. We believe that the key measure of quality of research in all sciences (and especially in geographical information sciences) is in transparency and reproducibility of the computer code used to generate results (read more in: “Everyone has a right to know what is happening with the planet”).",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#acknowledgments",
    "href": "index.html#acknowledgments",
    "title": "About",
    "section": "",
    "text": "SoilSpec4GG is a USDA-funded Food and Agriculture Cyberinformatics Tools Coordinated Innovation Network NIFA Award #2020-67021-32467 project. It brings together soil scientists, soil spectroscopists, soil informaticians, data scientists and software engineers to overcome some of the current bottlenecks preventing wider and more efficient use of soil spectroscopy. For more info refer to: https://soilspectroscopy.org/\nEcoDataCube.eu project is co-financed by the European Union (CEF Telecom project 2018-EU-IA-0095).\nEarthMonitor.org project has received funding from the European Union’s Horizon Europe research an innovation programme under grant agreement No. 101059548.\nAI4SoilHealth.eu project has received funding from the European Union’s Horizon Europe research an innovation programme under grant agreement No. 101086179.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "About",
    "section": "",
    "text": "This is a public compendium of global, regional, national and sub-national soil samples and/or soil profile datasets (points with Observations and Measurements of soil properties and characteristics). Datasets listed here, assuming compatible open data license, are afterwards imported into the Global compilation of soil chemical and physical properties and soil classes and eventually used to create a better open soil information across countries. The specific objectives of this initiative are:\n\nTo enable data digitization, import and binding + harmonization,\n\nTo accelerate research collaboration and networking,\n\nTo enable development of more accurate / more usable global and regional soil property and class maps (typically published via https://OpenLandMap.org),\n\n\n\n\nCompiled data (imported, standardized, quality-controlled) is available through a diversity of standard formats:\n\nRDS file (native R data format);\nGPKG file (Geopackage file ready to be opened in QGIS);\n\nAll files can be downloaded from the /out directory.\n\n\n\nThe minimum requirements to submit a dataset for inclusion to the OpenLandMap repository are:\n\nLicense and terms of use clearly specified AND,\n\nComplete and consistent metadata that can ensure correct standardization and harmonization steps AND,\n\nAt least 50 unique spatial locations AND,\n\nNo broken or invalid URLs,\n\nData sets that do NOT satisfy the above listed minimum requirements might be removed. If you discover an issue with license, data description or version number of a dataset, please open a Github issue.\n\n\n\n\n\nSoil profiles and soil samples with chemical and physical properties global compilation preview.\n\n\n\n\nRecommended settings for all datasets are:\n\nPeer-reviewed versions of the datasets (i.e. a dataset accompanied with a peer-reviewed publication) should have the priority,\n\nRegister your dataset (use e.g. https://zenodo.org) and assign a DOI to each version,\n\nProvide enough metadata so that it can be imported and bind with other data without errors,\n\nIf your dataset is a compilation of previously published datasets, please indicate in the description,\n\nInformation outdated or missing? Please open an issue or best do a correction and then a pull request.\n\n\n\nMultiple international organizations from FAO’s Global Soil Partnership to UNCCD’s Land Degredation Neutrality, European Commission and similar, support soil data collation projects and especially curation of the legacy soil data. Some existing soil Observations and Measurements (O&M) soil data initiatives include:\n\nFAO’s Data Hub,\n\nFAO’s Global SoilInformation System (GLOSIS),\n\nFine Root Ecology Database (FRED),\n\nFLUXNET global network,\n\nGlobal database of soil nematodes,\n\nGlobal soil macrofauna database,\n\nGlobal soil respiration database (SRDB),\n\nInternational Soil Modeling Consortium (ISMC),\n\nInternational Soil Moisture Network,\n\nInternational Soil Radiocarbon Database (ISRaD),\n\nInternational Soil Carbon Network (ISCN),\n\nLandPKS project,\n\nLong Term Ecological Research (LTER) Network sites,\n\nNational Ecological Observatory Network (NEON),\n\nOpen Soil Spectral Library (OSSL),\n\nOpen Bodem Index,\n\nORNL DAAC theme soil,\n\nSoils Data Harmonization (SoDaH),\n\nWoSIS Soil Profile Database,\n\nUN’s FAO hosts International Network of Soil Information Institutions, which we recommend joining and actively contributing. INSII and FAO’s Global Soil Partnership aim at developing and hosting Global SoilInformation System (GLOSIS), although this does not serve yet any soil observations and measurements.\nA more in-depth inventory of all various national and international soil datasets can be found in:\n\nRossiter, D.G.,: Compendium of Soil Geographical Databases\n\n\n\n\n\nSoil variables of interest include:\n\nChemical soil properties:\n\n\nSoil organic carbon, total carbon, total nitrogen,\nSoil pH, effective Cation Exchange Capacity (eCEC),\nSoil sodicity (presence of a high proportion of sodium ions relative to other cations),\nMacro-nutrients: extractable — potassium (K), calcium (Ca), sodium (Na), magnesium (Mg) and similar,\nMicro-nutrients: phosphorus (P), sulfur (S), iron (Fe), zinc (Zn) and similar,\nSoil pollutants, heavy metals and similar,\nElectrical conductivity,\n\n\nPhysical soil properties:\n\n\nSoil texture and texture fractions: silt, clay and sand, stone content,\nBulk density, depth to bedrock and similar,\nHydraulic conductivity, water content — Field Capacity (FC; the amount of water held in the soil after it has been fully wetted and free drainage has stopped), Permanent Wilting Point (PWP; the soil moisture condition at which the plant could not obtain water and would wilt and die), Plant Available Water Capacity (PAWC; the amount of water between field capacity and permanent wilting point water holding capacity) and similar,\nSoil temperature,\n\n\nSoil biological / biodiversity variables:\n\n\nSoil biomass,\nSoil micro-, meso-, macro- and mega-fauna abundance,\nSoil biodiversity indices,\n\n\nSoil classification / taxonomy variables:\n\n\nSoil type,\nSoi suitability classes, soil fertility classes,\nSoil texture classes and families,\n\n\nSoil absorbances / soil spectroscopy variables:\n\n\nSoil absorbance in VIS-NIR and MIR part of spectra,\n\n\n\n\nAs a general rule of thumb we recommend all contributors to use the following general scheme to organize Soil Observations & Measurements with 3–4 main tables and metadata + legends organized in other tables:\n\nSoil site information (geographical coordinates, land use / land cover, soil classification etc),\nSoil horizon information (soil observations and measurements specific to soil layers / diagnostic horizons),\nProximal soil sensing information including soil scans,\n\nFor making soil observations and measurements we recommend following the USDA National Cooperative Soil Survey (NCSS) Soil Characterization Database codes and specification as much as possible. These are explained in detail in the Kellogg Soil Survey Laboratory Methods Manual and The Field Book for Describing and Sampling Soils. Likewise, FAO Guidelines for soil description, and the FAO’s GSOC measurement, monitoring, reporting and verification (MRV) protocol also explain in detail how to collect soil samples and setup a system for monitoring soil organic carbon.\nIt is recommended that one should, as much as possible, use the international standards and references. Some highly recommended protocols and standards include:\n\nUUID generator tool to generate unique ID’s for unique soil sites, horizons, samples etc (to convert an existing local ID to UUID, best use openssl::md5(local_id)),\nOpen Location Codes to generate geographic location codes,\nOGC standards to prepare metadata and exchange data across field / computer systems;\nISO8601 to save time and date information,\nISO3166 for country / administrative codes,\nGPS and WGS84 longitude and latitude in decimal degrees to save the location information,\nInternational DOI foundation to refer to specific dataset and/or publication,\nUSDA soil classification system and World Reference Base to classify soils,\nUSDA soil texture calculator to determine and share soil texture classes including texture-by-hand,\nKellogg Soil Survey Laboratory Methods Manual for reference physical and chemical soil property determination in laboratory,\nSoils Laboratory Manual, K-State Edition,\nGLOSOLAN Standard Operating Procedures (SOPs),\n\nOpen Bodem Index specification,\n\n\n\n\nPlease feel free to contribute entries. See GitHub repository for more detailed instructions.\n\n\n\nIf you contribute, add also your name and Twitter, ORCID or blog link below:\nTomislav Hengl, Jonathan Sanderman, Mario Antonio Guevara Santamaria,\nThis document is based on the https://www.bigbookofr.com/ repository by Oscar Baruffa.\n\n\n\nThe data is provided “as is”. OpenGeoHub foundation and its suppliers and licensors hereby disclaim all warranties of any kind, express or implied, including, without limitation, the warranties of merchantability, fitness for a particular purpose and non-infringement. Neither OpenGeoHub foundation nor its suppliers and licensors, makes any warranty that the Website will be error free or that access thereto will be continuous or uninterrupted. You understand that you download from, or otherwise obtain content or services through, the Website at your own discretion and risk.\n\n\n\n\nThis website/book is free to use, and is licensed under the Creative Commons Attribution-ShareAlike 4.0 International License.\nPlease note that each input data set might have a different license than indicated above. We have done our best to track down all licenses and terms of use, however, if you think that your data set has been imported incorrectly or should not be used to produce derivative works, please contact us and we will correct asap.\n\n\n\n\n\nTo cite this dataset please use:\n@dataset{hengl_t_2023_4748499,\n  author       = {Hengl, T. and Gupta, S. and Minarik, R.},\n  title        = {{An Open Compendium of Soil Datasets: Soil Observations and Measurements}},\n  year         = 2023,\n  publisher    = {OpenGeoHub foundation},\n  address      = {Wageningen},\n  version      = {v0.2},\n  doi          = {10.5281/zenodo.4748499},\n  url          = {https://doi.org/10.5281/zenodo.4748499}\n}\n\n\n\nSome other connected publications and initiatives describing collation and import of legacy soil observations and measurements that might interest you:\n\nArrouays, D., Leenaars, J. G., Richer-de-Forges, A. C., Adhikari, K., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil legacy data rescue via GlobalSoilMap and other international and national initiatives. GeoResJ, 14, 1-19.\n\nBeillouin, D., Cardinael, R., Berre, D., Boyer, A., Corbeels, M., Fallot, A., … & Demenois, J. (2021). A global overview of studies about land management, land‐use change, and climate change effects on soil organic carbon. Global Change Biology. https://doi.org/10.1111/gcb.15998 \nBatjes, N. H., Ribeiro, E., van Oostrum, A., Leenaars, J., Hengl, T., & de Jesus, J. M. (2017). WoSIS: providing standardised soil profile data for the world. Earth System Science Data, 9(1), 1. https://doi.org/10.5194/essd-9-1-2017 \nBillings, S. A., Lajtha, K., Malhotra, A., Berhe, A. A., de Graaff, M. A., Earl, S., … & Wieder, W. (2021). Soil organic carbon is not just for soil scientists: measurement recommendations for diverse practitioners. Ecological Applications, 31(3), e02290. https://doi.org/10.1002/eap.2290\n\nBrown, G., Demeterio, W. and Samuel-Rosa, A. (2021). Towards a more open Soil Science. SciELO in Perspective, 2021 [viewed 17 June 2021].\nGupta, S., Hengl, T., Lehmann, P., Bonetti, S., & Or, D. (2021). SoilKsatDB: global database of soil saturated hydraulic conductivity measurements for geoscience applications. Earth System Science Data, 13(4), 1593-1612. https://doi.org/10.5194/essd-13-1593-2021\n\nHengl, T., MacMillan, R.A., (2019). Predictive Soil Mapping with R. OpenGeoHub foundation, Wageningen, the Netherlands, 370 pages, https://soilmapper.org, ISBN: 978-0-359-30635-0.\n\nMoorberg, C. J., & Crouse, D. A. (2017). An open‐source laboratory manual for introductory, undergraduate soil science courses. Natural Sciences Education, 46(1), 1-8.\n\nRamcharan, A., Hengl, T., Beaudette, D., & Wills, S. (2017). A soil bulk density pedotransfer function based on machine learning: A case study with the NCSS soil characterization database. Soil Science Society of America Journal, 81(6), 1279-1287. https://doi.org/10.2136/sssaj2016.12.0421\nRos, G. H., Verweij, S. E., Janssen, S. J., De Haan, J., & Fujita, Y. (2022). An Open Soil Health Assessment Framework Facilitating Sustainable Soil Management. Environmental Science & Technology, 56(23), 17375-17384.\nRossiter, D.G.,: Compendium of Soil Geographical Databases.\n\n\n\n\n\nOpenGeoHub foundation is a not-for-profit research foundation located in Wageningen, the Netherlands. We specifically promote publishing and sharing of Open Geographical and Geoscientific Data, using and developing Open Source Software and encouraging and empowering under-represented researchers e.g. those from ODA recipient countries and female researchers. We believe that the key measure of quality of research in all sciences (and especially in geographical information sciences) is in transparency and reproducibility of the computer code used to generate results (read more in: “Everyone has a right to know what is happening with the planet”).\n\n\n\nSoilSpec4GG is a USDA-funded Food and Agriculture Cyberinformatics Tools Coordinated Innovation Network NIFA Award #2020-67021-32467 project. It brings together soil scientists, soil spectroscopists, soil informaticians, data scientists and software engineers to overcome some of the current bottlenecks preventing wider and more efficient use of soil spectroscopy. For more info refer to: https://soilspectroscopy.org/\nEcoDataCube.eu project is co-financed by the European Union (CEF Telecom project 2018-EU-IA-0095).\nEarthMonitor.org project has received funding from the European Union’s Horizon Europe research an innovation programme under grant agreement No. 101059548.\nAI4SoilHealth.eu project has received funding from the European Union’s Horizon Europe research an innovation programme under grant agreement No. 101086179.",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "index.html#how-to-cite",
    "href": "index.html#how-to-cite",
    "title": "About",
    "section": "",
    "text": "To cite this dataset please use:\n@dataset{hengl_t_2023_4748499,\n  author       = {Hengl, T. and Gupta, S. and Minarik, R.},\n  title        = {{An Open Compendium of Soil Datasets: Soil Observations and Measurements}},\n  year         = 2023,\n  publisher    = {OpenGeoHub foundation},\n  address      = {Wageningen},\n  version      = {v0.2},\n  doi          = {10.5281/zenodo.4748499},\n  url          = {https://doi.org/10.5281/zenodo.4748499}\n}",
    "crumbs": [
      "Home",
      "Data import",
      "About"
    ]
  },
  {
    "objectID": "020-dataset_list.html",
    "href": "020-dataset_list.html",
    "title": "Datasets",
    "section": "",
    "text": "Description: Originally a plant root database but also contains some soil laboratory data and soil observations.\n\n📕 Iversen CM, McCormack ML, Baer JK, Powell AS, Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli A, Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): A Global Collection of Root Trait Data with Coincident Site, Vegetation, Edaphic, and Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department of Energy, Oak Ridge, Tennessee, U.S.A.\n\n🔗 Project website: https://roots.ornl.gov/\n\n📂 Data download URL: https://doi.org/10.25581/ornlsfa.014/1459186\n\n📍 Unique locations: 280\n\n📋 Unique complete rows: 858\n\n📝 Import steps: chemsprops.FRED\n\n\n\n\nDescription: Soil Organic Carbon data from various publications. Many missing years for PREVIOUS SOC and SOIL CHARACTERISTICS.\n\n📕 Ledo, A., Hillier, J., Smith, P. et al. (2019) A global, empirical, harmonised dataset of soil organic carbon changes under perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1\n\n🔗 Project website: https://africap.info/\n\n📂 Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2\n\n📍 Unique locations: 174\n\n📋 Unique complete rows: 1526\n\n📝 Import steps: chemsprops.SOCPDB\n\n\n\n\nDescription: The database encompasses all published studies that report at least one of the following data measured in the field (not laboratory): annual soil respiration, mean seasonal soil respiration, a seasonal or annual partitioning of soil respiration into its source fluxes, soil respiration temperature response (Q10), or soil respiration at 10 degrees C.\n\n📕 Bond-Lamberty, B. and Thomson, A. (2010). A global database of soil respiration data, Biogeosciences, 7, 1915-1926, https://doi.org/10.5194/bg-7-1915-2010\n\n🔗 Project website: https://github.com/bpbond/srdb/\n\n📂 Data download URL: https://github.com/bpbond/srdb/\n\n📍 Unique locations: 826\n\n📋 Unique complete rows: 1596\n\n📝 Import steps: chemsprops.SRDB\n\n\n\n\nDescription: Contains a data base of 173 soil hydrological data (raw data) from 71 sites all over the world (Asia, Africa, Australia America and Europe). The samples were mainly collected and measured as part of research projects. The soils cover a wide range of texture classes and dry bulk densities. The data base consists of water retention and unsaturated hydraulic conductivity data.\n\n📕 Schindler, Uwe; Müller, Lothar (2015): Soil hydraulic functions of international soils measured with the Extended Evaporation Method (EEM) and the HYPROP device, Leibniz-Zentrum für Agrarlandschaftsforschung (ZALF) e.V.[doi:10.4228/ZALF.2003.273]\n\n🔗 Project website:\n\n📂 Data download URL: http://dx.doi.org/10.4228/ZALF.2003.273\n\n📍 Unique locations: 71\n\n📋 Unique complete rows: 173\n\n📝 Import steps: chemsprops.HYDROS\n\n\n\n\nDescription: ISRIC-WISE database holds selected site and horizon data for 10,250 soil profiles from 149 countries. Profile data were extracted from a wide range of sources and harmonized with respect to the original (1974) and revised (1988) Legend of the FAO-Unesco Soil Map of the World. Profiles have been described, sampled, and analyzed according to methods and standards in use in the originating countries. WISE was specifically developed for land-related applications at continental and global scales.\n\n📕 Batjes, N.H. (2009). Harmonized soil profile data for applications at global and continental scales: updates to the WISE database. Soil Use and Management 25(2):124-127. DOI:10.1111/j.1475-2743.2009.00202.x\n\n🔗 Project website: https:/isric.org\n\n📂 Data download URL: https://files.isric.org/public/wise/WD-WISE.zip\n\n📍 Unique locations: 6723\n\n📋 Unique complete rows: 23278\n\n📝 Import steps: chemsprops.WISE\n\n\n\n\nDescription: World Soil Reference Collection comprises about 800 soil profiles from over 70 countries with detailed soil profile and environmental data.\n\n📕 Batjes, N. H. (1995). A homogenized soil data file for global environmental research: A subset of FAO, ISRIC and NRCS profiles (Version 1.0) (No. 95/10b). ISRIC. / Van de Ven, T., & Tempel, P. (1994). ISIS 4.0: ISRIC Soil Information System: User Manual. ISRIC.\n\n🔗 Project website: https:/isis.isric.org\n\n📂 Data download URL: https:/isis.isric.org\n\n📍 Unique locations: 785\n\n📋 Unique complete rows: 5637\n\n📝 Import steps: hydrosprops.ISIS\n\n\n\n\nDescription: These data were assembled by the Nature Conservancy and a team of scientists from 19 institutions to quantify carbon sequestration in naturally regenerating forests around the world.\n\n📕 Cook-Patton, S. C., Leavitt, S. M., Gibbs, D., Harris, N. L., Lister, K., Anderson-Teixeira, K. J., … & Griscom, B. W. (2020). Mapping carbon accumulation potential from global natural forest regrowth. Nature, 585(7826), 545-550. https://doi.org/10.1038/s41586-020-2686-x\n\n🔗 Project website: https://github.com/forc-db/groa\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3983644\n\n📍 Unique locations: 1921\n\n📋 Unique complete rows: 1921\n\n📝 Import steps:\n\n\n\n\nDescription: A Globally Distributed Soil Spectral Library Mid Infrared Diffuse Reflectance Spectra. MIR scans for some 785 profiles from the ISRIC World Soil Reference Collection. The samples are from 58 countries spanning Africa, Asia, Europe, North America, and South America. Data available under the CC-BY 4.0 license.\n\n📕 World Agroforestry Centre, (2014). The ICRAF/ISRIC spectral library, Soil-Plant Spectral Diagnostics laboratory, United Nations Avenue, Nairobi, Kenya.\n\n🔗 Project website: https://www.worldagroforestry.org/sd/landhealth/soil-plant-spectral-diagnostics-laboratory/soil-spectra-library\n\n📂 Data download URL: https://files.isric.org/public/other/ICRAF-ISRICVNIRSoilDatabase.zip\n\n📍 Unique locations: 785\n\n📋 Unique complete rows:\n\n📝 Import steps: sslsprops.ICRAF_ISRIC\n\n\n\n\nDescription: Contains a total of 13,258 Ksat measurements from 1908 sites were assembled from the published literature.\n\n📕 Gupta, S., Hengl, T., Lehmann, P., Bonetti, S., and Or, D.: (2021) SoilKsatDB: global database of soil saturated hydraulic conductivity measurements for geoscience applications, Earth Syst. Sci. Data, 13, 1593–1612, https://doi.org/10.5194/essd-13-1593-2021.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3752721\n\n📍 Unique locations: 1908\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops\n\n\n\n\nDescription: Contains a total of 15,153 soil water characteristics curve (SWCC) measurements from 2659 sites assembled from the published literature.\n\n📕 Gupta, S., Papritz, A., Lehmann, P., Hengl, T., Bonetti, S., and Or, D., (2020): GSHP: Global soil hydraulic properties database”. Manuscript submitted to Scientific Data.\n\n🔗 Project website: https://github.com/ETHZ-repositories/GSHP-database\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.5547338\n\n📍 Unique locations: 2659\n\n📋 Unique complete rows:\n\n📝 Import steps: GSHP-database\n\n\n\n\nDescription: Data collected by various people through the LandPKS App for mobile phones (crowdsourced). Data is of limited quality and usually no laboratory data is collected and shared.\n\n📕 Herrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). The Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use and Management through Cloud Computing, Mobile Applications, and Crowdsourcing. Journal of Soil and Water Conservation, 68(1), 5A-12A.\n\n🔗 Project website: http://portal.landpotential.org\n\n📂 Data download URL: http://portal.landpotential.org/#/landpksmap\n\n📍 Unique locations: 15326\n\n📋 Unique complete rows: 41644\n\n📝 Import steps: chemsprops.LandPKS\n\n\n\n\nDescription: Point data set used to produce a global map of mangrove forest soil carbon at 30 m spatial resolution.\n\n📕 Sanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). A global map of mangrove forest soil carbon at 30 m spatial resolution. Environmental Research Letters, 13(5), 055002.\n\n🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/\n\n📂 Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT\n\n📍 Unique locations: 1568\n\n📋 Unique complete rows: 7718\n\n📝 Import steps: chemsprops.Mangroves\n\n\n\n\nDescription: Soil carbon profile data from paired land use comparisons.\n\n📕 Sanderman, J., Hengl, T., & Fiske, G. J. (2017). Soil carbon debt of 12,000 years of human land use. Proceedings of the National Academy of Sciences, 114(36), 9575-9580.\n\n🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/\n\n📂 Data download URL: https://doi.org/10.7910/DVN/QQQM8V/8MSBNI\n\n📍 Unique locations: 1604\n\n📋 Unique complete rows: 224\n\n📝 Import steps: chemsprops.RemnantSOC\n\n\n\n\nDescription: SoDaH is built on several network science efforts in the United States. It’s aim is to provide an open-access resource to facilitate and automate further harmonization and synthesis of soil carbon data.\n\n📕 Wieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: the SOils DAta Harmonization database, an open-source synthesis of soil data from research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195\n\n🔗 Project website: https://lter.github.io/som-website\n\n📂 Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4\n\n📍 Unique locations: 1052\n\n📋 Unique complete rows: 20383\n\n📝 Import steps: chemsprops.SoDaH\n\n\n\n\nDescription: A database for global soil health assessment. Only limited soil properties available.\n\n📕 Jian, J., Du, X., & Stewart, R. D. (2020). A database for global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3.\n\n🔗 Project website: https://github.com/jinshijian/SoilHealthDB\n\n📂 Data download URL: https://github.com/jinshijian/SoilHealthDB\n\n📍 Unique locations: 88\n\n📋 Unique complete rows: 120\n\n📝 Import steps: chemsprops.SoilHealthDB\n\n\n\n\nDescription: Soil textural information (clay, silt, and sand content) is available for 3842 out of 5023 infiltration measurements.\n\n📕 Rahmati, M., Weihermüller, L., Vanderborght, J., Pachepsky, Y. A., Mao, L., Sadeghi, S. H., … & Toth, B. (2018). Development and analysis of the Soil Water Infiltration Global database. Earth Syst. Sci. Data, 10, 1237–1263.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.1594/PANGAEA.885492\n\n📍 Unique locations: 88\n\n📋 Unique complete rows: 120\n\n📝 Import steps: chemsprops.SWIG\n\n\n\n\nDescription: The dataset contains measured soil water retention, hydraulic conductivity, and water diffusivity data, as well as pedological information of some 790 soil samples from around the world.\n\n📕 Nemes, Attila; Schaap, Marcel; Leij, Feike J.; Wösten, J. Henk M. (2015). UNSODA 2.0: Unsaturated Soil Hydraulic Database. Database and program for indirect methods of estimating unsaturated hydraulic properties. US Salinity Laboratory - ARS - USDA. https://doi.org/10.15482/USDA.ADC/1173246. / Børgesen, C. D., Jacobsen, O. H., Hansen, S., & Schaap, M. G. (2006). Soil hydraulic properties near saturation, an improved conductivity model. Journal of Hydrology, 324(1-4), 40-50. https://doi.org/10.1016/j.jhydrol.2005.09.014\n🔗 Project website:\n\n📂 Data download URL: Zip packages\n\n📍 Unique locations: 790\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops.UNSODA\n\n\n\n\nDescription: A global point data set with organic soil carbon and nitrogen data. Poor spatial location accuracy with error often &gt; 10 km. Bulk density for many points has been estimated not measured. Sampling year has not been but literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. Most of samples come from natural vegetation (undisturbed) areas.\n\n📕 Zinke, P. J., Millemann, R. E., & Boden, T. A. (1986). Worldwide organic soil carbon and nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory.\n\n🔗 Project website: https://cdiac.ess-dive.lbl.gov/\n\n📂 Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018\n\n📍 Unique locations: 1712\n\n📋 Unique complete rows: 3977\n\n📝 Import steps: chemsprops.ISCND\n\n\n\n\n\n\n\nDescription: A compilation of legacy soil profiles from hundreds of profiles. Produced for the purpose of the Africa Soil Information Services (AfSIS) project.\n\n📕 Leenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01.\n\n🔗 Project website: https://www.isric.org/projects/africa-soil-profiles-database-afsp\n\n📂 Data download URL: https://data.isric.org/\n\n📍 Unique locations: 15630\n\n📋 Unique complete rows: 60306\n\n📝 Import steps: chemsprops.AfSPDB\n\n\n\n\nDescription: Soil spectroscopy-based soil samples datasets. Produced by World Agroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center for International Earth Science Information Network (CIESIN), The International Center for Tropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) and Rothamsted Research (RRES) for the purpose of the Africa Soil Information Services (AfSIS) project. Many more samples have been collected in the period 2010–2018.\n\n📕 Towett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. A., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition of soils in Sub-Saharan Africa and relationship with soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002\n\n🔗 Project website: https://github.com/qedsoftware/afsis-soil-chem-tutorial\n\n📂 Data download URL: https://registry.opendata.aws/afsis/\n\n📍 Unique locations: 929\n\n📋 Unique complete rows: 4162\n\n📝 Import steps: chemsprops.AfSIS1\n\n\n\n\n\n\n\nDescription: Represents parts of Russian Federation and Canada. This data set consists of significantly higher soil organic carbon concentrations.\n\n📕 Hugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). A new data set for estimating organic carbon storage to 3 m depth in soils of the northern circumpolar permafrost region. Earth System Science Data (Online), 5(2).\n\n🔗 Project website: https://bolin.su.se/data/ncscd/\n\n📂 Data download URL: http://dx.doi.org/10.5879/ECDS/00000002\n\n📍 Unique locations: 410\n\n📋 Unique complete rows: 7104\n\n📝 Import steps: chemsprops.NCSCD\n\n\n\n\n\n\n\n\n\n\nDescription: Top-soil samples only (0–20 cm). In year 2012 additional samples were collected from Romania and Bulgaria.\n\n📕 Tóth, G., Jones, A., Montanarella, L., Alewell, C., Ballabio, C., Carre, F., … & Hermann, T. (2013). LUCAS Topsoil Survey—Methodology, Data and Results. JRC Technical Reports. Luxembourg. Publications Office of the European Union, EUR26102 – Scientific and Technical Research series – ISSN 1831-9424 (online); ISBN 978-92-79-32542-7; doi: 10.2788/97922.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n📍 Unique locations: 21272\n\n📋 Unique complete rows: 21272\n\n📝 Import steps: chemsprops.LUCAS\n\n\n\n\nDescription: Top-soil samples only (0–20 cm). This is currently the largest systematic soil sample dataset for EU.\n\n📕 Orgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernandez-Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data\n\n📍 Unique locations: 21859\n\n📋 Unique complete rows: 21859\n\n📝 Import steps: chemsprops.LUCAS\n\n\n\n\nDescription: Top-soil samples only (0–20 cm) collected in 2018. Several additional soil properties have been added.\n\n📕 Orgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernandez-Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/projects/lucas\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/projects/lucas\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Geochemical background and threshold for 53 chemical elements in European agricultural soil.\n\n📕 Reimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, A., Negrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background and threshold for 53 chemical elements in European agricultural soil. Applied Geochemistry, 88, 302-318.\n\n🔗 Project website: http://gemas.geolba.ac.at/\n\n📂 Data download URL: http://gemas.geolba.ac.at/\n\n📍 Unique locations: 4026\n\n📋 Unique complete rows: 4131\n\n📝 Import steps: chemsprops.GEMAS\n\n\n\n\n\n\n\n\n\n\nDescription: A compilation of legacy soil profiles from majority of Latin American countries.\n\n📕 Alianza Mundial por el Suelo. 2013. Sistema de Informacion de Suelos de Latinoamerica (SISLAC). https://hdl.handle.net/10568/49611\n\n🔗 Project website: http://www.sislac.org/\n\n📂 Data download URL: http://54.229.242.119/sislac/es\n\n📍 Unique locations: 14606\n\n📋 Unique complete rows: 49994\n\n📝 Import steps: chemsprops.SISLAC\n\n\n\n\nDescription: Peatland soil measurements (points) from the literature.\n\n📕 Murdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals more peat in the tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452\n\n🔗 Project website: https://www.cifor.org/\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 756\n\n📝 Import steps: chemsprops.Peatlands\n\n\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset. Compiled from various projects.\n\n📕 CSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004.\n\n🔗 Project website: https://www.csiro.au/en/Do-business/Services/Enviro/Soil-archive\n\n📂 Data download URL: https://doi.org/10.25919/5eeb2a56eac12\n\n📍 Unique locations: 13826\n\n📋 Unique complete rows: 70791\n\n📝 Import steps: chemsprops.NatSoil\n\n\n\n\n\n\n\nDescription: Legacy soil profile dataset for Flemish Region.\n\n📕 Beckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. / Ottoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles for assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001\n\n🔗 Project website: https://www.dov.vlaanderen.be\n\n📂 Data download URL: https://www.dov.vlaanderen.be\n\n📍 Unique locations: 6877\n📋 Unique complete rows: 41310\n📝 Import steps: chemsprops.Vlaanderen2010\n\n\n\n\n\n\n\nDescription: National compilation of representative soil profiles. This dataset has been used in FEBR. Data comes primarily from the Radam project (Projeto Radambrasil, 1973–1986).\n\n📕 Cooper, M., Mendes, L. M. S., Silva, W. L. C., & Sparovek, G. (2005). A national soil profile database for Brazil available to international scientists. Soil Science Society of America Journal, 69(3), 649-652. https://doi.org/10.2136/sssaj2004.0140 / Benedetti, M. M., Curi, N., Sparovek, G., Carvalho Filho, A., & Silva, S. H. G. (2011). Updated Brazilian’s georeferenced soil database-an improvement for international scientific information exchanging. Embrapa, 1, 309-332.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 5086\n\n📋 Unique complete rows: 10,034\n\n📝 Import steps:\n\n\n\n\nDescription: Compilation of SS data from various projects.\n\n📕 Demattê, J. A., Dotto, A. C., Paiva, A. F., Sato, M. V., Dalmolin, R. S., Maria do Socorro, B., … & do Couto, H. T. Z. (2019). The Brazilian Soil Spectral Library (BSSL): A general view, application and challenges. Geoderma, 354, 113793. https://doi.org/10.1016/j.geoderma.2019.05.043\n\n🔗 Project website: https://bibliotecaespectral.wixsite.com/english\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 50,662\n\n📝 Import steps:\n\n\n\n\nDescription: Soil legacy data from various projects in Brazil standardized and bind together.\n\n📕 Samuel-Rosa, A., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data in Brazil: geospatial data quality and how to improve it. Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430\n\n🔗 Project website: https://www.pedometria.org/febr/\n\n📂 Data download URL: https://www.pedometria.org/febr/\n\n📍 Unique locations: 6098\n\n📋 Unique complete rows: 7842\n\n📝 Import steps: chemsprops.FEBR\n\n\n\n\nDescription: Contains various soil samples (complete profiles, partial profiles, extra samples) from the Soil Database database (BDsolos). Spatial location accuracy is variable: where possible geographic coordinates available in the Free Brazilian Repository for Open Soil Data (FEBR) were used, otherwise locations were assigned to the center of the municipality. Data set is available publicly via the PronaSolos Platform under the CC-BY-NC license.\n\n📕 POLIDORO, J., COELHO, M., CARVALHO FILHO, A. D., LUMBRERAS, J., de OLIVEIRA, A. P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos do Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).\n\n🔗 Project website: https://geoportal.cprm.gov.br/pronasolos/\n\n📂 Data download URL: http://geoinfo.cnps.embrapa.br/documents/3013/download\n\n📍 Unique locations: 9113\n\n📋 Unique complete rows: 34,464\n\n📝 Import steps:\n\n\n\n\nDescription: Contains hydrophysical data for Brazilian soils that seeks to consolidate water retention and saturated hydraulic conductivity data together with basic soil features and the methods of determination of these hydraulic properties.\n\n📕 Ottoni, M. V., Ottoni Filho, T. B., Schaap, M. G., Lopes-Assad, M. L. R., & Rotunno Filho, O. C. (2018). Hydrophysical database for Brazilian soils (HYBRAS) and pedotransfer functions for water retention. Vadose Zone Journal, 17(1).\n🔗 Project website: http://geosgb.cprm.gov.br/geosgb/\n\n📂 Data download URL: http://geosgb.cprm.gov.br/geosgb/downloads_en.html\n\n📍 Unique locations: 445\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops.HYBRAS\n\n\n\n\n\n\n\nDescription: Complete soil profile database. Legacy soil profiles collected in various projects. Over-represents southern parts of Canada / agricultural land.\n\n📕 Agriculture and Agri-Food Canada National Pedon Database.\n\n🔗 Project website: https://open.canada.ca/data/en/\n\n📂 Data download URL: https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\n\n📍 Unique locations: 3096\n\n📋 Unique complete rows: 15946\n\n📝 Import steps: chemsprops.NPDB\n\n\n\n\nDescription: Upper and lower limits for horizons can be negative because convention in Canada is to start counting soil depth from mineral soil (hence O and similar horizons are not counted).\n\n📕 Shaw, C., Hilger, A., Filiatrault, M., & Kurz, W. (2018). A Canadian upland forest soil profile and carbon stocks database. Ecology, 99(4), 989-989. https://doi.org/10.1002/ecy.2159\n🔗 Project website:\n\n📂 Data download URL: Supplement file\n\n📍 Unique locations: 2347\n\n📋 Unique complete rows: 15162\n\n📝 Import steps: chemsprops.CUFS\n\n\n\n\nDescription: Established in 1998 to provide a monitoring network across Alberta for each of the 43 Ecodistricts. Only limited amount of sampling locations (42 benchmark sites) but revisited every year. It reports that only Phosphorous shows significant changes over time, while SOC, total N, pH stay relatively constant across Alberta.\n\n📕 Cathcart, J., Mason, H., Sey, B. Heinz, J. and Cannon, K. (2008). Nine Years of Soil Quality Data from the Alberta Benchmark Program. Resource Sciences Branch, Alberta Agriculture and Rural Development, Edmonton, Alberta, Canada. 84 pp.\n\n🔗 Project website: https://open.canada.ca/data/en/\n\n📂 Data download URL:\n\n📍 Unique locations: 130\n\n📋 Unique complete rows: 2484\n\n📝 Import steps:\n\n\n\n\nDescription: Soil texture data from 29,570 mineral soil samples from 17,901 soil profiles to model and map particle size composition in ecoforest polygons of the provincial ecoforest map of Quebec, Canada.\n\n📕 Duchesne, L., Ouimet, R., (2021). Digital mapping of soil texture in ecoforest polygons in Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.7717/peerj.11685/supp-1\n\n📍 Unique locations: 17,901\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Soil carbon samples only.\n\n📕 Pfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: the Chilean Soil Organic Carbon database, a multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457-468, https://doi.org/10.5194/essd-12-457-2020.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3\n\n📍 Unique locations: 12132\n\n📋 Unique complete rows: 16371\n\n📝 Import steps: chemsprops.CHLSOC\n\n\n\n\n\n\n\nDescription: National compilation of representative soil profiles. The point data is not available publicly.\n\n📕 Shangguan, W., Dai, Y., Liu, B., Zhu, A., Duan, Q., Wu, L., … & Zhang, Y. (2013). A China data set of soil properties for land surface modeling. Journal of Advances in Modeling Earth Systems, 5(2), 212-224. https://doi.org/10.1002/jame.20026\n\n🔗 Project website: http://globalchange.bnu.edu.cn/research/data\n\n📂 Data download URL:\n\n📍 Unique locations: 8979\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: The Soil and Terrain database for China primary data includes also representative soil profiles.\n\n📕 Dijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil and landform properties for LADA partner countries. ISRIC report 2008/06 and GLADA report 2008/03, ISRIC — World Soil Information and FAO, Wageningen.\n\n🔗 Project website: https://data.isric.org\n\n📂 Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip\n\n📍 Unique locations: 1430\n\n📋 Unique complete rows: 5105\n\n📝 Import steps: chemsprops.CNSOTER\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset. Somewhat over-represents forest soils.\n\n📕 Martinovic J., (2000) “Tla u Hrvatskoj”, Monografija, Drzavna uprava za zastitu prirode i okolisa, str. 269, Zagreb. ISBN: 9536793059 / Basic F., (2014) “The Soils of Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154\n\n🔗 Project website: http://www.haop.hr/\n\n📂 Data download URL: Complete document\n\n📍 Unique locations: 2169\n\n📋 Unique complete rows: 5746\n\n📝 Import steps: chemsprops.bpht\n\n\n\n\n\n\n\nDescription: Texture fractions harmonized at five standard depths (5, 15, 30, 60, and 100 cm) using SISLAC soil profile data for Colombia. Data set available under CC BY license.\n\n📕 Varón-Ramírez, V. M., Araujo-Carrillo, G. A., & Guevara, M. (2022). Colombian soil texture: Building a spatial ensemble model. Earth System Science Data Discussions, 1-30. https://doi.org/10.5194/essd-2021-437\n\n🔗 Project website: https://www.agrosavia.co/\n\n📂 Data download URL: https://dx.doi.org/10.6073/pasta/6dded07af834834ee21a134b247507fd\n\n📍 Unique locations: 4203\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Contains over 1,800 soil samples with total carbon and total N from ten distinct geo-climatic regions throughout the Congo Basin and wider African Great Lakes region. Points are spatially clustered around six core sampling regions.\n\n📕 Summerauer, L., Baumann, P., Ramirez-Lopez, L., Barthel, M., Bauters, M., Bukombe, B., … & Six, J. (2021). Filling a key gap: a soil infrared library for central Africa. Soil Discussions, 1-28.\n\n🔗 Project website: https://github.com/laura-summerauer/ssl-central-africa\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.4320395\n\n📍 Unique locations: 920\n\n📋 Unique complete rows: 1852\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National legacy soil profile database for Costa Rica.\n\n📕 Mata, R., Vazquez, A., Rosales, A., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociacion Costarricense de la Ciencia del Suelo, San Jose, CRC. Escala, 1, 200000.\n\n🔗 Project website: http://www.cia.ucr.ac.cr\n\n📂 Data download URL: zip file\n\n📍 Unique locations: 472\n\n📋 Unique complete rows: 2042\n\n📝 Import steps: chemsprops.CostaRica\n\n\n\n\n\n\n\nDescription: Soil polygon map of Estonia and various derived grids. Point data (1,121 samples) is not publicly available but can be obtained by contacting the authors.\n\n📕 Kmoch, A., Kanal, A., Astover, A., Kull, A., Virro, H., Helm, A., Pärtel, M., Ostonen, I., and Uuemaa, E. (2021). EstSoil-EH: a high-resolution eco-hydrological modelling parameters dataset for Estonia, Earth Syst. Sci. Data, 13, 83–97. https://doi.org/10.5194/essd-13-83-2021\n\n🔗 Project website: https://landscape-geoinformatics.ut.ee/estsoil-eh-dataset\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3473289\n\n📍 Unique locations: 3373\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Full soil profiles with results of the chemical and physical analyses of the soil profiles and monitoring + results of management practices related to soil data. Locations of the points have been degraded with minimum error of 1 km to avoid legal issues with land owners / farmers.\n\n📕 Saby, N. P. A., Chenu, J.-P., Szergi, T., Csorba, A., Bertuzzi, P., Toutain, B., … Creamer, R. (2020). French RMQS soil profile and monitoring dataset with related management practices data. Recherche Data Gouv. https://doi.org/10.15454/AIQ9WS / Saby, N. P. A., Thioulouse, J., Jolivet, C. C., Ratié, C., Boulonne, L., Bispo, A., & Arrouays, D. (2009). Multivariate analysis of the spatial patterns of 8 trace elements using the French soil monitoring network data. Science of the Total Environment, 407(21), 5644-5652. http://dx.doi.org/10.1016/j.scitotenv.2009.07.002\n🔗 Project website: https://landmarkproject.eu/\n\n📂 Data download URL: https://doi.org/10.15454/AIQ9WS\n\n📍 Unique locations: 2171\n\n📋 Unique complete rows: 4149\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: For protection of data privacy, the coordinate was randomly generated within a radius of 4-km around the planned sampling point.\n\n📕 Poeplau, C., Jacobs, A., Don, A., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks of organic carbon in German agricultural soils—Key results of the first comprehensive inventory. Journal of Plant Nutrition and Soil Science, 183(6), 665-681.\n\n🔗 Project website: https://www.thuenen.de/de/ak/\n\n📂 Data download URL: https://doi.org/10.3220/DATA20200203151139\n\n📍 Unique locations: 3104\n\n📋 Unique complete rows: 17187\n\n📝 Import steps: chemsprops.BZE_LW\n\n\n\n\n\n\n\nDescription: Described in literature but not yet imported to AfSPDB.\n\n📕 Owusu, S., Yigini, Y., Olmedo, G. F., & Omuto, C. T. (2020). Spatial prediction of soil organic carbon stocks in Ghana using legacy data. Geoderma, 360, 114008.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Soil samples (0-20 cm, 20-50 cm) collected within the AfSIS-II project. Coordinates of points are not available. Sample reference and soil spectral data available under CC-0 license.\n\n📕 Hengl, T., Miller, M.A.E., Križan, J. et al. (2021). African soil properties and nutrients mapped at 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y\n\n🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils\n\n📂 Data download URL: https://doi.org/10.34725/DVN/SPRSFN\n\n📍 Unique locations:\n\n📋 Unique complete rows: 3013\n\n📝 Import steps: AfSIS2\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset. In 2012/2013, 246 profile pits were sampled and analysed as part of the Irish Soil Information System project to fill in gaps in the description of representative profile data for Ireland. The point data is not publicly available.\n\n📕 Creamer, R., & O’Sullivan, L. (Eds.). (2018). The soils of Ireland. Springer. ISBN: 9783319711898.\n\n🔗 Project website: http://soils.teagasc.ie/\n\n📂 Data download URL:\n\n📍 Unique locations: 246\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset.\n\n📕 Mohammad, H. B. (2000). Soil resources and use potentiality map of Iran. Soil and Water Research Institute, Teheran, Iran. / Dewan, M. L., & Famouri, J. (1964). The soils of Iran. Food and Agriculture Organization of the United Nations.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 1373\n\n📋 Unique complete rows: 4759\n\n📝 Import steps: chemsprops.IRANSPDB\n\n\n\n\n\n\n\nDescription: Compilation of soil spectral data from various projects.\n\n📕 NA\n\n🔗 Project website: https://www.modelfarm-aro.org/subject-areas/the-national-soil-spectral-library-of-israel/?lang=en\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 4000\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Soil profile observation compiled from Nigeria National Legacy data and IITA Project sites. Submitted by Tunrayo Alabi, CGIAR - Consortium for Spatial Information (CGIAR-CSI). Overlaps with the Africa Soil profiles dataset.\n\n📕 Leenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01. / Akpa, S. I., Odeh, I. O., Bishop, T. F., Hartemink, A. E., & Amapu, I. Y. (2016). Total soil organic carbon and carbon sequestration potential in Nigeria. Geoderma, 271, 202-215.\n\n🔗 Project website: https://www.africageoportal.com\n\n📂 Data download URL: https://www.africageoportal.com/datasets/CSI::legacy-soils-and-national-surveys/about\n\n📍 Unique locations:\n\n📋 Unique complete rows: 2569\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Legacy soil profile dataset.\n\n📕 Coetzee, M. E. (2001). NAMSOTER, a SOTER database for Namibia. Agroecological Zoning, 458.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 1014\n\n📋 Unique complete rows: 2953\n\n📝 Import steps: chemsprops.LandPKS\n\n\n\n\n\n\n\nDescription: Legacy dataset. The National Soil Inventory of Scotland (NSIS 1978-88) dataset was collected at sampling points arranged on a 10 km grid across the country. The data set is maintained and distributed by the James Hutton Institute under Ordnance Survey Open Data (Data).\n\n📕 Lilly, A., Bell, J.S., Hudson, G., Nolan, A.J. & Towers. W. (Compilers) (2010). National soil inventory of Scotland (NSIS_1); site location, sampling and profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230\n\n🔗 Project website: http://soils.environment.gov.scot/\n\n📂 Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download\n\n📍 Unique locations: 721\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Legacy dataset. The National Soil Inventory of Slovenia (agricultural land only).\n\n📕 Vrščaj, B., Repe, B., Simončič, P., & Vrščaj, B. (2017). Soil Information. The Soils of Slovenia, 157-170. https://doi.org/10.1007/978-94-017-8585-3_7\n\n🔗 Project website: https://rkg.gov.si/vstop/\n\n📂 Data download URL: https://rkg.gov.si/vstop/\n\n📍 Unique locations: 1879\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National SS library.\n\n📕 Baumann, P., Helfenstein, A., Gubler, A., Keller, A., Meuli, R. G., Wächter, D., … & Six, J. (2021). Developing the Swiss soil spectral library for local estimation and monitoring. SOIL Discussions, 1-32. https://doi.org/10.5194/soil-2020-105\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Swiss National soil information system (NABODAT). Proprietary data but can be requested for research purposes. Includes also the Swiss Soil Monitoring Network (NABO).\n\n📕 Rehbein, K., van der Meer, M., Grob, U., Wegmann, F. and Keller, A. 2011. “Das Nationale Bodeninformationssystem NABODAT in der Schweiz”. In Berichte der DBG “Böden verstehen – Böden nutzen –Böden fit machen”, 3–9 September 2011, Berlin http://eprints.dbges.de / Keller, A. (2013). National soil information systems to support spatial planning procedures. disP-The Planning Review, 49(1), 68-71. https://doi.org/10.1080/02513625.2013.799872\n🔗 Project website: https://www.nabodat.ch/\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Swiss Biodiversity Monitoring (BDM) soil samples. Focused on monitoring soil bacterial communities.\n\n📕 Mayerhofer, J., Wächter, D., Calanca, P., Kohli, L., Roth, T., Meuli, R. G., & Widmer, F. (2021). Environmental and anthropogenic factors shape major bacterial community types across the complex mountain landscape of switzerland. Frontiers in microbiology, 12, 581430. https://doi.org/10.3389/fmicb.2021.581430\n\n🔗 Project website: https://www.biodiversitymonitoring.ch/index.php/en/home-footer\n\n📂 Data download URL:\n\n📍 Unique locations: 255\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Tanzanian Soil Information Service. Coordinates of points are available from https://registry.opendata.aws/afsis/. Sample data available under CC-0 license.\n\n📕 Hengl, T., Miller, M.A.E., Križan, J. et al. (2021). African soil properties and nutrients mapped at 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y\n\n🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils\n\n📂 Data download URL: https://doi.org/10.34725/DVN/XUDGJY\n\n📍 Unique locations:\n\n📋 Unique complete rows: 26,772\n\n📝 Import steps: AfSIS2\n\n\n\n\n\n\n\nDescription: All documentation in Russian only.\n\n📕 Stolbovoy V.S., Molchanov E.N., Sheremet B.V. Morphogenetic basis of the unified state register of soil resources of Russia. Dokuchaev Soil Bulletin. 2016;(86):115-123. https://doi.org/10.19047/0136-1694-2016-86-115-123\n\n🔗 Project website:\n\n📂 Data download URL: http://egrpr.esoil.ru/content/1DB.html\n\n📍 Unique locations: 802\n\n📋 Unique complete rows: 4137\n\n📝 Import steps: chemsprops.EGRPR\n\n\n\n\n\n\n\nDescription: National soil and land use database. Proprietary dataset maintained by Cranfield University. LandIS is a Registered Trademark.\n\n📕 Bradley, R. I., Milne, R., Bell, J., Lilly, A., Jordan, C., & Higgins, A. (2005). A soil carbon and land use database for the United Kingdom. Soil use and Management, 21(4), 363-369. https://doi.org/10.1079/SUM2005351 / Hallett, S.H., Sakrabani, R., Keay, C.A. and Hannam, J.A. (2017). Developments in Land Information Systems: Case studies in land resource management capabilities and options. Soil Use and Management. http://doi.org/10.1111/sum.12380\n🔗 Project website: https://www.landis.org.uk/\n\n📂 Data download URL: https://www.landis.org.uk/soilsguide/series.cfm\n\n📍 Unique locations: 50,000+\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National Cooperative Soil Survey Characterization Database is probably the most comprehensive and most detailed soil profile dataset in the World. It is continuously maintained by the USDA National Cooperative Soil Survey. Data is available under the CC-0 license.\n\n📕 USDA-NRCS, (2016). General description for NCSS Soil Characterization Data. USDA, Natural Resources Conservation Service. / O’Geen, A., Walkinshaw, M., & Beaudette, D. (2017). SoilWeb: A multifaceted interface to soil survey information. Soil Science Society of America Journal, 81(4), 853-862. https://doi.org/10.2136/sssaj2016.11.0386n\n\n🔗 Project website: http://ncsslabdatamart.sc.egov.usda.gov/\n\n📂 Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/\n\n📍 Unique locations: 19861\n\n📋 Unique complete rows: 136011\n\n📝 Import steps: chemsprops.NCSS\n\n\n\n\nDescription: MIR spectral library and associated soil characterization database, which now includes &gt;50,000 MIR spectra collected on soils primarily from the United States. Currently not available publicly for use.\n\n📕 Seybold, C. A., Ferguson, R., Wysocki, D., Bailey, S., Anderson, J., Nester, B., … & Thomas, P. (2019). Application of Mid‐Infrared Spectroscopy in Soil Survey. Soil Science Society of America Journal, 83(6), 1746-1759. https://doi.org/10.2136/sssaj2019.06.0205 / Sanderman, J., Savage, K., & Dangal, S. R. (2020). Mid‐infrared spectroscopy for prediction of soil health indicators in the United States. Soil Science Society of America Journal, 84(1), 251-261. https://doi.org/10.1002/saj2.20009\n\n🔗 Project website: https://www.nrcs.usda.gov/wps/portal/nrcs/main/soils/research/\n\n📂 Data download URL:\n\n📍 Unique locations: 61103\n\n📋 Unique complete rows:\n\n📝 Import steps: sslsprops.KSSL\n\n\n\n\nDescription: Locations of each site have been degraded due to confidentiality and only reflect the general position of each site.\n\n📕 Wills, S. et al. (2013) “Rapid carbon assessment (RaCA) methodology: Sampling and Initial Summary. United States Department of Agriculture.” Natural Resources Conservation Service, National Soil Survey Center.\n\n🔗 Project website: https://www.nrcs.usda.gov/survey/raca/\n\n📂 Data download URL: https://www.nrcs.usda.gov/wps/portal/nrcs/detailfull/soils/research/?cid=nrcs142p2_054164\n\n📍 Unique locations: 6332\n\n📋 Unique complete rows: 143006\n\n📝 Import steps: chemsprops.RaCa\n\n\n\n\nDescription: Systematic geochemical and mineralogical survey of soil horizons analyzed using a consistent set of methods, sample spacing 1 per 1,600 sq km. Data is available under the CC-0 license.\n\n📕 Smith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., and Fey, D.L., (2013). Geochemical and mineralogical data for soils of the conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/ / Smith, D. B., W. F. Cannon, and L. G. Woodruff (2011). A national-scale geochemical and mineralogical survey of soils of the conterminous United States. Appl. Geochem., 26, S250–S255. https://doi.org/10.1016/j.apgeochem.2011.03.116.\n\n🔗 Project website: https://mrdata.usgs.gov/ds-801/\n\n📂 Data download URL: https://mrdata.usgs.gov/ds-801/\n\n📍 Unique locations: 4857\n\n📋 Unique complete rows: 9446\n\n📝 Import steps: chemsprops.USGS.NGS\n\n\n\n\nDescription: Systematic inventory of forest plots.\n\n📕 Domke, G. M., Perry, C. H., Walters, B. F., Nave, L. E., Woodall, C. W., & Swanston, C. W. (2017). Toward inventory‐based estimates of soil organic carbon in forests of the United States. Ecological Applications, 27(4), 1223-1235. https://doi.org/10.1002/eap.1516/ / Forest Inventory and Analysis, (2014). The Forest Inventory and Analysis Database: Database description and user guide version 6.0.1 for Phase 3. U.S. Department of Agriculture, Forest Service. 182 p. [Online]. Available: https://www.fia.fs.fed.us/library/database-documentation/\n\n🔗 Project website: https://www.fia.fs.fed.us\n\n📂 Data download URL: https://apps.fs.usda.gov/fia/datamart/datamart.html\n\n📍 Unique locations: 5149\n\n📋 Unique complete rows: 23208\n\n📝 Import steps: chemsprops.FIADB\n\n\n\n\n\n\n\n\nDescription: This dataset consists of measurements of bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. Soil cores were sampled during early summer in 2013 and 2014. Data publicly available under the Open Government Licence.\n\n📕 Estop-Aragones, C.; Fisher, J.P.; Cooper, M.A.; Thierry, A.; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, I.P. (2016). Bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952\n\n🔗 Project website: http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/\n\n📂 Data download URL: https://catalogue.ceh.ac.uk/documents/efa2a84b-3505-4221-a7da-12af3cdc1952\n\n📍 Unique locations:\n\n📋 Unique complete rows: 2932\n\n📝 Import steps:\n\n\n\n\nDescription: Contains soil profile data at depths of 5 cm and 25 cm from 238 sampling sites for a high and cold mountainous area, Northeastern Qinghai-Tibet Plateau. Includes the soil hydraulic properties include clay, silt, sand, soil organic carbon, soil saturated hydraulic conductivity. Data available under CC-BY license.\n\n📕 Tian, J., Zhang, B., Wang, X., & He, C. (2022). An in situ observation dataset of soil hydraulic properties and soil moisture in a high and cold mountainous area on the northeastern Qinghai-Tibet Plateau. Earth System Science Data Discussions, 1-29. https://doi.org/10.5194/essd-2022-21\n\n🔗 Project website: https://data.tpdc.ac.cn/\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.5830583\n\n📍 Unique locations: 238\n\n📋 Unique complete rows:\n\n📝 Import steps:",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#global-datasets",
    "href": "020-dataset_list.html#global-datasets",
    "title": "Datasets",
    "section": "",
    "text": "Description: Originally a plant root database but also contains some soil laboratory data and soil observations.\n\n📕 Iversen CM, McCormack ML, Baer JK, Powell AS, Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli A, Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): A Global Collection of Root Trait Data with Coincident Site, Vegetation, Edaphic, and Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department of Energy, Oak Ridge, Tennessee, U.S.A.\n\n🔗 Project website: https://roots.ornl.gov/\n\n📂 Data download URL: https://doi.org/10.25581/ornlsfa.014/1459186\n\n📍 Unique locations: 280\n\n📋 Unique complete rows: 858\n\n📝 Import steps: chemsprops.FRED\n\n\n\n\nDescription: Soil Organic Carbon data from various publications. Many missing years for PREVIOUS SOC and SOIL CHARACTERISTICS.\n\n📕 Ledo, A., Hillier, J., Smith, P. et al. (2019) A global, empirical, harmonised dataset of soil organic carbon changes under perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1\n\n🔗 Project website: https://africap.info/\n\n📂 Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2\n\n📍 Unique locations: 174\n\n📋 Unique complete rows: 1526\n\n📝 Import steps: chemsprops.SOCPDB\n\n\n\n\nDescription: The database encompasses all published studies that report at least one of the following data measured in the field (not laboratory): annual soil respiration, mean seasonal soil respiration, a seasonal or annual partitioning of soil respiration into its source fluxes, soil respiration temperature response (Q10), or soil respiration at 10 degrees C.\n\n📕 Bond-Lamberty, B. and Thomson, A. (2010). A global database of soil respiration data, Biogeosciences, 7, 1915-1926, https://doi.org/10.5194/bg-7-1915-2010\n\n🔗 Project website: https://github.com/bpbond/srdb/\n\n📂 Data download URL: https://github.com/bpbond/srdb/\n\n📍 Unique locations: 826\n\n📋 Unique complete rows: 1596\n\n📝 Import steps: chemsprops.SRDB\n\n\n\n\nDescription: Contains a data base of 173 soil hydrological data (raw data) from 71 sites all over the world (Asia, Africa, Australia America and Europe). The samples were mainly collected and measured as part of research projects. The soils cover a wide range of texture classes and dry bulk densities. The data base consists of water retention and unsaturated hydraulic conductivity data.\n\n📕 Schindler, Uwe; Müller, Lothar (2015): Soil hydraulic functions of international soils measured with the Extended Evaporation Method (EEM) and the HYPROP device, Leibniz-Zentrum für Agrarlandschaftsforschung (ZALF) e.V.[doi:10.4228/ZALF.2003.273]\n\n🔗 Project website:\n\n📂 Data download URL: http://dx.doi.org/10.4228/ZALF.2003.273\n\n📍 Unique locations: 71\n\n📋 Unique complete rows: 173\n\n📝 Import steps: chemsprops.HYDROS\n\n\n\n\nDescription: ISRIC-WISE database holds selected site and horizon data for 10,250 soil profiles from 149 countries. Profile data were extracted from a wide range of sources and harmonized with respect to the original (1974) and revised (1988) Legend of the FAO-Unesco Soil Map of the World. Profiles have been described, sampled, and analyzed according to methods and standards in use in the originating countries. WISE was specifically developed for land-related applications at continental and global scales.\n\n📕 Batjes, N.H. (2009). Harmonized soil profile data for applications at global and continental scales: updates to the WISE database. Soil Use and Management 25(2):124-127. DOI:10.1111/j.1475-2743.2009.00202.x\n\n🔗 Project website: https:/isric.org\n\n📂 Data download URL: https://files.isric.org/public/wise/WD-WISE.zip\n\n📍 Unique locations: 6723\n\n📋 Unique complete rows: 23278\n\n📝 Import steps: chemsprops.WISE\n\n\n\n\nDescription: World Soil Reference Collection comprises about 800 soil profiles from over 70 countries with detailed soil profile and environmental data.\n\n📕 Batjes, N. H. (1995). A homogenized soil data file for global environmental research: A subset of FAO, ISRIC and NRCS profiles (Version 1.0) (No. 95/10b). ISRIC. / Van de Ven, T., & Tempel, P. (1994). ISIS 4.0: ISRIC Soil Information System: User Manual. ISRIC.\n\n🔗 Project website: https:/isis.isric.org\n\n📂 Data download URL: https:/isis.isric.org\n\n📍 Unique locations: 785\n\n📋 Unique complete rows: 5637\n\n📝 Import steps: hydrosprops.ISIS\n\n\n\n\nDescription: These data were assembled by the Nature Conservancy and a team of scientists from 19 institutions to quantify carbon sequestration in naturally regenerating forests around the world.\n\n📕 Cook-Patton, S. C., Leavitt, S. M., Gibbs, D., Harris, N. L., Lister, K., Anderson-Teixeira, K. J., … & Griscom, B. W. (2020). Mapping carbon accumulation potential from global natural forest regrowth. Nature, 585(7826), 545-550. https://doi.org/10.1038/s41586-020-2686-x\n\n🔗 Project website: https://github.com/forc-db/groa\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3983644\n\n📍 Unique locations: 1921\n\n📋 Unique complete rows: 1921\n\n📝 Import steps:\n\n\n\n\nDescription: A Globally Distributed Soil Spectral Library Mid Infrared Diffuse Reflectance Spectra. MIR scans for some 785 profiles from the ISRIC World Soil Reference Collection. The samples are from 58 countries spanning Africa, Asia, Europe, North America, and South America. Data available under the CC-BY 4.0 license.\n\n📕 World Agroforestry Centre, (2014). The ICRAF/ISRIC spectral library, Soil-Plant Spectral Diagnostics laboratory, United Nations Avenue, Nairobi, Kenya.\n\n🔗 Project website: https://www.worldagroforestry.org/sd/landhealth/soil-plant-spectral-diagnostics-laboratory/soil-spectra-library\n\n📂 Data download URL: https://files.isric.org/public/other/ICRAF-ISRICVNIRSoilDatabase.zip\n\n📍 Unique locations: 785\n\n📋 Unique complete rows:\n\n📝 Import steps: sslsprops.ICRAF_ISRIC\n\n\n\n\nDescription: Contains a total of 13,258 Ksat measurements from 1908 sites were assembled from the published literature.\n\n📕 Gupta, S., Hengl, T., Lehmann, P., Bonetti, S., and Or, D.: (2021) SoilKsatDB: global database of soil saturated hydraulic conductivity measurements for geoscience applications, Earth Syst. Sci. Data, 13, 1593–1612, https://doi.org/10.5194/essd-13-1593-2021.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3752721\n\n📍 Unique locations: 1908\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops\n\n\n\n\nDescription: Contains a total of 15,153 soil water characteristics curve (SWCC) measurements from 2659 sites assembled from the published literature.\n\n📕 Gupta, S., Papritz, A., Lehmann, P., Hengl, T., Bonetti, S., and Or, D., (2020): GSHP: Global soil hydraulic properties database”. Manuscript submitted to Scientific Data.\n\n🔗 Project website: https://github.com/ETHZ-repositories/GSHP-database\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.5547338\n\n📍 Unique locations: 2659\n\n📋 Unique complete rows:\n\n📝 Import steps: GSHP-database\n\n\n\n\nDescription: Data collected by various people through the LandPKS App for mobile phones (crowdsourced). Data is of limited quality and usually no laboratory data is collected and shared.\n\n📕 Herrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). The Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use and Management through Cloud Computing, Mobile Applications, and Crowdsourcing. Journal of Soil and Water Conservation, 68(1), 5A-12A.\n\n🔗 Project website: http://portal.landpotential.org\n\n📂 Data download URL: http://portal.landpotential.org/#/landpksmap\n\n📍 Unique locations: 15326\n\n📋 Unique complete rows: 41644\n\n📝 Import steps: chemsprops.LandPKS\n\n\n\n\nDescription: Point data set used to produce a global map of mangrove forest soil carbon at 30 m spatial resolution.\n\n📕 Sanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). A global map of mangrove forest soil carbon at 30 m spatial resolution. Environmental Research Letters, 13(5), 055002.\n\n🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/\n\n📂 Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT\n\n📍 Unique locations: 1568\n\n📋 Unique complete rows: 7718\n\n📝 Import steps: chemsprops.Mangroves\n\n\n\n\nDescription: Soil carbon profile data from paired land use comparisons.\n\n📕 Sanderman, J., Hengl, T., & Fiske, G. J. (2017). Soil carbon debt of 12,000 years of human land use. Proceedings of the National Academy of Sciences, 114(36), 9575-9580.\n\n🔗 Project website: https://www.woodwellclimate.org/research-area/carbon/\n\n📂 Data download URL: https://doi.org/10.7910/DVN/QQQM8V/8MSBNI\n\n📍 Unique locations: 1604\n\n📋 Unique complete rows: 224\n\n📝 Import steps: chemsprops.RemnantSOC\n\n\n\n\nDescription: SoDaH is built on several network science efforts in the United States. It’s aim is to provide an open-access resource to facilitate and automate further harmonization and synthesis of soil carbon data.\n\n📕 Wieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: the SOils DAta Harmonization database, an open-source synthesis of soil data from research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195\n\n🔗 Project website: https://lter.github.io/som-website\n\n📂 Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4\n\n📍 Unique locations: 1052\n\n📋 Unique complete rows: 20383\n\n📝 Import steps: chemsprops.SoDaH\n\n\n\n\nDescription: A database for global soil health assessment. Only limited soil properties available.\n\n📕 Jian, J., Du, X., & Stewart, R. D. (2020). A database for global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3.\n\n🔗 Project website: https://github.com/jinshijian/SoilHealthDB\n\n📂 Data download URL: https://github.com/jinshijian/SoilHealthDB\n\n📍 Unique locations: 88\n\n📋 Unique complete rows: 120\n\n📝 Import steps: chemsprops.SoilHealthDB\n\n\n\n\nDescription: Soil textural information (clay, silt, and sand content) is available for 3842 out of 5023 infiltration measurements.\n\n📕 Rahmati, M., Weihermüller, L., Vanderborght, J., Pachepsky, Y. A., Mao, L., Sadeghi, S. H., … & Toth, B. (2018). Development and analysis of the Soil Water Infiltration Global database. Earth Syst. Sci. Data, 10, 1237–1263.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.1594/PANGAEA.885492\n\n📍 Unique locations: 88\n\n📋 Unique complete rows: 120\n\n📝 Import steps: chemsprops.SWIG\n\n\n\n\nDescription: The dataset contains measured soil water retention, hydraulic conductivity, and water diffusivity data, as well as pedological information of some 790 soil samples from around the world.\n\n📕 Nemes, Attila; Schaap, Marcel; Leij, Feike J.; Wösten, J. Henk M. (2015). UNSODA 2.0: Unsaturated Soil Hydraulic Database. Database and program for indirect methods of estimating unsaturated hydraulic properties. US Salinity Laboratory - ARS - USDA. https://doi.org/10.15482/USDA.ADC/1173246. / Børgesen, C. D., Jacobsen, O. H., Hansen, S., & Schaap, M. G. (2006). Soil hydraulic properties near saturation, an improved conductivity model. Journal of Hydrology, 324(1-4), 40-50. https://doi.org/10.1016/j.jhydrol.2005.09.014\n🔗 Project website:\n\n📂 Data download URL: Zip packages\n\n📍 Unique locations: 790\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops.UNSODA\n\n\n\n\nDescription: A global point data set with organic soil carbon and nitrogen data. Poor spatial location accuracy with error often &gt; 10 km. Bulk density for many points has been estimated not measured. Sampling year has not been but literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. Most of samples come from natural vegetation (undisturbed) areas.\n\n📕 Zinke, P. J., Millemann, R. E., & Boden, T. A. (1986). Worldwide organic soil carbon and nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory.\n\n🔗 Project website: https://cdiac.ess-dive.lbl.gov/\n\n📂 Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018\n\n📍 Unique locations: 1712\n\n📋 Unique complete rows: 3977\n\n📝 Import steps: chemsprops.ISCND",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#africa",
    "href": "020-dataset_list.html#africa",
    "title": "Datasets",
    "section": "",
    "text": "Description: A compilation of legacy soil profiles from hundreds of profiles. Produced for the purpose of the Africa Soil Information Services (AfSIS) project.\n\n📕 Leenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01.\n\n🔗 Project website: https://www.isric.org/projects/africa-soil-profiles-database-afsp\n\n📂 Data download URL: https://data.isric.org/\n\n📍 Unique locations: 15630\n\n📋 Unique complete rows: 60306\n\n📝 Import steps: chemsprops.AfSPDB\n\n\n\n\nDescription: Soil spectroscopy-based soil samples datasets. Produced by World Agroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center for International Earth Science Information Network (CIESIN), The International Center for Tropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) and Rothamsted Research (RRES) for the purpose of the Africa Soil Information Services (AfSIS) project. Many more samples have been collected in the period 2010–2018.\n\n📕 Towett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. A., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition of soils in Sub-Saharan Africa and relationship with soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002\n\n🔗 Project website: https://github.com/qedsoftware/afsis-soil-chem-tutorial\n\n📂 Data download URL: https://registry.opendata.aws/afsis/\n\n📍 Unique locations: 929\n\n📋 Unique complete rows: 4162\n\n📝 Import steps: chemsprops.AfSIS1",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#asia",
    "href": "020-dataset_list.html#asia",
    "title": "Datasets",
    "section": "",
    "text": "Description: Represents parts of Russian Federation and Canada. This data set consists of significantly higher soil organic carbon concentrations.\n\n📕 Hugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). A new data set for estimating organic carbon storage to 3 m depth in soils of the northern circumpolar permafrost region. Earth System Science Data (Online), 5(2).\n\n🔗 Project website: https://bolin.su.se/data/ncscd/\n\n📂 Data download URL: http://dx.doi.org/10.5879/ECDS/00000002\n\n📍 Unique locations: 410\n\n📋 Unique complete rows: 7104\n\n📝 Import steps: chemsprops.NCSCD",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#europe",
    "href": "020-dataset_list.html#europe",
    "title": "Datasets",
    "section": "",
    "text": "Description: Top-soil samples only (0–20 cm). In year 2012 additional samples were collected from Romania and Bulgaria.\n\n📕 Tóth, G., Jones, A., Montanarella, L., Alewell, C., Ballabio, C., Carre, F., … & Hermann, T. (2013). LUCAS Topsoil Survey—Methodology, Data and Results. JRC Technical Reports. Luxembourg. Publications Office of the European Union, EUR26102 – Scientific and Technical Research series – ISSN 1831-9424 (online); ISBN 978-92-79-32542-7; doi: 10.2788/97922.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n📍 Unique locations: 21272\n\n📋 Unique complete rows: 21272\n\n📝 Import steps: chemsprops.LUCAS\n\n\n\n\nDescription: Top-soil samples only (0–20 cm). This is currently the largest systematic soil sample dataset for EU.\n\n📕 Orgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernandez-Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas2015-topsoil-data\n\n📍 Unique locations: 21859\n\n📋 Unique complete rows: 21859\n\n📝 Import steps: chemsprops.LUCAS\n\n\n\n\nDescription: Top-soil samples only (0–20 cm) collected in 2018. Several additional soil properties have been added.\n\n📕 Orgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernandez-Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153.\n\n🔗 Project website: https://esdac.jrc.ec.europa.eu/projects/lucas\n\n📂 Data download URL: https://esdac.jrc.ec.europa.eu/projects/lucas\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Geochemical background and threshold for 53 chemical elements in European agricultural soil.\n\n📕 Reimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, A., Negrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background and threshold for 53 chemical elements in European agricultural soil. Applied Geochemistry, 88, 302-318.\n\n🔗 Project website: http://gemas.geolba.ac.at/\n\n📂 Data download URL: http://gemas.geolba.ac.at/\n\n📍 Unique locations: 4026\n\n📋 Unique complete rows: 4131\n\n📝 Import steps: chemsprops.GEMAS",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#south-america",
    "href": "020-dataset_list.html#south-america",
    "title": "Datasets",
    "section": "",
    "text": "Description: A compilation of legacy soil profiles from majority of Latin American countries.\n\n📕 Alianza Mundial por el Suelo. 2013. Sistema de Informacion de Suelos de Latinoamerica (SISLAC). https://hdl.handle.net/10568/49611\n\n🔗 Project website: http://www.sislac.org/\n\n📂 Data download URL: http://54.229.242.119/sislac/es\n\n📍 Unique locations: 14606\n\n📋 Unique complete rows: 49994\n\n📝 Import steps: chemsprops.SISLAC\n\n\n\n\nDescription: Peatland soil measurements (points) from the literature.\n\n📕 Murdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals more peat in the tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452\n\n🔗 Project website: https://www.cifor.org/\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 756\n\n📝 Import steps: chemsprops.Peatlands",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#national-datasets",
    "href": "020-dataset_list.html#national-datasets",
    "title": "Datasets",
    "section": "",
    "text": "Description: National legacy soil profile dataset. Compiled from various projects.\n\n📕 CSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004.\n\n🔗 Project website: https://www.csiro.au/en/Do-business/Services/Enviro/Soil-archive\n\n📂 Data download URL: https://doi.org/10.25919/5eeb2a56eac12\n\n📍 Unique locations: 13826\n\n📋 Unique complete rows: 70791\n\n📝 Import steps: chemsprops.NatSoil\n\n\n\n\n\n\n\nDescription: Legacy soil profile dataset for Flemish Region.\n\n📕 Beckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. / Ottoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles for assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001\n\n🔗 Project website: https://www.dov.vlaanderen.be\n\n📂 Data download URL: https://www.dov.vlaanderen.be\n\n📍 Unique locations: 6877\n📋 Unique complete rows: 41310\n📝 Import steps: chemsprops.Vlaanderen2010\n\n\n\n\n\n\n\nDescription: National compilation of representative soil profiles. This dataset has been used in FEBR. Data comes primarily from the Radam project (Projeto Radambrasil, 1973–1986).\n\n📕 Cooper, M., Mendes, L. M. S., Silva, W. L. C., & Sparovek, G. (2005). A national soil profile database for Brazil available to international scientists. Soil Science Society of America Journal, 69(3), 649-652. https://doi.org/10.2136/sssaj2004.0140 / Benedetti, M. M., Curi, N., Sparovek, G., Carvalho Filho, A., & Silva, S. H. G. (2011). Updated Brazilian’s georeferenced soil database-an improvement for international scientific information exchanging. Embrapa, 1, 309-332.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 5086\n\n📋 Unique complete rows: 10,034\n\n📝 Import steps:\n\n\n\n\nDescription: Compilation of SS data from various projects.\n\n📕 Demattê, J. A., Dotto, A. C., Paiva, A. F., Sato, M. V., Dalmolin, R. S., Maria do Socorro, B., … & do Couto, H. T. Z. (2019). The Brazilian Soil Spectral Library (BSSL): A general view, application and challenges. Geoderma, 354, 113793. https://doi.org/10.1016/j.geoderma.2019.05.043\n\n🔗 Project website: https://bibliotecaespectral.wixsite.com/english\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 50,662\n\n📝 Import steps:\n\n\n\n\nDescription: Soil legacy data from various projects in Brazil standardized and bind together.\n\n📕 Samuel-Rosa, A., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data in Brazil: geospatial data quality and how to improve it. Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430\n\n🔗 Project website: https://www.pedometria.org/febr/\n\n📂 Data download URL: https://www.pedometria.org/febr/\n\n📍 Unique locations: 6098\n\n📋 Unique complete rows: 7842\n\n📝 Import steps: chemsprops.FEBR\n\n\n\n\nDescription: Contains various soil samples (complete profiles, partial profiles, extra samples) from the Soil Database database (BDsolos). Spatial location accuracy is variable: where possible geographic coordinates available in the Free Brazilian Repository for Open Soil Data (FEBR) were used, otherwise locations were assigned to the center of the municipality. Data set is available publicly via the PronaSolos Platform under the CC-BY-NC license.\n\n📕 POLIDORO, J., COELHO, M., CARVALHO FILHO, A. D., LUMBRERAS, J., de OLIVEIRA, A. P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos do Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).\n\n🔗 Project website: https://geoportal.cprm.gov.br/pronasolos/\n\n📂 Data download URL: http://geoinfo.cnps.embrapa.br/documents/3013/download\n\n📍 Unique locations: 9113\n\n📋 Unique complete rows: 34,464\n\n📝 Import steps:\n\n\n\n\nDescription: Contains hydrophysical data for Brazilian soils that seeks to consolidate water retention and saturated hydraulic conductivity data together with basic soil features and the methods of determination of these hydraulic properties.\n\n📕 Ottoni, M. V., Ottoni Filho, T. B., Schaap, M. G., Lopes-Assad, M. L. R., & Rotunno Filho, O. C. (2018). Hydrophysical database for Brazilian soils (HYBRAS) and pedotransfer functions for water retention. Vadose Zone Journal, 17(1).\n🔗 Project website: http://geosgb.cprm.gov.br/geosgb/\n\n📂 Data download URL: http://geosgb.cprm.gov.br/geosgb/downloads_en.html\n\n📍 Unique locations: 445\n\n📋 Unique complete rows:\n\n📝 Import steps: hydrosprops.HYBRAS\n\n\n\n\n\n\n\nDescription: Complete soil profile database. Legacy soil profiles collected in various projects. Over-represents southern parts of Canada / agricultural land.\n\n📕 Agriculture and Agri-Food Canada National Pedon Database.\n\n🔗 Project website: https://open.canada.ca/data/en/\n\n📂 Data download URL: https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\n\n📍 Unique locations: 3096\n\n📋 Unique complete rows: 15946\n\n📝 Import steps: chemsprops.NPDB\n\n\n\n\nDescription: Upper and lower limits for horizons can be negative because convention in Canada is to start counting soil depth from mineral soil (hence O and similar horizons are not counted).\n\n📕 Shaw, C., Hilger, A., Filiatrault, M., & Kurz, W. (2018). A Canadian upland forest soil profile and carbon stocks database. Ecology, 99(4), 989-989. https://doi.org/10.1002/ecy.2159\n🔗 Project website:\n\n📂 Data download URL: Supplement file\n\n📍 Unique locations: 2347\n\n📋 Unique complete rows: 15162\n\n📝 Import steps: chemsprops.CUFS\n\n\n\n\nDescription: Established in 1998 to provide a monitoring network across Alberta for each of the 43 Ecodistricts. Only limited amount of sampling locations (42 benchmark sites) but revisited every year. It reports that only Phosphorous shows significant changes over time, while SOC, total N, pH stay relatively constant across Alberta.\n\n📕 Cathcart, J., Mason, H., Sey, B. Heinz, J. and Cannon, K. (2008). Nine Years of Soil Quality Data from the Alberta Benchmark Program. Resource Sciences Branch, Alberta Agriculture and Rural Development, Edmonton, Alberta, Canada. 84 pp.\n\n🔗 Project website: https://open.canada.ca/data/en/\n\n📂 Data download URL:\n\n📍 Unique locations: 130\n\n📋 Unique complete rows: 2484\n\n📝 Import steps:\n\n\n\n\nDescription: Soil texture data from 29,570 mineral soil samples from 17,901 soil profiles to model and map particle size composition in ecoforest polygons of the provincial ecoforest map of Quebec, Canada.\n\n📕 Duchesne, L., Ouimet, R., (2021). Digital mapping of soil texture in ecoforest polygons in Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.7717/peerj.11685/supp-1\n\n📍 Unique locations: 17,901\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Soil carbon samples only.\n\n📕 Pfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: the Chilean Soil Organic Carbon database, a multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457-468, https://doi.org/10.5194/essd-12-457-2020.\n\n🔗 Project website:\n\n📂 Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3\n\n📍 Unique locations: 12132\n\n📋 Unique complete rows: 16371\n\n📝 Import steps: chemsprops.CHLSOC\n\n\n\n\n\n\n\nDescription: National compilation of representative soil profiles. The point data is not available publicly.\n\n📕 Shangguan, W., Dai, Y., Liu, B., Zhu, A., Duan, Q., Wu, L., … & Zhang, Y. (2013). A China data set of soil properties for land surface modeling. Journal of Advances in Modeling Earth Systems, 5(2), 212-224. https://doi.org/10.1002/jame.20026\n\n🔗 Project website: http://globalchange.bnu.edu.cn/research/data\n\n📂 Data download URL:\n\n📍 Unique locations: 8979\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: The Soil and Terrain database for China primary data includes also representative soil profiles.\n\n📕 Dijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil and landform properties for LADA partner countries. ISRIC report 2008/06 and GLADA report 2008/03, ISRIC — World Soil Information and FAO, Wageningen.\n\n🔗 Project website: https://data.isric.org\n\n📂 Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip\n\n📍 Unique locations: 1430\n\n📋 Unique complete rows: 5105\n\n📝 Import steps: chemsprops.CNSOTER\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset. Somewhat over-represents forest soils.\n\n📕 Martinovic J., (2000) “Tla u Hrvatskoj”, Monografija, Drzavna uprava za zastitu prirode i okolisa, str. 269, Zagreb. ISBN: 9536793059 / Basic F., (2014) “The Soils of Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154\n\n🔗 Project website: http://www.haop.hr/\n\n📂 Data download URL: Complete document\n\n📍 Unique locations: 2169\n\n📋 Unique complete rows: 5746\n\n📝 Import steps: chemsprops.bpht\n\n\n\n\n\n\n\nDescription: Texture fractions harmonized at five standard depths (5, 15, 30, 60, and 100 cm) using SISLAC soil profile data for Colombia. Data set available under CC BY license.\n\n📕 Varón-Ramírez, V. M., Araujo-Carrillo, G. A., & Guevara, M. (2022). Colombian soil texture: Building a spatial ensemble model. Earth System Science Data Discussions, 1-30. https://doi.org/10.5194/essd-2021-437\n\n🔗 Project website: https://www.agrosavia.co/\n\n📂 Data download URL: https://dx.doi.org/10.6073/pasta/6dded07af834834ee21a134b247507fd\n\n📍 Unique locations: 4203\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Contains over 1,800 soil samples with total carbon and total N from ten distinct geo-climatic regions throughout the Congo Basin and wider African Great Lakes region. Points are spatially clustered around six core sampling regions.\n\n📕 Summerauer, L., Baumann, P., Ramirez-Lopez, L., Barthel, M., Bauters, M., Bukombe, B., … & Six, J. (2021). Filling a key gap: a soil infrared library for central Africa. Soil Discussions, 1-28.\n\n🔗 Project website: https://github.com/laura-summerauer/ssl-central-africa\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.4320395\n\n📍 Unique locations: 920\n\n📋 Unique complete rows: 1852\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National legacy soil profile database for Costa Rica.\n\n📕 Mata, R., Vazquez, A., Rosales, A., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociacion Costarricense de la Ciencia del Suelo, San Jose, CRC. Escala, 1, 200000.\n\n🔗 Project website: http://www.cia.ucr.ac.cr\n\n📂 Data download URL: zip file\n\n📍 Unique locations: 472\n\n📋 Unique complete rows: 2042\n\n📝 Import steps: chemsprops.CostaRica\n\n\n\n\n\n\n\nDescription: Soil polygon map of Estonia and various derived grids. Point data (1,121 samples) is not publicly available but can be obtained by contacting the authors.\n\n📕 Kmoch, A., Kanal, A., Astover, A., Kull, A., Virro, H., Helm, A., Pärtel, M., Ostonen, I., and Uuemaa, E. (2021). EstSoil-EH: a high-resolution eco-hydrological modelling parameters dataset for Estonia, Earth Syst. Sci. Data, 13, 83–97. https://doi.org/10.5194/essd-13-83-2021\n\n🔗 Project website: https://landscape-geoinformatics.ut.ee/estsoil-eh-dataset\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.3473289\n\n📍 Unique locations: 3373\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Full soil profiles with results of the chemical and physical analyses of the soil profiles and monitoring + results of management practices related to soil data. Locations of the points have been degraded with minimum error of 1 km to avoid legal issues with land owners / farmers.\n\n📕 Saby, N. P. A., Chenu, J.-P., Szergi, T., Csorba, A., Bertuzzi, P., Toutain, B., … Creamer, R. (2020). French RMQS soil profile and monitoring dataset with related management practices data. Recherche Data Gouv. https://doi.org/10.15454/AIQ9WS / Saby, N. P. A., Thioulouse, J., Jolivet, C. C., Ratié, C., Boulonne, L., Bispo, A., & Arrouays, D. (2009). Multivariate analysis of the spatial patterns of 8 trace elements using the French soil monitoring network data. Science of the Total Environment, 407(21), 5644-5652. http://dx.doi.org/10.1016/j.scitotenv.2009.07.002\n🔗 Project website: https://landmarkproject.eu/\n\n📂 Data download URL: https://doi.org/10.15454/AIQ9WS\n\n📍 Unique locations: 2171\n\n📋 Unique complete rows: 4149\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: For protection of data privacy, the coordinate was randomly generated within a radius of 4-km around the planned sampling point.\n\n📕 Poeplau, C., Jacobs, A., Don, A., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks of organic carbon in German agricultural soils—Key results of the first comprehensive inventory. Journal of Plant Nutrition and Soil Science, 183(6), 665-681.\n\n🔗 Project website: https://www.thuenen.de/de/ak/\n\n📂 Data download URL: https://doi.org/10.3220/DATA20200203151139\n\n📍 Unique locations: 3104\n\n📋 Unique complete rows: 17187\n\n📝 Import steps: chemsprops.BZE_LW\n\n\n\n\n\n\n\nDescription: Described in literature but not yet imported to AfSPDB.\n\n📕 Owusu, S., Yigini, Y., Olmedo, G. F., & Omuto, C. T. (2020). Spatial prediction of soil organic carbon stocks in Ghana using legacy data. Geoderma, 360, 114008.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Soil samples (0-20 cm, 20-50 cm) collected within the AfSIS-II project. Coordinates of points are not available. Sample reference and soil spectral data available under CC-0 license.\n\n📕 Hengl, T., Miller, M.A.E., Križan, J. et al. (2021). African soil properties and nutrients mapped at 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y\n\n🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils\n\n📂 Data download URL: https://doi.org/10.34725/DVN/SPRSFN\n\n📍 Unique locations:\n\n📋 Unique complete rows: 3013\n\n📝 Import steps: AfSIS2\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset. In 2012/2013, 246 profile pits were sampled and analysed as part of the Irish Soil Information System project to fill in gaps in the description of representative profile data for Ireland. The point data is not publicly available.\n\n📕 Creamer, R., & O’Sullivan, L. (Eds.). (2018). The soils of Ireland. Springer. ISBN: 9783319711898.\n\n🔗 Project website: http://soils.teagasc.ie/\n\n📂 Data download URL:\n\n📍 Unique locations: 246\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National legacy soil profile dataset.\n\n📕 Mohammad, H. B. (2000). Soil resources and use potentiality map of Iran. Soil and Water Research Institute, Teheran, Iran. / Dewan, M. L., & Famouri, J. (1964). The soils of Iran. Food and Agriculture Organization of the United Nations.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 1373\n\n📋 Unique complete rows: 4759\n\n📝 Import steps: chemsprops.IRANSPDB\n\n\n\n\n\n\n\nDescription: Compilation of soil spectral data from various projects.\n\n📕 NA\n\n🔗 Project website: https://www.modelfarm-aro.org/subject-areas/the-national-soil-spectral-library-of-israel/?lang=en\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows: 4000\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Soil profile observation compiled from Nigeria National Legacy data and IITA Project sites. Submitted by Tunrayo Alabi, CGIAR - Consortium for Spatial Information (CGIAR-CSI). Overlaps with the Africa Soil profiles dataset.\n\n📕 Leenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01. / Akpa, S. I., Odeh, I. O., Bishop, T. F., Hartemink, A. E., & Amapu, I. Y. (2016). Total soil organic carbon and carbon sequestration potential in Nigeria. Geoderma, 271, 202-215.\n\n🔗 Project website: https://www.africageoportal.com\n\n📂 Data download URL: https://www.africageoportal.com/datasets/CSI::legacy-soils-and-national-surveys/about\n\n📍 Unique locations:\n\n📋 Unique complete rows: 2569\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Legacy soil profile dataset.\n\n📕 Coetzee, M. E. (2001). NAMSOTER, a SOTER database for Namibia. Agroecological Zoning, 458.\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations: 1014\n\n📋 Unique complete rows: 2953\n\n📝 Import steps: chemsprops.LandPKS\n\n\n\n\n\n\n\nDescription: Legacy dataset. The National Soil Inventory of Scotland (NSIS 1978-88) dataset was collected at sampling points arranged on a 10 km grid across the country. The data set is maintained and distributed by the James Hutton Institute under Ordnance Survey Open Data (Data).\n\n📕 Lilly, A., Bell, J.S., Hudson, G., Nolan, A.J. & Towers. W. (Compilers) (2010). National soil inventory of Scotland (NSIS_1); site location, sampling and profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230\n\n🔗 Project website: http://soils.environment.gov.scot/\n\n📂 Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download\n\n📍 Unique locations: 721\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Legacy dataset. The National Soil Inventory of Slovenia (agricultural land only).\n\n📕 Vrščaj, B., Repe, B., Simončič, P., & Vrščaj, B. (2017). Soil Information. The Soils of Slovenia, 157-170. https://doi.org/10.1007/978-94-017-8585-3_7\n\n🔗 Project website: https://rkg.gov.si/vstop/\n\n📂 Data download URL: https://rkg.gov.si/vstop/\n\n📍 Unique locations: 1879\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National SS library.\n\n📕 Baumann, P., Helfenstein, A., Gubler, A., Keller, A., Meuli, R. G., Wächter, D., … & Six, J. (2021). Developing the Swiss soil spectral library for local estimation and monitoring. SOIL Discussions, 1-32. https://doi.org/10.5194/soil-2020-105\n\n🔗 Project website:\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Swiss National soil information system (NABODAT). Proprietary data but can be requested for research purposes. Includes also the Swiss Soil Monitoring Network (NABO).\n\n📕 Rehbein, K., van der Meer, M., Grob, U., Wegmann, F. and Keller, A. 2011. “Das Nationale Bodeninformationssystem NABODAT in der Schweiz”. In Berichte der DBG “Böden verstehen – Böden nutzen –Böden fit machen”, 3–9 September 2011, Berlin http://eprints.dbges.de / Keller, A. (2013). National soil information systems to support spatial planning procedures. disP-The Planning Review, 49(1), 68-71. https://doi.org/10.1080/02513625.2013.799872\n🔗 Project website: https://www.nabodat.ch/\n\n📂 Data download URL:\n\n📍 Unique locations:\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\nDescription: Swiss Biodiversity Monitoring (BDM) soil samples. Focused on monitoring soil bacterial communities.\n\n📕 Mayerhofer, J., Wächter, D., Calanca, P., Kohli, L., Roth, T., Meuli, R. G., & Widmer, F. (2021). Environmental and anthropogenic factors shape major bacterial community types across the complex mountain landscape of switzerland. Frontiers in microbiology, 12, 581430. https://doi.org/10.3389/fmicb.2021.581430\n\n🔗 Project website: https://www.biodiversitymonitoring.ch/index.php/en/home-footer\n\n📂 Data download URL:\n\n📍 Unique locations: 255\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: Tanzanian Soil Information Service. Coordinates of points are available from https://registry.opendata.aws/afsis/. Sample data available under CC-0 license.\n\n📕 Hengl, T., Miller, M.A.E., Križan, J. et al. (2021). African soil properties and nutrients mapped at 30 m spatial resolution using two-scale ensemble machine learning. Scientific Reports, 11, 6130. https://dx.doi.org/10.1038/s41598-021-85639-y\n\n🔗 Project website: https://data.worldagroforestry.org/dataverse/icraf_soils\n\n📂 Data download URL: https://doi.org/10.34725/DVN/XUDGJY\n\n📍 Unique locations:\n\n📋 Unique complete rows: 26,772\n\n📝 Import steps: AfSIS2\n\n\n\n\n\n\n\nDescription: All documentation in Russian only.\n\n📕 Stolbovoy V.S., Molchanov E.N., Sheremet B.V. Morphogenetic basis of the unified state register of soil resources of Russia. Dokuchaev Soil Bulletin. 2016;(86):115-123. https://doi.org/10.19047/0136-1694-2016-86-115-123\n\n🔗 Project website:\n\n📂 Data download URL: http://egrpr.esoil.ru/content/1DB.html\n\n📍 Unique locations: 802\n\n📋 Unique complete rows: 4137\n\n📝 Import steps: chemsprops.EGRPR\n\n\n\n\n\n\n\nDescription: National soil and land use database. Proprietary dataset maintained by Cranfield University. LandIS is a Registered Trademark.\n\n📕 Bradley, R. I., Milne, R., Bell, J., Lilly, A., Jordan, C., & Higgins, A. (2005). A soil carbon and land use database for the United Kingdom. Soil use and Management, 21(4), 363-369. https://doi.org/10.1079/SUM2005351 / Hallett, S.H., Sakrabani, R., Keay, C.A. and Hannam, J.A. (2017). Developments in Land Information Systems: Case studies in land resource management capabilities and options. Soil Use and Management. http://doi.org/10.1111/sum.12380\n🔗 Project website: https://www.landis.org.uk/\n\n📂 Data download URL: https://www.landis.org.uk/soilsguide/series.cfm\n\n📍 Unique locations: 50,000+\n\n📋 Unique complete rows:\n\n📝 Import steps:\n\n\n\n\n\n\n\nDescription: National Cooperative Soil Survey Characterization Database is probably the most comprehensive and most detailed soil profile dataset in the World. It is continuously maintained by the USDA National Cooperative Soil Survey. Data is available under the CC-0 license.\n\n📕 USDA-NRCS, (2016). General description for NCSS Soil Characterization Data. USDA, Natural Resources Conservation Service. / O’Geen, A., Walkinshaw, M., & Beaudette, D. (2017). SoilWeb: A multifaceted interface to soil survey information. Soil Science Society of America Journal, 81(4), 853-862. https://doi.org/10.2136/sssaj2016.11.0386n\n\n🔗 Project website: http://ncsslabdatamart.sc.egov.usda.gov/\n\n📂 Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/\n\n📍 Unique locations: 19861\n\n📋 Unique complete rows: 136011\n\n📝 Import steps: chemsprops.NCSS\n\n\n\n\nDescription: MIR spectral library and associated soil characterization database, which now includes &gt;50,000 MIR spectra collected on soils primarily from the United States. Currently not available publicly for use.\n\n📕 Seybold, C. A., Ferguson, R., Wysocki, D., Bailey, S., Anderson, J., Nester, B., … & Thomas, P. (2019). Application of Mid‐Infrared Spectroscopy in Soil Survey. Soil Science Society of America Journal, 83(6), 1746-1759. https://doi.org/10.2136/sssaj2019.06.0205 / Sanderman, J., Savage, K., & Dangal, S. R. (2020). Mid‐infrared spectroscopy for prediction of soil health indicators in the United States. Soil Science Society of America Journal, 84(1), 251-261. https://doi.org/10.1002/saj2.20009\n\n🔗 Project website: https://www.nrcs.usda.gov/wps/portal/nrcs/main/soils/research/\n\n📂 Data download URL:\n\n📍 Unique locations: 61103\n\n📋 Unique complete rows:\n\n📝 Import steps: sslsprops.KSSL\n\n\n\n\nDescription: Locations of each site have been degraded due to confidentiality and only reflect the general position of each site.\n\n📕 Wills, S. et al. (2013) “Rapid carbon assessment (RaCA) methodology: Sampling and Initial Summary. United States Department of Agriculture.” Natural Resources Conservation Service, National Soil Survey Center.\n\n🔗 Project website: https://www.nrcs.usda.gov/survey/raca/\n\n📂 Data download URL: https://www.nrcs.usda.gov/wps/portal/nrcs/detailfull/soils/research/?cid=nrcs142p2_054164\n\n📍 Unique locations: 6332\n\n📋 Unique complete rows: 143006\n\n📝 Import steps: chemsprops.RaCa\n\n\n\n\nDescription: Systematic geochemical and mineralogical survey of soil horizons analyzed using a consistent set of methods, sample spacing 1 per 1,600 sq km. Data is available under the CC-0 license.\n\n📕 Smith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., and Fey, D.L., (2013). Geochemical and mineralogical data for soils of the conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/ / Smith, D. B., W. F. Cannon, and L. G. Woodruff (2011). A national-scale geochemical and mineralogical survey of soils of the conterminous United States. Appl. Geochem., 26, S250–S255. https://doi.org/10.1016/j.apgeochem.2011.03.116.\n\n🔗 Project website: https://mrdata.usgs.gov/ds-801/\n\n📂 Data download URL: https://mrdata.usgs.gov/ds-801/\n\n📍 Unique locations: 4857\n\n📋 Unique complete rows: 9446\n\n📝 Import steps: chemsprops.USGS.NGS\n\n\n\n\nDescription: Systematic inventory of forest plots.\n\n📕 Domke, G. M., Perry, C. H., Walters, B. F., Nave, L. E., Woodall, C. W., & Swanston, C. W. (2017). Toward inventory‐based estimates of soil organic carbon in forests of the United States. Ecological Applications, 27(4), 1223-1235. https://doi.org/10.1002/eap.1516/ / Forest Inventory and Analysis, (2014). The Forest Inventory and Analysis Database: Database description and user guide version 6.0.1 for Phase 3. U.S. Department of Agriculture, Forest Service. 182 p. [Online]. Available: https://www.fia.fs.fed.us/library/database-documentation/\n\n🔗 Project website: https://www.fia.fs.fed.us\n\n📂 Data download URL: https://apps.fs.usda.gov/fia/datamart/datamart.html\n\n📍 Unique locations: 5149\n\n📋 Unique complete rows: 23208\n\n📝 Import steps: chemsprops.FIADB",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#other-datasets",
    "href": "020-dataset_list.html#other-datasets",
    "title": "Datasets",
    "section": "",
    "text": "Description: This dataset consists of measurements of bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. Soil cores were sampled during early summer in 2013 and 2014. Data publicly available under the Open Government Licence.\n\n📕 Estop-Aragones, C.; Fisher, J.P.; Cooper, M.A.; Thierry, A.; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, I.P. (2016). Bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952\n\n🔗 Project website: http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/\n\n📂 Data download URL: https://catalogue.ceh.ac.uk/documents/efa2a84b-3505-4221-a7da-12af3cdc1952\n\n📍 Unique locations:\n\n📋 Unique complete rows: 2932\n\n📝 Import steps:\n\n\n\n\nDescription: Contains soil profile data at depths of 5 cm and 25 cm from 238 sampling sites for a high and cold mountainous area, Northeastern Qinghai-Tibet Plateau. Includes the soil hydraulic properties include clay, silt, sand, soil organic carbon, soil saturated hydraulic conductivity. Data available under CC-BY license.\n\n📕 Tian, J., Zhang, B., Wang, X., & He, C. (2022). An in situ observation dataset of soil hydraulic properties and soil moisture in a high and cold mountainous area on the northeastern Qinghai-Tibet Plateau. Earth System Science Data Discussions, 1-29. https://doi.org/10.5194/essd-2022-21\n\n🔗 Project website: https://data.tpdc.ac.cn/\n\n📂 Data download URL: https://doi.org/10.5281/zenodo.5830583\n\n📍 Unique locations: 238\n\n📋 Unique complete rows:\n\n📝 Import steps:",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#chemical-soil-variables",
    "href": "020-dataset_list.html#chemical-soil-variables",
    "title": "Datasets",
    "section": "Chemical soil variables",
    "text": "Chemical soil variables",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#physical-soil-variables",
    "href": "020-dataset_list.html#physical-soil-variables",
    "title": "Datasets",
    "section": "Physical soil variables",
    "text": "Physical soil variables",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#biological-soil-variables",
    "href": "020-dataset_list.html#biological-soil-variables",
    "title": "Datasets",
    "section": "Biological soil variables",
    "text": "Biological soil variables",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#soil-classification",
    "href": "020-dataset_list.html#soil-classification",
    "title": "Datasets",
    "section": "Soil classification",
    "text": "Soil classification",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "020-dataset_list.html#site-observations",
    "href": "020-dataset_list.html#site-observations",
    "title": "Datasets",
    "section": "Site observations",
    "text": "Site observations",
    "crumbs": [
      "Home",
      "Data import",
      "Datasets"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html",
    "href": "035-import_wrb_data.html",
    "title": "WRB soil types",
    "section": "",
    "text": "This section describes import steps used to produce a global compilation of FAO’s IUSS’s World Reference Base (WRB) observations of soil types. Classes are either used as-is or a translated from some local or international system. Correlation tables are available in the folder ./correlation and is based on various literature sources. Correlation is not trivial and often not 1:1 so we typically use 2–3 options for translating soil types (Krasilnikov et al. 2009). Output compilations are available in the folder ./out. Please refer to the dataset version / DOI to ensure full reproducibility of your modeling.\nThis dataset is currently used to produce soil type maps of the world at various spatial resolutions. To add new dataset please open a new issue or do a merge request.\n\n\n\nThere are currently several global datasets that reference distribution of WRB classes. For building training points for predictive soil type mapping the most comprehensive dataset seems to be World Soil Information Service (WoSIS) soil profile database (available via: https://www.isric.org/explore/wosis) (Batjes, Ribeiro, and Van Oostrum 2020).\nYou can download the most up-to-date snapshot of the most up-to-date WOSIS Geopackage file directly by using the ISRIC’s Web Feature Service. Below is an example of a snapshot downloaded on 10-April-2023:\n\nwosis = sf::read_sf(\"/mnt/landmark/HWSDv2/wosis_latest_profiles.gpkg\")\nsummary(as.factor(wosis$cwrb_version))\n\nThe WRB soil types can be generate by combining multiple columns:\n\nwosis$wrb4 = paste0(ifelse(is.na(wosis$cwrb_prefix_qualifier), \"\", paste0(wosis$cwrb_prefix_qualifier, \" \")), wosis$cwrb_reference_soil_group, ifelse(is.na(wosis$cwrb_suffix_qualifier), \"\", paste0(\" \", wosis$cwrb_suffix_qualifier)))\nsummary(as.factor(wosis$wrb4), maxsum=20)\n\nThis finally gives about 30,000 soil points with soil classification:\n\nwosis.wrb = wosis[!wosis$wrb4==\"NA\", c(\"profile_id\", \"geom_accuracy\", \"latitude\", \"longitude\", \"wrb4\", \"dataset_id\")]\nstr(wosis.wrb)\n#plot(wosis.wrb[,c(\"longitude\",\"latitude\")])\n\nWe can write the summary distribution of soil types by using:\n\nxs0 = summary(as.factor(wosis.wrb$wrb4), maxsum = length(levels(as.factor(wosis.wrb$wrb4))))\nwrite.csv(data.frame(WRB=attr(xs0, \"names\"), count=xs0), \"./correlation/wosis.wrb_summary.csv\")\n\nAfter some clean-up, we can prepare a harmonized legend that now has consistently WRB soil types up to the level of great-group + prefix and with soil points that have a location accuracy of not worse than 1 km:\n\nh.wosis = read.csv(\"./correlation/WOSIS_WRB_legend.csv\")\nh.wosis$wrb4 = h.wosis$WRB\nwosis.wrb$h_wrb4 = plyr::join(as.data.frame(wosis.wrb[\"wrb4\"]), h.wosis)$h_wrb4\n## copy values\nwosis.wrb2 = wosis.wrb\nwosis.wrb2$h_wrb4 = plyr::join(as.data.frame(wosis.wrb2[\"wrb4\"]), h.wosis)$h_wrb4.2\n#summary(as.factor(wosis.wrb$h_wrb4))\n#str(levels(as.factor(wosis.wrb$h_wrb4)))\n## remove points with poor location accuracy\nh.wosis.wrb = rbind(\n     as.data.frame(wosis.wrb[!(is.na(wosis.wrb$h_wrb4)|wosis.wrb$h_wrb4==\"\"|wosis.wrb$geom_accuracy&gt;0.08334),]), \n     as.data.frame(wosis.wrb2[!(is.na(wosis.wrb2$h_wrb4)|wosis.wrb2$h_wrb4==\"\"|wosis.wrb2$geom_accuracy&gt;0.08334),]))\nh.wosis.wrb$source_db = h.wosis.wrb$dataset_id\ndim(h.wosis.wrb)\nsaveRDS.gz(h.wosis.wrb, \"./correlation/h.wosis.wrb.rds\")\n\nwhich can be now considered an analysis-ready point dataset with h_wrb4 being the harmonized value of the soil type:\n\nh.wosis.wrb = readRDS(\"./correlation/h.wosis.wrb.rds\")\nhead(h.wosis.wrb)\n\n  profile_id geom_accuracy latitude longitude      wrb4\n1      47431      0.000100   6.5875    2.1525  Planosol\n2      47478      0.010000   6.5875    2.1900  Planosol\n3      47503      0.000100   6.5875    2.2262  Planosol\n4      47596      0.000100   6.8733    2.3458   Acrisol\n5      52678      0.000278   1.0700   34.9000  Vertisol\n6      52686      0.000278   0.9400   34.9500 Ferralsol\n                  dataset_id                  geom           h_wrb4\n1  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.1525 6.5875) Eutric Planosols\n2  {AF-AfSP,BJSOTER,WD-WISE}   POINT (2.19 6.5875) Eutric Planosols\n3  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.2262 6.5875) Eutric Planosols\n4  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.3458 6.8733)  Haplic Acrisols\n5 {AF-AfSP,KE-SOTER,WD-WISE}     POINT (34.9 1.07) Haplic Vertisols\n6 {AF-AfSP,KE-SOTER,WD-WISE}    POINT (34.95 0.94) Geric Ferralsols\n                   source_db\n1  {AF-AfSP,BJSOTER,WD-WISE}\n2  {AF-AfSP,BJSOTER,WD-WISE}\n3  {AF-AfSP,BJSOTER,WD-WISE}\n4  {AF-AfSP,BJSOTER,WD-WISE}\n5 {AF-AfSP,KE-SOTER,WD-WISE}\n6 {AF-AfSP,KE-SOTER,WD-WISE}\n\n\n\n\n\nA disadvantage of using only legacy soil profiles, however, is that these are often spatially clustered i.e. large gaps exists where almost no data available. This applies especially for African and Asian continents. To increase spatial coverage of the training points for global soil type mapping, we can add points generated from the global soil polygon map e.g. Harmonized World Soil Database (HWSD) (FAO & IIASA 2023). This can be done in three steps: first, we prepare summary of all WRB soil types in the HWSDv2:\n\nhwsd &lt;- mdb.get(\"/mnt/landmark/HWSDv2/HWSD2.mdb\")\n#str(hwsd)\nwrb.leg = hwsd$D_WRB4\n#str(wrb.leg)\nwrb.leg$WRB4 = wrb.leg$CODE\nlayer = hwsd$HWSD2_LAYERS[,c(\"HWSD2.SMU.ID\", \"WRB4\")]\nlayer$VALUE = plyr::join(layer, wrb.leg[c(\"VALUE\",\"WRB4\")], match=\"first\")$VALUE\nxs = summary(as.factor(layer$VALUE), maxsum = nrow(wrb.leg))\nwrite.csv(data.frame(WRB4=attr(xs, \"names\"), count=xs), \"./correlation/hwsd2_summary.csv\")\n\nThe ./correlation/hwsd2_summary.csv table now shows which are the most frequent soil types for the world based on the HWSDv2. Note, these are primarily expert-based and of unknown uncertainty / confidence, so should be used with caution, unlike WoSIS and other legacy soil profiles which are based on actual soil observations and fieldwork.\nSecond, we can prepare a raster layer that we can use to randomly draw training points using some probability sampling e.g. Simple Random Sampling. Because we want to draw samples from an equal area space, a good idea is to convert the original HWSD raster to the IGH projection:\n\nrgdal::GDALinfo(\"/mnt/landmark/HWSDv2/HWSD2.bil\")\n## 1km resolution\nte = c(-20037508,-6728980, 20037508, 8421750)\ngh.prj = \"+proj=igh +ellps=WGS84 +units=m +no_defs\"\nsystem(paste0('gdalwarp /mnt/landmark/HWSDv2/HWSD2.bil /mnt/landmark/HWSDv2/HWSD2_gh_1km.tif -r \\\"near\\\" \n      --config CHECK_WITH_INVERT_PROJ TRUE -t_srs \\\"', gh.prj, \n      '\\\" -co \\\"COMPRESS=DEFLATE\\\" -tr 1000 1000 -overwrite -te ', \n      paste(te, collapse = \" \")))\n\nNow we can sample random points from the projected raster by using the terra package functionality (Hijmans 2019). We generate 100,000 random points, although in principle we can later on subset the points to much less points as needed.\n\nrnd.hwsd = terra::spatSample(terra::rast(\"/mnt/landmark/HWSDv2/HWSD2_gh_1km.tif\"), \n                             size=1e5, method=\"random\", na.rm=TRUE, xy=TRUE)\n## merge and make WRB4 layer\nnames(rnd.hwsd)[3] = \"HWSD2.SMU.ID\"\nrnd.hwsd$WRB4 = plyr::join(rnd.hwsd, layer[c(\"HWSD2.SMU.ID\",\"VALUE\")], match=\"first\")$VALUE\nrnd.sf = sf::st_as_sf(rnd.hwsd, coords = c(1,2), crs=gh.prj)\nrnd.ll &lt;- rnd.sf %&gt;% sf::st_transform(4326)\nunlink(\"./correlation/sim_hwsdv2_pnts.gpkg\")\nsf::write_sf(rnd.ll, \"./correlation/sim_hwsdv2_pnts.gpkg\", driver = \"GPKG\")\nsaveRDS(rnd.ll, \"./correlation/sim_hwsdv2_pnts.rds\")\n\nWe can further harmonize values using a correlation legend:\n\nrnd.ll = readRDS(\"./correlation/sim_hwsdv2_pnts.rds\")\nh.hwsd = read.csv(\"./correlation/HWSDv2_WRB_legend.csv\")\nhwsd.wrb = as.data.frame(cbind(rnd.ll, sf::st_coordinates(rnd.ll)))\nhwsd.wrb = plyr::rename(hwsd.wrb, c(\"X\"=\"longitude\", \"Y\"=\"latitude\"))\nhwsd.wrb$h_wrb4 = plyr::join(hwsd.wrb, h.hwsd)$h_wrb4\n\nJoining by: WRB4\n\nhwsd.wrb$source_db = \"HWSDv2\"\nhwsd.wrb$profile_id = paste0(\"SIM\", 1:nrow(hwsd.wrb))\n## subset to complete points\nhwsd.wrb = hwsd.wrb[!is.na(hwsd.wrb$WRB4),]\n\nwhich now also has a harmonized column h_wrb4 compatible to the column produced using the WoSIS points:\n\nhead(hwsd.wrb)\n\n  HWSD2.SMU.ID               WRB4  longitude latitude\n1         1467    Ferric Lixisols   8.290244 13.93512\n2        11321         Anthrosols  82.118452 41.73180\n3        26612 Calcaric Cambisols  33.212770 15.03106\n4        16664   Eutric Cambisols  38.366071 10.60237\n5         3387    Cambic Cryosols -64.448944 55.92456\n6        11805    Haplic Acrisols 118.358546 25.82881\n                    geometry             h_wrb4 source_db profile_id\n1  POINT (8.290244 13.93512)    Ferric Lixisols    HWSDv2       SIM1\n2   POINT (82.11845 41.7318)               &lt;NA&gt;    HWSDv2       SIM2\n3  POINT (33.21277 15.03106) Calcaric Cambisols    HWSDv2       SIM3\n4  POINT (38.36607 10.60237)   Eutric Cambisols    HWSDv2       SIM4\n5 POINT (-64.44894 55.92456)    Cambic Cryosols    HWSDv2       SIM5\n6  POINT (118.3585 25.82881)    Haplic Acrisols    HWSDv2       SIM6\n\n\nSo in summary we have prepared two point datasets from WoSIS and HSWDv2. WoSIS are the actual observations of soil types and should be considered ground-truth. The HWSDv2 contains the WRB 2022 version soil types per mapping unit, but these are potentially of variable accuracy and should be only used to fill gaps in training data. We had to manually adjust harmonize some classes that we either outdated (old WRB versions) or are missing prefix / suffix.\nThere are many more point datasets with WRB classification or compatible classification that could be added to the list of training points. Below we list most recent datasets with soil types that we import and add to WoSIS to produce the most up-to-date compilation of soil training data.\n\n\n\nIn addition to WoSIS and HWSDv2, we can also add some additional point datasets that are not yet included in any global compilation but potentially contain ground-truth observations of soil types. For example, we can use point observations coming from the land-surface observations e.g.  to represent shifting sand and bare-rock areas. For example, global land cover validation data sets that are produced by photo-interpretation of very high resolution satellite imagery (e.g. 20 cm spatial resolution) often contain useful observations of the shifting sand, permanent ice and bare-rocks (Tsendbazar et al. 2021). These specific surface materials are often missing or are systematically under-represented in the legacy soil profile datasets. Here is an example of almost 6000 observations of bare rock and shifting sands:\n\nlc.xy = readRDS(\"./correlation/photointerpretation_leptosol.rds\")\nsummary(as.factor(lc.xy$h_wrb4))\n\nLithic Leptosols   Shifting sands \n            3928             2156 \n\n\nNote that we define the Shifting sands as an additional category of soil type as these are arbitrarily either masked out or (controversially) classified to different soil types. We consider that it is more consistent to map shifting sands as a separate category of land.\nAnother dataset interesting for soil type mapping are the legacy soil observations focused on tropical peatlands, published in the literature, then digitized manually (Hengl 2016; Gumbricht et al. 2017):\n\npeat.xy = read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR_v1.csv\", na.strings = c(\"\", \"NA\"))\npeat.xy = plyr::rename(peat.xy, c(\"TAXNWRB\"=\"h_wrb4\", \"modelling.x\"=\"longitude\", \"modelling.y\"=\"latitude\", \"SOURCEID\"=\"profile_id\"))\npeat.xy$source_db = \"CIFOR_peatlands\"\npeat.xy = peat.xy[!is.na(peat.xy$longitude) & !is.na(peat.xy$h_wrb4), c(\"profile_id\", \"source_db\",\"longitude\", \"latitude\", \"h_wrb4\")]\n\nPeatlands and inaccessible tropical soil types are often under-represented and hence this dataset helps reduce the bias in under-representing tropical soils.\nCroatian soil profile database also contains soil types still in FAO classification system (Antonić, Pernar, and Jelaska 2003):\n\nhr.xy = readRDS(\"./correlation/hrspdb_pnts.rds\")\nhr.xy2 = hr.xy[,-which(names(hr.xy) == \"h_wrb4\")]\nhr.xy2 = plyr::rename(hr.xy2, c(\"h_wrb4.2\"=\"h_wrb4\"))\n\nLegacy soil observations for Italy (Righini, Costantini, and Sulli 2001; Vecchio, Barberis, and Bourlot 2002):\n\nit.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Italy.rds\")\nit.xy = plyr::rename(it.xy, c(\"wrb2015\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"long\"=\"longitude\"))\nit.xy$source_db = \"Italian_SPDB\"\n\nGerman agricultural soil inventory dataset (Poeplau et al. 2020):\n\nde.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Germany.rds\")\nde.xy = plyr::rename(de.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"PointID\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nde.xy$Specific.soil.subtype = NULL\nde.xy$source_db = \"BZE_LW\"\nde.xy2 = de.xy[,-which(names(de.xy) == \"h_wrb4\")]\nde.xy2 = plyr::rename(de.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))\n\nFrench RMQS soil profile and monitoring dataset (Saby et al. 2020):\n\nfr.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_France.rds\")\nfr.xy = plyr::rename(fr.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nfr.xy$signific_ger_95 = NULL\nfr.xy$source_db = \"RMQS1\"\nfr.xy2 = fr.xy[,-which(names(fr.xy) == \"h_wrb4\")]\nfr.xy2 = plyr::rename(fr.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))\n\n\n\n\nMultiple imported point datasets can be finally combined into a single global consistent analysis-ready training dataset (here we limit to max 20,000 simulated points):\n\nsel.cn = c(\"profile_id\",\"latitude\", \"longitude\", \"h_wrb4\", \"source_db\")\ntr.pnts = plyr::rbind.fill(list(h.wosis.wrb[, sel.cn], \n      hwsd.wrb[sample.int(2e4, n = nrow(hwsd.wrb)), sel.cn],\n      lc.xy, hr.xy2[, sel.cn], \n      peat.xy[, sel.cn],\n      hr.xy[, sel.cn],\n      it.xy[, sel.cn], de.xy[, sel.cn], de.xy2[, sel.cn], \n      fr.xy[, sel.cn], fr.xy2[, sel.cn]))\n\nWe can clean-up some systematic naming issues common in many soil DBs:\n\ntr.pnts$h_wrb4 = gsub(\",\", \" \", tr.pnts$h_wrb4)\ntr.pnts$h_wrb4 = gsub(\"distric\", \"dystric\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol \", \"sols \", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol$\", \"sols\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = ifelse(tr.pnts$h_wrb4==\"\", NA, tr.pnts$h_wrb4)\n## subset to complete points:\ntr.pnts = tr.pnts[!is.na(tr.pnts$h_wrb4)&!is.na(tr.pnts$longitude),]\n\nThis gives a total of about 70,000 training points with WRB soil type. Note that correlation between different national systems is not trivial and hence you should always check the folder ./correlation to see if some soil types are possibly incorrectly correlated. Also, IUSS and FAO are kind to maintain the World Reference Base (WRB), but a table correlating various versions of WRB is often not trivial and we have to somewhat improvise (or ignore the issue) that some soil types have changed over time.\n\nwrb.pnts_profiles_sf &lt;- sf::st_as_sf(tr.pnts, coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_profiles.png\")){\n  plot_gh(wrb.pnts_profiles_sf, out.pdf=\"./img/sol_wrb.pnts_profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_profiles.pdf ./img/sol_wrb.pnts_profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_profiles.png ./img/sol_wrb.pnts_profiles.png\")\n}\n\n\n\n\n\n\nA global compilation of soil profiles with WRB soil type classification.\n\n\n\n\n\nwrb.pnts_profilesL_sf &lt;- sf::st_as_sf(tr.pnts[!(tr.pnts$source_db %in% c(\"HWSDv2\", \"GlobalLCV\")),], coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_tot.profiles.png\")){\n  plot_gh(wrb.pnts_profilesL_sf, out.pdf=\"./img/sol_wrb.pnts_tot.profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_tot.profiles.pdf ./img/sol_wrb.pnts_tot.profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_tot.profiles.png ./img/sol_wrb.pnts_tot.profiles.png\")\n}\n\n\n\n\n\n\nA global compilation of soil profiles with WRB soil type classification: a subset with actual soil profiles.\n\n\n\n\nWe can export the final training points to Geopackage file by using e.g.:\n\nsf::write_sf(sf::st_as_sf(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \n                          coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\"), \n      paste0(\"./out/gpkg/sol_wrb.pnts_profiles.gpkg\"), driver = \"GPKG\")\nsaveRDS(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \"./out/rds/sol_wrb.pnts_profiles.rds\")\n#save.image.pigz(file=\"soilwrb.RData\")",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html#overview",
    "href": "035-import_wrb_data.html#overview",
    "title": "WRB soil types",
    "section": "",
    "text": "This section describes import steps used to produce a global compilation of FAO’s IUSS’s World Reference Base (WRB) observations of soil types. Classes are either used as-is or a translated from some local or international system. Correlation tables are available in the folder ./correlation and is based on various literature sources. Correlation is not trivial and often not 1:1 so we typically use 2–3 options for translating soil types (Krasilnikov et al. 2009). Output compilations are available in the folder ./out. Please refer to the dataset version / DOI to ensure full reproducibility of your modeling.\nThis dataset is currently used to produce soil type maps of the world at various spatial resolutions. To add new dataset please open a new issue or do a merge request.",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html#wosis-point-datasets",
    "href": "035-import_wrb_data.html#wosis-point-datasets",
    "title": "WRB soil types",
    "section": "",
    "text": "There are currently several global datasets that reference distribution of WRB classes. For building training points for predictive soil type mapping the most comprehensive dataset seems to be World Soil Information Service (WoSIS) soil profile database (available via: https://www.isric.org/explore/wosis) (Batjes, Ribeiro, and Van Oostrum 2020).\nYou can download the most up-to-date snapshot of the most up-to-date WOSIS Geopackage file directly by using the ISRIC’s Web Feature Service. Below is an example of a snapshot downloaded on 10-April-2023:\n\nwosis = sf::read_sf(\"/mnt/landmark/HWSDv2/wosis_latest_profiles.gpkg\")\nsummary(as.factor(wosis$cwrb_version))\n\nThe WRB soil types can be generate by combining multiple columns:\n\nwosis$wrb4 = paste0(ifelse(is.na(wosis$cwrb_prefix_qualifier), \"\", paste0(wosis$cwrb_prefix_qualifier, \" \")), wosis$cwrb_reference_soil_group, ifelse(is.na(wosis$cwrb_suffix_qualifier), \"\", paste0(\" \", wosis$cwrb_suffix_qualifier)))\nsummary(as.factor(wosis$wrb4), maxsum=20)\n\nThis finally gives about 30,000 soil points with soil classification:\n\nwosis.wrb = wosis[!wosis$wrb4==\"NA\", c(\"profile_id\", \"geom_accuracy\", \"latitude\", \"longitude\", \"wrb4\", \"dataset_id\")]\nstr(wosis.wrb)\n#plot(wosis.wrb[,c(\"longitude\",\"latitude\")])\n\nWe can write the summary distribution of soil types by using:\n\nxs0 = summary(as.factor(wosis.wrb$wrb4), maxsum = length(levels(as.factor(wosis.wrb$wrb4))))\nwrite.csv(data.frame(WRB=attr(xs0, \"names\"), count=xs0), \"./correlation/wosis.wrb_summary.csv\")\n\nAfter some clean-up, we can prepare a harmonized legend that now has consistently WRB soil types up to the level of great-group + prefix and with soil points that have a location accuracy of not worse than 1 km:\n\nh.wosis = read.csv(\"./correlation/WOSIS_WRB_legend.csv\")\nh.wosis$wrb4 = h.wosis$WRB\nwosis.wrb$h_wrb4 = plyr::join(as.data.frame(wosis.wrb[\"wrb4\"]), h.wosis)$h_wrb4\n## copy values\nwosis.wrb2 = wosis.wrb\nwosis.wrb2$h_wrb4 = plyr::join(as.data.frame(wosis.wrb2[\"wrb4\"]), h.wosis)$h_wrb4.2\n#summary(as.factor(wosis.wrb$h_wrb4))\n#str(levels(as.factor(wosis.wrb$h_wrb4)))\n## remove points with poor location accuracy\nh.wosis.wrb = rbind(\n     as.data.frame(wosis.wrb[!(is.na(wosis.wrb$h_wrb4)|wosis.wrb$h_wrb4==\"\"|wosis.wrb$geom_accuracy&gt;0.08334),]), \n     as.data.frame(wosis.wrb2[!(is.na(wosis.wrb2$h_wrb4)|wosis.wrb2$h_wrb4==\"\"|wosis.wrb2$geom_accuracy&gt;0.08334),]))\nh.wosis.wrb$source_db = h.wosis.wrb$dataset_id\ndim(h.wosis.wrb)\nsaveRDS.gz(h.wosis.wrb, \"./correlation/h.wosis.wrb.rds\")\n\nwhich can be now considered an analysis-ready point dataset with h_wrb4 being the harmonized value of the soil type:\n\nh.wosis.wrb = readRDS(\"./correlation/h.wosis.wrb.rds\")\nhead(h.wosis.wrb)\n\n  profile_id geom_accuracy latitude longitude      wrb4\n1      47431      0.000100   6.5875    2.1525  Planosol\n2      47478      0.010000   6.5875    2.1900  Planosol\n3      47503      0.000100   6.5875    2.2262  Planosol\n4      47596      0.000100   6.8733    2.3458   Acrisol\n5      52678      0.000278   1.0700   34.9000  Vertisol\n6      52686      0.000278   0.9400   34.9500 Ferralsol\n                  dataset_id                  geom           h_wrb4\n1  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.1525 6.5875) Eutric Planosols\n2  {AF-AfSP,BJSOTER,WD-WISE}   POINT (2.19 6.5875) Eutric Planosols\n3  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.2262 6.5875) Eutric Planosols\n4  {AF-AfSP,BJSOTER,WD-WISE} POINT (2.3458 6.8733)  Haplic Acrisols\n5 {AF-AfSP,KE-SOTER,WD-WISE}     POINT (34.9 1.07) Haplic Vertisols\n6 {AF-AfSP,KE-SOTER,WD-WISE}    POINT (34.95 0.94) Geric Ferralsols\n                   source_db\n1  {AF-AfSP,BJSOTER,WD-WISE}\n2  {AF-AfSP,BJSOTER,WD-WISE}\n3  {AF-AfSP,BJSOTER,WD-WISE}\n4  {AF-AfSP,BJSOTER,WD-WISE}\n5 {AF-AfSP,KE-SOTER,WD-WISE}\n6 {AF-AfSP,KE-SOTER,WD-WISE}",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html#hwsdv2",
    "href": "035-import_wrb_data.html#hwsdv2",
    "title": "WRB soil types",
    "section": "",
    "text": "A disadvantage of using only legacy soil profiles, however, is that these are often spatially clustered i.e. large gaps exists where almost no data available. This applies especially for African and Asian continents. To increase spatial coverage of the training points for global soil type mapping, we can add points generated from the global soil polygon map e.g. Harmonized World Soil Database (HWSD) (FAO & IIASA 2023). This can be done in three steps: first, we prepare summary of all WRB soil types in the HWSDv2:\n\nhwsd &lt;- mdb.get(\"/mnt/landmark/HWSDv2/HWSD2.mdb\")\n#str(hwsd)\nwrb.leg = hwsd$D_WRB4\n#str(wrb.leg)\nwrb.leg$WRB4 = wrb.leg$CODE\nlayer = hwsd$HWSD2_LAYERS[,c(\"HWSD2.SMU.ID\", \"WRB4\")]\nlayer$VALUE = plyr::join(layer, wrb.leg[c(\"VALUE\",\"WRB4\")], match=\"first\")$VALUE\nxs = summary(as.factor(layer$VALUE), maxsum = nrow(wrb.leg))\nwrite.csv(data.frame(WRB4=attr(xs, \"names\"), count=xs), \"./correlation/hwsd2_summary.csv\")\n\nThe ./correlation/hwsd2_summary.csv table now shows which are the most frequent soil types for the world based on the HWSDv2. Note, these are primarily expert-based and of unknown uncertainty / confidence, so should be used with caution, unlike WoSIS and other legacy soil profiles which are based on actual soil observations and fieldwork.\nSecond, we can prepare a raster layer that we can use to randomly draw training points using some probability sampling e.g. Simple Random Sampling. Because we want to draw samples from an equal area space, a good idea is to convert the original HWSD raster to the IGH projection:\n\nrgdal::GDALinfo(\"/mnt/landmark/HWSDv2/HWSD2.bil\")\n## 1km resolution\nte = c(-20037508,-6728980, 20037508, 8421750)\ngh.prj = \"+proj=igh +ellps=WGS84 +units=m +no_defs\"\nsystem(paste0('gdalwarp /mnt/landmark/HWSDv2/HWSD2.bil /mnt/landmark/HWSDv2/HWSD2_gh_1km.tif -r \\\"near\\\" \n      --config CHECK_WITH_INVERT_PROJ TRUE -t_srs \\\"', gh.prj, \n      '\\\" -co \\\"COMPRESS=DEFLATE\\\" -tr 1000 1000 -overwrite -te ', \n      paste(te, collapse = \" \")))\n\nNow we can sample random points from the projected raster by using the terra package functionality (Hijmans 2019). We generate 100,000 random points, although in principle we can later on subset the points to much less points as needed.\n\nrnd.hwsd = terra::spatSample(terra::rast(\"/mnt/landmark/HWSDv2/HWSD2_gh_1km.tif\"), \n                             size=1e5, method=\"random\", na.rm=TRUE, xy=TRUE)\n## merge and make WRB4 layer\nnames(rnd.hwsd)[3] = \"HWSD2.SMU.ID\"\nrnd.hwsd$WRB4 = plyr::join(rnd.hwsd, layer[c(\"HWSD2.SMU.ID\",\"VALUE\")], match=\"first\")$VALUE\nrnd.sf = sf::st_as_sf(rnd.hwsd, coords = c(1,2), crs=gh.prj)\nrnd.ll &lt;- rnd.sf %&gt;% sf::st_transform(4326)\nunlink(\"./correlation/sim_hwsdv2_pnts.gpkg\")\nsf::write_sf(rnd.ll, \"./correlation/sim_hwsdv2_pnts.gpkg\", driver = \"GPKG\")\nsaveRDS(rnd.ll, \"./correlation/sim_hwsdv2_pnts.rds\")\n\nWe can further harmonize values using a correlation legend:\n\nrnd.ll = readRDS(\"./correlation/sim_hwsdv2_pnts.rds\")\nh.hwsd = read.csv(\"./correlation/HWSDv2_WRB_legend.csv\")\nhwsd.wrb = as.data.frame(cbind(rnd.ll, sf::st_coordinates(rnd.ll)))\nhwsd.wrb = plyr::rename(hwsd.wrb, c(\"X\"=\"longitude\", \"Y\"=\"latitude\"))\nhwsd.wrb$h_wrb4 = plyr::join(hwsd.wrb, h.hwsd)$h_wrb4\n\nJoining by: WRB4\n\nhwsd.wrb$source_db = \"HWSDv2\"\nhwsd.wrb$profile_id = paste0(\"SIM\", 1:nrow(hwsd.wrb))\n## subset to complete points\nhwsd.wrb = hwsd.wrb[!is.na(hwsd.wrb$WRB4),]\n\nwhich now also has a harmonized column h_wrb4 compatible to the column produced using the WoSIS points:\n\nhead(hwsd.wrb)\n\n  HWSD2.SMU.ID               WRB4  longitude latitude\n1         1467    Ferric Lixisols   8.290244 13.93512\n2        11321         Anthrosols  82.118452 41.73180\n3        26612 Calcaric Cambisols  33.212770 15.03106\n4        16664   Eutric Cambisols  38.366071 10.60237\n5         3387    Cambic Cryosols -64.448944 55.92456\n6        11805    Haplic Acrisols 118.358546 25.82881\n                    geometry             h_wrb4 source_db profile_id\n1  POINT (8.290244 13.93512)    Ferric Lixisols    HWSDv2       SIM1\n2   POINT (82.11845 41.7318)               &lt;NA&gt;    HWSDv2       SIM2\n3  POINT (33.21277 15.03106) Calcaric Cambisols    HWSDv2       SIM3\n4  POINT (38.36607 10.60237)   Eutric Cambisols    HWSDv2       SIM4\n5 POINT (-64.44894 55.92456)    Cambic Cryosols    HWSDv2       SIM5\n6  POINT (118.3585 25.82881)    Haplic Acrisols    HWSDv2       SIM6\n\n\nSo in summary we have prepared two point datasets from WoSIS and HSWDv2. WoSIS are the actual observations of soil types and should be considered ground-truth. The HWSDv2 contains the WRB 2022 version soil types per mapping unit, but these are potentially of variable accuracy and should be only used to fill gaps in training data. We had to manually adjust harmonize some classes that we either outdated (old WRB versions) or are missing prefix / suffix.\nThere are many more point datasets with WRB classification or compatible classification that could be added to the list of training points. Below we list most recent datasets with soil types that we import and add to WoSIS to produce the most up-to-date compilation of soil training data.",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html#additional-point-datasets-with-wrb-classes",
    "href": "035-import_wrb_data.html#additional-point-datasets-with-wrb-classes",
    "title": "WRB soil types",
    "section": "",
    "text": "In addition to WoSIS and HWSDv2, we can also add some additional point datasets that are not yet included in any global compilation but potentially contain ground-truth observations of soil types. For example, we can use point observations coming from the land-surface observations e.g.  to represent shifting sand and bare-rock areas. For example, global land cover validation data sets that are produced by photo-interpretation of very high resolution satellite imagery (e.g. 20 cm spatial resolution) often contain useful observations of the shifting sand, permanent ice and bare-rocks (Tsendbazar et al. 2021). These specific surface materials are often missing or are systematically under-represented in the legacy soil profile datasets. Here is an example of almost 6000 observations of bare rock and shifting sands:\n\nlc.xy = readRDS(\"./correlation/photointerpretation_leptosol.rds\")\nsummary(as.factor(lc.xy$h_wrb4))\n\nLithic Leptosols   Shifting sands \n            3928             2156 \n\n\nNote that we define the Shifting sands as an additional category of soil type as these are arbitrarily either masked out or (controversially) classified to different soil types. We consider that it is more consistent to map shifting sands as a separate category of land.\nAnother dataset interesting for soil type mapping are the legacy soil observations focused on tropical peatlands, published in the literature, then digitized manually (Hengl 2016; Gumbricht et al. 2017):\n\npeat.xy = read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR_v1.csv\", na.strings = c(\"\", \"NA\"))\npeat.xy = plyr::rename(peat.xy, c(\"TAXNWRB\"=\"h_wrb4\", \"modelling.x\"=\"longitude\", \"modelling.y\"=\"latitude\", \"SOURCEID\"=\"profile_id\"))\npeat.xy$source_db = \"CIFOR_peatlands\"\npeat.xy = peat.xy[!is.na(peat.xy$longitude) & !is.na(peat.xy$h_wrb4), c(\"profile_id\", \"source_db\",\"longitude\", \"latitude\", \"h_wrb4\")]\n\nPeatlands and inaccessible tropical soil types are often under-represented and hence this dataset helps reduce the bias in under-representing tropical soils.\nCroatian soil profile database also contains soil types still in FAO classification system (Antonić, Pernar, and Jelaska 2003):\n\nhr.xy = readRDS(\"./correlation/hrspdb_pnts.rds\")\nhr.xy2 = hr.xy[,-which(names(hr.xy) == \"h_wrb4\")]\nhr.xy2 = plyr::rename(hr.xy2, c(\"h_wrb4.2\"=\"h_wrb4\"))\n\nLegacy soil observations for Italy (Righini, Costantini, and Sulli 2001; Vecchio, Barberis, and Bourlot 2002):\n\nit.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Italy.rds\")\nit.xy = plyr::rename(it.xy, c(\"wrb2015\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"long\"=\"longitude\"))\nit.xy$source_db = \"Italian_SPDB\"\n\nGerman agricultural soil inventory dataset (Poeplau et al. 2020):\n\nde.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_Germany.rds\")\nde.xy = plyr::rename(de.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"PointID\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nde.xy$Specific.soil.subtype = NULL\nde.xy$source_db = \"BZE_LW\"\nde.xy2 = de.xy[,-which(names(de.xy) == \"h_wrb4\")]\nde.xy2 = plyr::rename(de.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))\n\nFrench RMQS soil profile and monitoring dataset (Saby et al. 2020):\n\nfr.xy = readRDS(\"/mnt/landmark/HWSDv2/taxa/WRB_points_France.rds\")\nfr.xy = plyr::rename(fr.xy, c(\"WRB_correlation_1\"=\"h_wrb4\", \"id_site\"=\"profile_id\", \"lat\"=\"latitude\", \"lon\"=\"longitude\"))\nfr.xy$signific_ger_95 = NULL\nfr.xy$source_db = \"RMQS1\"\nfr.xy2 = fr.xy[,-which(names(fr.xy) == \"h_wrb4\")]\nfr.xy2 = plyr::rename(fr.xy2, c(\"WRB_correlation_2\"=\"h_wrb4\"))",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "035-import_wrb_data.html#final-compilation-of-analysis-ready-points",
    "href": "035-import_wrb_data.html#final-compilation-of-analysis-ready-points",
    "title": "WRB soil types",
    "section": "",
    "text": "Multiple imported point datasets can be finally combined into a single global consistent analysis-ready training dataset (here we limit to max 20,000 simulated points):\n\nsel.cn = c(\"profile_id\",\"latitude\", \"longitude\", \"h_wrb4\", \"source_db\")\ntr.pnts = plyr::rbind.fill(list(h.wosis.wrb[, sel.cn], \n      hwsd.wrb[sample.int(2e4, n = nrow(hwsd.wrb)), sel.cn],\n      lc.xy, hr.xy2[, sel.cn], \n      peat.xy[, sel.cn],\n      hr.xy[, sel.cn],\n      it.xy[, sel.cn], de.xy[, sel.cn], de.xy2[, sel.cn], \n      fr.xy[, sel.cn], fr.xy2[, sel.cn]))\n\nWe can clean-up some systematic naming issues common in many soil DBs:\n\ntr.pnts$h_wrb4 = gsub(\",\", \" \", tr.pnts$h_wrb4)\ntr.pnts$h_wrb4 = gsub(\"distric\", \"dystric\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol \", \"sols \", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = gsub(\"sol$\", \"sols\", tr.pnts$h_wrb4, ignore.case = TRUE)\ntr.pnts$h_wrb4 = ifelse(tr.pnts$h_wrb4==\"\", NA, tr.pnts$h_wrb4)\n## subset to complete points:\ntr.pnts = tr.pnts[!is.na(tr.pnts$h_wrb4)&!is.na(tr.pnts$longitude),]\n\nThis gives a total of about 70,000 training points with WRB soil type. Note that correlation between different national systems is not trivial and hence you should always check the folder ./correlation to see if some soil types are possibly incorrectly correlated. Also, IUSS and FAO are kind to maintain the World Reference Base (WRB), but a table correlating various versions of WRB is often not trivial and we have to somewhat improvise (or ignore the issue) that some soil types have changed over time.\n\nwrb.pnts_profiles_sf &lt;- sf::st_as_sf(tr.pnts, coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_profiles.png\")){\n  plot_gh(wrb.pnts_profiles_sf, out.pdf=\"./img/sol_wrb.pnts_profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_profiles.pdf ./img/sol_wrb.pnts_profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_profiles.png ./img/sol_wrb.pnts_profiles.png\")\n}\n\n\n\n\n\n\nA global compilation of soil profiles with WRB soil type classification.\n\n\n\n\n\nwrb.pnts_profilesL_sf &lt;- sf::st_as_sf(tr.pnts[!(tr.pnts$source_db %in% c(\"HWSDv2\", \"GlobalLCV\")),], coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\")\nif(!file.exists(\"./img/sol_wrb.pnts_tot.profiles.png\")){\n  plot_gh(wrb.pnts_profilesL_sf, out.pdf=\"./img/sol_wrb.pnts_tot.profiles.pdf\")\n  system(\"pdftoppm ./img/sol_wrb.pnts_tot.profiles.pdf ./img/sol_wrb.pnts_tot.profiles -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_wrb.pnts_tot.profiles.png ./img/sol_wrb.pnts_tot.profiles.png\")\n}\n\n\n\n\n\n\nA global compilation of soil profiles with WRB soil type classification: a subset with actual soil profiles.\n\n\n\n\nWe can export the final training points to Geopackage file by using e.g.:\n\nsf::write_sf(sf::st_as_sf(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \n                          coords = c(\"longitude\",\"latitude\"), crs=\"EPSG:4326\"), \n      paste0(\"./out/gpkg/sol_wrb.pnts_profiles.gpkg\"), driver = \"GPKG\")\nsaveRDS(tr.pnts[!tr.pnts$source_db==\"Italian_SPDB\",], \"./out/rds/sol_wrb.pnts_profiles.rds\")\n#save.image.pigz(file=\"soilwrb.RData\")",
    "crumbs": [
      "Home",
      "Tutorials",
      "WRB soil types"
    ]
  },
  {
    "objectID": "015-dataset_communities.html",
    "href": "015-dataset_communities.html",
    "title": "Soil data communities and mailing lists",
    "section": "",
    "text": "To follow progress of the soil data compilations consider connecting to some of the active communities / registering for the mailing lists and/or discussion groups.\n\n\nPedometrics is the commission of the International Union of Soil Sciences. You can read more about pedometrics from &lt;www.pedometrics.org&gt;. There is also Pedometrics mailing list where you can ask more technical questions.\n\n\n\nDigital Soil Mapping community (A Working Group of the International Union of Soil Sciences (IUSS)) can be accessed via the home page &lt;www.digitalsoilmapping.org&gt; and/or via the Facebook group on Digital Soil Mapping.",
    "crumbs": [
      "Home",
      "Data import",
      "Soil data communities and mailing lists"
    ]
  },
  {
    "objectID": "015-dataset_communities.html#pedometrics-community",
    "href": "015-dataset_communities.html#pedometrics-community",
    "title": "Soil data communities and mailing lists",
    "section": "",
    "text": "Pedometrics is the commission of the International Union of Soil Sciences. You can read more about pedometrics from &lt;www.pedometrics.org&gt;. There is also Pedometrics mailing list where you can ask more technical questions.",
    "crumbs": [
      "Home",
      "Data import",
      "Soil data communities and mailing lists"
    ]
  },
  {
    "objectID": "015-dataset_communities.html#digital-soil-mapping-community",
    "href": "015-dataset_communities.html#digital-soil-mapping-community",
    "title": "Soil data communities and mailing lists",
    "section": "",
    "text": "Digital Soil Mapping community (A Working Group of the International Union of Soil Sciences (IUSS)) can be accessed via the home page &lt;www.digitalsoilmapping.org&gt; and/or via the Facebook group on Digital Soil Mapping.",
    "crumbs": [
      "Home",
      "Data import",
      "Soil data communities and mailing lists"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html",
    "href": "025-import_chemical_data.html",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "The code and data set is continuously being updated. If you notice a bug or typo, please open an issue and report.\nLast update: 2024-12-03\n\n\nThis section describes import steps used to produce a global compilation of soil laboratory data with chemical (and physical) soil properties that can be then used for predictive soil mapping / modeling at global and regional scales.\nRead more about soil chemical properties, global soil profile and sample data sets and functionality:\n\nArrouays, D., Leenaars, J. G., Richer-de-Forges, A. C., Adhikari, K., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil legacy data rescue via GlobalSoilMap and other international and national initiatives. GeoResJ, 14, 1-19.\nBatjes, N. H., Ribeiro, E., van Oostrum, A., Leenaars, J., Hengl, T., & de Jesus, J. M. (2017). WoSIS: providing standardised soil profile data for the world. Earth System Science Data, 9(1), 1.\nHengl, T., MacMillan, R.A., (2019). Predictive Soil Mapping with R. OpenGeoHub foundation, Wageningen, the Netherlands, 370 pages, www.soilmapper.org, ISBN: 978-0-359-30635-0.\nRossiter, D.G.,: Compendium of Soil Geographical Databases.\n\n\n\n\n\n\n\nMetadata information: “Soil Survey Investigation Report No. 42.” and “Soil Survey Investigation Report No. 45.”,\nModel DB: National Cooperative Soil Survey (NCSS) Soil Characterization Database,\n\n\n\n\n\nsite.names = c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude_decimal_degrees\", \n               \"latitude_decimal_degrees\", \"SSL_classification_name\")\nhor.names = c(\"labsampnum\", \"site_key\", \"layer_key\", \"layer_sequence\", \"hzn_top\",\"hzn_bot\", \n              \"hzn_desgn\", \"texture_description\", \"texture_lab\", \"clay_total\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n## target structure:\ncol.names = unique(c(site.names, hor.names, \"source_db\", \"confidence_degree\", \"project_url\", \"citation_url\"))\n\nTarget variables listed:\n\nclay_total: Clay, Total in % wt for &lt;2 mm soil fraction,\nsilt_total: Silt, Total in % wt for &lt;2 mm soil fraction,\nsand_total: Sand, Total in % wt for &lt;2 mm soil fraction,\norganic_carbon: Carbon, Organic in g/kg for &lt;2 mm soil fraction based on Dry combustion,\noc_d: Soil organic carbon density in kg/m3,\ntotal_carbon_ncs: Carbon, Total in g/kg for &lt;2 mm soil fraction,\ntotal_nitrogen_ncs: Nitrogen, Total NCS in g/kg for &lt;2 mm soil fraction,\nph_kcl: pH, KCl Suspension for &lt;2 mm soil fraction,\nph_h2o: pH, 1:1 Soil-Water Suspension for &lt;2 mm soil fraction,\nph_cacl2: pH, CaCl2 Suspension for &lt;2 mm soil fraction,\nsum_of_cations_cec_pH_8_2: Cation Exchange Capacity, Summary, in cmol(+)/kg for &lt;2 mm soil fraction,\ncec_nh4_ph_7: Cation Exchange Capacity, NH4 prep, in cmol(+)/kg for &lt;2 mm soil fraction,\necec_base_plus_aluminum: Cation Exchange Capacity, Effective, CMS derived value default, standa prep in cmol(+)/kg for &lt;2 mm soil fraction,\ntotal_frag_wt_pct_gt_2_mm_ws: Coarse fragments in % wt for &gt;2 mm soil fraction,\nbulk_density_oven_dry: Bulk density (Oven Dry) in g/cm3 (4A1h),\nca_ext: Calcium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nmg_ext: Magnesium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nna_ext: Sodium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nk_ext: Potassium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nec_water_extractable: Electrical Conductivity, Saturation Extract in dS/m for &lt;2 mm soil fraction,\nec_predict_one_to_two: Electrical Conductivity, Predict, 1:2 (w/w) in dS/m for &lt;2 mm soil fraction,\n\n\n\n\n\n\n\nThe November 2024 version contains 67,367 sites. This is the world largest open soil laboratory database to date.\n\nNational Cooperative Soil Survey, (2020). National Cooperative Soil Survey Characterization Database. Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/\nNauman, T.W., Kienast‐Brown, S., Roecker, S.M., Brungard, C., White, D., Philippe, J., & Thompson, J.A. (2024). Soil landscapes of the United States (SOLUS): Developing predictive soil property maps of the conterminous United States using hybrid training sets. Soil Sci. Soc. Am. J. https://doi.org/10.1002/saj2.20769\n\nThis data set is continuously updated.\n\nif(!exists(\"chemsprops.NCSS\")){\n  #nccs.xy = terra::vect(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/ncss_labdata_locations.gpkg\")\n  #ncss.site &lt;- dplyr::bind_cols(as.data.frame(nccs.xy), geom(nccs.xy))\n  ncss.site &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/ncss_labdata_locations.csv.gz\")\n  ## Rows: 67367 Columns: 88\n  #plot(ncss.site[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  ncss.chem &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_chemical_properties.csv.gz\")\n  ## Rows: 325740 Columns: 210\n  #summary(ncss.chem$organic_carbon_walkley_black)\n  ncss.phys &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_physical_properties.csv.gz\")\n  ## Rows: 406281 Columns: 123\n  ncss.layer &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_layer.csv.gz\")\n  ## Rows: 417656 Columns: 24\n  ncss.horizons = dplyr::full_join(dplyr::full_join(ncss.layer, ncss.phys, by = c(\"labsampnum\",\"layer_key\")), ncss.chem, by = c(\"labsampnum\",\"layer_key\"))\n  summary(ncss.horizons$estimated_organic_matter)\n  ## translate to SOC DC\n  ## https://doi.org/10.1016/j.geoderma.2021.115547\n  ## SOC = 1.3 * WBC\n  ## Wills et al., 2013 (https://doi.org/10.2136/sssaj2012.0168)\n  ## SOC  = 0.86 * WBC + 0.25, n=13,800, R2=0.93\n  ncss.horizons$organic_carbon = ifelse(ncss.horizons$organic_carbon_walkley_black &lt; 0, 0, (ncss.horizons$organic_carbon_walkley_black * 1.3) * 10)  ## g/kg\n  #ggplot(ncss.horizons, aes(organic_carbon+1)) + geom_histogram() + scale_x_log10()\n  #summary(ncss.horizons$organic_carbon)\n  ncss.horizons$bulk_density_oven_dry = ifelse(ncss.horizons$bulk_density_oven_dry &lt; 0.05 | ncss.horizons$bulk_density_oven_dry &gt; 2.4, NA, ncss.horizons$bulk_density_oven_dry)\n  #hist(ncss.horizons$bulk_density_oven_dry, col=\"grey\", breaks=40)\n  ncss.horizons$total_frag_wt_pct_gt_2_mm_ws = ifelse(ncss.horizons$total_frag_wt_pct_gt_2_mm_ws &gt; 99, NA, ncss.horizons$total_frag_wt_pct_gt_2_mm_ws)\n  ncss.horizons$oc_d = signif( ncss.horizons$organic_carbon / 1000 * ncss.horizons$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(ncss.horizons$total_frag_wt_pct_gt_2_mm_ws), 0, ncss.horizons$total_frag_wt_pct_gt_2_mm_ws))/100, 3)\n  ncss.horizons$ca_ext = signif(ncss.horizons$ca_nh4_ph_7 * 200, 4)\n  ncss.horizons$mg_ext = signif(ncss.horizons$mg_nh4_ph_7 * 121, 3)\n  ncss.horizons$na_ext = signif(ncss.horizons$na_nh4_ph_7 * 230, 3)\n  ncss.horizons$k_ext = signif(ncss.horizons$k_nh4_ph_7 * 391, 3)\n  ncss.horizons$total_nitrogen_ncs = ncss.horizons$total_nitrogen_ncs * 10\n  ## bind into single table\n  #str(which(!ncss.horizons$site_key %in% ncss.site$site_key))\n  chemsprops.NCSS = dplyr::full_join(ncss.site[,site.names], ncss.horizons[,hor.names])\n  chemsprops.NCSS$site_obsdate = format(as.Date(chemsprops.NCSS$site_obsdate, format=\"%Y/%m/%d\"), \"%Y-%m-%d\")\n  #summary(as.Date(chemsprops.NCSS$site_obsdate))\n  #summary(substr(chemsprops.NCSS$site_obsdate, 1, 4)&gt;1999 & !is.na(chemsprops.NCSS$oc_d))\n  ## ONLY 200 records &gt;1999 with SOC and BD!\n  chemsprops.NCSS$source_db = \"USDA_NCSS\"\n  #dim(chemsprops.NCSS)\n  ## 477516      36\n  chemsprops.NCSS$confidence_degree = 1\n  chemsprops.NCSS$project_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  chemsprops.NCSS$citation_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  chemsprops.NCSS = complete.vars(chemsprops.NCSS, sel=c(\"hzn_top\", \"hzn_bot\", \"organic_carbon\", \"clay_total\", \"ecec_base_plus_aluminum\", \"ph_h2o\", \"ec_predict_one_to_two\", \"k_ext\"), remove.duplicates = FALSE)\n  #summary(chemsprops.NCSS$oc_d)\n  #summary(chemsprops.NCSS$organic_carbon)\n  saveRDS.gz(chemsprops.NCSS, \"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/chemsprops.NCSS.rds\")\n}\n\nNew names:\n• `` -&gt; `...1`\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 67367 Columns: 88\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (58): pedlabsampnum, upedonid, priority, priority2, samp_name, samp_clas...\ndbl (24): ...1, OBJECTID, objectid_1, pedon_key, site_key, peiid, labdatades...\nlgl  (6): SSL_taxpartsizemod, SSL_taxother, SSL_osdtypelocflag, samp_taxfamh...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 325740 Columns: 210\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (52): labsampnum, prep_code, ca_nh4_ph_7_method, mg_nh4_ph_7_method, na_...\ndbl (74): OBJECTID, objectid_1, layer_key, result_source_key, ca_nh4_ph_7, m...\nlgl (84): iron_kcl_extractable, iron_kcl_extractable_method, ph_oxidized, ph...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 406281 Columns: 123\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): labsampnum, prep_code, texture_lab, particle_size_method, bulk_den...\ndbl (57): OBJECTID, objectid_1, layer_key, result_source_key, clay_total, si...\nlgl (46): bulk_density_tenth_bar, bulk_density_tenth_bar_method, bulk_densit...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 417656 Columns: 24\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (10): labsampnum, layer_type, layer_field_label_1, layer_field_label_2, ...\ndbl (12): OBJECTID, objectid_1, layer_key, project_key, site_key, pedon_key,...\nlgl  (2): hzn_prime, hzn_desgn_other\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nJoining with `by = join_by(site_key)`\n\n\nWarning in dplyr::full_join(ncss.site[, site.names], ncss.horizons[, hor.names]): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 56038 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\ndim(chemsprops.NCSS)\n\n[1] 352969     39\n\n## [1] 352969     39\n\n\n\n\n\nSmith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., and Fey, D.L., (2013). Geochemical and mineralogical data for soils of the conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/.\nGrossman, J. N. (2004). The National Geochemical Survey-database and documentation. U.S. Geological Survey Open-File Report 2004-1001. DOI:10.3133/ofr20041001.\nNote: NGS focuses on stream-sediment samples, but also contains many soil samples.\n\n\nif(!exists(\"chemsprops.USGS.NGS\")){\n  ngs.points &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/site.txt\", sep=\",\")\n  ## 4857 pnts\n  ngs.layers &lt;- lapply(c(\"top5cm.txt\", \"ahorizon.txt\", \"chorizon.txt\"), function(i){read.csv(paste0(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/\", i), sep=\",\")})\n  ngs.layers = plyr::rbind.fill(ngs.layers)\n  #dim(ngs.layers)\n  # 14571  126\n  #summary(ngs.layers$tot_carb_pct)\n  #lattice::xyplot(c_org_pct ~ c_tot_pct, ngs.layers, scales=list(x = list(log = 2), y = list(log = 2)))\n  #lattice::xyplot(c_org_pct ~ tot_clay_pct, ngs.layers, scales=list(y = list(log = 2)))\n  ngs.layers$total_carbon_ncs = ngs.layers$c_tot_pct * 10\n  ## \"The sample was combusted in an oxygen atmosphere at 1,370 ºC to oxidize C to carbon dioxide (CO2)\"\n  ngs.layers$organic_carbon = ngs.layers$c_org_pct * 10 \n  ngs.layers$hzn_top = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][1]})\n  ngs.layers$hzn_bot = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][2]})\n  #summary(ngs.layers$tot_clay_pct)\n  #summary(ngs.layers$k_pct) ## very high numbers?\n  ## question is if the geochemical element results are compatible with e.g. k_ext?\n  t.ngs = c(\"lab_id\", \"site_id\", \"horizon\", \"hzn_top\", \"hzn_bot\", \"tot_clay_pct\", \"total_carbon_ncs\", \"organic_carbon\")\n  ngs.m = plyr::join(ngs.points, ngs.layers[!is.na(ngs.layers$c_org_pct),t.ngs])\n  ngs.m$site_obsdate = as.Date(ngs.m$colldate, format=\"%Y-%m-%d\") \n  #summary(substr(ngs.m$site_obsdate, 1, 4)&gt;1999)\n  ngs.h.lst &lt;- c(\"site_id\", \"quad\", \"site_obsdate\", \"longitude\", \"latitude\", \"SSL_classification_name\", \"lab_id\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"horizon\", \"tex_psda\", \"texture_lab\", \"tot_clay_pct\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = ngs.h.lst[which(!ngs.h.lst %in% names(ngs.m))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ngs.m[,i] = NA } }\n  chemsprops.USGS.NGS = ngs.m[,ngs.h.lst]\n  chemsprops.USGS.NGS$source_db = \"USGS.NGS\"\n  chemsprops.USGS.NGS$confidence_degree = 1\n  chemsprops.USGS.NGS$project_url = \"https://mrdata.usgs.gov/ds-801/\"\n  chemsprops.USGS.NGS$citation_url = \"https://pubs.usgs.gov/ds/801/\"\n  chemsprops.USGS.NGS = complete.vars(chemsprops.USGS.NGS, sel = c(\"tot_clay_pct\", \"organic_carbon\"), coords = c(\"longitude\", \"latitude\"))\n  #summary(chemsprops.USGS.NGS$organic_carbon)\n  saveRDS.gz(chemsprops.USGS.NGS, \"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/chemsprops.USGS.NGS.rds\")\n}\n\nJoining by: site_id\n\ndim(chemsprops.USGS.NGS)\n\n[1] 9447   39\n\n## [1] 9447   39\n\n\n\n\n\nLeenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01; 2014. Data download URL: https://data.isric.org/\n\n\nif(!exists(\"chemsprops.AfSPDB\")){\n  library(foreign)\n  afspdb.profiles &lt;- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Profiles.dbf\", as.is=TRUE)\n  afspdb.layers &lt;- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Layers.dbf\", as.is=TRUE)\n  afspdb.s.lst &lt;- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\")\n  #summary(afspdb.layers$BlkDens)\n  ## add missing columns\n  for(j in 1:ncol(afspdb.layers)){ \n    if(is.numeric(afspdb.layers[,j])) { \n      afspdb.layers[,j] &lt;- ifelse(afspdb.layers[,j] &lt; 0, NA, afspdb.layers[,j]) \n    }\n  }\n  afspdb.layers$ca_ext = afspdb.layers$ExCa * 200\n  afspdb.layers$mg_ext = afspdb.layers$ExMg * 121\n  afspdb.layers$na_ext = afspdb.layers$ExNa * 230\n  afspdb.layers$k_ext = afspdb.layers$ExK * 391\n  #summary(afspdb.layers$k_ext)\n  afspdb.m = plyr::join(afspdb.profiles[,afspdb.s.lst], afspdb.layers)\n  #summary(afspdb.m$OrgC)\n  afspdb.m$oc_d = signif(afspdb.m$OrgC * afspdb.m$BlkDens * (100 - ifelse(is.na(afspdb.m$CfPc), 0, afspdb.m$CfPc))/100, 3)\n  #summary(afspdb.m$oc_d)\n  #summary(afspdb.m$T_Year)\n  afspdb.m$T_Year = ifelse(afspdb.m$T_Year &lt; 0, NA, afspdb.m$T_Year)\n  afspdb.h.lst &lt;- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\", \"USDA\", \"LayerID\", \"LyrObj\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"texture_description\", \"LabTxtr\", \"Clay\", \"Silt\", \"Sand\", \"OrgC\", \"oc_d\", \"TotC\", \"TotalN\", \"PHKCl\", \"PHH2O\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"EC\", \"ec_12pre\")\n  x.na = afspdb.h.lst[which(!afspdb.h.lst %in% names(afspdb.m))]\n  if(length(x.na)&gt;0){ for(i in x.na){ afspdb.m[,i] = NA } }\n  chemsprops.AfSPDB = afspdb.m[,afspdb.h.lst]\n  chemsprops.AfSPDB$source_db = \"AfSPDB\"\n  chemsprops.AfSPDB$confidence_degree = 5\n  chemsprops.AfSPDB$project_url = \"https://www.isric.org/projects/africa-soil-profiles-database-afsp\"\n  chemsprops.AfSPDB$citation_url = \"https://www.isric.org/sites/default/files/isric_report_2014_01.pdf\"\n  chemsprops.AfSPDB = complete.vars(chemsprops.AfSPDB, sel = c(\"LabTxtr\",\"OrgC\",\"Clay\",\"Ecec\",\"PHH2O\",\"EC\",\"k_ext\"), coords = c(\"X_LonDD\", \"Y_LatDD\"))\n  saveRDS.gz(chemsprops.AfSPDB, \"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/chemsprops.AfSPDB.rds\")\n}\n\nJoining by: ProfileID\n\ndim(chemsprops.AfSPDB)\n\n[1] 68833    39\n\n## [1] 68833    39\n\n\n\n\n\nTowett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. A., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition of soils in Sub-Saharan Africa and relationship with soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002\nAfSIS Soil Chemistry produced by World Agroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center for International Earth Science Information Network (CIESIN), The International Center for Tropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) and Rothamsted Research (RRES). Data download URL: https://registry.opendata.aws/afsis/\n\n\nif(!exists(\"chemsprops.AfSIS1\")){\n  afsis1.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Georeferences/georeferences.csv\")\n  afsis1.xy$Sampling.date = 2011\n  afsis1.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  afsis1.hor = plyr::rbind.fill(lapply(afsis1.lst, read.csv))\n  tansis.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Georeferences/georeferences.csv\")\n  #summary(tansis.xy$Sampling.date)\n  tansis.xy$Sampling.date = 2018\n  tansis.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  tansis.hor = plyr::rbind.fill(lapply(tansis.lst, read.csv))\n  afsis1t.df = plyr::rbind.fill(list(plyr::join(afsis1.hor, afsis1.xy, by=\"SSN\"), plyr::join(tansis.hor, tansis.xy, by=\"SSN\")))\n  afsis1t.df$UpDpth = ifelse(afsis1t.df$Depth==\"sub\", 20, 0)\n  afsis1t.df$LowDpth = ifelse(afsis1t.df$Depth==\"sub\", 50, 20)\n  afsis1t.df$LayerNr = ifelse(afsis1t.df$Depth==\"sub\", 2, 1)\n  #summary(afsis1t.df$C...Org)\n  afsis1t.df$oc = rowMeans(afsis1t.df[,c(\"C...Org\", \"X.C\")], na.rm=TRUE) * 10\n  afsis1t.df$c_tot = afsis1t.df$Total.carbon\n  afsis1t.df$n_tot = rowMeans(afsis1t.df[,c(\"Total.nitrogen\", \"X.N\")], na.rm=TRUE) * 10\n  afsis1t.df$ph_h2o = rowMeans(afsis1t.df[,c(\"PH\", \"pH\")], na.rm=TRUE)\n  ## multiple texture fractions - which one is the total clay, sand, silt?\n  ## Clay content for water dispersed particles-recorded after 4 minutes of ultrasonication\n  #summary(afsis1t.df$Psa.w4clay)\n  #plot(afsis1t.df[,c(\"Longitude\", \"Latitude\")])\n  afsis1.h.lst &lt;- c(\"SSN\", \"Site\", \"Sampling.date\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"Soil.material\", \"layer_key\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"texture_description\", \"LabTxtr\", \"Psa.w4clay\", \"Psa.w4silt\", \"Psa.w4sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"PHKCl\", \"ph_h2o\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"M3.Mg\", \"M3.Na\", \"M3.K\", \"EC\", \"ec_12pre\")\n  x.na = afsis1.h.lst[which(!afsis1.h.lst %in% names(afsis1t.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ afsis1t.df[,i] = NA } }\n  chemsprops.AfSIS1 = afsis1t.df[,afsis1.h.lst]\n  chemsprops.AfSIS1$source_db = \"AfSIS1\"\n  chemsprops.AfSIS1$confidence_degree = 2\n  chemsprops.AfSIS1$project_url = \"https://registry.opendata.aws/afsis/\"\n  chemsprops.AfSIS1$citation_url = \"https://doi.org/10.1016/j.geodrs.2015.06.002\"\n  chemsprops.AfSIS1 = complete.vars(chemsprops.AfSIS1, sel = c(\"Psa.w4clay\",\"oc\",\"ph_h2o\",\"M3.K\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.AfSIS1, \"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/chemsprops.AfSIS1.rds\")\n}\ndim(chemsprops.AfSIS1)\n\n[1] 4369   39\n\n## [1] 4369   39\n\n\n\n\n\nISDA’s repository contains open soil analysis data for the African continent: https://doi.org/10.17605/OSF.IO/A69R5 Note: Year of sampling is not specified, hence of limited use for spatiotemporal modeling.\n\n\nif(!exists(\"chemsprops.isda\")){\n  isda.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/ISDA/iSDA_soil_data.csv\")\n  #summary(as.Date(isda.xy$end_date, format=\"%d/%m/%Y\"))\n  #summary(as.factor(isda.xy$source))\n  #library(\"ggplot2\")\n  #library(\"scales\")\n  # ggplot(isda.xy, aes(as.POSIXct(Sampling.date), ..count..)) + \n  #   geom_histogram() +\n  #   theme_bw() + xlab(NULL) +\n  #   scale_x_datetime(breaks = date_breaks(\"3 months\"),\n  #                    labels = date_format(\"%Y-%b\"),\n  #                    limits = c(as.POSIXct(\"2008-01-01\"), \n  #                               as.POSIXct(\"2020-12-31\")) )\n  #head(isda.xy)\n  #plot(isda.xy[,c(\"longitude\", \"latitude\")])\n  isda.xy$labsampnum = paste0(\"ISDA.\", 1:nrow(isda.xy))\n  isda.h.lst &lt;- c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude\", \n              \"latitude\", \"SSL_classification_name\", \"labsampnum\",\n              \"layer_key\", \"layer_sequence\", \"horizon_upper\", \n              \"horizon_lower\", \"hzn_desgn\", \"texture_description\",\n              \"texture_lab\", \"clay_total\", \"silt_total\", \"sand_total\",\n              \"carbon_organic\", \"oc_d\", \"carbon_total\", \"nitrogen_total\", \"ph_kcl\", \"ph\",\n              \"ph_cacl2\", \"sum_of_cations_cec_pH_8_2\",\n              \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \"total_frag_wt_pct_gt_2_mm_ws\",\n              \"bulk_density_oven_dry\", \"calcium_extractable\", \"magnesium_extractable\", \"sodium_extractable\",\n              \"potassium_extractable\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = isda.h.lst[which(!isda.h.lst %in% names(isda.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ isda.xy[,i] = NA } }\n  chemsprops.isda = isda.xy[,isda.h.lst]\n  chemsprops.isda$source_db = \"ISDA\"\n  chemsprops.isda$confidence_degree = 4\n  chemsprops.isda$project_url = \"https://www.isda-africa.com/\"\n  chemsprops.isda$citation_url = \"https://doi.org/10.17605/OSF.IO/A69R5\"\n  chemsprops.isda = complete.vars(chemsprops.isda, sel = c(\"carbon_organic\",\"ph\"), coords = c(\"longitude\", \"latitude\"))\n  saveRDS.gz(chemsprops.isda, \"/mnt/diskstation/data/Soil_points/AF/ISDA/chemsprops.isda.rds\")\n}\ndim(chemsprops.isda)\n\n[1] 49225    39\n\n## [1] 49225    39\n\n\n\n\n\nIversen CM, McCormack ML, Baer JK, Powell AS, Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli A, Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): A Global Collection of Root Trait Data with Coincident Site, Vegetation, Edaphic, and Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department of Energy, Oak Ridge, Tennessee, U.S.A. Access on-line at: https://doi.org/10.25581/ornlsfa.014/1459186.\n\n\nif(!exists(\"chemsprops.FRED\")){\n  Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  fred = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", skip = 10, col_names=FALSE)\n  ## 57,190 x 1,164\n  #nm.fred = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Column_Definitions_20210423-091040.csv\", header=TRUE)\n  nm.fred0 = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", nrows=2)\n  names(fred) = make.names(t(nm.fred0)[,1])\n  ## 1164 columns!\n  #summary(fred$Soil.organic.C.content)\n  fred.h.lst = c(\"Notes_Row.ID\", \"Data.source_DOI\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"Soil.horizon\", \"Soil.texture\", \"texture_lab\", \"Soil.texture_Fraction.clay\", \"Soil.texture_Fraction.silt\", \"Soil.texture_Fraction.sand\", \"Soil.organic.C.content\", \"oc_d\", \"c_tot\", \"Soil.N.content\", \"ph_kcl\", \"Soil.pH_Water\", \"Soil.pH_Salt\", \"Soil.cation.exchange.capacity..CEC.\", \"cec_nh4\", \"Soil.effective.cation.exchange.capacity..ECEC.\", \"wpg2\", \"Soil.bulk.density\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  fred$site_obsdate = as.integer(rowMeans(fred[,c(\"Sample.collection_Year.ending.collection\", \"Sample.collection_Year.beginning.collection\")], na.rm=TRUE))\n  #summary(fred$site_obsdate)\n  fred$longitude_decimal_degrees = ifelse(is.na(fred$Longitude), fred$Longitude_Estimated, fred$Longitude)\n  fred$latitude_decimal_degrees = ifelse(is.na(fred$Latitude), fred$Latitude_Estimated, fred$Latitude)\n  #names(fred)[grep(\"Notes_Row\", names(fred))]\n  #summary(fred[,grep(\"clay\", names(fred))])\n  #summary(fred[,grep(\"cation.exchange\", names(fred))])\n  #summary(fred[,grep(\"organic.C\", names(fred))])\n  #summary(fred$Soil.organic.C.content)\n  #summary(fred$Soil.bulk.density)\n  #summary(as.factor(fred$Soil.horizon))\n  fred$hzn_bot = ifelse(is.na(fred$Soil.depth_Lower.sampling.depth), fred$Soil.depth - 5, fred$Soil.depth_Lower.sampling.depth)\n  fred$hzn_top = ifelse(is.na(fred$Soil.depth_Upper.sampling.depth), fred$Soil.depth + 5, fred$Soil.depth_Upper.sampling.depth)\n  fred$oc_d = signif(fred$Soil.organic.C.content / 1000 * fred$Soil.bulk.density * 1000, 3)\n  #summary(fred$oc_d)  \n  x.na = fred.h.lst[which(!fred.h.lst %in% names(fred))]\n  if(length(x.na)&gt;0){ for(i in x.na){ fred[,i] = NA } }\n  chemsprops.FRED = fred[,fred.h.lst]\n  #plot(chemsprops.FRED[,4:5])\n  chemsprops.FRED$source_db = \"FRED\"\n  chemsprops.FRED$confidence_degree = 5\n  chemsprops.FRED$project_url = \"https://roots.ornl.gov/\"\n  chemsprops.FRED$citation_url = \"https://doi.org/10.25581/ornlsfa.014/1459186\"\n  chemsprops.FRED = complete.vars(chemsprops.FRED, sel = c(\"Soil.organic.C.content\", \"Soil.texture_Fraction.clay\", \"Soil.pH_Water\"))\n  ## many duplicates\n  saveRDS.gz(chemsprops.FRED, \"/mnt/diskstation/data/Soil_points/INT/FRED/chemsprops.FRED.rds\")  \n}\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 57190 Columns: 1164\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (54): X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X17, X1...\ndbl (271): X1, X2, X30, X31, X32, X35, X36, X43, X44, X45, X46, X47, X48, X4...\nlgl (839): X16, X20, X37, X38, X39, X42, X52, X53, X54, X55, X56, X57, X58, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.FRED)\n\n[1] 14537    39\n\n## [1] 14537  39\n\n\n\n\n\nGuerrero‐Ramírez, N. R., Mommer, L., Freschet, G. T., Iversen, C. M., McCormack, M. L., Kattge, J., … & Weigelt, A. (2021). Global root traits (GRooT) database. Global ecology and biogeography, 30(1), 25-37. https://dx.doi.org/10.1111/geb.13179\n\n\nif(!exists(\"chemsprops.GROOT\")){\n  #Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  GROOT = read.csv(\"/mnt/diskstation/data/Soil_points/INT/GRooT/GRooTFullVersion.csv\")\n  ## 114,222 x 73\n  #summary(GROOT$soilCarbon)\n  #summary(!is.na(GROOT$soilCarbon))\n  #summary(GROOT$soilOrganicMatter)\n  #summary(GROOT$soilNitrogen)\n  #summary(GROOT$soilpH)\n  #summary(as.factor(GROOT$soilTexture))\n  #lattice::xyplot(soilCarbon ~ soilpH, GROOT, par.settings = list(plot.symbol = list(col=scales::alpha(\"black\", 0.6), fill=scales::alpha(\"red\", 0.6), pch=21, cex=0.6)), scales = list(y=list(log=TRUE, equispaced.log=FALSE)), ylab=\"SOC\", xlab=\"pH\")\n  GROOT$site_obsdate = as.Date(paste0(GROOT$year, \"-01-01\"), format=\"%Y-%m-%d\")\n  GROOT$hzn_top = 0\n  GROOT$hzn_bot = 30\n  GROOT.h.lst = c(\"locationID\", \"originalID\", \"site_obsdate\", \"decimalLongitud\", \"decimalLatitude\", \"SSL_classification_name\", \"GRooTID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"soilTexture\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"soilCarbon\", \"oc_d\", \"c_tot\", \"soilNitrogen\", \"ph_kcl\", \"soilpH\", \"ph_cacl2\", \"soilCationExchangeCapacity\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = GROOT.h.lst[which(!GROOT.h.lst %in% names(GROOT))]\n  if(length(x.na)&gt;0){ for(i in x.na){ GROOT[,i] = NA } }\n  chemsprops.GROOT = GROOT[,GROOT.h.lst]\n  chemsprops.GROOT$source_db = \"GROOT\"\n  chemsprops.GROOT$confidence_degree = 8\n  chemsprops.GROOT$project_url = \"https://groot-database.github.io/GRooT/\"\n  chemsprops.GROOT$citation_url = \"https://dx.doi.org/10.1111/geb.13179\"\n  chemsprops.GROOT = complete.vars(chemsprops.GROOT, sel = c(\"soilCarbon\", \"soilpH\"), coords = c(\"decimalLongitud\", \"decimalLatitude\"))\n  saveRDS.gz(chemsprops.GROOT, \"/mnt/diskstation/data/Soil_points/INT/GRooT/chemsprops.GROOT.rds\")\n}\ndim(chemsprops.GROOT)\n\n[1] 16271    39\n\n## [1] 16271  39\n\n\n\n\n\nBond-Lamberty, B. and Thomson, A. (2010). A global database of soil respiration data, Biogeosciences, 7, 1915–1926, https://doi.org/10.5194/bg-7-1915-2010\n\n\nif(!exists(\"chemsprops.SRDB\")){\n  srdb = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SRDB/srdb-data.csv\")\n  ## 10366 x 85\n  srdb.h.lst = c(\"Site_ID\", \"Notes\", \"Study_midyear\", \"Longitude\", \"Latitude\",  \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psd\", \"texture_lab\", \"Soil_clay\", \"Soil_silt\", \"Soil_sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Soil_BD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  #summary(srdb$Study_midyear)\n  srdb$hzn_bot = ifelse(is.na(srdb$C_soildepth), 100, srdb$C_soildepth)\n  srdb$hzn_top = 0\n  #summary(srdb$Soil_clay)\n  #summary(srdb$C_soilmineral)\n  srdb$oc_d = signif(srdb$C_soilmineral / 1000 / (srdb$hzn_bot/100), 3)\n  #summary(srdb$oc_d) \n  #summary(srdb$Soil_BD)\n  srdb$oc = srdb$oc_d / srdb$Soil_BD\n  #summary(srdb$oc)\n  x.na = srdb.h.lst[which(!srdb.h.lst %in% names(srdb))]\n  if(length(x.na)&gt;0){ for(i in x.na){ srdb[,i] = NA } }\n  chemsprops.SRDB = srdb[,srdb.h.lst]\n  #plot(chemsprops.SRDB[,4:5])\n  chemsprops.SRDB$source_db = \"SRDB\"\n  chemsprops.SRDB$confidence_degree = 5\n  chemsprops.SRDB$project_url = \"https://github.com/bpbond/srdb/\"\n  chemsprops.SRDB$citation_url = \"https://doi.org/10.5194/bg-7-1915-2010\"\n  chemsprops.SRDB = complete.vars(chemsprops.SRDB, sel = c(\"oc\", \"Soil_clay\", \"Soil_BD\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.SRDB, \"/mnt/diskstation/data/Soil_points/INT/SRDB/chemsprops.SRDB.rds\")\n}\ndim(chemsprops.SRDB)\n\n[1] 3337   39\n\n## [1] 3337   39\n\n\n\n\n\nWieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: the SOils DAta Harmonization database, an open-source synthesis of soil data from research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195. Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4\nWieder, W.R., D. Pierson, S.R. Earl, K. … et al, (2020). SOils DAta Harmonization database (SoDaH): an open-source synthesis of soil data from research networks ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4 (Accessed 2024-11-19).\n\n\nif(!exists(\"chemsprops.SoDaH\")){\n  sodah.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/SoDaH/521_soils_data_harmonization_6e8416fa0c9a2c2872f21ba208e6a919.csv\")\n  #head(sodah.hor)\n  #summary(sodah.hor$coarse_frac)\n  #summary(sodah.hor$lyr_soc)\n  #summary(sodah.hor$lyr_som_WalkleyBlack/1.724)\n  #summary(as.factor(sodah.hor$observation_date))\n  sodah.hor$site_obsdate = as.integer(substr(sodah.hor$observation_date, 1, 4))\n  sodah.hor$oc = ifelse(is.na(sodah.hor$lyr_soc), sodah.hor$lyr_som_WalkleyBlack/1.724* 1.3, sodah.hor$lyr_soc) * 10 \n  sodah.hor$n_tot = sodah.hor$lyr_n_tot * 10\n  sodah.hor$oc_d = signif(sodah.hor$oc / 1000 * sodah.hor$bd_samp * 1000 * (100 - ifelse(is.na(sodah.hor$coarse_frac), 0, sodah.hor$coarse_frac))/100, 3)\n  sodah.hor$site_key = paste(sodah.hor$network, sodah.hor$location_name, sep=\"_\")\n  sodah.hor$labsampnum = make.unique(paste(sodah.hor$network, sodah.hor$location_name, sodah.hor$L1, sep=\"_\"))\n  #summary(sodah.hor$oc_d)\n  sodah.h.lst = c(\"site_key\", \"data_file\", \"observation_date\", \"long\", \"lat\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"layer_top\", \"layer_bot\", \"hzn\", \"profile_texture_class\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"coarse_frac\", \"bd_samp\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  x.na = sodah.h.lst[which(!sodah.h.lst %in% names(sodah.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sodah.hor[,i] = NA } }\n  chemsprops.SoDaH = sodah.hor[,sodah.h.lst]\n  #plot(chemsprops.SoDaH[,4:5])\n  chemsprops.SoDaH$source_db = \"SoDaH\"\n  chemsprops.SoDaH$confidence_degree = 3\n  chemsprops.SoDaH$project_url = \"https://lter.github.io/som-website\"\n  chemsprops.SoDaH$citation_url = \"https://doi.org/10.5194/essd-2020-195\"\n  chemsprops.SoDaH = complete.vars(chemsprops.SoDaH, sel = c(\"oc\", \"clay\", \"ph_h2o\"), coords = c(\"long\", \"lat\"))\n  saveRDS.gz(chemsprops.SoDaH, \"/mnt/diskstation/data/Soil_points/INT/SoDaH/chemsprops.SoDaH.rds\")\n}\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 293592 Columns: 157\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (62): google_dir, data_file, curator_PersonName, curator_organization, ...\ndbl  (63): lat, long, elevation, map, mat, tx_start, aspect_deg, slope, npp,...\nlgl  (31): depth_water, lit_c, lit_n, lit_p, lit_cn, lit_lig, bnpp_notes, L5...\ndate  (1): modification_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SoDaH)\n\n[1] 55760    39\n\n## [1] 55760    39\n\n\n\n\n\nBatjes, N.H. (2019). Harmonized soil profile data for applications at global and continental scales: updates to the WISE database. Soil Use and Management 5:124–127. Data download URL: https://files.isric.org/public/wise/WD-WISE.zip\n\n\nif(!exists(\"chemsprops.WISE\")){\n  wise.site &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_SITE.csv\", stringsAsFactors = FALSE)\n  #fao.90.lst = lapply(levels(as.factor(wise.site$FAO_90)), function(i){sumcor(wise.site, \"FAO_90\", \"USCL\", i)})\n  #fao.90.uscl = do.call(rbind, fao.90.lst)\n  #write.csv(fao.90.uscl, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/correlation_FAO.90_USCL.csv\")\n  wise.s.lst &lt;- c(\"WISE3_id\", \"PITREF\", \"DATEYR\", \"LONDD\", \"LATDD\", \"USCL\")\n  wise.site$LONDD = as.numeric(wise.site$LONDD)\n  wise.site$LATDD = as.numeric(wise.site$LATDD)\n  wise.layer &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_HORIZON.csv\", stringsAsFactors = FALSE)\n  wise.layer$ca_ext = signif(wise.layer$EXCA * 200, 4)\n  wise.layer$mg_ext = signif(wise.layer$EXMG * 121, 3)\n  wise.layer$na_ext = signif(wise.layer$EXNA * 230, 3)\n  wise.layer$k_ext = signif(wise.layer$EXK * 391, 3)\n  wise.layer$oc_d = signif(wise.layer$ORGC / 1000 * wise.layer$BULKDENS * 1000 * (100 - ifelse(is.na(wise.layer$GRAVEL), 0, wise.layer$GRAVEL))/100, 3)\n  wise.h.lst &lt;- c(\"WISE3_ID\", \"labsampnum\", \"layer_key\", \"HONU\", \"TOPDEP\", \"BOTDEP\", \"DESIG\", \"tex_psda\", \"texture_lab\", \"CLAY\", \"SILT\", \"SAND\", \"ORGC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKCL\", \"PHH2O\", \"PHCACL2\", \"CECSOIL\", \"cec_nh4\", \"ecec\", \"GRAVEL\" , \"BULKDENS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ECE\", \"ec_12pre\")\n  x.na = wise.h.lst[which(!wise.h.lst %in% names(wise.layer))]\n  if(length(x.na)&gt;0){ for(i in x.na){ wise.layer[,i] = NA } }\n  chemsprops.WISE = merge(wise.site[,wise.s.lst], wise.layer[,wise.h.lst], by.x=\"WISE3_id\", by.y=\"WISE3_ID\")\n  chemsprops.WISE$source_db = \"ISRIC_WISE\"\n  chemsprops.WISE$confidence_degree = 4\n  chemsprops.WISE$project_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"  \n  chemsprops.WISE$citation_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"\n  chemsprops.WISE = complete.vars(chemsprops.WISE, sel = c(\"ORGC\",\"CLAY\",\"PHH2O\",\"CECSOIL\",\"k_ext\"), coords = c(\"LONDD\", \"LATDD\"))\n  saveRDS.gz(chemsprops.WISE, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/chemsprops.WISE.rds\")\n}\ndim(chemsprops.WISE)\n\n[1] 37443    39\n\n## [1] 37443    39\n\n\n\n\n\nReimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, A., Négrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background and threshold for 53 chemical elements in European agricultural soil. Applied Geochemistry, 88, 302-318. Data download URL: http://gemas.geolba.ac.at/\n\n\nif(!exists(\"chemsprops.GEMAS\")){\n  gemas.samples &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/EU/GEMAS/GEMAS.csv\", stringsAsFactors = FALSE)\n  ## GEMAS, agricultural soil, 0-20 cm, air dried, &lt;2 mm, aqua regia Data from ACME, total C, TOC, CEC, ph_CaCl2\n  gemas.samples$hzn_top = 0\n  gemas.samples$hzn_bot = 20\n  gemas.samples$oc = gemas.samples$TOC * 10\n  #summary(gemas.samples$oc)\n  gemas.samples$c_tot = gemas.samples$C_tot * 10\n  gemas.samples$site_obsdate = 2009\n  gemas.h.lst &lt;- c(\"ID\", \"COUNRTY\", \"site_obsdate\", \"XCOO\", \"YCOO\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"TYPE\", \"tex_psda\", \"texture_lab\", \"clay\", \"silt\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = gemas.h.lst[which(!gemas.h.lst %in% names(gemas.samples))]\n  if(length(x.na)&gt;0){ for(i in x.na){ gemas.samples[,i] = NA } }\n  chemsprops.GEMAS &lt;- gemas.samples[,gemas.h.lst]\n  chemsprops.GEMAS$source_db = \"GEMAS_2009\"\n  chemsprops.GEMAS$confidence_degree = 2\n  chemsprops.GEMAS$project_url = \"http://gemas.geolba.ac.at/\"\n  chemsprops.GEMAS$citation_url = \"https://doi.org/10.1016/j.apgeochem.2017.01.021\"\n  chemsprops.GEMAS = complete.vars(chemsprops.GEMAS, sel = c(\"oc\",\"clay\",\"pH_CaCl2\"), coords = c(\"XCOO\", \"YCOO\"))\n  saveRDS.gz(chemsprops.GEMAS, \"/mnt/diskstation/data/Soil_points/EU/GEMAS/chemsprops.GEMAS.rds\")\n}\ndim(chemsprops.GEMAS)\n\n[1] 4131   39\n\n## [1] 4131   39\n\n\n\n\n\nOrgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernández‐Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153. Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n\nif(!exists(\"chemsprops.LUCAS\")){\n  lucas.samples &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_TOPSOIL_v1.xlsx\", sheet = 1)\n  lucas.samples$site_obsdate &lt;- \"2009\"\n  #summary(lucas.samples$N)\n  lucas.ro &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Romania.xlsx\", sheet = 1)\n  lucas.ro$site_obsdate &lt;- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.ro))]\n  lucas.ro = plyr::rename(lucas.ro, replace=c(\"Soil.ID\"=\"sample_ID\", \"GPS_X_LONG\"=\"GPS_LONG\", \"GPS_Y_LAT\"=\"GPS_LAT\", \"pHinH2O\"=\"pH_in_H2O\", \"pHinCaCl2\"=\"pH_in_CaCl\"))\n  lucas.bu &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Bulgaria.xlsx\", sheet = 1)\n  lucas.bu$site_obsdate &lt;- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.bu))]\n  #lucas.ch &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_2015_Topsoil_data_of_Switzerland-with-coordinates.xlsx_.xlsx\", sheet = 1, startRow = 2)\n  #lucas.ch = plyr::rename(lucas.ch, replace=c(\"Soil_ID\"=\"sample_ID\", \"GPS_.LAT\"=\"GPS_LAT\", \"pH.in.H2O\"=\"pH_in_H2O\", \"pH.in.CaCl2\"=\"pH_in_CaCl\", \"Calcium.carbonate/.g.kg–1\"=\"CaCO3\", \"Silt/.g.kg–1\"=\"silt\", \"Sand/.g.kg–1\"=\"sand\", \"Clay/.g.kg–1\"=\"clay\", \"Organic.carbon/.g.kg–1\"=\"OC\"))\n  ## Double readings?\n  lucas.t = plyr::rbind.fill(list(lucas.samples, lucas.ro, lucas.bu))\n  lucas.h.lst &lt;- c(\"POINT_ID\", \"usiteid\", \"site_obsdate\", \"GPS_LONG\", \"GPS_LAT\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_in_H2O\", \"pH_in_CaCl\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas.h.lst[which(!lucas.h.lst %in% names(lucas.t))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas.t[,i] = NA } }\n  chemsprops.LUCAS &lt;- lucas.t[,lucas.h.lst]\n  chemsprops.LUCAS$source_db = \"LUCAS_2009\"\n  chemsprops.LUCAS$hzn_top &lt;- 0\n  chemsprops.LUCAS$hzn_bot &lt;- 20\n  chemsprops.LUCAS$OC = ifelse(as.numeric(chemsprops.LUCAS$OC)&lt;0, 0, as.numeric(chemsprops.LUCAS$OC))\n  chemsprops.LUCAS$confidence_degree = 2\n  chemsprops.LUCAS$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS = complete.vars(chemsprops.LUCAS, sel = c(\"OC\",\"clay\",\"pH_in_H2O\"), coords = c(\"GPS_LONG\", \"GPS_LAT\"))\n  saveRDS.gz(chemsprops.LUCAS, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS.rds\")\n}\n\nWarning in ifelse(as.numeric(chemsprops.LUCAS$OC) &lt; 0, 0,\nas.numeric(chemsprops.LUCAS$OC)): NAs introduced by coercion\nWarning in ifelse(as.numeric(chemsprops.LUCAS$OC) &lt; 0, 0,\nas.numeric(chemsprops.LUCAS$OC)): NAs introduced by coercion\n\ndim(chemsprops.LUCAS)\n\n[1] 21272    39\n\n## [1] 21272    39\n\n\nif(!exists(\"chemsprops.LUCAS2\")){\n  #lucas2015.samples &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.xlsx\", sheet = 1)\n  lucas2015.v = terra::vect(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.shp\")\n  #head(as.data.frame(lucas2015.xy))\n  lucas2015.xy = dplyr::bind_cols(as.data.frame(lucas2015.v), geom(lucas2015.v))\n  ## https://www.aqion.de/site/130\n  ## 1 mS/m = 100 mS/cm | 1 dS/m = 1 mS/cm = 1 mS/m / 100\n  lucas2015.xy$ec_satp = lucas2015.xy$EC / 100\n  lucas2015.h.lst &lt;- c(\"Point_ID\", \"LC0_Desc\", \"site_obsdate\", \"x\", \"y\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_H20\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas2015.h.lst[which(!lucas2015.h.lst %in% names(lucas2015.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas2015.xy[,i] = NA } }\n  chemsprops.LUCAS2 &lt;- lucas2015.xy[,lucas2015.h.lst]\n  chemsprops.LUCAS2$source_db = \"LUCAS_2015\"\n  chemsprops.LUCAS2$hzn_top &lt;- 0\n  chemsprops.LUCAS2$hzn_bot &lt;- 20\n  chemsprops.LUCAS2$site_obsdate &lt;- \"2015\"\n  chemsprops.LUCAS2$confidence_degree = 2\n  chemsprops.LUCAS2$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS2$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS2 = complete.vars(chemsprops.LUCAS2, sel = c(\"OC\",\"Clay\",\"pH_H20\"), coords = c(\"x\", \"y\"))\n  saveRDS.gz(chemsprops.LUCAS2, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS2.rds\")\n}\ndim(chemsprops.LUCAS2)\n\n[1] 21859    39\n\n## [1] 21859    39\n\n\nif(!exists(\"chemsprops.LUCAS3\")){\n  lucas2018.xy &lt;- readxl::read_excel(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS-SOIL-2018.xls\", sheet = 1)\n  rem.LOD = function(x){ as.numeric(ifelse(x==\"&lt; LOD\", 0, as.numeric(x)))}\n  lucas2018.bd = read.csv(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/BulkDensity_2018_final-2.csv\")\n  lucas2018.xy$BD = dplyr::left_join(lucas2018.xy, lucas2018.bd, join_by(POINTID == POINT_ID))$BD.0.20\n  lucas2018.xy$BD = ifelse(lucas2018.xy$BD &lt; 0.04 | lucas2018.xy$BD &gt; 2.4, NA, lucas2018.xy$BD)\n  ## 1 mS/m = 100 mS/cm | 1 dS/m = 1 mS/cm = 1 mS/m / 100\n  #summary(!is.na(lucas2018.xy$`OC (20-30 cm)`))\n  lucas2018.xy$pH_H2O = as.numeric(lucas2018.xy$pH_H2O)\n  lucas2018.xy$OC = rem.LOD(lucas2018.xy$OC)\n  #summary(lucas2018.xy$OC)\n  lucas2018.xy$K = rem.LOD(lucas2018.xy$K)\n  lucas2018.xy$oc_d = signif(lucas2018.xy$OC/1000 * lucas2018.xy$BD*1000, 3)\n  #summary(lucas2018.xy$oc_d)\n  lucas2018.xy$site_obsdate = as.Date(lucas2018.xy$SURVEY_DATE, format = \"%d/%m/%y\")\n  lucas2018.xy$ec_satp = as.numeric(lucas2018.xy$EC) / 100\n  lucas2018.h.lst &lt;- c(\"Point_ID\", \"LC0_Desc\", \"site_obsdate\", \"TH_LONG\", \"TH_LAT\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_H20\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"BD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas2018.h.lst[which(!lucas2018.h.lst %in% names(lucas2018.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas2018.xy[,i] = NA } }\n  chemsprops.LUCAS3 &lt;- lucas2018.xy[,lucas2018.h.lst]\n  chemsprops.LUCAS3$source_db = \"LUCAS_2018\"\n  chemsprops.LUCAS3$hzn_top &lt;- 0\n  chemsprops.LUCAS3$hzn_bot &lt;- 20\n  chemsprops.LUCAS3$confidence_degree = 2\n  chemsprops.LUCAS3$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS3$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS3 = complete.vars(chemsprops.LUCAS3, sel = c(\"OC\",\"pH_H20\",\"BD\"), coords = c(\"TH_LONG\", \"TH_LAT\"))\n  saveRDS.gz(chemsprops.LUCAS3, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS3.rds\")\n}\n\nWarning: Expecting numeric in K15399 / R15399C11: got '&lt; LOD'\n\n\nWarning in ifelse(x == \"&lt; LOD\", 0, as.numeric(x)): NAs introduced by coercion\nWarning in ifelse(x == \"&lt; LOD\", 0, as.numeric(x)): NAs introduced by coercion\n\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.LUCAS3)\n\n[1] 18982    39\n\n## [1] 18982    39\n\n\n\n\n\nSanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). A global map of mangrove forest soil carbon at 30 m spatial resolution. Environmental Research Letters, 13(5), 055002. Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT\nMaxwell, T. L., Hengl, T., Parente, L. L., Minarik, R., Worthington, T. A., Bunting, P., … & Landis, E. (2023). Global mangrove soil organic carbon stocks dataset at 30 m resolution for the year 2020 based on spatiotemporal predictive machine learning. Data in Brief, 50, 109621. https://doi.org/10.1016/j.dib.2023.109621\n\n\nif(!exists(\"chemsprops.Mangroves\")){\n  mng.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_sites.csv\", skip=1)\n  mng.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_horizons.csv\", skip=1)\n  mng.2022 = read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_C_2022_update.csv\")\n  mng.2022$CD_calc = mng.2022$OC /100 * as.numeric(mng.2022$BD_reported)\n  mng.2022.f = plyr::rename(mng.2022, replace = list(\"Year_collected\"=\"Year_sampled\", \"Longitude\"=\"Longitude_Adjusted\", \"Latitude\"=\"Latitude_Adjusted\", \"BD_reported\"=\"BD_final\", \"OC\"=\"OC_final\"))\n  mngALL = plyr::join(mng.hors, mng.profs, by=c(\"Site.name\"))\n  mngALL = plyr::rbind.fill(mngALL, mng.2022)\n  mngALL$oc = mngALL$OC_final * 10\n  mngALL$oc_d = mngALL$CD_calc * 1000\n  mngALL$hzn_top = mngALL$U_depth * 100\n  mngALL$hzn_bot = mngALL$L_depth * 100\n  mngALL$wpg2 = 0\n  #summary(mngALL$BD_reported) ## some very high values 3.26 t/m3\n  mngALL$Year = ifelse(is.na(mngALL$Year_sampled), mngALL$Years_collected, mngALL$Year_sampled)\n  mng.col = c(\"Site.name\", \"Site..\", \"Year\", \"Longitude_Adjusted\", \"Latitude_Adjusted\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD_reported\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")  \n  x.na = mng.col[which(!mng.col %in% names(mngALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ mngALL[,i] = NA } }\n  chemsprops.Mangroves = mngALL[,mng.col]\n  chemsprops.Mangroves$source_db = \"MangrovesDB\"\n  chemsprops.Mangroves$confidence_degree = 4\n  chemsprops.Mangroves$project_url = \"http://maps.oceanwealth.org/mangrove-restoration/\"\n  chemsprops.Mangroves$citation_url = \"https://doi.org/10.1088/1748-9326/aabe1c\"\n  chemsprops.Mangroves = complete.vars(chemsprops.Mangroves, sel = c(\"oc\",\"BD_reported\"), coords = c(\"Longitude_Adjusted\", \"Latitude_Adjusted\"))\n  #head(chemsprops.Mangroves)\n  mng.rm = chemsprops.Mangroves$Site.name[chemsprops.Mangroves$Site.name %in% mngALL$Site.name[grep(\"N\", mngALL$OK.to.release., ignore.case = FALSE)]]\n  saveRDS.gz(chemsprops.Mangroves, \"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/chemsprops.Mangroves.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.Mangroves)\n\n[1] 7987   39\n\n## [1] 7987   39\n\n\n\n\nPeatland soil measurements (points) from the literature described in:\n\nMurdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals more peat in the tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452\n\n\nif(!exists(\"chemsprops.Peatlands\")){\n  cif.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR_v1.csv\")\n  #summary(cif.hors$BD..g.cm..)\n  #summary(cif.hors$SOC)\n  #summary(cif.hors$TOC.content....)\n  #summary(!is.na(cif.hors$modelling.x))\n  cif.hors$oc = cif.hors$SOC * 10\n  cif.hors$wpg2 = 0\n  cif.hors$c_tot = cif.hors$TOC.content.... * 10\n  cif.hors$oc_d = cif.hors$C.density..kg.C.m..\n  cif.hors$site_obsdate = as.integer(substr(cif.hors$year, 1, 4))-1\n  cif.hors$SSL_classification_name = ifelse(cif.hors$TAXNUSDA==\"\", paste(cif.hors$TAXOUSDA), paste(cif.hors$TAXNUSDA))\n  #summary(as.factor(cif.hors$SSL_classification_name))\n  cif.col = c(\"SOURCEID\", \"usiteid\", \"site_obsdate\", \"modelling.x\", \"modelling.y\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Upper\", \"Lower\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD..g.cm..\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cif.col[which(!cif.col %in% names(cif.hors))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cif.hors[,i] = NA } }\n  chemsprops.Peatlands = cif.hors[,cif.col]\n  chemsprops.Peatlands$source_db = \"CIFOR\"\n  chemsprops.Peatlands$confidence_degree = 4\n  chemsprops.Peatlands$project_url = \"https://www.cifor.org/\"\n  chemsprops.Peatlands$citation_url = \"https://doi.org/10.17528/cifor/006452\"\n  chemsprops.Peatlands = complete.vars(chemsprops.Peatlands, sel = c(\"oc\", \"BD..g.cm..\", \"SSL_classification_name\", \"c_tot\"), coords = c(\"modelling.x\", \"modelling.y\"))\n  saveRDS.gz(chemsprops.Peatlands, \"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/chemsprops.Peatlands.rds\")\n}\ndim(chemsprops.Peatlands)\n\n[1] 2968   39\n\n## [1] 2968  39\n\n\n\n\n\nHerrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). The Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use and Management through Cloud Computing, Mobile Applications, and Crowdsourcing. Journal of Soil and Water Conservation, 68(1), 5A-12A. Data download URL: http://portal.landpotential.org/#/landpksmap\n\n\n\n\n\n\nLandPKS sites in 2024.\n\n\n\n\n\nif(!exists(\"chemsprops.LandPKS\")){\n  pks = plyr::rbind.fill(\n            vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/LandPKS/Export_LandInfo_Data_1.csv\"), \n            vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/LandPKS/Export_LandInfo_Data_2.csv\"))\n  #str(pks)\n  ## 55483 obs. of  52 variables\n  #summary(as.factor(pks$BedrockDepth))\n  pks.hor = data.frame(rock_fragments = \n                         c(pks$`RockFragments0-1cm`,\n                           pks$`RockFragments1-10cm`,\n                           pks$`RockFragments10-20cm`,\n                           pks$`RockFragments20-50cm`,\n                           pks$`RockFragments50-70cm`,\n                           pks$`RockFragments70-100cm`,\n                           pks$`RockFragments100-120cm`), \n                       tex_field = \n                         c(pks$`Texture0-1cm`, \n                           pks$`Texture1-10cm`, \n                           pks$`Texture10-20cm`, \n                           pks$`Texture20-50cm`, \n                           pks$`Texture50-70cm`, \n                           pks$`Texture70-100cm`, \n                           pks$`Texture100-120cm`))\n  pks.hor$hzn_top = c(rep(0, nrow(pks)), \n                      rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)))\n  pks.hor$hzn_bot = c(rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)), \n                      rep(120, nrow(pks)))\n  pks.hor$longitude_decimal_degrees = rep(as.numeric(pks$Longitude), 7)\n  pks.hor$latitude_decimal_degrees = rep(as.numeric(pks$Latitude), 7)\n  pks.hor$depth_bedrock = rep(as.numeric(pks$BedrockDepth), 7)\n  pks.hor$site_obsdate = rep(pks$DateCreated_GMT, 7)\n  pks.hor$site_key = rep(pks$ID, 7)\n  #summary(as.factor(pks.hor$tex_field))\n  tex.tr = data.frame(tex_field=c(\"CLAY\", \"CLAY LOAM\", \"LOAM\", \"LOAMY SAND\", \"SAND\", \"SANDY CLAY\", \"SANDY CLAY LOAM\", \"SANDY LOAM\", \"SILT LOAM\", \"SILTY CLAY\", \"SILTY CLAY LOAM\"), \n                      clay_tot_psa=c(62.4, 34.0, 19.0, 5.8, 3.3, 41.7, 27.0, 10.0, 13.1, 46.7, 34.0), \n                      silt_tot_psa=c(17.8, 34.0, 40.0, 12.0, 5.0, 6.7, 13.0, 25.0, 65.7, 46.7, 56.0), \n                      sand_tot_psa=c(19.8, 32.0, 41.0, 82.2, 91.7, 51.6, 60.0, 65.0, 21.2, 6.7, 10.0))\n  pks.hor$clay_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$clay_tot_psa\n  pks.hor$silt_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$silt_tot_psa\n  pks.hor$sand_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$sand_tot_psa\n  #summary(as.factor(pks.hor$rock_fragments))\n  pks.hor$wpg2 = ifelse(pks.hor$rock_fragments==\"&gt;60%\", 65, ifelse(pks.hor$rock_fragments==\"35-60%\", 47.5, ifelse(pks.hor$rock_fragments==\"15-35%\", 25, ifelse(pks.hor$rock_fragments==\"1-15%\" | pks.hor$rock_fragments==\"0-15%\", 5, ifelse(pks.hor$rock_fragments==\"0-1%\", 0.5, NA)))))\n  #head(pks.hor)\n  ## very shallow or very rocky soils\n  pks.hor$oc = ifelse(pks.hor$depth_bedrock&lt;10 | pks.hor$rock_fragments &gt; 60, 0.5, NA)\n  pks.col = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_field\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = pks.col[which(!pks.col %in% names(pks.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ pks.hor[,i] = NA } }\n  chemsprops.LandPKS = pks.hor[,pks.col]\n  chemsprops.LandPKS$source_db = \"LandPKS\"\n  chemsprops.LandPKS$confidence_degree = 8\n  chemsprops.LandPKS$project_url = \"http://portal.landpotential.org\"\n  chemsprops.LandPKS$citation_url = \"https://doi.org/10.2489/jswc.68.1.5A\"\n  chemsprops.LandPKS = complete.vars(chemsprops.LandPKS, sel = c(\"clay_tot_psa\",\"wpg2\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))\n  #plot(chemsprops.LandPKS[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")], pch=\"+\")\n  saveRDS.gz(chemsprops.LandPKS, \"/mnt/diskstation/data/Soil_points/INT/LandPKS/chemsprops.LandPKS.rds\")\n}\n\nRows: 23973 Columns: 52\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (52): ID, Name, RecorderName, Latitude, Longitude, DateCreated_GMT, Land...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 31510 Columns: 52\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (46): Name, RecorderName, LandUse, GrazingAnimals, Flooding, Slope, Slo...\ndbl   (4): ID, Latitude, Longitude, BedrockDepth\nlgl   (1): Grazed\ndttm  (1): DateCreated_GMT\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n\nJoining by: tex_field\nJoining by: tex_field\nJoining by: tex_field\n\ndim(chemsprops.LandPKS)\n\n[1] 165044     39\n\n## [1] 165044    39\n\n\n\n\n\nRussian Federation: The Unified State Register of Soil Resources (EGRPR). Data download URL: http://egrpr.esoil.ru/content/1DB.html Note: these are only historic data and it is not clear if the locations are synthetic or actual soil profiles.\n\n\nif(!exists(\"chemsprops.EGRPR\")){\n  russ.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Russia/EGRPR/Russia_EGRPR_soil_pedons.csv\")\n  russ.HOR$SOURCEID = paste(russ.HOR$CardID, russ.HOR$SOIL_ID, sep=\"_\")\n  russ.HOR$wpg2 = russ.HOR$TEXTSTNS\n  russ.HOR$SNDPPT &lt;- russ.HOR$TEXTSAF + russ.HOR$TEXSCM\n  russ.HOR$SLTPPT &lt;- russ.HOR$TEXTSIC + russ.HOR$TEXTSIM + 0.8 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  russ.HOR$CLYPPT &lt;- russ.HOR$TEXTCL + 0.2 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  ## Correct texture fractions:\n  sumTex &lt;- rowSums(russ.HOR[,c(\"SLTPPT\",\"CLYPPT\",\"SNDPPT\")])\n  russ.HOR$SNDPPT &lt;- russ.HOR$SNDPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$SLTPPT &lt;- russ.HOR$SLTPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$oc &lt;- rowMeans(data.frame(x1=russ.HOR$CORG * 10, x2=russ.HOR$ORGMAT/1.724 * 10), na.rm=TRUE)\n  russ.HOR$oc_d = signif(russ.HOR$oc / 1000 * russ.HOR$DVOL * 1000 * (100 - ifelse(is.na(russ.HOR$wpg2), 0, russ.HOR$wpg2))/100, 3)\n  russ.HOR$n_tot &lt;- russ.HOR$NTOT * 10\n  russ.HOR$ca_ext = russ.HOR$EXCA * 200\n  russ.HOR$mg_ext = russ.HOR$EXMG * 121\n  russ.HOR$na_ext = russ.HOR$EXNA * 230\n  russ.HOR$k_ext = russ.HOR$EXK * 391\n  ## Sampling year not available but with high confidence &lt;2000\n  russ.HOR$site_obsdate = \"1982\"\n  russ.sel.h &lt;- c(\"SOURCEID\", \"SOIL_ID\", \"site_obsdate\", \"LONG\", \"LAT\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HORNMB\", \"HORTOP\", \"HORBOT\", \"HISMMN\", \"tex_psda\", \"texture_lab\", \"CLYPPT\", \"SLTPPT\", \"SNDPPT\", \"oc\", \"oc_d\", \"c_tot\", \"NTOT\", \"PHSLT\", \"PHH2O\", \"ph_cacl2\", \"CECST\", \"cec_nh4\", \"ecec\", \"wpg2\", \"DVOL\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = russ.sel.h[which(!russ.sel.h %in% names(russ.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ russ.HOR[,i] = NA } }\n  chemsprops.EGRPR = russ.HOR[,russ.sel.h]\n  chemsprops.EGRPR$source_db = \"Russia_EGRPR\"\n  chemsprops.EGRPR$confidence_degree = 5\n  chemsprops.EGRPR$project_url = \"http://egrpr.esoil.ru/\"\n  chemsprops.EGRPR$citation_url = \"https://doi.org/10.19047/0136-1694-2016-86-115-123\"\n  chemsprops.EGRPR &lt;- complete.vars(chemsprops.EGRPR, sel=c(\"oc\", \"CLYPPT\"), coords = c(\"LONG\", \"LAT\"))\n  saveRDS.gz(chemsprops.EGRPR, \"/mnt/diskstation/data/Soil_points/Russia/EGRPR/chemsprops.EGRPR.rds\")\n}\ndim(chemsprops.EGRPR)\n\n[1] 4506   39\n\n## [1] 4506   39\n\n\n\n\n\nAgriculture and Agri-Food Canada National Pedon Database. Data download URL: https://open.canada.ca/data/en/\n\n\nif(!exists(\"chemsprops.NPDB\")){\n  NPDB.nm = c(\"NPDB_V2_sum_source_info.csv\",\"NPDB_V2_sum_chemical.csv\", \"NPDB_V2_sum_horizons_raw.csv\", \"NPDB_V2_sum_physical.csv\")\n  NPDB.HOR = plyr::join_all(lapply(paste0(\"/mnt/diskstation/data/Soil_points/Canada/NPDB/\", NPDB.nm), read.csv), type = \"full\")\n  NPDB.HOR$HISMMN = paste0(NPDB.HOR$HZN_MAS, NPDB.HOR$HZN_SUF, NPDB.HOR$HZN_MOD)\n  NPDB.HOR$CARB_ORG[NPDB.HOR$CARB_ORG==9] &lt;- NA\n  NPDB.HOR$N_TOTAL[NPDB.HOR$N_TOTAL==9] &lt;- NA\n  NPDB.HOR$oc = NPDB.HOR$CARB_ORG * 10\n  NPDB.HOR$oc_d = signif(NPDB.HOR$oc / 1000 * NPDB.HOR$BULK_DEN * 1000 * (100 - ifelse(is.na(NPDB.HOR$VC_SAND), 0, NPDB.HOR$VC_SAND))/100, 3)\n  NPDB.HOR$ca_ext = NPDB.HOR$EXCH_CA * 200\n  NPDB.HOR$mg_ext = NPDB.HOR$EXCH_MG * 121\n  NPDB.HOR$na_ext = NPDB.HOR$EXCH_NA * 230\n  NPDB.HOR$k_ext = NPDB.HOR$EXCH_K * 391\n  npdb.sel.h = c(\"PEDON_ID\", \"usiteid\", \"CAL_YEAR\", \"DD_LONG\", \"DD_LAT\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"U_DEPTH\", \"L_DEPTH\", \"HISMMN\", \"tex_psda\", \"texture_lab\", \"T_CLAY\", \"T_SILT\", \"T_SAND\", \"oc\", \"oc_d\", \"c_tot\", \"N_TOTAL\", \"ph_kcl\", \"PH_H2O\", \"PH_CACL2\", \"CEC\", \"cec_nh4\", \"ecec\", \"VC_SAND\", \"BULK_DEN\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = npdb.sel.h[which(!npdb.sel.h %in% names(NPDB.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ NPDB.HOR[,i] = NA } }\n  chemsprops.NPDB = NPDB.HOR[,npdb.sel.h]\n  chemsprops.NPDB$source_db = \"Canada_NPDB\"\n  chemsprops.NPDB$confidence_degree = 2\n  chemsprops.NPDB$project_url = \"https://open.canada.ca/data/en/\"\n  chemsprops.NPDB$citation_url = \"https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\"\n  chemsprops.NPDB &lt;- complete.vars(chemsprops.NPDB, sel=c(\"oc\", \"PH_H2O\", \"T_CLAY\"), coords = c(\"DD_LONG\", \"DD_LAT\"))\n  saveRDS.gz(chemsprops.NPDB, \"/mnt/diskstation/data/Soil_points/Canada/NPDB/chemsprops.NPDB.rds\")\n}\n\nJoining by: PEDON_ID\n\n\nJoining by: PEDON_ID, LAYER_ID, U_DEPTH, L_DEPTH\nJoining by: PEDON_ID, LAYER_ID, U_DEPTH, L_DEPTH\n\ndim(chemsprops.NPDB)\n\n[1] 16405    39\n\n## [1] 16405    39\n\n\n\n\n\nShaw, C., Hilger, A., Filiatrault, M., & Kurz, W. (2018). A Canadian upland forest soil profile and carbon stocks database. Ecology, 99(4), 989-989. Data download URL: https://esajournals.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fecy.2159&file=ecy2159-sup-0001-DataS1.zip\n\n*Organic horizons have negative values, the first mineral soil horizon has a value of 0 cm, and other mineral soil horizons have positive values. This needs to be corrected before the values can be bind with other international sets.\n\nif(!exists(\"chemsprops.CUFS\")){\n  ## Reading of the .dat file was tricky \n  cufs.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/PROFILES.csv\", stringsAsFactors = FALSE)\n  cufs.HOR$LOWER_HZN_LIMIT =cufs.HOR$UPPER_HZN_LIMIT + cufs.HOR$HZN_THICKNESS\n  ## Correct depth (Canadian data can have negative depths for soil horizons):\n  z.min.cufs &lt;- ddply(cufs.HOR, .(LOCATION_ID), summarize, aggregated = min(UPPER_HZN_LIMIT, na.rm=TRUE))\n  z.shift.cufs &lt;- join(cufs.HOR[\"LOCATION_ID\"], z.min.cufs, type=\"left\")$aggregated\n  ## fixed shift\n  z.shift.cufs &lt;- ifelse(z.shift.cufs&gt;0, 0, z.shift.cufs)\n  cufs.HOR$hzn_top &lt;- cufs.HOR$UPPER_HZN_LIMIT - z.shift.cufs\n  cufs.HOR$hzn_bot &lt;- cufs.HOR$LOWER_HZN_LIMIT - z.shift.cufs\n  cufs.SITE = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/SITES.csv\", stringsAsFactors = FALSE)\n  #str(cufs.SITE)\n  can.tbl = read.csv(\"./correlation/soil_types_correlation_table_Canada.csv\")\n  cufs.SITE$SSL_classification_name = dplyr::left_join(cufs.SITE[\"GGSG\"], can.tbl, by=c(\"GGSG\"=\"CSSC_Class\"))$TAXOUSDA\n  cufs.HOR$longitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LONGITUDE\n  cufs.HOR$latitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LATITUDE\n  cufs.HOR$site_obsdate = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$YEAR_SAMPLED\n  cufs.HOR$usiteid = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$RELEASE_SOURCE_SITEID\n  #summary(cufs.HOR$ORG_CARB_PCT)\n  #hist(cufs.HOR$ORG_CARB_PCT, breaks=45)\n  cufs.HOR$oc = cufs.HOR$ORG_CARB_PCT*10\n  #cufs.HOR$c_tot = cufs.HOR$oc + ifelse(is.na(cufs.HOR$CARBONATE_CARB_PCT), 0, cufs.HOR$CARBONATE_CARB_PCT*10)\n  cufs.HOR$n_tot = cufs.HOR$TOT_NITRO_PCT*10\n  cufs.HOR$ca_ext = cufs.HOR$EXCH_Ca * 200\n  cufs.HOR$mg_ext = cufs.HOR$EXCH_Mg * 121\n  cufs.HOR$na_ext = cufs.HOR$EXCH_Na * 230\n  cufs.HOR$k_ext = cufs.HOR$EXCH_K * 391\n  cufs.HOR$ph_cacl2 = cufs.HOR$pH\n  cufs.HOR$ph_cacl2[!cufs.HOR$pH_H2O_CACL2==\"CACL2\"] = NA\n  cufs.HOR$ph_h2o = cufs.HOR$pH\n  cufs.HOR$ph_h2o[!cufs.HOR$pH_H2O_CACL2==\"H2O\"] = NA\n  #summary(cufs.HOR$CF_VOL_PCT) ## is NA == 0??\n  cufs.HOR$wpg2 = ifelse(cufs.HOR$CF_CORR_FACTOR==1, 0, cufs.HOR$CF_VOL_PCT)\n  cufs.HOR$oc_d = signif(cufs.HOR$oc / 1000 * cufs.HOR$BULK_DENSITY * 1000 * (100 - ifelse(is.na(cufs.HOR$wpg2), 0, cufs.HOR$wpg2))/100, 3)\n  cufs.sel.h = c(\"LOCATION_ID\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HZN_SEQ_NO\", \"hzn_top\", \"hzn_bot\", \"HORIZON\", \"TEXT_CLASS\", \"texture_lab\", \"CLAY_PCT\", \"SILT_PCT\", \"SAND_PCT\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"CEC_CALCULATED\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK_DENSITY\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELEC_COND\", \"ec_12pre\")\n  x.na = cufs.sel.h[which(!cufs.sel.h %in% names(cufs.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cufs.HOR[,i] = NA } }\n  chemsprops.CUFS = cufs.HOR[,cufs.sel.h]\n  chemsprops.CUFS$source_db = \"Canada_CUFS\"\n  chemsprops.CUFS$confidence_degree = 1\n  chemsprops.CUFS$project_url = \"https://cfs.nrcan.gc.ca/publications/centre/nofc\"\n  chemsprops.CUFS$citation_url = \"https://doi.org/10.1002/ecy.2159\"\n  chemsprops.CUFS &lt;- complete.vars(chemsprops.CUFS, sel=c(\"oc\", \"ph_h2o\", \"CLAY_PCT\"))\n  saveRDS.gz(chemsprops.CUFS, \"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/chemsprops.CUFS.rds\")\n}\n\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\n\ndim(chemsprops.CUFS)\n\n[1] 15873    39\n\n## [1] 15873    39\n\n\n\n\n\nEstop-Aragones, C.; Fisher, J.P.; Cooper, M.A.; Thierry, A.; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, I.P. (2016). Bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952. Data download URL:\n\n\nif(!exists(\"chemsprops.CAPERM\")){\n  caperm.HOR = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Canada/NorthCanada/Bulk_density_CandNcontent_profiles_all_sites.csv\")\n  #measurements::conv_unit(\"-99 36 15.7\", from = \"deg_min_sec\", to = \"dec_deg\")\n  #caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", gsub('\\\"W', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_West, \"UTF-8\", \"UTF-8\", sub=' ')), fixed = TRUE)), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", caperm.HOR$Cordinates_West), from = \"deg_min_sec\", to = \"dec_deg\"))\n  #caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(gsub('\\\"N', '', gsub('o', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_North, \"UTF-8\", \"UTF-8\", sub=' '))), fixed = TRUE), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(caperm.HOR$Cordinates_North, from = \"deg_min_sec\", to = \"dec_deg\"))\n  #plot(caperm.HOR[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  caperm.HOR$site_obsdate = \"2013\"\n  caperm.HOR$site_key = make.unique(caperm.HOR$Soil.core)\n  #summary(as.factor(caperm.HOR$Soil_depth_cm))\n  caperm.HOR$hzn_top = caperm.HOR$Soil_depth_cm-1\n  caperm.HOR$hzn_bot = caperm.HOR$Soil_depth_cm+1\n  caperm.HOR$bulk_density_oven_dry = caperm.HOR$Bulk_density_gdrysoil_cm3wetsoil\n  caperm.HOR$organic_carbon = caperm.HOR$Ccontent_percentage_on_drymass * 10\n  caperm.HOR$total_nitrogen_ncs = caperm.HOR$Ncontent_percentage_on_drymass * 10\n  caperm.HOR$oc_d = signif(caperm.HOR$organic_carbon / 1000 * caperm.HOR$bulk_density_oven_dry * 1000, 3)\n  x.na = col.names[which(!col.names %in% names(caperm.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ caperm.HOR[,i] = NA } }\n  chemsprops.CAPERM = caperm.HOR[,col.names]\n  chemsprops.CAPERM$source_db = \"Canada_subarctic\"\n  chemsprops.CAPERM$confidence_degree = 2\n  chemsprops.CAPERM$project_url = \"http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/\"\n  chemsprops.CAPERM$citation_url = \"https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952\"\n  chemsprops.CAPERM &lt;- complete.vars(chemsprops.CAPERM, sel=c(\"organic_carbon\", \"total_nitrogen_ncs\"))\n  saveRDS.gz(chemsprops.CAPERM, \"/mnt/diskstation/data/Soil_points/Canada/NorthCanada/chemsprops.CAPERM.rds\")\n}\n\nRows: 2931 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (6): Soil.core, Remarks, soil.type_Org_Min_Blend_Rock, Cordinates_North,...\ndbl (4): Soil_depth_cm, Bulk_density_gdrysoil_cm3wetsoil, Ncontent_percentag...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.CAPERM)\n\n[1] 1381   39\n\n## [1] 1381   39\n\n\n\n\n\nDijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil and landform properties for LADA partner countries. ISRIC report 2008/06 and GLADA report 2008/03, ISRIC – World Soil Information and FAO, Wageningen. Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip\n\n\nif(!exists(\"chemsprops.CNSOTER\")){\n  sot.sites = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Profile.csv\")\n  st.cor = read.csv('./correlation/soil_type_correlation_ISRIC_WISE.csv')\n  sot.sites$SSL_classification_name = paste0( dplyr::left_join(sot.sites[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90\"), multiple = \"first\")$Class_1, \" / \",\n                       dplyr::left_join(sot.sites[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90\"), multiple = \"first\")$Class_2)           \n  #summary(as.factor(sot.sites$SSL_classification_name))\n  sot.horizons = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Horizon.csv\")\n  sot.HOR = plyr::join_all(list(sot.sites, sot.horizons), type = \"full\")\n  sot.HOR$oc = sot.HOR$SOCA * 10\n  sot.HOR$ca_ext = sot.HOR$EXCA * 200\n  sot.HOR$mg_ext = sot.HOR$EXMG * 121\n  sot.HOR$na_ext = sot.HOR$EXNA * 230\n  sot.HOR$k_ext = sot.HOR$EXCK * 391\n  ## upper depth missing needs to be derived manually\n  sot.HOR$hzn_top = NA\n  sot.HOR$hzn_top[2:nrow(sot.HOR)] &lt;- sot.HOR$HBDE[1:(nrow(sot.HOR)-1)]\n  sot.HOR$hzn_top &lt;- ifelse(sot.HOR$hzn_top &gt; sot.HOR$HBDE, 0, sot.HOR$hzn_top)\n  sot.HOR$hzn_top &lt;- ifelse(sot.HOR$HONU==1 & is.na(sot.HOR$hzn_top), 0, sot.HOR$hzn_top)\n  sot.HOR$oc_d = signif(sot.HOR$oc / 1000 * sot.HOR$BULK * 1000 * (100 - ifelse(is.na(sot.HOR$SDVC), 0, sot.HOR$SDVC))/100, 3)\n  sot.sel.h = c(\"PRID\", \"PDID\", \"SAYR\", \"LNGI\", \"LATI\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HONU\", \"hzn_top\",  \"HBDE\", \"HODE\", \"PSCL\", \"texture_lab\", \"CLPC\", \"STPC\", \"SDTO\", \"oc\", \"oc_d\", \"TOTC\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"SDVC\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = sot.sel.h[which(!sot.sel.h %in% names(sot.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sot.HOR[,i] = NA } }\n  chemsprops.CNSOT = sot.HOR[,sot.sel.h]\n  chemsprops.CNSOT$source_db = \"China_SOTER\"\n  chemsprops.CNSOT$confidence_degree = 8\n  chemsprops.CNSOT$project_url = \"https://www.isric.org/explore/soter\"\n  chemsprops.CNSOT$citation_url = \"https://isric.org/sites/default/files/isric_report_2008_06.pdf\"\n  chemsprops.CNSOT &lt;- complete.vars(chemsprops.CNSOT, sel=c(\"TOTC\", \"PHAQ\", \"CLPC\"), coords = c(\"LNGI\", \"LATI\"))\n  saveRDS.gz(chemsprops.CNSOT, \"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/chemsprops.CNSOT.rds\")\n}\n\nJoining by: PRID, INFR\n\ndim(chemsprops.CNSOT)\n\n[1] 5115   39\n\n## [1] 5115   39\n\n\n\n\n\nDíaz-Guadarrama, S., Varón-Ramírez, V. M., Lizarazo, I., Guevara, M., Angelini, M., Araujo-Carrillo, G. A., … & Rubiano, Y. (2024). Improving the Latin America and Caribbean Soil Information System (SISLAC) database enhances its usability and scalability. Earth System Science Data, 16(3), 1229-1246. https://doi.org/10.5194/essd-16-1229-2024\n\n\nif(!exists(\"chemsprops.SISLAC\")){\n  sis.hor = read.csv(\"/mnt/diskstation/data/Soil_points/SA/SISLAC/sislac_v2.csv\", stringsAsFactors = FALSE)\n  #str(sis.hor)\n  #summary(as.factor(sis.hor$source))\n  ## Remove some redundant records:\n  sis.hor = sis.hor[!sis.hor$source %in% c(\"WoSIS July 2016 Snapshot\", \"CHLSOC: the Chilean Soil Organic Carbon database\", \"Harmonized soil database of Ecuador (HESD)\", \"México Serie-2\"),]\n  #dim(sis.hor)\n  ## 96421 rows\n  ## SOC for Uruguay do not match the original soil profile data (see e.g. http://www.mgap.gub.uy/sites/default/files/multimedia/skmbt_c45111090914030.pdf)\n  ## compare with:\n  #sis.hor[sis.hor$perfil_id==\"23861\",]\n  #summary(sis.hor$organic_carbon)\n  ## Some erratic values with SOC % &gt; 100%!\n  sis.hor$oc = ifelse(sis.hor$organic_carbon &gt; 80, NA, sis.hor$organic_carbon * 10)\n  #ggplot(sis.hor, aes(oc+1)) + geom_histogram() + scale_x_log10()\n  #summary(sis.hor$bulk_density)\n  #summary(sis.hor$coarse_fragments)\n  sis.hor$oc_d = signif(sis.hor$oc / 1000 * sis.hor$bulk_density * 1000 * (100 - ifelse(is.na(sis.hor$coarse_fragments), 0, sis.hor$coarse_fragments))/100, 3)\n  #summary(sis.hor$oc_d)\n  sis.hor$site_obsdate = format(as.Date(sis.hor$fecha, format=\"%d/%m/%Y\"), \"%Y-%m-%d\")\n  sis.hor$n_tot = sis.hor$n * 10\n  #summary(sis.hor$k)\n  sis.hor$ca_ext = sis.hor$ca * 200\n  sis.hor$mg_ext = sis.hor$mg * 121\n  sis.hor$k_ext = sis.hor$k * 391\n  #summary(as.factor(substr(sis.hor$site_obsdate, 1, 4)))\n  ## 71407 thousand with year 1900 / many with 1905? Typos?\n  sis.sel.h = c(\"profile_id\", \"profile_identifier\", \"site_obsdate\", \"longitude\", \"latitude\", \"SSL_classification_name\", \"layer_identifier\", \"layer_id\", \"layer_sequence\", \"top\", \"bottom\", \"designation\", \"textura\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"coarse_fragments\", \"analitico_densidad_aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = sis.sel.h[which(!sis.sel.h %in% names(sis.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sis.hor[,i] = NA } }\n  chemsprops.SISLAC = sis.hor[,sis.sel.h]\n  chemsprops.SISLAC$source_db = \"SISLAC\"\n  chemsprops.SISLAC$confidence_degree = 6\n  chemsprops.SISLAC$project_url = \"https://github.com/DiazSergio/Revised-SISLAC-Database-Version1.2\"\n  chemsprops.SISLAC$citation_url = \"https://doi.org/10.5194/essd-16-1229-2024\"\n  chemsprops.SISLAC &lt;- complete.vars(chemsprops.SISLAC, sel=c(\"oc\",\"ph\",\"clay\"), coords = c(\"longitude\", \"latitude\"))\n  saveRDS.gz(chemsprops.SISLAC, \"/mnt/diskstation/data/Soil_points/SA/SISLAC/chemsprops.SISLAC.rds\")\n}\ndim(chemsprops.SISLAC)\n\n[1] 92121    39\n\n## [1] 92121    39\n\n\n\n\n\nSamuel-Rosa, A., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data in Brazil: geospatial data quality and how to improve it. Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430\nFree Brazilian Repository for Open Soil Data – febr. Data download URL: http://www.ufsm.br/febr/ and/or https://samuel-rosa.github.io/project/febr/#estou-procurando-dados\n\n\nif(!exists(\"chemsprops.FEBR\")){\n  #remotes::install_github(repo = \"laboratorio-de-pedometria/febr-package\")\n  #library(febr)\n  ## download up-to-date copy of data\n  #febr.lab = febr::layer(dataset = \"all\", variable=\"all\")\n  #febr.lab = febr::observation(dataset = \"all\")\n  #febr.md = febr::metadata(data.set = c(\"ctb0003\", \"ctb0002\"))\n  febr.hor = read.csv(gzfile(\"/mnt/diskstation/data/Soil_points/Brasil/FEBR/febr-superconjunto.txt.gz\"), stringsAsFactors = FALSE, dec = \",\", sep = \";\")\n  ## Rows: 50470 Columns: 40\n  #head(febr.hor)\n  #summary(febr.hor$coord_x)\n  #summary(as.factor(febr.hor$coord_fonte))\n  #summary(as.numeric(febr.hor$carbono))\n  #summary(as.numeric(febr.hor$ph))\n  #summary(as.numeric(febr.hor$dsi))\n  #summary(febr.hor$dsi) ## bulk density of total soil\n  febr.hor$organic_carbon = as.numeric(febr.hor$carbono)\n  febr.hor$bulk_density_oven_dry = as.numeric(febr.hor$dsi)\n  febr.hor$ph_h2o = ifelse(febr.hor$ph&lt;30|febr.hor$ph&gt;90, NA, febr.hor$ph/10)\n  febr.hor$clay_tot_psa = febr.hor$argila /10\n  febr.hor$sand_tot_psa = febr.hor$areia /10\n  febr.hor$silt_tot_psa = febr.hor$silte /10\n  febr.hor$wpg2 = (1000-febr.hor$terrafina)/10\n  febr.hor$oc_d = signif(febr.hor$organic_carbon / 1000 * febr.hor$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(febr.hor$wpg2), 0, febr.hor$wpg2))/100, 3)\n  #summary(febr.hor$oc_d)\n  #br.sm = summary(as.factor(febr.hor$taxon_sibcs))\n  #br.tax = as.data.frame(br.sm)\n  #br.tax$levels = attr(br.sm, \"names\")\n  #write.csv(br.tax, \"/mnt/diskstation/data/Soil_points/Brasil/FEBR/febr_taxon_sibcs.csv\")\n  febr.tax = read.csv(\"./correlation/soil_type_correlation_BR_FEBR.csv\")\n  febr.hor$SSL_classification_name = dplyr::left_join(febr.hor[\"taxon_sibcs\"], febr.tax, by=c(\"taxon_sibcs\"=\"levels\"), multiple = \"first\")$SSL_classification_name\n  febr.hor$SSL_classification_name = ifelse(is.na(febr.hor$taxon_st), febr.hor$SSL_classification_name, febr.hor$taxon_st)\n  #summary(as.factor(febr.hor$SSL_classification_name))\n  febr.sel.h &lt;- c(\"observacao_id\", \"usiteid\", \"observacao_data\", \"coord_x\", \"coord_y\", \"SSL_classification_name\", \"sisb_id\", \"layer_key\", \"camada_id\", \"profund_sup\", \"profund_inf\", \"camada_nome\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"organic_carbon\", \"oc_d\", \"c_tot\", \"total_carbon_ncs\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = febr.sel.h[which(!febr.sel.h %in% names(febr.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ febr.hor[,i] = NA } }\n  chemsprops.FEBR = febr.hor[,febr.sel.h]\n  chemsprops.FEBR$source_db = \"FEBR\"\n  chemsprops.FEBR$confidence_degree = 4\n  chemsprops.FEBR$project_url = \"http://www.ufsm.br/febr/\"\n  chemsprops.FEBR$citation_url = \"https://doi.org/10.1590/1678-992x-2017-0430\"\n  chemsprops.FEBR &lt;- complete.vars(chemsprops.FEBR, sel=c(\"organic_carbon\", \"ph_h2o\", \"clay_tot_psa\", \"bulk_density_oven_dry\"), coords = c(\"coord_x\", \"coord_y\"))\n  saveRDS.gz(chemsprops.FEBR, \"/mnt/diskstation/data/Soil_points/Brasil/FEBR/chemsprops.FEBR.rds\")\n}\ndim(chemsprops.FEBR)\n\n[1] 24420    39\n\n## [1] 24420    39\n\n\n\n\n\nPOLIDORO, J., COELHO, M., CARVALHO FILHO, A. D., LUMBRERAS, J., de OLIVEIRA, A. P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos do Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).\nDownload URL:http://geoinfo.cnps.embrapa.br/documents/3013/download\n\n\nif(!exists(\"chemsprops.PRONASOLOS\")){\n  pronas.hor = as.data.frame(sf::read_sf(\"/mnt/diskstation/data/Soil_points/Brasil/Pronasolos/Perfis_PronaSolos_20201202v2.shp\"))\n  ## 34,464 rows\n  #head(pronas.hor)\n  #summary(as.numeric(pronas.hor$carbono_or))\n  #summary(as.numeric(pronas.hor$densidade_))\n  #summary(as.numeric(pronas.hor$argila))\n  #summary(as.numeric(pronas.hor$cascalho))\n  #summary(as.numeric(pronas.hor$ph_h2o))\n  #summary(as.numeric(pronas.hor$complexo_2))\n  ## A lot of errors / typos e.g. very high values and 0 values!!\n  #pronas.hor$data_colet[1:50]\n  pronas.in.name = c(\"sigla\", \"codigo_pon\", \"data_colet\", \"gcs_latitu\", \"gcs_longit\", \"simbolo_ho\", \"profundida\", \n                     \"profundi_1\", \"cascalho\", \"areia_tota\", \"silte\", \"argila\", \"densidade_\", \"ph_h2o\", \"ph_kcl\", \n                     \"complexo_s\", \"complexo_1\", \"complexo_2\", \"complexo_3\", \"valor_s\", \"carbono_or\", \"nitrogenio\",\n                     \"condutivid\", \"classe_tex\")\n  #pronas.in.name[which(!pronas.in.name %in% names(pronas.hor))]\n  pronas.x = as.data.frame(pronas.hor[,pronas.in.name])\n  pronas.out.name = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\",\n                      \"hzn_desgn\", \"hzn_bot\", \"hzn_top\", \"total_frag_wt_pct_gt_2_mm_ws\", \"sand_total\", \"silt_total\", \n                      \"clay_total\", \"bulk_density_oven_dry\", \"ph_h2o\", \"ph_kcl\", \"ca_ext\",\n                      \"mg_ext\", \"k_ext\", \"na_ext\", \"sum_of_cations_cec_pH_8_2\", \"organic_carbon\", \"total_nitrogen_ncs\", \"ec_water_extractable\", \"texture_description\")\n  ## translate values\n  pronas.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(pronas.in.name)))\n  pronas.fun.lst[[which(pronas.in.name==\"sigla\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"codigo_pon\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"data_colet\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"simbolo_ho\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"classe_tex\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_s\")]] = \"as.numeric(x)*200\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_1\")]] = \"as.numeric(x)*121\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_2\")]] = \"as.numeric(x)*391\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_3\")]] = \"as.numeric(x)*230\"\n  pronas.fun.lst[[which(pronas.in.name==\"areia_tota\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"silte\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"argila\")]] = \"round(as.numeric(x)/10, 1)\"\n  ## save translation rules:\n  #write.csv(data.frame(pronas.in.name, pronas.out.name, unlist(pronas.fun.lst)), \"pronas_soilab_transvalues.csv\")\n  pronas.soil = transvalues(pronas.x, pronas.out.name, pronas.in.name, pronas.fun.lst)\n  ## a lot of NA's\n  #summary(pronas.soil$organic_carbon)\n  pronas.soil$bulk_density_oven_dry &lt;- ifelse(pronas.soil$bulk_density_oven_dry &lt; 0.05, NA, pronas.soil$bulk_density_oven_dry)\n  pronas.soil$total_frag_wt_pct_gt_2_mm_ws &lt;- ifelse(pronas.soil$total_frag_wt_pct_gt_2_mm_ws &lt; 0 | pronas.soil$total_frag_wt_pct_gt_2_mm_ws &gt; 100, NA, pronas.soil$total_frag_wt_pct_gt_2_mm_ws)\n  #summary(pronas.soil$bulk_density_oven_dry)\n  pronas.soil$oc_d = signif(pronas.soil$organic_carbon / 1000 * pronas.soil$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(pronas.soil$total_frag_wt_pct_gt_2_mm_ws), 0, pronas.soil$total_frag_wt_pct_gt_2_mm_ws))/100, 3)\n  #summary(pronas.soil$oc_d)\n  x.na = col.names[which(!col.names %in% names(pronas.soil))]\n  if(length(x.na)&gt;0){ for(i in x.na){ pronas.soil[,i] = NA } }\n  chemsprops.PRONASOLOS = pronas.soil[,col.names]\n  chemsprops.PRONASOLOS$source_db = \"PRONASOLOS\"\n  chemsprops.PRONASOLOS$confidence_degree = 2\n  chemsprops.PRONASOLOS$project_url = \"https://geoportal.cprm.gov.br/pronasolos/\"\n  chemsprops.PRONASOLOS$citation_url = \"https://www.infoteca.cnptia.embrapa.br/infoteca/handle/doc/1135056\"\n  chemsprops.PRONASOLOS &lt;- complete.vars(chemsprops.PRONASOLOS, sel=c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.PRONASOLOS, \"/mnt/diskstation/data/Soil_points/Brasil/Pronasolos/chemsprops.PRONASOLOS.rds\")\n}\n\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\n\ndim(chemsprops.PRONASOLOS)\n\n[1] 32708    39\n\n## [1] 32708    39\n\n\n\n\n\nVásquez-Toxcón, A.O., H. Tobías Vásquez, and M. Guevara, (2023). Guatemala Soil Organic Carbon Database (0 to 30 cm, 1965-2010). ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/8dd15238c604c3ac75daf985548bd05c (Accessed 2024-11-24).\n\nVásquez, A., Varón‐Ramírez, V. M., Tobías, H., & Guevara, M. (2024). Guatemala soil organic carbon database (GTMSOC). European Journal of Soil Science, 75(1), e13450. https://doi.org/10.1111/ejss.13450\n\n\nif(!exists(\"chemsprops.Guatemala\")){\n  gua.df = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Guatemala/GTMSOCBD.csv\")\n  ## Rows: 910 Columns: 12\n  #str(gua.site)\n  #summary(as.factor(gua.site$SOC_Method))\n  ## measured using wet-oxidation method (Walley-Black)\n  gua.df$oc = gua.df$SOC * 1.3\n  ## Values are about 50-100% higher than in other countries\n  #summary(gua.df$CF)\n  gua.df$wpg2 = ifelse(is.na(gua.df$CF), 0, gua.df$CF)\n  gua.df$oc_d = signif(gua.df$oc / 1000 * gua.df$BD * 1000 * (100 - gua.df$wpg2)/100, 3)\n  gua.df$LIMSUP = 0; gua.df$LIMINF = 30\n  #summary(gua.df$oc_d)\n  gua.sel.h = c(\"ID\", \"upedonid\", \"Date\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"LIMSUP\", \"LIMINF\", \"hzn_desgn\", \"texture_description\", \"texture_lab\", \"clay_total\", \"silt_total\", \"sand_total\",  \n              \"oc\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"CF\", \"BD\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = gua.sel.h[which(!gua.sel.h %in% names(gua.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ gua.df[,i] = NA } }\n  chemsprops.Guatemala = gua.df[,gua.sel.h]\n  chemsprops.Guatemala$source_db = \"Guatemala_GTMSOC\"\n  chemsprops.Guatemala$confidence_degree = 2\n  chemsprops.Guatemala$project_url = \"https://doi.org/10.6073/pasta/8dd15238c604c3ac75daf985548bd05c\"\n  chemsprops.Guatemala$citation_url = \"https://doi.org/10.1111/ejss.13450\"\n  chemsprops.Guatemala &lt;- complete.vars(chemsprops.Guatemala, sel=c(\"oc\",\"BD\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.Guatemala, \"/mnt/diskstation/data/Soil_points/Guatemala/chemsprops.Guatemala.rds\")\n}\n\nRows: 910 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (5): ID, SOC_Method, BD_Method, Data_Source, Primary_Information\ndbl (6): Longitude, Latitude, SOC, BD, CF, Date\nlgl (1): CF_Method\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.Guatemala)\n\n[1] 910  39\n\n## [1] 910   39\n\n\n\n\n\nArmas, D.I., M. Guevara, F. Bezares, R. Vargas, P. Durante, V.H. Osorio, W.A. Jimenez, and C. Oyonarte. (2022). Harmonized Soil Database of Ecuador 2021 ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/1560e803953c839e7aedef78ff7d3f6c (Accessed 2024-11-24).\n\nArmas, D., Guevara, M., Bezares, F., Vargas, R., Durante, P., Osorio, V., Jiménez, W., and Oyonarte, C. (2023). Harmonized Soil Database of Ecuador (HESD): data from 2009 to 2015, Earth Syst. Sci. Data, 15, 431–445, https://doi.org/10.5194/essd-15-431-2023\n\n\nif(!exists(\"chemsprops.Ecuador\")){\n  ecu.site = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Ecuador/Harmonized_Soil_Database_of_Ecuador_profile_v0.2EDI.csv\")\n  #summary(ecu.site$CORX)\n  ecu.xy = terra::vect(ecu.site[,c(\"CORX\",\"CORY\")], geom=c(\"CORX\", \"CORY\"), crs=\"EPSG:32717\")\n  ecu.ll = terra::project(ecu.xy, \"EPSG:4326\")\n  ecu.site$longitude_decimal_degrees = geom(ecu.ll)[,\"x\"]\n  ecu.site$latitude_decimal_degrees = geom(ecu.ll)[,\"y\"]\n  #plot(ecu.site[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")], pch=\"+\", asp=1)\n  ecu.site$site_obsdate = as.Date(ecu.site$FEMU, format=\"%d/%m/%y\")\n  ecu.site$site_obsdate[nchar(ecu.site$FEMU)&gt;8] &lt;- as.Date(ecu.site$FEMU, format=\"%d/%m/%Y\")[nchar(ecu.site$FEMU)&gt;8]\n  ##summary(ecu.site$site_obsdate)\n  ecu.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Ecuador/Harmonized_Soil_Database_of_Ecuador_horizon_v0.2.csv\")\n  ecu.df = dplyr::left_join(ecu.hor, ecu.site, by=\"ID_PER\", multiple=\"first\")\n  ## measured using wet-oxidation method (Walley-Black)\n  ecu.df$oc = ecu.df$CO * 1.3\n  #summary(ecu.df$oc)\n  #summary(ecu.df$DA)\n  #summary(ecu.df$KDIS) # centimolePerKilogram\n  ecu.df$ca_ext = ecu.df$CADIS * 200\n  ecu.df$mg_ext = ecu.df$MGDIS * 121\n  ecu.df$na_ext = ecu.df$NACC * 230\n  ecu.df$k_ext = ecu.df$KDIS * 391\n  #summary(as.factor(ecu.df$FR_CL))\n  ecu.df$wpg2 = ifelse(ecu.df$FR_CL==\"0-2\", 1, \n                       ifelse(ecu.df$FR_CL==\" 02-05\", 3.5, \n                       ifelse(ecu.df$FR_CL==\" 05-15\", 10, \n                       ifelse(ecu.df$FR_CL==\"15-40\", 27.5, \n                       ifelse(ecu.df$FR_CL==\"40-80\", 60, \n                       ifelse(ecu.df$FR_CL==\"&gt; 80\", 90, 0))))))\n  ecu.df$wpg2 = ifelse(is.na(ecu.df$wpg2), 0, ecu.df$wpg2)\n  #summary(ecu.df$wpg2)\n  ecu.df$oc_d = signif(ecu.df$oc / 1000 * ecu.df$DA * 1000 * (100 - ecu.df$wpg2)/100, 3)\n  #summary(ecu.df$oc_d)\n  ecu.sel.h = c(\"ID_PER\", \"ID_NAC\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"STSG\", \"ID_HOR\", \"layer_key\", \"ORDHOR\", \"LIMSUP\", \"LIMINF\", \"HMOR\", \"texture_description\", \"texture_lab\", \"ARCILLA\", \"LIMO\", \"ARENA\", \"oc\", \"oc_d\", \"c_tot\", \"NTOT\", \"ph_kcl\", \"PHAQ\", \"ph_cacl2\", \"SBCC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"DA\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"CESS\", \"ec_12pre\")\n  x.na = ecu.sel.h[which(!ecu.sel.h %in% names(ecu.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ecu.df[,i] = NA } }\n  chemsprops.Ecuador = ecu.df[,ecu.sel.h]\n  chemsprops.Ecuador$source_db = \"Ecuador_HESD\"\n  chemsprops.Ecuador$confidence_degree = 2\n  chemsprops.Ecuador$project_url = \"https://doi.org/10.6073/pasta/1560e803953c839e7aedef78ff7d3f6c\"\n  chemsprops.Ecuador$citation_url = \"https://doi.org/10.5194/essd-15-431-2023\"\n  chemsprops.Ecuador &lt;- complete.vars(chemsprops.Ecuador, sel=c(\"oc\",\"PHAQ\",\"ARCILLA\",\"DA\"))\n  saveRDS.gz(chemsprops.Ecuador, \"/mnt/diskstation/data/Soil_points/Ecuador/chemsprops.Ecuador.rds\")\n}\n\nRows: 13542 Columns: 24\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (17): ID_NAC, COLP, STSG, STGG, STOD, RTS, RHS, LITO, GEOF, TUSO, TVEG, ...\ndbl  (7): ID_PER, CORX, CORY, ALT, PRES, PEND, FRGG\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 51673 Columns: 56\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Hmor, MSHOR, SUBHOR, FR_CL\ndbl (40): ID_PER, ID_HOR, CORX, CORY, ORDHOR, DISHOR, LIMSUP, LIMINF, ROOTS,...\nlgl (12): pHSS, CESS, NASS, KSS, CASS, MGSS, SBSS, CARSS, SULSS, CLSS, PSI, RAS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\ndim(chemsprops.Ecuador)\n\n[1] 30188    39\n\n## [1] 30188    39\n\n\n\n\n\nPaz-Pellat, F., & Velázquez-Rodríguez, A. S. (2018). Base de datos de perfiles de suelos en México. Elementos para Políticas Públicas, 2(3), 210-235. https://www.elementospolipub.org/ojs/index.php/epp/issue/view/3\n\n\nif(!exists(\"chemsprops.MexicoINEGI\")){\n  mex.xy = terra::vect(\"/mnt/diskstation/data/Soil_points/Mexico/INEGI/perfiles_serieii.shp\", crs=\"EPSG:6362\")\n  mex.ll &lt;- terra::project(mex.xy, \"EPSG:4326\")\n  #plot(mex.ll)\n  mex.df = as.data.frame(mex.xy)\n  mex.df$site_key = sapply(mex.df$ID_PERFIL, function(i){strsplit(i, \"-\")}[[1]][1])\n  ## 4428\n  mex.df$longitude_decimal_degrees = geom(mex.ll)[,\"x\"]\n  mex.df$latitude_decimal_degrees = geom(mex.ll)[,\"y\"]\n  ##summary(mex.df$CO) ## Carbono orgánico, método de Walkley y Black\n  mex.df$oc = mex.df$CO * 10 * 1.3\n  #summary(mex.df$K)\n  mex.df$ca_ext = mex.df$CA * 200\n  mex.df$mg_ext = mex.df$MG * 121\n  mex.df$na_ext = mex.df$`NA` * 230\n  mex.df$k_ext = mex.df$K * 391\n  mex.df$site_obsdate = format(as.Date(mex.df$FECHA, format=\"%d/%m/%Y\"), \"%Y-%m-%d\")\n  ## pH del horizonte, método del potenciómetro, relación con agua 1:1\n  mex.sel.h = c(\"site_key\", \"IDHOJA\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"ID_PERFIL\", \"layer_key\", \"horizonte\", \"LIM_SUP\", \"LIM_INF\", \"NOMEN_HTE\", \"CLAS_TEXT\", \"texture_lab\", \"R\", \"L\", \"A\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pHKCl\", \"PH\", \"ph_cacl2\", \"CIC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"CE\", \"ec_12pre\")\n  x.na = mex.sel.h[which(!mex.sel.h %in% names(mex.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ mex.df[,i] = NA } }\n  chemsprops.MexicoINEGI = mex.df[,mex.sel.h]\n  chemsprops.MexicoINEGI$source_db = \"MexicoINEGI\"\n  chemsprops.MexicoINEGI$confidence_degree = 4\n  chemsprops.MexicoINEGI$project_url = \"https://www.inegi.org.mx/\"\n  chemsprops.MexicoINEGI$citation_url = \"https://www.elementospolipub.org/ojs/index.php/epp/article/view/16\"\n  chemsprops.MexicoINEGI &lt;- complete.vars(chemsprops.MexicoINEGI, sel=c(\"oc\",\"PH\",\"R\"))\n  saveRDS.gz(chemsprops.MexicoINEGI, \"/mnt/diskstation/data/Soil_points/Mexico/INEGI/chemsprops.MexicoINEGI.rds\")\n}\ndim(chemsprops.MexicoINEGI)\n\n[1] 16820    39\n\n## [1] 16820    39\n\n\n\n\n\nMata, R., Vázquez, A., Rosales, A., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociación Costarricense de la Ciencia del Suelo, San José, CRC. Escala, 1, 200000. Data download URL: http://www.cia.ucr.ac.cr/wp-content/recursosnaturales/Base%20perfiles%20de%20suelos%20v1.1.rar\nMata-Chinchilla, R., & Castro-Chinchilla, J. (2019). Geoportal de suelos de Costa Rica como Bien Público al servicio del país. Revista Tecnología En Marcha, 32(7), Pág. 51-56. https://doi.org/10.18845/tm.v32i7.4259\n\n\nif(!exists(\"chemsprops.CostaRica\")){\n  cr.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Costa_Rica/Base_de_datos_version_1.2.3.csv\", stringsAsFactors = FALSE)\n  #plot(cr.hor[,c(\"X\",\"Y\")], pch=\"+\", asp=1)\n  cr.hor$usiteid = paste(cr.hor$Provincia, cr.hor$Cantón, cr.hor$Id, sep=\"_\")\n  #summary(cr.hor$Corg.)\n  cr.hor$oc = cr.hor$Corg. * 10\n  cr.hor$Densidad.Aparente = as.numeric(paste0(cr.hor$Densidad.Aparente))\n  #summary(cr.hor$K)\n  cr.hor$ca_ext = cr.hor$Ca * 200\n  cr.hor$mg_ext = cr.hor$Mg * 121\n  #cr.hor$na_ext = cr.hor$Na * 230\n  cr.hor$k_ext = cr.hor$K * 391\n  cr.hor$wpg2 = NA\n  cr.hor$oc_d = signif(cr.hor$oc / 1000 * cr.hor$Densidad.Aparente * 1000 * (100 - ifelse(is.na(cr.hor$wpg2), 0, cr.hor$wpg2))/100, 3)\n  #summary(cr.hor$oc_d)\n  cr.sel.h = c(\"Id\", \"usiteid\", \"Fecha\", \"X\", \"Y\", \"Sub.Grupo\", \"labsampnum\", \"layer_key\", \"horizonte\", \"prof_inicio\", \"prof_final\", \"id_hz\", \"Clase.Textural\", \"texture_lab\", \"ARCILLA\", \"LIMO\", \"ARENA\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pHKCl\", \"pH_H2O\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Densidad.Aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cr.sel.h[which(!cr.sel.h %in% names(cr.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cr.hor[,i] = NA } }\n  chemsprops.CostaRica = cr.hor[,cr.sel.h]\n  chemsprops.CostaRica$source_db = \"CostaRica\"\n  chemsprops.CostaRica$confidence_degree = 4\n  chemsprops.CostaRica$project_url = \"http://www.cia.ucr.ac.cr\"\n  chemsprops.CostaRica$citation_url = \"https://doi.org/10.18845/tm.v32i7.42\"\n  chemsprops.CostaRica &lt;- complete.vars(chemsprops.CostaRica, sel=c(\"oc\",\"pH_H2O\",\"ARCILLA\",\"Densidad.Aparente\"), coords = c(\"X\", \"Y\"))\n  saveRDS.gz(chemsprops.CostaRica, \"/mnt/diskstation/data/Soil_points/Costa_Rica/chemsprops.CostaRica.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.CostaRica)\n\n[1] 2051   39\n\n## [1] 2051   39\n\n\n\n\n\nDewan, M. L., & Famouri, J. (1964). The soils of Iran. Food and Agriculture Organization of the United Nations.\n\nHengl, T., Toomanian, N., Reuter, H. I., & Malakouti, M. J. (2007). Methods to interpolate soil categorical variables from profile observations: Lessons from Iran. Geoderma, 140(4), 417-427.\nMohammad, H. B. (2000). Soil resources and use potentiality map of Iran. Soil and Water Research Institute, Teheran, Iran.\n\n\nif(!exists(\"chemsprops.IRANSPDB\")){\n  na.s = c(\"?\",\"\",\"?.\",\"??\", -2147483647, -1.00e+308, \"&lt;NA&gt;\")\n  iran.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbana.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:12]\n  names(iran.hor) = c(\"site_key\", \"hzn_desgn\", \"hzn_top\", \"hzn_bot\", \"ph_h2o\", \"ec_water_extractable\", \"oc\", \"CACO\", \"PBS\", \"sand_total\", \"silt_total\", \"clay_total\")\n  iran.hor$hzn_top = ifelse(is.na(iran.hor$hzn_top) & iran.hor$hzn_desgn==\"A\", 0, iran.hor$hzn_top)\n  iran.hor2 = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbhor.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:8]\n  names(iran.hor2) = c(\"site_key\", \"layer_sequence\", \"DESI\", \"hzn_top\", \"hzn_bot\", \"M_colour\", \"texture_description\", \"hzn_desgn\")\n  iran.site = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sgdb.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)\n  names(iran.site) = c(\"usiteid\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\", \"FAO\", \"Tax\", \"site_key\")\n  st.cor = read.csv('./correlation/soil_types_correlation_full_data_FAO74_US_CPSS.csv')\n  st.cor$Correlation_ = toupper(st.cor$Correlation)\n  iran.site$SSL_classification_name = dplyr::left_join(iran.site[\"FAO\"], st.cor, by=c(\"FAO\"=\"Correlation_\"), multiple = \"first\")$SoilUnitDUS\n  summary(as.factor(iran.site$SSL_classification_name))\n  iran.db = plyr::join_all(list(iran.site, iran.hor, iran.hor2))\n  iran.db$organic_carbon = iran.db$oc * 10\n  #summary(iran.db$oc)\n  x.na = col.names[which(!col.names %in% names(iran.db))]\n  if(length(x.na)&gt;0){ for(i in x.na){ iran.db[,i] = NA } }\n  chemsprops.IRANSPDB = iran.db[,col.names]\n  chemsprops.IRANSPDB$source_db = \"Iran_SPDB\"\n  chemsprops.IRANSPDB$confidence_degree = 4\n  chemsprops.IRANSPDB$project_url = \"\"\n  chemsprops.IRANSPDB$citation_url = \"https://doi.org/10.1016/j.geoderma.2007.04.022\"\n  chemsprops.IRANSPDB &lt;- complete.vars(chemsprops.IRANSPDB, sel=c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.IRANSPDB, \"/mnt/diskstation/data/Soil_points/Iran/chemsprops.IRANSPDB.rds\")\n}\n\nJoining by: site_key\n\n\nJoining by: site_key, hzn_desgn, hzn_top, hzn_bot\n\ndim(chemsprops.IRANSPDB)\n\n[1] 4941   39\n\n## [1] 4941   39\n\n\n\n\n\nHugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). A new data set for estimating organic carbon storage to 3 m depth in soils of the northern circumpolar permafrost region. Earth System Science Data (Online), 5(2). Data download URL: http://dx.doi.org/10.5879/ECDS/00000002\n\nNote: this data set show extremely high SOC content (average 30%). It appears that this was a purposive survey i.e. surveyors were looking for peatlands and gelisols with high SOC content.\n\nif(!exists(\"chemsprops.NCSCD\")){\n  ncscd.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/NCSCD/Harden_etal_2012_Hugelius_etal_2013_cleaned_data.csv\", stringsAsFactors = FALSE)\n  ## To translate LOI % into OC %: OC % = (−0.0013 × LOI %2 ) + (0.637 × LOI %)) was used\n  ## for mineral soils: OC % = (−0.00005 × LOI %3 ) + (0.0059× LOI %2 ) + (0.362 × LOI %))\n  ncscd.hors$oc = as.numeric(ncscd.hors$X.C)*10\n  ## mean OC content 30%!!\n  #summary(ncscd.hors$oc)\n  #hist(ncscd.hors$Layer.thickness.cm, breaks = 45)\n  ncscd.hors$Layer.thickness.cm = ifelse(ncscd.hors$Layer.thickness.cm&lt;0, NA, ncscd.hors$Layer.thickness.cm)\n  ncscd.hors$hzn_bot = ncscd.hors$Basal.Depth.cm + ncscd.hors$Layer.thickness.cm\n  ncscd.hors$db_od = as.numeric(ncscd.hors$bulk.density.g.cm.3)\n  ## BD &gt;2.4t/m3 -&gt; rock\n  ncscd.hors$db_od = ifelse(ncscd.hors$db_od&gt;2.4, NA, ncscd.hors$db_od)\n  ## Can we assume no coarse fragments?\n  ncscd.hors$wpg2 = 0\n  ncscd.hors$oc_d = signif(ncscd.hors$oc / 1000 * ncscd.hors$db_od * 1000 * (100 - ifelse(is.na(ncscd.hors$wpg2), 0, ncscd.hors$wpg2))/100, 3)\n  ## very high values &gt;40 kg/m3\n  ncscd.hors$site_obsdate = format(as.Date(ncscd.hors$Sample.date, format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  #summary(ncscd.hors$db_od)\n  ncscd.hors$Great.Group = ifelse(is.na(ncscd.hors$Great.Group), ncscd.hors$Suborder, ncscd.hors$Great.Group)\n  ncscd.col = c(\"Profile.ID\", \"citation\", \"site_obsdate\", \"Long\", \"Lat\", \"Great.Group\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Basal.Depth.cm\", \"hzn_bot\", \"Horizon.type\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ncscd.col[which(!ncscd.col %in% names(ncscd.hors))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ncscd.hors[,i] = NA } }\n  chemsprops.NCSCD = ncscd.hors[,ncscd.col]\n  chemsprops.NCSCD$source_db = \"NCSCD\"\n  chemsprops.NCSCD$confidence_degree = 10\n  chemsprops.NCSCD$project_url = \"https://bolin.su.se/data/ncscd/\"\n  chemsprops.NCSCD$citation_url = \"https://doi.org/10.5194/essd-5-393-2013\"\n  chemsprops.NCSCD = complete.vars(chemsprops.NCSCD, sel = c(\"oc\",\"db_od\"), coords = c(\"Long\", \"Lat\"))\n  #str(levels(as.factor(chemsprops.NCSCD$Profile.ID)))\n  ## 1476 unique sites\n  # openair::scatterPlot(chemsprops.NCSCD, x = \"oc\", y = \"db_od\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, # log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"Bulk density [t/m3]\")\n  # openair::scatterPlot(chemsprops.NCSCD, x = \"oc\", y = \"oc_d\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n  saveRDS.gz(chemsprops.NCSCD, \"/mnt/diskstation/data/Soil_points/INT/NCSCD/chemsprops.NCSCD.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.NCSCD)\n\n[1] 7371   39\n\n## [1] 7371   39\n\n\n\n\n\n\nRelationship between SOC [kg/m3] and BD for NCSCD data set.\n\n\n\n\n\n\n\n\nCSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004. Data download URL: https://doi.org/10.25919/5eeb2a56eac12 (available upon request)\n\nSearle, R. (2014). The Australian site data collation to support the GlobalSoilMap. GlobalSoilMap: Basis of the global spatial soil information system, 127.\n\n\nif(!exists(\"chemsprops.NatSoil\")){\n  library(Hmisc) \n  cmdb &lt;- mdb.get(\"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612.mdb\")\n  #str(cmdb$SITES)\n  au.obs = cmdb$OBSERVATIONS[,c(\"s.id\", \"o.location.notes\", \"o.date.desc\", \"o.latitude.GDA94\", \"o.longitude.GDA94\", \"o.soil.taxonomy\")]\n  au.obs$o.soil.taxonomy = paste(au.obs$o.soil.taxonomy)\n  csiro.tax = read.csv(\"./tabular/CSIRO_codes_taxonomy.csv\")\n  au.obs$SSL_classification_name = dplyr::left_join(au.obs[\"o.soil.taxonomy\"], csiro.tax, by=c(\"o.soil.taxonomy\"=\"Code\"), multiple = \"first\")$SSL_classification_name\n  #summary(as.factor(au.obs$SSL_classification_name))\n  ## only about 300 profiles with USDA classification\n  au.obs = au.obs[!is.na(au.obs$o.longitude.GDA94),]\n  coordinates(au.obs) &lt;- ~o.longitude.GDA94+o.latitude.GDA94\n  proj4string(au.obs) &lt;- CRS(\"+proj=longlat +ellps=GRS80 +no_defs\")\n  au.xy &lt;- data.frame(spTransform(au.obs, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  #plot(au.xy[,c(\"coords.x1\", \"coords.x2\")])\n  ## all variables in one column and need to be sorted based on the lab method\n  #summary(cmdb$LAB_METHODS$LABM.SHORT.NAME)\n  #write.csv(cmdb$LAB_METHODS, \"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612_lab_methods.csv\")\n  lab.tbl = list(\n          c(\"6_DC\", \"6A1\", \"6A1_UC\", \"6B1\", \"6B2\", \"6B2a\", \"6B2b\", \"6B3\", \"6B4\", \"6B4a\", \"6B4b\", \"6Z\"), # %\n          c(\"6B3a\"), # g/kg\n          c(\"6H4\", \"6H4_SCaRP\"), # %\n          c(\"7_C_B\", \"7_NR\", \"7A1\", \"7A2\", \"7A2a\", \"7A2b\", \"7A3\", \"7A4\", \"7A5\", \"7A6\", \"7A6a\", \"7A6b\", \"7A6b_MCLW\"),  # g/kg\n          c(\"4A1\", \"4_NR\", \"4A_C_2.5\", \"4A_C_1\", \"4G1\"),\n          c(\"4C_C_1\", \"4C1\", \"4C2\", \"23A\"),\n          c(\"4B_C_2.5\", \"4B1\", \"4B2\"),\n          c(\"P10_NR_C\", \"P10_HYD_C\", \"P10_PB_C\", \"P10_PB1_C\", \"P10_CF_C\", \"P10_I_C\"),\n          c(\"P10_NR_Z\", \"P10_HYD_Z\", \"P10_PB_Z\", \"P10_PB1_Z\", \"P10_CF_Z\", \"P10_I_Z\"),\n          c(\"P10_NR_S\", \"P10_HYD_S\", \"P10_PB_S\", \"P10_PB1_S\", \"P10_CF_S\", \"P10_I_S\"),\n          c(\"15C1modCEC\", \"15_HSK_CEC\", \"15J_CEC\"),\n          c(\"15I1\", \"15I2\", \"15I3\", \"15I4\", \"15D3_CEC\"),\n          c(\"15_BASES\", \"15_NR\", \"15J_H\", \"15J1\"),\n          c(\"2Z2_Grav\", \"P10_GRAV\"),\n          c(\"503.08a\", \"P3A_NR\", \"P3A1\", \"P3A1_C4\", \"P3A1_CLOD\", \"P3A1_e\"),\n          c(\"18F1_CA\"),\n          c(\"18F1_MG\"),\n          c(\"18F1_NA\"),\n          c(\"18F1_K\", \"18F2\", \"18A1mod\", \"18_NR\", \"18A1\", \"18A1_NR\", \"18B1\", \"18B2\"),\n          c(\"3_C_B\", \"3_NR\", \"3A_TSS\"),\n          c(\"3A_C_2.5\", \"3A1\")\n          )\n  names(lab.tbl) = c(\"oc\", \"ocP\", \"c_tot\", \"n_tot\", \"ph_h2o\", \"ph_kcl\", \"ph_cacl2\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  val.lst = lapply(1:length(lab.tbl), function(i){\n       x &lt;- cmdb$LAB_RESULTS[cmdb$LAB_RESULTS$labm.code %in% lab.tbl[[i]], c(\"agency.code\", \"proj.code\", \"labm.code\", \"s.id\", \"o.id\", \"h.no\", \"labr.value\")]; \n       names(x)[7] &lt;- names(lab.tbl)[i]; return(x) })\n  names(val.lst) = names(lab.tbl)\n  val.lst$oc$oc = val.lst$oc$oc * 10\n  summary(as.factor(val.lst$oc$labm.code))\n  ## 6_DC    6A1 6A1_UC    6B1    6B2   6B2b    6B3     6Z \n  ##  403  15403   8094    119   5447      4   5735   1899 \n  ## 6_DC = Organic carbon (%) - Dry combustion\n  ## 6A1_UC = Organic carbon (%) - Uncorrected Walkley and Black method\n  val.lst$oc$oc[val.lst$oc$labm.code == \"6A1_UC\"] = val.lst$oc$oc[val.lst$oc$labm.code == \"6A1_UC\"] * 1.3\n  #summary(val.lst$oc$oc)\n  #str(val.lst, max.level = 1)\n  for(i in 1:length(val.lst)){ val.lst[[i]]$h.id &lt;- paste(val.lst[[i]]$agency.code, val.lst[[i]]$proj.code, val.lst[[i]]$s.id, val.lst[[i]]$o.id, val.lst[[i]]$h.no, sep=\"_\") }\n  au.hor &lt;- plyr::join_all(lapply(val.lst, function(x){x[,7:8]}), match=\"first\")\n  #str(as.factor(au.hor$h.id))\n  cmdb$HORIZONS$h.id = paste(cmdb$HORIZONS$agency.code, cmdb$HORIZONS$proj.code, cmdb$HORIZONS$s.id, cmdb$HORIZONS$o.id, cmdb$HORIZONS$h.no, sep=\"_\")\n  cmdb$HORIZONS$hzn_desgn = paste(cmdb$HORIZONS$h.desig.master, cmdb$HORIZONS$h.desig.subdiv, cmdb$HORIZONS$h.desig.suffix, sep=\"\")\n  au.horT &lt;- plyr::join_all(list(cmdb$HORIZONS[,c(\"h.id\",\"s.id\",\"h.no\",\"h.texture\",\"hzn_desgn\",\"h.upper.depth\",\"h.lower.depth\")], au.hor, au.xy))\n  au.horT$site_obsdate = format(as.Date(au.horT$o.date.desc, format=\"%d%m%Y\"), \"%Y-%m-%d\")\n  #summary(as.Date(au.horT$site_obsdate))\n  au.horT$sand_tot_psa = ifelse(is.na(au.horT$sand_tot_psa), 100-(au.horT$clay_tot_psa + au.horT$silt_tot_psa), au.horT$sand_tot_psa)\n  au.horT$hzn_top = au.horT$h.upper.depth*100\n  au.horT$hzn_bot = au.horT$h.lower.depth*100\n  #summary(au.horT$oc)\n  au.horT$oc_d = signif(au.horT$oc / 1000 * au.horT$db_od * 1000 * (100 - ifelse(is.na(au.horT$wpg2), 0, au.horT$wpg2))/100, 3)\n  #summary(au.horT$oc_d)\n  au.cols.n = c(\"s.id\", \"o.location.notes\", \"site_obsdate\", \"coords.x1\", \"coords.x2\", \"SSL_classification_name\", \"h.id\", \"layer_key\", \"h.no\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"h.texture\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = au.cols.n[which(!au.cols.n %in% names(au.horT))]\n  if(length(x.na)&gt;0){ for(i in x.na){ au.horT[,i] = NA } }\n  chemsprops.NatSoil = au.horT[,au.cols.n]\n  chemsprops.NatSoil$source_db = \"CSIRO_NatSoil\"\n  chemsprops.NatSoil$confidence_degree = 3\n  chemsprops.NatSoil$project_url = \"https://www.csiro.au/en/Do-business/Services/Enviro/Soil-archive\"\n  chemsprops.NatSoil$citation_url = \"https://doi.org/10.25919/5eeb2a56eac12\"\n  chemsprops.NatSoil = complete.vars(chemsprops.NatSoil, sel = c(\"oc\",\"db_od\",\"clay_tot_psa\",\"ph_h2o\"), coords = c(\"coords.x1\", \"coords.x2\"))\n  saveRDS.gz(chemsprops.NatSoil, \"/mnt/diskstation/data/Soil_points/Australia/CSIRO/chemsprops.NatSoil.rds\")\n}\n\n\nAttaching package: 'Hmisc'\n\n\nThe following objects are masked from 'package:plyr':\n\n    is.discrete, summarize\n\n\nThe following objects are masked from 'package:terra':\n\n    describe, mask, units, zoom\n\n\nThe following objects are masked from 'package:dplyr':\n\n    src, summarize\n\n\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n\n\n14 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n27 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \n14 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 \n17 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \n114 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n12 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 \n43 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n\n\nJoining by: h.id\n\n\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\n\n\nJoining by: s.id\n\ndim(chemsprops.NatSoil)\n\n[1] 89754    39\n\n## [1] 89754    39\n\n\n\n\n\nCoetzee, M. E. (2001). NAMSOTER, a SOTER database for Namibia. Agroecological Zoning, 458.\nCoetzee, M. E. (2009). Chemical characterisation of the soils of East Central Namibia (Doctoral dissertation, Stellenbosch: University of Stellenbosch).\n\n\nif(!exists(\"chemsprops.NAMSOTER\")){\n  nam.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_profiles.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  #nam.sm = summary(as.factor(nam.profs$CLAF))\n  #nam.tax = as.data.frame(nam.sm)\n  #nam.tax$levels = attr(nam.sm, \"names\")\n  #write.csv(nam.tax, \"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/namsoter_taxon_wrb.csv\")\n  st.cor = read.csv('./correlation/soil_type_correlation_ISRIC_WISE.csv')\n  st.cor$FAO_90_ = gsub(\"SOLS\", \"SOL\", toupper(st.cor$FAO_90.1))\n  nam.profs$SSL_classification_name = paste0( dplyr::left_join(nam.profs[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90_\"), multiple = \"first\")$Class_1, \" / \",\n                    dplyr::left_join(nam.profs[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90_\"), multiple = \"first\")$Class_2)\n  #summary(as.factor(nam.profs$SSL_classification_name))\n  nam.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_horizons.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  #summary(nam.hors$TOTN)\n  #summary(nam.hors$TOTC)\n  nam.hors$hzn_top &lt;- NA\n  nam.hors$hzn_top &lt;- ifelse(nam.hors$HONU==1, 0, nam.hors$hzn_top)\n  h.lst &lt;- lapply(1:7, function(x){which(nam.hors$HONU==x)})\n  for(i in 2:7){\n    sel &lt;- match(nam.hors$PRID[h.lst[[i]]], nam.hors$PRID[h.lst[[i-1]]])\n    nam.hors$hzn_top[h.lst[[i]]] &lt;- nam.hors$HBDE[h.lst[[i-1]]][sel]\n  }\n  nam.hors$HBDE &lt;- ifelse(is.na(nam.hors$HBDE), nam.hors$hzn_top+50, nam.hors$HBDE)\n  #summary(nam.hors$HBDE)\n  namALL = plyr::join(nam.hors, nam.profs, by=c(\"PRID\"))\n  namALL$k_ext = namALL$EXCK * 391\n  namALL$ca_ext = namALL$EXCA * 200\n  namALL$mg_ext = namALL$EXMG * 121\n  namALL$na_ext = namALL$EXNA * 230\n  #summary(namALL$MINA)\n  namALL$BULK &lt;- ifelse(namALL$BULK&gt;2.4, NA, namALL$BULK)\n  namALL$wpg2 = ifelse(namALL$MINA==\"D\", 80, ifelse(namALL$MINA==\"A\", 60, ifelse(namALL$MINA==\"M\", 25, ifelse(namALL$MINA==\"C\", 10, ifelse(namALL$MINA==\"V\", 1, ifelse(namALL$MINA==\"F\", 2.5, ifelse(namALL$MINA==\"M/A\", 40, ifelse(namALL$MINA==\"C/M\", 15, 0))))))))\n  #hist(namALL$wpg2)\n  ## TOTC: Organic Carbon (Colourimetric Walkey-Black Method) (SOP Soil-125)\n  namALL$oc = namALL$TOTC * 1.3\n  namALL$oc_d = signif(namALL$oc / 1000 * namALL$BULK * 1000 * (100 - ifelse(is.na(namALL$wpg2), 0, namALL$wpg2))/100, 3)\n  #summary(namALL$oc_d)\n  #summary(namALL$PHAQ) ## Check - high ph! mean = 7.9\n  namALL$site_obsdate = 2000\n  nam.col = c(\"PRID\", \"SLID\", \"site_obsdate\", \"LONG\", \"LATI\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HONU\", \"hzn_top\", \"HBDE\", \"HODE\", \"PSCL\", \"texture_lab\", \"CLPC\", \"STPC\", \"SDTO\", \"TOTC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELCO\", \"ec_12pre\")\n  x.na = nam.col[which(!nam.col %in% names(namALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ namALL[,i] = NA } }\n  chemsprops.NAMSOTER = namALL[,nam.col]\n  chemsprops.NAMSOTER$source_db = \"NAMSOTER\"\n  chemsprops.NAMSOTER$confidence_degree = 2\n  chemsprops.NAMSOTER$project_url = \"\"\n  chemsprops.NAMSOTER$citation_url = \"https://edepot.wur.nl/485173\"\n  chemsprops.NAMSOTER = complete.vars(chemsprops.NAMSOTER, sel = c(\"TOTC\",\"CLPC\",\"PHAQ\"), coords = c(\"LONG\", \"LATI\"))\n  saveRDS.gz(chemsprops.NAMSOTER, \"/mnt/diskstation/data/Soil_points/Namibia/chemsprops.NAMSOTER.rds\")\n}\ndim(chemsprops.NAMSOTER)\n\n[1] 2955   39\n\n## [1] 2955   39\n\n\n\n\n\nZinke, P. J., Millemann, R. E., & Boden, T. A. (1986). Worldwide organic soil carbon and nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory. Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018\nNote: poor spatial location accuracy i.e. &lt;10 km. Bulk density for many points has been estimated not measured. Sampling year has not been but literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. Most of samples come from natural vegetation (undisturbed) areas.\n\n\nif(!exists(\"chemsprops.ISCND\")){\n  ndp.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISCND/ndp018.csv\", na.strings = c(\"-9999\", \"?\", \"NA\"), stringsAsFactors = FALSE)\n  names(ndp.profs) = c(\"PROFILE\", \"CODE\", \"CARBON\", \"NITROGEN\", \"LAT\", \"LONG\", \"ELEV\", \"SOURCE\", \"HOLDRIGE\", \"OLSON\", \"PARENT\")\n  for(j in c(\"CARBON\",\"NITROGEN\",\"ELEV\")){  ndp.profs[,j] &lt;- as.numeric(ndp.profs[,j])   }\n  #summary(ndp.profs$CARBON)\n  lat.s  &lt;- grep(\"S\", ndp.profs$LAT) # lat.n &lt;- grep(\"N\", ndp.profs$LAT)\n  ndp.profs$latitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LAT))\n  ndp.profs$latitude_decimal_degrees[lat.s] = ndp.profs$latitude_decimal_degrees[lat.s] * -1\n  lon.w &lt;- grep(\"W\", ndp.profs$LONG) # lon.e  &lt;- grep(\"E\", ndp.profs$LONG, fixed = TRUE)\n  ndp.profs$longitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LONG))\n  ndp.profs$longitude_decimal_degrees[lon.w] = ndp.profs$longitude_decimal_degrees[lon.w] * -1\n  #plot(ndp.profs[,c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\")])\n  ndp.profs$hzn_top = 0; ndp.profs$hzn_bot = 100\n  ## Sampling years from the doc: 1965, 1974, 1976, 1978, 1979, 1984 \n  ndp.profs$site_obsdate = \"1982\"\n  ndp.col = c(\"PROFILE\", \"CODE\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"CARBON\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ndp.col[which(!ndp.col %in% names(ndp.profs))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ndp.profs[,i] = NA } }\n  chemsprops.ISCND = ndp.profs[,ndp.col]\n  chemsprops.ISCND$source_db = \"ISCND\"\n  chemsprops.ISCND$confidence_degree = 8\n  chemsprops.ISCND$project_url = \"https://iscn.fluxdata.org/data/\"\n  chemsprops.ISCND$citation_url = \"https://dx.doi.org/10.3334/CDIAC/lue.ndp018\"\n  chemsprops.ISCND = complete.vars(chemsprops.ISCND, sel = c(\"CARBON\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))  \n  saveRDS.gz(chemsprops.ISCND, \"/mnt/diskstation/data/Soil_points/INT/ISCND/chemsprops.ISCND.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.ISCND)\n\n[1] 4114   39\n\n## [1] 4114   39\n\n\n\n\n\nManies, K., Waldrop, M., and Harden, J. (2020): Generalized models to estimate carbon and nitrogen stocks of organic soil horizons in Interior Alaska, Earth Syst. Sci. Data, 12, 1745–1757, https://doi.org/10.5194/essd-12-1745-2020, Data download URL: https://doi.org/10.5066/P960N1F9\n\n\nif(!exists(\"chemsprops.Alaska\")){\n  al.gps &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Site_GPS_coordinates_v1-1.csv\", stringsAsFactors = FALSE)\n  ## Different datums!\n  #summary(as.factor(al.gps$Datum))\n  al.gps1 = al.gps[al.gps$Datum==\"NAD83\",]\n  coordinates(al.gps1) = ~ Longitude + Latitude\n  proj4string(al.gps1) = \"+proj=longlat +datum=NAD83\"\n  al.gps0 = spTransform(al.gps1, CRS(\"+proj=longlat +datum=WGS84\"))\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Longitude\"] = al.gps0@coords[,1]\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Latitude\"] = al.gps0@coords[,2]\n  al.gps$site = al.gps$Site\n  al.hor &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Generalized_models_for_CandN_Alaska_v1-1.csv\", stringsAsFactors = FALSE)\n  al.hor$hzn_top = al.hor$depth - as.numeric(al.hor$thickness)\n  al.hor$site_obsdate = format(as.Date(al.hor$date, format = \"%m/%d/%Y\"), \"%Y-%m-%d\")\n  ## \"We analyzed soil samples for total C and N using a Carlo Erba NA1500 elemental analyzer (Fisons Instruments). \n  ## Samples were combusted in the presence of excess oxygen.\"\n  al.hor$oc = as.numeric(al.hor$carbon) * 10\n  al.hor$n_tot = as.numeric(al.hor$nitrogen) * 10\n  al.hor$oc_d = as.numeric(al.hor$Cdensity) * 1000\n  #summary(al.hor$oc_d)\n  al.horA = plyr::join(al.hor, al.gps, by=c(\"site\"))\n  al.col = c(\"profile\", \"description\", \"site_obsdate\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"sampleID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"depth\", \"Hcode\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BDfine\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = al.col[which(!al.col %in% names(al.horA))]\n  if(length(x.na)&gt;0){ for(i in x.na){ al.horA[,i] = NA } }\n  chemsprops.Alaska = al.horA[,al.col]\n  chemsprops.Alaska$source_db = \"Alaska_interior\"\n  chemsprops.Alaska$confidence_degree = 1\n  chemsprops.Alaska$project_url = \"https://www.usgs.gov/centers/gmeg\"\n  chemsprops.Alaska$citation_url = \"https://doi.org/10.5194/essd-12-1745-2020\"\n  chemsprops.Alaska = complete.vars(chemsprops.Alaska, sel = c(\"oc\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))\n  # openair::scatterPlot(chemsprops.Alaska, x = \"oc\", y = \"oc_d\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n  saveRDS.gz(chemsprops.Alaska, \"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/chemsprops.Alaska.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.Alaska)\n\n[1] 4013   39\n\n## [1] 4013   39\n\n\n\n\n\n\nRelationship between SOC [kg/m3] and SOC [g/kg] for the Alaska data set.\n\n\n\n\n\n\n\n\nMartinović J., (2000) “Tla u Hrvatskoj”, Monografija, Državna uprava za zaštitu prirode i okoliša, str. 269, Zagreb. ISBN: 9536793059\nBašić F., (2014) “The Soils of Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154\n\n\nif(!exists(\"chemsprops.bpht\")){\n  bpht.site &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_sites_1997.csv\", stringsAsFactors = FALSE)\n  bpht.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_1997.csv\", stringsAsFactors = FALSE)\n  ## filter typos\n  for(j in c(\"GOR\", \"DON\", \"MKP\", \"PH1\", \"PH2\", \"MSP\", \"MP\", \"MG\", \"HUM\", \"EXTN\", \"EXTP\", \"EXTK\", \"CAR\")){\n    bpht.hors[,j] = as.numeric(bpht.hors[,j])\n  }\n  ## Convert to the USDA standard\n  bpht.hors$sand_tot_psa &lt;- bpht.hors$MSP * 0.8 + bpht.hors$MKP\n  bpht.hors$silt_tot_psa &lt;- bpht.hors$MP + bpht.hors$MSP * 0.2\n  bpht.hors$oc &lt;- signif(bpht.hors$HUM/1.724 * 10, 3)\n  ## summary(bpht.hors$sand_tot_psa)\n  bpht.s.lst &lt;- c(\"site_key\", \"UZORAK\", \"Cro16.30_X\", \"Cro16.30_Y\", \"FITOC\", \"STIJENA\", \"HID_DREN\", \"DUBINA\")\n  bpht.hor = plyr::join(bpht.site[,bpht.s.lst], bpht.hors)\n  bpht.hor$wpg2 = bpht.hor$STIJENA\n  bpht.hor$DON &lt;- ifelse(is.na(bpht.hor$DON), bpht.hor$GOR+50, bpht.hor$DON)\n  bpht.hor$depth &lt;- bpht.hor$GOR + (bpht.hor$DON - bpht.hor$GOR)/2\n  bpht.hor = bpht.hor[!is.na(bpht.hor$depth),]\n  bpht.hor$wpg2[which(bpht.hor$GOR&lt;30)] &lt;- bpht.hor$wpg2[which(bpht.hor$GOR&lt;30)]*.3\n  bpht.hor$sample_key = make.unique(paste(bpht.hor$PEDOL_ID, bpht.hor$OZN, sep=\"_\"))\n  bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"] &lt;- bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"]/10\n  ## convert N, P, K\n  #summary(bpht.hor$EXTK) -- measurements units?\n  bpht.hor$p_ext = bpht.hor$EXTP * 4.364\n  bpht.hor$k_ext = bpht.hor$EXTK * 8.3013\n  bpht.hor = bpht.hor[!is.na(bpht.hor$`Cro16.30_X`),]\n  ## coordinates:\n  bpht.pnts = SpatialPointsDataFrame(bpht.hor[,c(\"Cro16.30_X\",\"Cro16.30_Y\")], bpht.hor[\"site_key\"], proj4string = CRS(\"+proj=tmerc +lat_0=0 +lon_0=16.5 +k=0.9999 +x_0=2500000 +y_0=0 +ellps=bessel +towgs84=550.499,164.116,475.142,5.80967,2.07902,-11.62386,0.99999445824 +units=m\"))\n  bpht.pnts.ll &lt;- spTransform(bpht.pnts, CRS(\"+proj=longlat +datum=WGS84\"))\n  bpht.hor$longitude_decimal_degrees = bpht.pnts.ll@coords[,1]\n  bpht.hor$latitude_decimal_degrees = bpht.pnts.ll@coords[,2] \n  bpht.h.lst &lt;- c('site_key', 'OZ_LIST_PROF', 'UZORAK', 'longitude_decimal_degrees', 'latitude_decimal_degrees', \"SSL_classification_name\", 'labsampnum', \"layer_key\", 'layer_sequence', 'GOR', 'DON', 'OZN', 'TT', \"texture_lab\", 'MG', 'silt_tot_psa', 'sand_tot_psa', 'oc', 'oc_d', 'c_tot', 'EXTN', 'PH2', 'PH1', 'ph_cacl2', 'cec_sum', 'cec_nh4', 'ecec', 'wpg2', 'db_od', 'ca_ext', 'mg_ext', 'na_ext', 'k_ext', 'ec_satp', 'ec_12pre')\n  x.na = bpht.h.lst[which(!bpht.h.lst %in% names(bpht.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ bpht.hor[,i] = NA } }\n  chemsprops.bpht = bpht.hor[,bpht.h.lst]\n  chemsprops.bpht$source_db = \"Croatian_Soil_Pedon\"\n  chemsprops.bpht$confidence_degree = 1\n  chemsprops.bpht$project_url = \"http://www.haop.hr/\"\n  chemsprops.bpht$citation_url = \"https://books.google.nl/books?id=k_a2MgAACAAJ\"\n  chemsprops.bpht = complete.vars(chemsprops.bpht, sel = c(\"oc\",\"MG\",\"PH1\",\"k_ext\"))\n  saveRDS.gz(chemsprops.bpht, \"/mnt/diskstation/data/Soil_points/Croatia/chemsprops.bpht.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n\nJoining by: site_key\n\ndim(chemsprops.bpht)\n\n[1] 5757   39\n\n## [1] 5757   39\n\n\n\n\n\nSanderman, J., (2017) “Remnant native SOC database”, Soil carbon profile data from paired land use comparisons, https://doi.org/10.7910/DVN/QQQM8V/8MSBNI, Harvard Dataverse, V1\n\nSanderman, J., Hengl, T., & Fiske, G. J. (2017). Soil carbon debt of 12,000 years of human land use. Proceedings of the National Academy of Sciences, 114(36), 9575-9580. https://doi.org/10.1073/pnas.1706103114\n\n\nif(!exists(\"chemsprops.RemnantSOC\")){\n  rem.hor &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 3)\n  rem.site &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 2)\n  rem.ref &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 4)\n  rem.site = plyr::join(rem.site, rem.ref[,c(\"Source.No.\",\"DOI\",\"Sample_year\")], by=c(\"Source.No.\"))\n  rem.site$Site = rem.site$Site.ID\n  rem.horA = plyr::join(rem.hor, rem.site, by=c(\"Site\"))\n  rem.horA$hzn_top = rem.horA$'U_depth.(m)'*100\n  rem.horA$hzn_bot = rem.horA$'L_depth.(m)'*100\n  ## Estimated BD = bulk density estimated by simple pedotransfer function (BD = 1.5833*EXP(-0.012*OC); see SI of paper)\n  rem.horA$db_od = ifelse(is.na(as.numeric(rem.horA$'measured.BD.(Mg/m3)')), as.numeric(rem.horA$'estimated.BD.(Mg/m3)'), as.numeric(rem.horA$'measured.BD.(Mg/m3)'))\n  rem.horA$oc_d = signif(rem.horA$'OC.(g/kg)' * rem.horA$db_od, 3)\n  #summary(rem.horA$oc_d)\n  rem.col = c(\"Source.No.\", \"Site\", \"Sample_year\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"OC.(g/kg)\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = rem.col[which(!rem.col %in% names(rem.horA))]\n  if(length(x.na)&gt;0){ for(i in x.na){ rem.horA[,i] = NA } }\n  chemsprops.RemnantSOC = rem.horA[,rem.col]\n  chemsprops.RemnantSOC$source_db = \"WHRC_remnant_SOC\"\n  chemsprops.RemnantSOC$confidence_degree = 8\n  chemsprops.RemnantSOC$project_url = \"https://www.woodwellclimate.org/research-area/carbon/\"\n  chemsprops.RemnantSOC$citation_url = \"http://dx.doi.org/10.1073/pnas.1706103114\"\n  chemsprops.RemnantSOC = complete.vars(chemsprops.RemnantSOC, sel = c(\"OC.(g/kg)\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))  \n  saveRDS.gz(chemsprops.RemnantSOC, \"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/chemsprops.RemnantSOC.rds\")\n}\n\nWarning in ifelse(is.na(as.numeric(rem.horA$\"measured.BD.(Mg/m3)\")),\nas.numeric(rem.horA$\"estimated.BD.(Mg/m3)\"), : NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(rem.horA$\"measured.BD.(Mg/m3)\")),\nas.numeric(rem.horA$\"estimated.BD.(Mg/m3)\"), : NAs introduced by coercion\n\ndim(chemsprops.RemnantSOC)\n\n[1] 1631   39\n\n## [1] 1631   39\n\n\n\n\n\nJian, J., Du, X., & Stewart, R. D. (2020). A database for global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3. Data download URL: https://github.com/jinshijian/SoilHealthDB\n\nNote: some information is available about column names (see: https://www.nature.com/articles/s41597-020-0356-3/tables/3) but detailed explanation is missing.\n\nif(!exists(\"chemsprops.SoilHealthDB\")){\n  shdb.hor &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/SoilHealthDB/SoilHealthDB_V2.xlsx\", sheet = 1, na.strings = c(\"NA\", \"NotAvailable\", \"Not-available\"))\n  #summary(as.factor(shdb.hor$SoilFamily))\n  #summary(as.factor(shdb.hor$SamplingDepth))\n  shdb.hor$hzn_top = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][1] }))\n  shdb.hor$hzn_bot = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][2] }))\n  shdb.hor$hzn_top = ifelse(is.na(shdb.hor$hzn_top), 0, shdb.hor$hzn_top)\n  shdb.hor$hzn_bot = ifelse(is.na(shdb.hor$hzn_bot), 15, shdb.hor$hzn_bot)\n  shdb.hor$oc = as.numeric(shdb.hor$BackgroundSOC) * 10\n  shdb.hor$oc_d = signif(shdb.hor$oc * shdb.hor$SoilBD, 3)\n  #summary(shdb.hor$oc_d)\n  for(j in c(\"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"SoilpH\", \"Longitude\", \"Latitude\")){   shdb.hor[,j]  &lt;- as.numeric(shdb.hor[,j])   }\n  shdb.hor$ClayPerc = ifelse(is.na(shdb.hor$ClayPerc), 100-(shdb.hor$SiltPerc+shdb.hor$SandPerc), shdb.hor$ClayPerc)\n  #summary(shdb.hor$oc_d)\n  shdb.col = c(\"StudyID\", \"ExperimentID\", \"SamplingYear\", \"Longitude\", \"Latitude\", \"SoilFamily\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"Texture\", \"texture_lab\", \"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"SoilpH\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"SoilBD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = shdb.col[which(!shdb.col %in% names(shdb.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ shdb.hor[,i] = NA } }\n  chemsprops.SoilHealthDB = shdb.hor[,shdb.col]\n  chemsprops.SoilHealthDB$source_db = \"SoilHealthDB\"\n  chemsprops.SoilHealthDB$confidence_degree = 8\n  chemsprops.SoilHealthDB$project_url = \"https://github.com/jinshijian/SoilHealthDB\"\n  chemsprops.SoilHealthDB$citation_url = \"https://doi.org/10.1038/s41597-020-0356-3\"\n  chemsprops.SoilHealthDB = complete.vars(chemsprops.SoilHealthDB, sel = c(\"ClayPerc\", \"SoilpH\", \"oc\", \"SoilFamily\"), coords = c(\"Longitude\", \"Latitude\"))  \n  saveRDS.gz(chemsprops.SoilHealthDB, \"/mnt/diskstation/data/Soil_points/INT/SoilHealthDB/chemsprops.SoilHealthDB.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SoilHealthDB)\n\n[1] 5050   39\n\n## [1] 5050   39\n\n\n\n\n\nLedo, A., Hillier, J., Smith, P. et al. (2019) A global, empirical, harmonised dataset of soil organic carbon changes under perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1. Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2\n\nNote: Many missing years for PREVIOUS SOC AND SOIL CHARACTERISTICS.\n\nif(!exists(\"chemsprops.SOCPDB\")){\n  library(\"readxl\")\n  socpdb &lt;- readxl::read_excel(\"/mnt/diskstation/data/Soil_points/INT/SOCPDB/SOC_perennials_DATABASE.xls\", skip=1, sheet = 1)\n  #names(socpdb)\n  #summary(as.factor(socpdb$USDA))\n  #summary(as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(is.na(as.numeric(socpdb$year_measure)), as.numeric(socpdb$yearPpub)-5, as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(socpdb$year_measure&lt;1960, NA, socpdb$year_measure)\n  socpdb$depth_current = socpdb$soil_to_cm_current - socpdb$soil_from_cm_current\n  socpdb = socpdb[socpdb$depth_current&gt;5,]\n  socpdb$SOC_g_kg_current = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)), as.numeric(socpdb$SOC_Mg_ha_current) / (socpdb$depth_current/100 * as.numeric(socpdb$bulk_density_Mg_m3_current) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_current))\n  socpdb$depth_previous = socpdb$soil_to_cm_previous - socpdb$soil_from_cm_previous\n  socpdb$SOC_g_kg_previous = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)), as.numeric(socpdb$SOC_Mg_ha_previous) / (socpdb$depth_previous/100 * as.numeric(socpdb$Bulkdensity_previous) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_previous))\n  hor.b = which(names(socpdb) %in% c(\"ID\", \"plotID\", \"Longitud\", \"Latitud\", \"year_measure\", \"years_since_luc\", \"USDA\", \"original_source\"))\n  socpdb1 = socpdb[,c(hor.b, grep(\"_current\", names(socpdb)))]\n  #summary(as.numeric(socpdb1$years_since_luc))\n  ## 10 yrs median\n  socpdb1$site_obsdate = socpdb1$year_measure\n  socpdb2 = socpdb[,c(hor.b, grep(\"_previous\", names(socpdb)))]\n  socpdb2$site_obsdate = socpdb2$year_measure - ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10, as.numeric(socpdb2$years_since_luc))\n  colnames(socpdb2) &lt;- sub(\"_previous\", \"_current\", colnames(socpdb2))\n  nm.socpdb = c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \"sand_total\", \"organic_carbon\", \"ph_h2o\", \"bulk_density_oven_dry\")\n  sel.socdpb1 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"USDA\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"bulk_density_Mg_m3_current\")\n  sel.socdpb2 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"USDA\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"Bulkdensity_current\")   \n  socpdbALL = as.data.frame(dplyr::bind_rows(lapply(list(socpdb1[,sel.socdpb1], socpdb2[,sel.socdpb2]), function(i){ dplyr::mutate_all(setNames(i, nm.socpdb), as.character) })))\n  for(j in which(names(socpdbALL) %in% c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \"sand_total\", \"organic_carbon\", \"ph_h2o\", \"bulk_density_oven_dry\"))){ socpdbALL[,j] &lt;- as.numeric(socpdbALL[,j]) }\n  #summary(socpdbALL$organic_carbon) ## mean = 15\n  #summary(socpdbALL$bulk_density_oven_dry)\n  #summary(socpdbALL$ph_h2o)\n  socpdbALL$oc_d = signif(socpdbALL$organic_carbon * socpdbALL$bulk_density_oven_dry, 3)\n  #summary(socpdbALL$oc_d)\n  x.na = col.names[which(!col.names %in% names(socpdbALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ socpdbALL[,i] = NA } }\n  chemsprops.SOCPDB &lt;- socpdbALL[,col.names]\n  chemsprops.SOCPDB$source_db = \"SOCPDB\"\n  chemsprops.SOCPDB$confidence_degree = 5\n  chemsprops.SOCPDB$project_url = \"https://africap.info/\"\n  chemsprops.SOCPDB$citation_url = \"https://doi.org/10.1038/s41597-019-0062-1\"\n  chemsprops.SOCPDB = complete.vars(chemsprops.SOCPDB, sel = c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.SOCPDB, \"/mnt/diskstation/data/Soil_points/INT/SOCPDB/chemsprops.SOCPDB.rds\")\n}\n\nWarning: Expecting numeric in AP1137 / R1137C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1138 / R1138C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1139 / R1139C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1140 / R1140C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1141 / R1141C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1142 / R1142C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1143 / R1143C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1144 / R1144C42: got 'YES'\n\n\nWarning: Expecting numeric in I1305 / R1305C9: got 'NA'\n\n\nWarning: Expecting numeric in J1305 / R1305C10: got 'NA'\n\n\nWarning: Expecting numeric in I1306 / R1306C9: got 'NA'\n\n\nWarning: Expecting numeric in J1306 / R1306C10: got 'NA'\n\n\nWarning: Expecting numeric in I1307 / R1307C9: got 'NA'\n\n\nWarning: Expecting numeric in J1307 / R1307C10: got 'NA'\n\n\nWarning: Expecting numeric in I1308 / R1308C9: got 'NA'\n\n\nWarning: Expecting numeric in J1308 / R1308C10: got 'NA'\n\n\nWarning: Expecting numeric in I1309 / R1309C9: got 'NA'\n\n\nWarning: Expecting numeric in J1309 / R1309C10: got 'NA'\n\n\nWarning: Expecting numeric in I1310 / R1310C9: got 'NA'\n\n\nWarning: Expecting numeric in J1310 / R1310C10: got 'NA'\n\n\nWarning: Expecting numeric in I1311 / R1311C9: got 'NA'\n\n\nWarning: Expecting numeric in J1311 / R1311C10: got 'NA'\n\n\nWarning: Expecting numeric in I1312 / R1312C9: got 'NA'\n\n\nWarning: Expecting numeric in J1312 / R1312C10: got 'NA'\n\n\nWarning: Expecting numeric in I1317 / R1317C9: got 'NA'\n\n\nWarning: Expecting numeric in J1317 / R1317C10: got 'NA'\n\n\nWarning: Expecting numeric in I1318 / R1318C9: got 'NA'\n\n\nWarning: Expecting numeric in J1318 / R1318C10: got 'NA'\n\n\nWarning: Expecting numeric in I1319 / R1319C9: got 'NA'\n\n\nWarning: Expecting numeric in J1319 / R1319C10: got 'NA'\n\n\nWarning: Expecting numeric in I1320 / R1320C9: got 'NA'\n\n\nWarning: Expecting numeric in J1320 / R1320C10: got 'NA'\n\n\nWarning: Expecting numeric in I1321 / R1321C9: got 'NA'\n\n\nWarning: Expecting numeric in J1321 / R1321C10: got 'NA'\n\n\nWarning: Expecting numeric in I1322 / R1322C9: got 'NA'\n\n\nWarning: Expecting numeric in J1322 / R1322C10: got 'NA'\n\n\nWarning: Expecting numeric in I1323 / R1323C9: got 'NA'\n\n\nWarning: Expecting numeric in J1323 / R1323C10: got 'NA'\n\n\nWarning: Expecting numeric in I1324 / R1324C9: got 'NA'\n\n\nWarning: Expecting numeric in J1324 / R1324C10: got 'NA'\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$year_measure)),\nas.numeric(socpdb$yearPpub) - : NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$year_measure)),\nas.numeric(socpdb$yearPpub) - : NAs introduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10,\nas.numeric(socpdb2$years_since_luc)): NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10,\nas.numeric(socpdb2$years_since_luc)): NAs introduced by coercion\n\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SOCPDB)\n\n[1] 2416   39\n\n## [1] 2416   39\n\n\n\n\n\nPoeplau, C., Jacobs, A., Don, A., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks of organic carbon in German agricultural soils—Key results of the first comprehensive inventory. Journal of Plant Nutrition and Soil Science, 183(6), 665-681. https://doi.org/10.1002/jpln.202000113. Data download URL: https://doi.org/10.3220/DATA20200203151139\n\nNote: For protection of data privacy, the coordinate was randomly generated within a radius of 4-km around the planned sampling point. This data is hence probably not suitable for spatial analysis, predictive soil mapping.\n\nif(!exists(\"chemsprops.BZE_LW\")){\n  site.de &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/SITE.xlsx\", sheet = 1)\n  site.de$site_obsdate = format(as.Date(paste0(\"01-\", site.de$Sampling_month, \"-\", site.de$Sampling_year), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.de.xy = site.de[,c(\"PointID\",\"xcoord\",\"ycoord\")]\n  ## 3104\n  bze.cor = read.csv('./correlation/soil_type_correlation_BZE.csv')\n  site.de$SSL_classification_name = paste0( dplyr::left_join(site.de[\"Specific.soil.subtype\"], bze.cor, by=c(\"Specific.soil.subtype\"=\"bze_subtype\"), multiple = \"first\")$USDA_1, \" / \",\n                    dplyr::left_join(site.de[\"Specific.soil.subtype\"], bze.cor, by=c(\"Specific.soil.subtype\"=\"bze_subtype\"), multiple = \"first\")$USDA_2)\n  #summary(as.factor(site.de$SSL_classification_name))\n  coordinates(site.de.xy) &lt;- ~xcoord+ycoord\n  proj4string(site.de.xy) &lt;- CRS(\"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\")\n  site.de.ll &lt;- data.frame(spTransform(site.de.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.de$longitude_decimal_degrees = site.de.ll[,2]\n  site.de$latitude_decimal_degrees = site.de.ll[,3]\n  hor.de &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1)\n  #hor.de = plyr::join(openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1), openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/HORIZON_DATA.xlsx\", sheet = 1), by=\"PointID\")\n  ## 17,189 rows\n  horALL.de = plyr::join(hor.de, site.de, by=\"PointID\")\n  ## Sand content [Mass-%]; grain size 63-2000µm (DIN ISO 11277)\n  horALL.de$sand_tot_psa &lt;- horALL.de$gS + horALL.de$mS + horALL.de$fS + 0.2 * horALL.de$gU\n  horALL.de$silt_tot_psa &lt;- horALL.de$fU + horALL.de$mU + 0.8 * horALL.de$gU\n  ## Convert millisiemens/meter [mS/m] to microsiemens/centimeter [μS/cm, uS/cm]\n  horALL.de$ec_satp = horALL.de$EC_H2O / 10\n  hor.sel.de &lt;- c(\"PointID\", \"Main.soil.type\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Layer.upper.limit\", \"Layer.lower.limit\", \"hzn_desgn\", \"Soil.texture.class\", \"texture_lab\", \"Clay\", \"silt_tot_psa\", \"sand_tot_psa\", \"TOC\", \"oc_d\", \"TC\", \"TN\", \"ph_kcl\", \"pH_H2O\", \"pH_CaCl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"Rock.fragment.fraction\", \"BD_FS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  #summary(horALL.de$TOC) ## mean = 12.3\n  #summary(horALL.de$BD_FS) ## mean = 1.41\n  #summary(horALL.de$pH_H2O)\n  horALL.de$oc_d = signif(horALL.de$TOC * horALL.de$BD_FS * (1-horALL.de$Rock.fragment.fraction/100), 3)\n  #summary(horALL.de$oc_d)\n  x.na = hor.sel.de[which(!hor.sel.de %in% names(horALL.de))]\n  if(length(x.na)&gt;0){ for(i in x.na){ horALL.de[,i] = NA } }\n  chemsprops.BZE_LW &lt;- horALL.de[,hor.sel.de]\n  chemsprops.BZE_LW$source_db = \"BZE_LW\"\n  chemsprops.BZE_LW$confidence_degree = 3\n  chemsprops.BZE_LW$project_url = \"https://www.thuenen.de/de/ak/\"\n  chemsprops.BZE_LW$citation_url = \"https://doi.org/10.1002/jpln.202000113\"\n  chemsprops.BZE_LW = complete.vars(chemsprops.BZE_LW, sel = c(\"TOC\", \"pH_H2O\", \"Clay\"))\n  saveRDS.gz(chemsprops.BZE_LW, \"/mnt/diskstation/data/Soil_points/Germany/chemsprops.BZE_LW.rds\")\n}\ndim(chemsprops.BZE_LW)\n\n[1] 17189    39\n\n## [1] 17189    39\n\n\n\n\n\nBeckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. Data download URL: https://www.dov.vlaanderen.be/geonetwork/home/api/records/78e15dd4-8070-4220-afac-258ea040fb30\nOttoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles for assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001\n\n\nif(!exists(\"chemsprops.Vlaanderen2010\")){\n  site.vl &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Profiel.csv\")\n  site.vl$site_obsdate = format(as.Date(sapply(site.vl$Profilering_Datum, function(i){strsplit(i, \" \")[[1]][1]}), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.vl.xy = site.vl[,c(\"ID\",\"Coordinaat_Lambert72_X\",\"Coordinaat_Lambert72_Y\")]\n  ## 7020\n  site.vl.xy = site.vl.xy[complete.cases(site.vl.xy),]\n  coordinates(site.vl.xy) &lt;- ~Coordinaat_Lambert72_X+Coordinaat_Lambert72_Y\n  proj4string(site.vl.xy) &lt;- CRS(\"+init=epsg:31300\")\n  site.vl.ll &lt;- data.frame(spTransform(site.vl.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.vl$longitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$coords.x1\n  site.vl$latitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$coords.x2\n  site.vl$Profiel_ID = site.vl$ID\n  hor.vl &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Horizont.csv\")\n  ## 42,529 rows\n  horALL.vl = plyr::join(hor.vl, site.vl, by=\"Profiel_ID\")\n  horALL.vl$oc = horALL.vl$Humus*10 /1.724\n  #summary(horALL.vl$oc) ## mean = 7.8\n  #summary(horALL.vl$pH_H2O)\n  horALL.vl$hzn_top &lt;- rowSums(horALL.vl[,c(\"Diepte_grens_boven1\", \"Diepte_grens_boven2\")], na.rm=TRUE)/2\n  horALL.vl$hzn_bot &lt;- rowSums(horALL.vl[,c(\"Diepte_grens_onder1\",\"Diepte_grens_onder2\")], na.rm=TRUE)/2\n  horALL.vl$sand_tot_psa &lt;- horALL.vl$T50_100 + horALL.vl$T100_200 + horALL.vl$T200_500 + horALL.vl$T500_1000 + horALL.vl$T1000_2000\n  horALL.vl$silt_tot_psa &lt;- horALL.vl$T2_10 + horALL.vl$T10_20 + horALL.vl$T20_50\n  horALL.vl$tex_psda = paste0(horALL.vl$HorizontTextuur_code1, horALL.vl$HorizontTextuur_code2)\n  ## some corrupt coordinates\n  horALL.vl &lt;- horALL.vl[horALL.vl$latitude_decimal_degrees &gt; 50.6,]\n  hor.sel.vl &lt;- c(\"Profiel_ID\", \"Bodemgroep\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"Hor_nr\", \"hzn_top\", \"hzn_bot\", \"Naam\", \"tex_psda\", \"texture_lab\", \"T0_2\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pH_KCl\", \"pH_H2O\", \"ph_cacl2\", \"Sorptiecapaciteit_Totaal\", \"cec_nh4\", \"ecec\", \"Tgroter_dan_2000\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = hor.sel.vl[which(!hor.sel.vl %in% names(horALL.vl))]\n  if(length(x.na)&gt;0){ for(i in x.na){ horALL.vl[,i] = NA } }\n  chemsprops.Vlaanderen &lt;- horALL.vl[,hor.sel.vl]\n  chemsprops.Vlaanderen$source_db = \"Vlaanderen\"\n  chemsprops.Vlaanderen$confidence_degree = 2\n  chemsprops.Vlaanderen$project_url = \"https://www.dov.vlaanderen.be\"\n  chemsprops.Vlaanderen$citation_url = \"https://doi.org/10.1016/j.geoderma.2015.04.001\"\n  chemsprops.Vlaanderen = complete.vars(chemsprops.Vlaanderen, sel = c(\"oc\", \"pH_H2O\", \"T0_2\"))\n  saveRDS.gz(chemsprops.Vlaanderen, \"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/chemsprops.Vlaanderen.rds\")\n}\n\nWarning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is\ndeprecated. It might return a CRS with a non-EPSG compliant axis order.\n\ndim(chemsprops.Vlaanderen)\n\n[1] 41364    39\n\n## [1] 41364    39\n\n\n\n\n\nHelfenstein, A., Mulder, V. L., Hack-ten Broeke, M. J. D., van Doorn, M., Teuling, K., Walvoort, D. J. J., and Heuvelink, G. B. M. (2024): BIS-4D: mapping soil properties and their uncertainties at 25 m resolution in the Netherlands, Earth Syst. Sci. Data, 16, 2941–2970. https://doi.org/10.5194/essd-16-2941-2024\n\nNote: Data download https://doi.org/10.4121/c90215b3-bdc6-4633-b721-4c4a0259d6dc.v4\n\nif(!exists(\"chemsprops.NLBIS\")){\n  ## Tabular datasets of each georeferenced soil property point data are provided as separate CSV files for each soil property.\n  nlbis.lst = list.files(\"/mnt/diskstation/data/Soil_points/Netherlands/BIS\", pattern=glob2rx(\"*.csv.gz\"), full.names = TRUE)\n  nlbis.hor = plyr::join_all(lapply(nlbis.lst, function(i){vroom::vroom(gzfile(i))}), type=\"full\")\n  #str(nlbis.hor)\n  ## 1,145,381 obs. of  21 variables\n  ## this is relatively large lab data set; it would create imbalance in the bind, so better to trim-down\n  ## year of sampling\n  #summary(as.factor(nlbis.hor$year))\n  nlbis.hor = nlbis.hor[nlbis.hor$year&gt;1999,]\n  #plot(nlbis.hor[,c(\"X\",\"Y\")], pch=\"+\", asp=1)\n  ## LOI method - harmonization: https://doi.org/10.1111/ejss.12558\n  #nlbis.hor$organic_carbon = nlbis.hor$SOM_per / 1.72 * 10\n  nlbis.hor$organic_carbon = (0.513*nlbis.hor$SOM_per-0.047*nlbis.hor$clay_per+0.00025*nlbis.hor$clay_per^2 )*10\n  nlbis.hor$organic_carbon = ifelse(nlbis.hor$organic_carbon &lt; 0, 0, nlbis.hor$organic_carbon)\n  #summary(nlbis.hor$organic_carbon)\n  nlbis.xy = terra::vect(nlbis.hor[,c(\"X\",\"Y\")], geom=c(\"X\",\"Y\"), crs=\"EPSG:28992\")\n  nlbis.ll = terra::project(nlbis.xy, \"EPSG:4326\")\n  nlbis.hor$longitude_decimal_degrees = geom(nlbis.ll)[,\"x\"]\n  nlbis.hor$latitude_decimal_degrees = geom(nlbis.ll)[,\"y\"]\n  nlbis.hor$cec_nh4_ph_7 = nlbis.hor$CEC / 10\n  #summary(nlbis.hor$d_upper)\n  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  ##   0.000   2.907  17.442  83.267  58.140 575.581   22417 \n  nlbis.hor$oc_d = signif(nlbis.hor$organic_carbon * nlbis.hor$BD_gcm3, 3)\n  #summary(nlbis.hor$oc_d)\n  #  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  #  2.79   13.10   24.40   29.87   43.18   83.70  238090  \n  nlbis.name = c(\"site_id\", \"upedonid\", \"year\", \"longitude_decimal_degrees\", \n               \"latitude_decimal_degrees\", \"SSL_classification_name\",  \n               \"sample_id\", \"layer_key\", \"hor_nr\", \"d_upper\", \"d_lower\", \n              \"hor\", \"texture_description\", \"texture_lab\", \"clay_per\", \"silt_per\", \n              \"sand_per\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"N_tot_mgkg\", \n              \"pH_KCl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"BD_gcm3\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = nlbis.name[which(!nlbis.name %in% names(nlbis.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ nlbis.hor[,i] = NA } }\n  chemsprops.NLBIS = nlbis.hor[,nlbis.name]\n  chemsprops.NLBIS$source_db = \"Netherlands.BIS\"\n  chemsprops.NLBIS$confidence_degree = 2\n  chemsprops.NLBIS$project_url = \"https://git.wageningenur.nl/helfe001/bis-4d\"\n  chemsprops.NLBIS$citation_url = \"https://doi.org/10.5194/essd-16-2941-2024, 2024\"\n  chemsprops.NLBIS = complete.vars(chemsprops.NLBIS, sel = c(\"organic_carbon\", \"pH_KCl\"))\n  saveRDS.gz(chemsprops.NLBIS, \"/mnt/diskstation/data/Soil_points/Netherlands/chemsprops.NLBIS.rds\")\n}\n\nRows: 15871 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, BD_gcm3\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 3815 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, CEC\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 631726 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, clay_per\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 5739 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, N_tot_mgkg\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 6084 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, P_ox_mmolkg\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 15248 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, pH_KCl\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 12918 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, sand_per\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 12912 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, silt_per\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 855950 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, SOM_per\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\ndim(chemsprops.NLBIS)\n\n[1] 116533     39\n\n## [1] 215947     39\n\n\n\n\n\nPfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: the Chilean Soil Organic Carbon database, a multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457–468, https://doi.org/10.5194/essd-12-457-2020. Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3\n\n\nif(!exists(\"chemsprops.CHLSOC\")){\n  chl.hor &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Chile/CHLSOC/CHLSOC_v1.0.csv\", stringsAsFactors = FALSE)\n  #summary(chl.hor$oc)\n  chl.hor$oc = chl.hor$oc*10\n  #summary(chl.hor$bd)\n  chl.hor$oc_d = signif(chl.hor$oc  * chl.hor$bd * (100 - ifelse(is.na(chl.hor$crf), 0, chl.hor$crf))/100, 3)\n  #summary(chl.hor$oc_d)\n  chl.col = c(\"ProfileID\", \"usiteid\", \"year\", \"long\", \"lat\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"top\", \"bottom\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"crf\", \"bd\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = chl.col[which(!chl.col %in% names(chl.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ chl.hor[,i] = NA } }\n  chemsprops.CHLSOC = chl.hor[,chl.col]\n  chemsprops.CHLSOC$source_db = \"Chilean_SOCDB\"\n  chemsprops.CHLSOC$confidence_degree = 4\n  chemsprops.CHLSOC$project_url = \"https://doi.org/10.17605/OSF.IO/NMYS3\"\n  chemsprops.CHLSOC$citation_url = \"https://doi.org/10.5194/essd-12-457-2020\"\n  chemsprops.CHLSOC = complete.vars(chemsprops.CHLSOC, sel = c(\"oc\", \"bd\"), coords = c(\"long\", \"lat\"))\n  saveRDS.gz(chemsprops.CHLSOC, \"/mnt/diskstation/data/Soil_points/Chile/chemsprops.CHLSOC.rds\")\n}\ndim(chemsprops.CHLSOC)\n\n[1] 16903    39\n\n## [1] 16903    39\n\n\n\n\n\nLilly, A., Bell, J.S., Hudson, G., Nolan, A.J. & Towers. W. (Compilers) (2010). National soil inventory of Scotland (NSIS_1); site location, sampling and profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230. Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download\n\n\nif(!exists(\"chemsprops.ScotlandNSIS1\")){\n  sco.xy = read.csv(\"/mnt/diskstation/data/Soil_points/Scotland/NSIS_10km.csv\")\n  coordinates(sco.xy) = ~ easting + northing\n  proj4string(sco.xy) = \"EPSG:27700\"\n  sco.ll = as.data.frame(spTransform(sco.xy, CRS(\"EPSG:4326\")))\n  sco.ll$site_obsdate = as.numeric(sapply(sco.ll$profile_da, function(x){substr(x, nchar(x)-3, nchar(x))}))\n  #hist(sco.ll$site_obsdate[sco.ll$site_obsdate&gt;1000])\n  ## no points after 1990!!\n  #summary(sco.ll$exch_k)\n  sco.in.name = c(\"profile_id\", \"site_obsdate\", \"coords.x1\", \"coords.x2\", \"horz_top\", \"horz_botto\", \n                  \"horz_symb\", \"sample_id\", \"texture_ps\",\n                  \"sand_int\", \"silt_int\", \"clay\", \"carbon\", \"nitrogen\", \"ph_h2o\", \"exch_ca\", \n                  \"exch_mg\", \"exch_na\", \"exch_k\", \"sum_cation\")\n  #sco.in.name[which(!sco.in.name %in% names(sco.ll))]\n  sco.x = as.data.frame(sco.ll[,sco.in.name])\n  #sco.x = sco.x[!sco.x$sample_id==0,]\n  #summary(sco.x$carbon)\n  sco.out.name = c(\"site_key\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \n                     \"hzn_bot\", \"hzn_top\", \"hzn_desgn\", \"labsampnum\", \"tex_psda\", \"sand_total\", \"silt_total\", \n                      \"clay_total\", \"organic_carbon\", \"total_nitrogen_ncs\", \"ph_h2o\", \"ca_ext\",\n                      \"mg_ext\", \"na_ext\", \"k_ext\", \"sum_of_cations_cec_pH_8_2\")\n  ## translate values\n  sco.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(sco.in.name)))\n  sco.fun.lst[[which(sco.in.name==\"profile_id\")]] = \"paste(x)\"\n  sco.fun.lst[[which(sco.in.name==\"exch_ca\")]] = \"as.numeric(x)*200\"\n  sco.fun.lst[[which(sco.in.name==\"exch_mg\")]] = \"as.numeric(x)*121\"\n  sco.fun.lst[[which(sco.in.name==\"exch_k\")]] = \"as.numeric(x)*391\"\n  sco.fun.lst[[which(sco.in.name==\"exch_na\")]] = \"as.numeric(x)*230\"\n  sco.fun.lst[[which(sco.in.name==\"carbon\")]] = \"as.numeric(x)*10\"\n  sco.fun.lst[[which(sco.in.name==\"nitrogen\")]] = \"as.numeric(x)*10\"\n  ## save translation rules:\n  #write.csv(data.frame(sco.in.name, sco.out.name, unlist(sco.fun.lst)), \"scotland_soilab_transvalues.csv\")\n  sco.soil = transvalues(sco.x, sco.out.name, sco.in.name, sco.fun.lst)\n  x.na = col.names[which(!col.names %in% names(sco.soil))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sco.soil[,i] = NA } }\n  chemsprops.ScotlandNSIS1 = sco.soil[,col.names]\n  chemsprops.ScotlandNSIS1$source_db = \"ScotlandNSIS1\"\n  chemsprops.ScotlandNSIS1$confidence_degree = 2\n  chemsprops.ScotlandNSIS1$project_url = \"http://soils.environment.gov.scot/\"\n  chemsprops.ScotlandNSIS1$citation_url = \"https://doi.org/10.5281/zenodo.4650230\"\n  chemsprops.ScotlandNSIS1 = complete.vars(chemsprops.ScotlandNSIS1, sel = c(\"organic_carbon\", \"ph_h2o\", \"clay_total\"))\n  saveRDS.gz(chemsprops.ScotlandNSIS1, \"/mnt/diskstation/data/Soil_points/Scotland/chemsprops.ScotlandNSIS1.rds\")\n}\n\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\n\ndim(chemsprops.ScotlandNSIS1)\n\n[1] 3091   39\n\n## [1] 3091   39\n\n\n\n\n\nDuchesne, L., Ouimet, R., (2021). Digital mapping of soil texture in ecoforest polygons in Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685. Data download URL: https://doi.org/10.7717/peerj.11685/supp-1\n\n\nif(!exists(\"chemsprops.QuebecTEX\")){\n  que.xy = read.csv(gzfile(\"/mnt/diskstation/data/Soil_points/Canada/Quebec/RawData.csv.gz\"))\n  #summary(as.factor(que.xy$Horizon))\n  ## horizon depths were not measured - we assume 15-30 and 30-80\n  que.xy$hzn_top = ifelse(que.xy$Horizon==\"B\", 15, 30)\n  que.xy$hzn_bot = ifelse(que.xy$Horizon==\"B\", 30, 80)\n  que.xy$site_key = que.xy$usiteid\n  que.xy$latitude_decimal_degrees = que.xy$Latitude\n  que.xy$longitude_decimal_degrees = que.xy$Longitude\n  que.xy$hzn_desgn = que.xy$Horizon\n  ## sampling year is unknown but the paper indicates 'The data come from 3 different provincial forest inventory programs... inventoried by provincial forestry authorities since 1970'\n  que.xy$site_obsdate = 2000\n  que.xy$sand_total = que.xy$PC_Sand\n  que.xy$silt_total = que.xy$PC_Silt\n  que.xy$clay_total = que.xy$PC_Clay\n  x.na = col.names[which(!col.names %in% names(que.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ que.xy[,i] = NA } }\n  chemsprops.QuebecTEX = que.xy[,col.names]\n  chemsprops.QuebecTEX$source_db = \"QuebecTEX\"\n  chemsprops.QuebecTEX$confidence_degree = 4\n  chemsprops.QuebecTEX$project_url = \"\"\n  chemsprops.QuebecTEX$citation_url = \"https://doi.org/10.7717/peerj.11685\"\n  chemsprops.QuebecTEX = complete.vars(chemsprops.QuebecTEX, sel = c(\"clay_total\"))\n  saveRDS.gz(chemsprops.QuebecTEX, \"/mnt/diskstation/data/Soil_points/Canada/chemsprops.QuebecTEX.rds\")\n}\ndim(chemsprops.QuebecTEX)\n\n[1] 29570    39\n\n## [1] 29570    39\n\n\n\n\n\nZorn, M., Breg Valjavec, M., Komac, B., Volk Bahun, M., & Hrvatin, M. (2020). Soils of Slovenia. The Geography of Slovenia: Small But Diverse, 91-107. https://doi.org/10.1007/978-3-030-14066-3_6 Data download: https://rkg.gov.si/vstop/\n\n\nif(!exists(\"chemsprops.Slovenia\")){\n  slo.xy = read_sf(\"/mnt/diskstation/data/Soil_points/Slovenia/PedoloskiProfili.shp\")\n  slo.sf = sf::st_transform(slo.xy, \"epsg:4326\")\n  slo.df = data.frame(cbind(as.data.frame(slo.sf), st_coordinates(slo.sf)))\n  slo.hor = foreign::read.dbf(\"/mnt/diskstation/data/Soil_points/Slovenia/Horizonti_v_PedoloskihProfilih.DBF\", as.is=TRUE)\n  sloALL = dplyr::left_join(slo.hor, slo.df)\n  sloALL = sloALL[!is.na(sloALL$X.1),]\n  ## [1] 11509    71\n  #plot(sloALL[,c(\"X.1\",\"Y.1\")], pch=\"+\")\n  ## year of sampling\n  #summary(as.factor(sloALL$LETO))\n  ## Walkely-Black: K2Cr2O7/H2SO4\n  sloALL$organic_carbon = ifelse(sloALL$OGLJ==0 & (sloALL$PHH==0), NA, sloALL$OGLJ) * 1.3 * 10\n  sloALL$total_nitrogen_ncs = ifelse(sloALL$DUSIK==0 & (sloALL$PHH==0), NA, sloALL$DUSIK) * 10\n  sloALL$ph_kcl = ifelse(sloALL$PHK &lt; 2 | sloALL$PHK &gt; 9.5, NA, sloALL$PHK)\n  sloALL$ph_h2o = ifelse(sloALL$PHH &lt; 2 | sloALL$PHH &gt; 9.5, NA, sloALL$PHH)\n  sloALL$ph_cacl2 = ifelse(sloALL$PHCA &lt; 2 | sloALL$PHCA &gt; 9.5, NA, sloALL$PHCA)\n  sloALL$sum_of_cations_cec_pH_8_2 = ifelse(sloALL$S==0 & sloALL$PHH==0, NA, sloALL$S)\n  #summary(as.factor(sloALL$SKELET))\n  ## increadible &gt;1000 differnt ways coarse fragments were entered!\n  sloALL$total_frag_wt_pct_gt_2_mm_ws = ifelse(sloALL$SKELET==\"5%\", 5, \n                                        ifelse(sloALL$SKELET==\"10%\", 10,\n                                        ifelse(sloALL$SKELET==\"20%\", 20, \n                                        ifelse(sloALL$SKELET==\"30%\", 30,\n                                        ifelse(sloALL$SKELET==\"40%\", 40,\n                                        ifelse(sloALL$SKELET==\"50%\", 50,\n                                        ifelse(sloALL$SKELET==\"60%\", 60,\n                                        ifelse(sloALL$SKELET==\"70%\", 70,\n                                        ifelse(sloALL$SKELET==\"5-10%\", 7.5,\n                                        ifelse(sloALL$SKELET==\"/\", 0, NA))))))))))\n  sloALL$sand_total &lt;- sloALL$PES * 0.8 + sloALL$MELJG\n  sloALL$silt_total = 100 - (sloALL$sand_total + sloALL$GLINA)\n  slo.name = c(\"ZPP\", \"SPP\", \"LETO\", \"X.1\", \"Y.1\", \"SSL_classification_name\",  \n               \"LABST\", \"layer_key\", \"layer_sequence\", \"GLZG\", \"GLSP\", \n              \"HORIZ\", \"TRZ\", \"texture_lab\", \"GLINA\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = slo.name[which(!slo.name %in% names(sloALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sloALL[,i] = NA } }\n  chemsprops.Slovenia = sloALL[,slo.name]\n  chemsprops.Slovenia$source_db = \"Slovenia.SPDB\"\n  chemsprops.Slovenia$confidence_degree = 2\n  chemsprops.Slovenia$project_url = \"https://rkg.gov.si/vstop/\"\n  chemsprops.Slovenia$citation_url = \"https://doi.org/10.1007/978-3-030-14066-3_6\"\n  chemsprops.Slovenia = complete.vars(chemsprops.Slovenia, sel = c(\"organic_carbon\", \"ph_h2o\", \"GLINA\"), coords = c(\"X.1\", \"Y.1\"))\n  saveRDS.gz(chemsprops.Slovenia, \"/mnt/diskstation/data/Soil_points/Slovenia/chemsprops.Slovenia.rds\")\n}\n\nField name: 'NA' changed to: 'NA.'\n\n\nJoining with `by = join_by(ZPP)`\n\ndim(chemsprops.Slovenia)\n\n[1] 11509    39\n\n## [1] 11509    39\n\n\n\n\n\nRamos, T. B., Horta, A., Gonçalves, M. C., Pires, F. P., Duffy, D., & Martins, J. C. (2017). The INFOSOLO database as a first step towards the development of a soil information system in Portugal. Catena, 158, 390-412. http://dx.doi.org/10.1016/j.catena.2017.07.020\n\nNote: INFOSOLO project https://projects.iniav.pt/infosolo/\n\nif(!exists(\"chemsprops.INFOSOLO\")){\n  port.nam = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/description.txt\", col_names = FALSE)[-c(5:6),]\n  port.site = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/soil.txt\", col_names = make.names(port.nam$X2[port.nam$X3==\"Soil\"]))\n  hor.nm.port = make.names(port.nam$X2[port.nam$X3==\"Properties\"])\n  port.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/properties.txt\", col_names = c(\"ID2\", \"ID1\", hor.nm.port[-1]), na = c(\"\", \"\\\\N\"))\n  portALL = dplyr::left_join(port.hor, port.site, by = \"ID1\")\n  ## [1] 9934   51\n  #plot(portALL[,c(\"Long\",\"Lat\")], pch=\"+\", asp=1)\n  ## year of sampling\n  #summary(as.factor(portALL$Year))\n  portALL$organic_carbon = portALL$OC * 10\n  ## 41 Walkley-Black\n  portALL$organic_carbon[which(portALL$OC_M==41)] = portALL$organic_carbon[which(portALL$OC_M==41)] * 1.3\n  portALL$oc_d = signif(portALL$organic_carbon * portALL$BD * (100 - ifelse(is.na(portALL$Coarse), 0, portALL$Coarse))/100, 3)\n  #summary(portALL$oc_d)\n  portALL$sand_total &lt;- portALL$FS * 0.8 + portALL$CS\n  portALL$silt_total = 100 - (portALL$sand_total + portALL$C)\n  portALL$k_ext = portALL$K...28 * 391\n  portALL$ca_ext = portALL$Ca * 200\n  portALL$mg_ext = portALL$Mg * 121\n  portALL$na_ext = portALL$Na * 230\n  port.name = c(\"Profile_ID\", \"ID1\", \"Year\", \"Long\", \"Lat\", \"SSL_classification_name\",  \n               \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Hor_top\", \"Hor_bot\", \n              \"Hor_name\", \"texture_description\", \"texture_lab\", \"C\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"N\", \n              \"ph_kcl\", \"pH\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"CEC\", \"ecec_base_plus_aluminum\", \n              \"Coarse\", \"BD\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = port.name[which(!port.name %in% names(portALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ portALL[,i] = NA } }\n  chemsprops.PT.INFOSOLO = portALL[,port.name]\n  chemsprops.PT.INFOSOLO$source_db = \"Portugal.INFOSOLO\"\n  chemsprops.PT.INFOSOLO$confidence_degree = 2\n  chemsprops.PT.INFOSOLO$project_url = \"https://projects.iniav.pt/infosolo/\"\n  chemsprops.PT.INFOSOLO$citation_url = \"http://dx.doi.org/10.1016/j.catena.2017.07.020\"\n  chemsprops.PT.INFOSOLO = complete.vars(chemsprops.PT.INFOSOLO, sel = c(\"organic_carbon\", \"pH\", \"C\"), coords = c(\"Long\", \"Lat\"))\n  saveRDS.gz(chemsprops.PT.INFOSOLO, \"/mnt/diskstation/data/Soil_points/Portugal/chemsprops.PT.INFOSOLO.rds\")\n}\n\nRows: 60 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (4): X2, X3, X4, X5\ndbl (1): X1\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 3461 Columns: 16\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (10): Profile_ID, Soil, Qualifier.2, Qualifier.3, WRB, Parent.Material, ...\ndbl  (6): ID1, Long, Lat, Year, Qualifier.1, Land.Use\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nNew names:\nRows: 9934 Columns: 36\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr  (1): Hor_name\ndbl (35): ID2, ID1, Hor_top, Hor_bot, Coarse, CS, FS, Si, C, Texture_M, BD, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.PT.INFOSOLO)\n\n[1] 9934   39\n\n## [1] 9934   39\n\n\n\n\n\nPotash, E., Guan, K., Margenot, A. J., Lee, D., Boe, A., Douglass, M., … & Zumpf, C. (2023). Multi-site evaluation of stratified and balanced sampling of soil organic carbon stocks in agricultural fields. Geoderma, 438, 116587. https://doi.org/10.1016/j.geoderma.2023.116587 data download: https://doi.org/10.6084/m9.figshare.23669304\n\nNote: This is relatively small data set focused on 8 commercial fields / farms.\n\nif(!exists(\"chemsprops.Potash2023\")){\n  multisite.xy = read.csv(\"/mnt/landmark/Soil_points/USA/Multi_site_evaluation/locations.csv\")\n  multisite.lb = read.csv(\"/mnt/landmark/Soil_points/USA/Multi_site_evaluation/measurements.csv\")\n  multisite.lb$oc_d = round(as.numeric(multisite.lb$SOCc) * 10 * multisite.lb$BD, 2)\n  #summary(multisite.lb$oc_d)\n  multisite.lb$organic_carbon = multisite.lb$SOCc*10\n  multisite.lb$site_key = multisite.lb$location_id\n  multisite.lb$bulk_density_oven_dry = multisite.lb$BD\n  multisite.lb$site_obsdate = 2021\n  multisite.lb$hzn_top = multisite.lb$sample_depth_min\n  multisite.lb$hzn_bot = multisite.lb$sample_depth_max\n  multisite.xy$longitude_decimal_degrees = multisite.xy$X\n  multisite.xy$latitude_decimal_degrees = multisite.xy$Y\n  multisite.lb$longitude_decimal_degrees = plyr::join(multisite.lb[\"location_id\"], multisite.xy, match = \"first\")$longitude_decimal_degrees\n  multisite.lb$latitude_decimal_degrees = plyr::join(multisite.lb[\"location_id\"], multisite.xy, match = \"first\")$latitude_decimal_degrees\n  x.na = col.names[which(!col.names %in% names(multisite.lb))]\n  if(length(x.na)&gt;0){ for(i in x.na){ multisite.lb[,i] = NA } }\n  chemsprops.Potash2023 = multisite.lb[,col.names]\n  chemsprops.Potash2023$source_db = \"Potash_et_al_2023\"\n  chemsprops.Potash2023$project_url = \"https://sustainability.illinois.edu/new-method-shows-promise-for-accurate-efficient-soil-carbon-estimates/\"\n  chemsprops.Potash2023$citation_url = \"https://doi.org/10.1016/j.geoderma.2023.116587\"\n  saveRDS.gz(chemsprops.Potash2023, \"/mnt/diskstation/data/Soil_points/USA/Multi_site_evaluation/chemsprops.Potash2023.rds\")\n}\n\nJoining by: location_id\nJoining by: location_id\n\ndim(chemsprops.Potash2023)\n\n[1] 3977   39\n\n## [1] 3977   39\n\n\n\n\n\nStanimirova, R., Tarrio, K., Turlej, K., McAvoy, K., Stonebrook, S., Hu, K. T., … & Friedl, M. A. (2023). A global land cover training dataset from 1984 to 2020. Scientific Data, 10(1), 879. https://doi.org/10.1038/s41597-023-02798-5\n\nNote: Pseudo-observations based on GLANCE points; use only class “6” which is sand surface;\n\nif(!exists(\"chemsprops.GLANCE\")){\n  ## 0 soil organic carbon + 99% sand content (deserts)\n  bare = read_sf(\"/mnt/landmark/GLANCE/bu_glance_training_dataV1.gpkg\")\n  ## Level 2 land cover value (integer): 1 (Water), 2 (Ice/snow), 3 (Developed), 4 (Soil), \n  ## 5 (Rock), 6 (Beach/sand), 7 (Deciduous), 8 (Evergreen), 9 (Mixed), 10 (Shrub), \n  ## 11 (Grassland), 12 (Agriculture), and 13 (Moss/lichen). NaN values present.\n  #bare = bare[(bare$Glance_Class_ID_level2==5|bare$Glance_Class_ID_level2==6),]\n  bare = bare[bare$Glance_Class_ID_level2==6,]\n  #plot(bare[\"Dataset_Code\"])\n  #write_sf(bare, \"bu_glance_sand_barerock_V1.gpkg\")\n  #plot(bare[\"Glance_Class_ID_level2\"])\n  #str(bare)\n  ## 3085 points\n  bare.df = data.table::data.table(cbind(as.data.frame(bare), st_coordinates(bare)))\n  ## Extend to start end periods:\n  bare.ex = as.data.frame(data.table::setDT(bare.df)[ , list(site_key=Glance_ID, X=X, Y=Y, longitude_decimal_degrees=Lon, latitude_decimal_degrees=Lat, site_obsdate = seq(Start_Year, End_Year)), by = 1:nrow(bare.df)])\n  ## 50220\n  ## insert zeros for all nutrients except for the once we are not sure:\n  ## http://www.decodedscience.org/chemistry-sahara-sand-elements-dunes/45828\n  bare.ex$oc_d = 0\n  bare.ex$organic_carbon = 0\n  bare.ex$total_carbon_ncs = 0\n  bare.ex$total_nitrogen_ncs = 0\n  bare.ex$k_ext = 0\n  bare.ex$mg_ext = 0\n  bare.ex$clay_total = 0\n  bare.ex$sand_total = 99\n  bare.ex$silt_total = 1\n  bare.ex$bulk_density_oven_dry = 1.6\n  bare.ex$source_db = \"GLANCE\"\n  bare.ex$hzn_top = 0\n  bare.ex$hzn_bot = 30\n  bare.ex$source_db = \"GLanCE.points\"\n  bare.ex$confidence_degree = 4\n  x.na = col.names[which(!col.names %in% names(bare.ex))]\n  if(length(x.na)&gt;0){ for(i in x.na){ bare.ex[,i] = NA } }\n  chemsprops.SIM = bare.ex[,col.names]\n  chemsprops.SIM$project_url = \"https://doi.org/10.34911/rdnt.x4xfh3\"\n  chemsprops.SIM$citation_url = \"https://doi.org/10.1038/s41597-023-02798-5\"\n  saveRDS.gz(chemsprops.SIM, \"/mnt/diskstation/data/Soil_points/INT/chemsprops.SIM.rds\")\n}\ndim(chemsprops.SIM)\n\n[1] 50220    39\n\n## [1] 50220    39\n\nOther potential large soil profile DBs of interest:\n\nShangguan, W., Dai, Y., Liu, B., Zhu, A., Duan, Q., Wu, L., … & Chen, D. (2013). A China data set of soil properties for land surface modeling. Journal of Advances in Modeling Earth Systems, 5(2), 212-224. https://doi.org/10.1002/jame.20026\n\nSalković, E., Djurović, I., Knežević, M., Popović-Bugarin, V., & Topalović, A. (2018). Digitization and mapping of national legacy soil data of Montenegro. Soil and Water Research, 13(2), 83-89. https://doi.org/10.17221/81/2017-SWR\n\n\n\n\n\n\n\n\nds.n = ls(pattern=glob2rx(\"chemsprops.*\"))\n## 49 data sets\nnm.l = lapply(ds.n, function(i){ names(get(i)) })\n#x = lapply(nm.l, length)\nnm.df = data.frame(do.call(rbind, nm.l))\nnm.df$data.set = ds.n\n#write.csv(nm.df, \"/mnt/diskstation/data/Soil_points/chemsprops.validate_column.names.csv\")\ntot_sprops = dplyr::bind_rows(lapply(ds.n, function(i){ mutate_all(setNames(get(i), col.names), as.character) }))\n## convert to numeric:\nfor(j in c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"layer_sequence\", \n           \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")){\n  tot_sprops[,j] = as.numeric(tot_sprops[,j])\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n#head(tot_sprops)\n\nClean up typos and physically impossible values:\n\ntex.rm = rowSums(tot_sprops[,c(\"clay_total\", \"silt_total\", \"sand_total\")])\nsummary(tex.rm)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-2997.0   100.0   100.0   100.2   100.0  2997.0  505078 \n\nfor(j in c(\"clay_total\", \"silt_total\", \"sand_total\", \"total_frag_wt_pct_gt_2_mm_ws\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;100|tot_sprops[,j]&lt;0, NA, tot_sprops[,j])\n  tot_sprops[,j] = ifelse(tex.rm&lt;99|is.na(tex.rm)|tex.rm&gt;101, NA, tot_sprops[,j])\n}\nfor(j in c(\"ph_h2o\",\"ph_kcl\",\"ph_cacl2\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;12|tot_sprops[,j]&lt;2, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$db_od)\nfor(j in c(\"bulk_density_oven_dry\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;2.4|tot_sprops[,j]&lt;0.03, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$oc)\nfor(j in c(\"organic_carbon\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;800|tot_sprops[,j]&lt;0, NA, tot_sprops[,j])\n}\n\nFill-in the missing depths:\n\n## soil layer depth (middle)\ntot_sprops$hzn_depth = tot_sprops$hzn_top + (tot_sprops$hzn_bot-tot_sprops$hzn_top)/2\nsummary(is.na(tot_sprops$hzn_depth))\n\n   Mode   FALSE    TRUE \nlogical 1492760   32464 \n\n## Note: large number of horizons without a depth\ntot_sprops = tot_sprops[!is.na(tot_sprops$hzn_depth),]\n#quantile(tot_sprops$hzn_depth, c(0.01,0.99), na.rm=TRUE)\ntot_sprops$hzn_depth = ifelse(tot_sprops$hzn_depth&lt;0, 10, ifelse(tot_sprops$hzn_depth&gt;800, 800, tot_sprops$hzn_depth))\n#hist(tot_sprops$hzn_depth, breaks=45)\n\nSummary number of points per data source:\n\nsummary(as.factor(tot_sprops$source_db))\n\n             AfSIS1              AfSPDB     Alaska_interior              BZE_LW \n               4369               68794                4011               17189 \n        Canada_CUFS         Canada_NPDB    Canada_subarctic       Chilean_SOCDB \n              15873               15297                1381               16887 \n        China_SOTER               CIFOR           CostaRica Croatian_Soil_Pedon \n               5115                 577                2037                5757 \n      CSIRO_NatSoil        Ecuador_HESD                FEBR                FRED \n              89645               30167               24353               12758 \n         GEMAS_2009       GLanCE.points               GROOT    Guatemala_GTMSOC \n               4131               50220               16271                 910 \n          Iran_SPDB               ISCND                ISDA          ISRIC_WISE \n               4859                4114               49225               37443 \n            LandPKS          LUCAS_2009          LUCAS_2015          LUCAS_2018 \n             165044               21272               21859               18982 \n        MangrovesDB         MexicoINEGI            NAMSOTER               NCSCD \n               7986               16820                2943                7348 \n    Netherlands.BIS   Portugal.INFOSOLO   Potash_et_al_2023          PRONASOLOS \n             116533                9934                3977               32615 \n          QuebecTEX        Russia_EGRPR       ScotlandNSIS1              SISLAC \n              29570                4506                3091               92121 \n      Slovenia.SPDB              SOCPDB               SoDaH        SoilHealthDB \n              11509                2416               30559                5050 \n               SRDB           USDA_NCSS            USGS.NGS          Vlaanderen \n               3337              351511                9399               41364 \n   WHRC_remnant_SOC \n               1631 \n\n\nAdd unique row identifier\n\ntot_sprops$uuid = openssl::md5(make.unique(paste(\"OpenLandMap\", tot_sprops$site_key, tot_sprops$layer_sequence, sep=\"_\")))\n\nand unique location based on the Open Location Code:\n\ntot_sprops$olc_id = olctools::encode_olc(tot_sprops$latitude_decimal_degrees, tot_sprops$longitude_decimal_degrees, 11)\nlength(levels(as.factor(tot_sprops$olc_id)))\n\n[1] 337870\n\n## 364,939\n\n\ntot_sprops.pnts = tot_sprops[!duplicated(tot_sprops$olc_id),c(\"site_key\", \"source_db\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"site_obsdate\", \"olc_id\", \"project_url\", \"citation_url\")]\ncoordinates(tot_sprops.pnts) &lt;- ~ longitude_decimal_degrees + latitude_decimal_degrees\nproj4string(tot_sprops.pnts) &lt;- \"EPSG:4326\"\n\nDensity of points per 100 x 100 km grid (IGH projection):\n\ng1 = terra::vect(\"/mnt/diskstation/data/Soil_points/tiles_GH_100km_land.gpkg\")\nov.g1 = terra::extract(g1[\"ID\"], terra::project(terra::vect(tot_sprops.pnts), crs(g1)))\ng1.c = summary(as.factor(ov.g1$ID), maxsum = length(levels(as.factor(ov.g1$ID))))\ng1.df = data.frame(count=g1.c, ID=attr(g1.c, \"names\"))\ng1$count = dplyr::left_join(data.frame(ID=g1$ID), g1.df)$count \n#plot(g1[\"count\"])\nwriteVector(g1[\"count\"], \"/mnt/diskstation/data/Soil_points/tiles_GH_100km_pnt.dens.gpkg\", overwrite=TRUE)\n\n\n\n\n\n\nDensity of points based on 100 by 100 km blocks in IGH projection.\n\n\n\n\nRemove points falling in the sea or similar:\n\n#mask = terra::rast(\"./layers1km/lcv_landmask_esacci.lc.l4_c_1km_s0..0cm_2000..2015_v1.0.tif\")\n#mask = terra::rast(\"/mnt/diskstation/data/LandGIS/layers250m/lcv_landmask_esacci.lc.l4_c_250m_s0..0cm_2000..2015_v1.0.tif\")\nmask = terra::rast(\"/mnt/diskstation/data/Soil_points/land.cover_copernicus_c_100m_s_20150101_20151231_go_epsg.4326_v3.0.1.tif\")\nov.sprops &lt;- terra::extract(mask, terra::vect(tot_sprops.pnts)) ## TAKES 1 mins\n#summary(as.factor(ov.sprops[,2]))\nif(sum(is.na(ov.sprops[,2]) | ov.sprops[,2]==200)&gt;0){\n  rem.lst = which(is.na(ov.sprops[,2]) | ov.sprops[,2]==200)\n  rem.sp = tot_sprops.pnts$site_key[rem.lst]\n  tot_sprops.pnts = tot_sprops.pnts[-rem.lst,]\n}\n## final number of unique spatial locations:\nnrow(tot_sprops.pnts)\n\n[1] 336442\n\n## 363511\n\n\n\n\nHave in mind that some datasets only represent top-soil (e.g. LUCAS) while other cover the whole soil depth, hence higher mean values for some regions (Europe) should be considered within the context of diverse soil depths.\n\nlibrary(ggplot2)\nggplot(tot_sprops, aes(x=source_db, y=log1p(organic_carbon))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 483108 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsel.db = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"Canada_NPDB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"hzn_depth\", y = \"organic_carbon\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"depth in cm\")\n\n\n\n\n\n\n\n\nNote: Canada dataset also shows SOC content for peatlands.\n\nggplot(tot_sprops, aes(x=source_db, y=bulk_density_oven_dry)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1212118 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"organic_carbon\", y = \"bulk_density_oven_dry\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, ylab=\"Bulk density\", xlab=\"SOC [g/kg]\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(oc_d))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1231449 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsel.db0 = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"organic_carbon\", y = \"oc_d\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n\n\n\n\n\n\n\n\nNote: SOC (%) and SOC density (kg/m3) are almost linear relationship (curving toward fixed value), except for organic soils (especially litter) where relationship is slightly shifted.\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"organic_carbon\", \n                     y = \"total_nitrogen_ncs\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, \n                     xlab=\"SOC [g/kg]\", ylab=\"N total [g/kg]\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=ph_h2o)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 678238 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\", \"CSIRO_NatSoil\", \"PRONASOLOS\"),], x = \"ph_kcl\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", xlab=\"soil pH KCl\", ylab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"hzn_depth\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"soil pH H2O\", xlab=\"depth in cm\")\n\n\n\n\n\n\n\n\nNote: there seems to be no apparent correlation between soil pH and soil depth.\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\"),], x = \"ph_h2o\", y = \"sum_of_cations_cec_pH_8_2\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"CEC\", xlab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"ph_h2o\", y = \"organic_carbon\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=clay_total)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 522290 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], y = \"clay_total\", x = \"sand_total\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", ylab=\"clay %\", xlab=\"sand %\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(sum_of_cations_cec_pH_8_2))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(sum_of_cations_cec_pH_8_2): NaNs produced\n\n\nWarning: Removed 1051862 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(total_nitrogen_ncs))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(total_nitrogen_ncs): NaNs produced\n\n\nWarning: Removed 988470 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(k_ext))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(k_ext): NaNs produced\n\n\nWarning: Removed 832905 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(ec_water_extractable))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1343643 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsprops_yrs = tot_sprops[!is.na(tot_sprops$site_obsdate),c(\"site_obsdate\", \"source_db\", \"organic_carbon\")]\nsprops_yrs$year = as.numeric(substr(x=sprops_yrs$site_obsdate, 1, 4))\n\nWarning: NAs introduced by coercion\n\nsprops_yrs$year = ifelse(sprops_yrs$year &lt;1960, NA, ifelse(sprops_yrs$year&gt;2024, NA, sprops_yrs$year))\n\n\nggplot(sprops_yrs, aes(x=source_db, y=year)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 157859 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(sprops_yrs[sprops_yrs$source_db %in% sel.db0,], y = \"organic_carbon\", x = \"year\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"Sampling year\")\n\n\n\n\n\n\n\n\n\n\n\nAdd layer_sequence where missing since this is needed to be able to convert to wide format:\n\n#summary(tot_sprops$layer_sequence)\ntot_sprops$dsiteid = paste(tot_sprops$source_db, tot_sprops$site_key, tot_sprops$site_obsdate, sep=\"_\")\nif(!exists(\"l.s1\")){\n  library(dplyr)\n  ## Note: takes &gt;1 mins\n  l.s1 &lt;- tot_sprops[,c(\"dsiteid\",\"hzn_depth\")] %&gt;% group_by(dsiteid) %&gt;% mutate(layer_sequence.f = data.table::frank(hzn_depth, ties.method = \"first\"))\n  tot_sprops$layer_sequence.f = ifelse(is.na(tot_sprops$layer_sequence), l.s1$layer_sequence.f, tot_sprops$layer_sequence)\n  tot_sprops$layer_sequence.f = ifelse(tot_sprops$layer_sequence.f&gt;6, 6, tot_sprops$layer_sequence.f)\n}\n\nConvert long table to wide table format so that each depth gets unique column (note: the most computational / time-consuming step usually):\n\nif(!exists(\"tot_sprops.w\")){\n  library(data.table)\n  tot_sprops.w = data.table::dcast( as.data.table(tot_sprops), \n                formula = olc_id ~ layer_sequence.f, \n                value.var = c(\"uuid\", hor.names[-which(hor.names %in% c(\"site_key\", \"layer_sequence\"))]), \n                ## \"labsampnum\", \"hzn_desgn\", \"tex_psda\" \n                #fun=function(x){ mean(x, na.rm=TRUE) }, \n                ## Note: does not work for characters\n                fun=function(x){ x[1] },\n                verbose = FALSE)\n  ## remove \"0\" layers added automatically but containing no values\n  tot_sprops.w = tot_sprops.w[,grep(\"*_0$\", colnames(tot_sprops.w)):=NULL]\n}\n\n\nAttaching package: 'data.table'\n\n\nThe following object is masked from 'package:terra':\n\n    shift\n\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n\ntot_sprops_w.pnts = tot_sprops.pnts\ntot_sprops_w.pnts@data = plyr::join(tot_sprops.pnts@data, tot_sprops.w)\n\nJoining by: olc_id\n\n\nWrite all soil profiles using a wide format:\n\nsel.rm.pnts  &lt;- tot_sprops_w.pnts$source_db==\"LUCAS_2009\" | tot_sprops_w.pnts$source_db==\"LUCAS_2015\" | tot_sprops_w.pnts$site_key %in% mng.rm | tot_sprops_w.pnts$site_key %in% rem.sp\nout.gpkg = \"./out/gpkg/sol_chem.pnts_horizons.gpkg\"\n#unlink(out.gpkg)\nif(!file.exists(out.gpkg)){\n  sf::st_write(st_as_sf(tot_sprops_w.pnts), \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_horizons.gpkg\", \"sol_chem.pnts_horizons\", driver=\"GPKG\")\n  sf::st_write(st_as_sf(tot_sprops_w.pnts[!sel.rm.pnts,]), out.gpkg, \"sol_chem.pnts_horizons\", driver=\"GPKG\")\n}\n\n\n\n\nRemove points that are not allowed to be distributed publicly:\n\nsel.rm  &lt;- tot_sprops$source_db==\"LUCAS_2009\" | tot_sprops$source_db==\"LUCAS_2015\" | tot_sprops$source_db==\"LUCAS_2018\" | tot_sprops$site_key %in% mng.rm | tot_sprops$site_key %in% rem.sp\ntot_sprops.s = tot_sprops[!sel.rm,] \n\nPlot in Goode Homolozine projection and save final objects:\n\nif(!file.exists(\"./img/sol_chem.pnts_sites.png\")){\n  tot_sprops.pnts_sf &lt;- st_as_sf(tot_sprops.pnts[1], crs=4326)\n  plot_gh(tot_sprops.pnts_sf, out.pdf=\"./img/sol_chem.pnts_sites.pdf\")\n  ## extremely slow --- takes 15mins\n  system(\"pdftoppm ./img/sol_chem.pnts_sites.pdf ./img/sol_chem.pnts_sites -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_chem.pnts_sites.png ./img/sol_chem.pnts_sites.png\")\n}\n\n\n\n\n\n\nSoil profiles and soil samples with chemical and physical properties global compilation.\n\n\n\n\n\n\n\n\n\nsaveRDS.gz(tot_sprops.s, \"./out/rds/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops.pnts, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_sites.rds\")\n#library(farff)\n#writeARFF(tot_sprops.s, \"./out/arff/sol_chem.pnts_horizons.arff\", overwrite = TRUE)\n## compressed CSV\n#write.csv(tot_sprops.s, file=gzfile(\"./out/csv/sol_chem.pnts_horizons.csv.gz\"))\n## regression matrix:\n#saveRDS.gz(rm.sol, \"./out/rds/sol_chem.pnts_horizons_rm.rds\")\n\nSave temp object:\n\nsave.image.pigz(file=\"soilchem.RData\")",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html#overview",
    "href": "025-import_chemical_data.html#overview",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "This section describes import steps used to produce a global compilation of soil laboratory data with chemical (and physical) soil properties that can be then used for predictive soil mapping / modeling at global and regional scales.\nRead more about soil chemical properties, global soil profile and sample data sets and functionality:\n\nArrouays, D., Leenaars, J. G., Richer-de-Forges, A. C., Adhikari, K., Ballabio, C., Greve, M., … & Heuvelink, G. (2017). Soil legacy data rescue via GlobalSoilMap and other international and national initiatives. GeoResJ, 14, 1-19.\nBatjes, N. H., Ribeiro, E., van Oostrum, A., Leenaars, J., Hengl, T., & de Jesus, J. M. (2017). WoSIS: providing standardised soil profile data for the world. Earth System Science Data, 9(1), 1.\nHengl, T., MacMillan, R.A., (2019). Predictive Soil Mapping with R. OpenGeoHub foundation, Wageningen, the Netherlands, 370 pages, www.soilmapper.org, ISBN: 978-0-359-30635-0.\nRossiter, D.G.,: Compendium of Soil Geographical Databases.",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html#specifications",
    "href": "025-import_chemical_data.html#specifications",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "Metadata information: “Soil Survey Investigation Report No. 42.” and “Soil Survey Investigation Report No. 45.”,\nModel DB: National Cooperative Soil Survey (NCSS) Soil Characterization Database,\n\n\n\n\n\nsite.names = c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude_decimal_degrees\", \n               \"latitude_decimal_degrees\", \"SSL_classification_name\")\nhor.names = c(\"labsampnum\", \"site_key\", \"layer_key\", \"layer_sequence\", \"hzn_top\",\"hzn_bot\", \n              \"hzn_desgn\", \"texture_description\", \"texture_lab\", \"clay_total\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n## target structure:\ncol.names = unique(c(site.names, hor.names, \"source_db\", \"confidence_degree\", \"project_url\", \"citation_url\"))\n\nTarget variables listed:\n\nclay_total: Clay, Total in % wt for &lt;2 mm soil fraction,\nsilt_total: Silt, Total in % wt for &lt;2 mm soil fraction,\nsand_total: Sand, Total in % wt for &lt;2 mm soil fraction,\norganic_carbon: Carbon, Organic in g/kg for &lt;2 mm soil fraction based on Dry combustion,\noc_d: Soil organic carbon density in kg/m3,\ntotal_carbon_ncs: Carbon, Total in g/kg for &lt;2 mm soil fraction,\ntotal_nitrogen_ncs: Nitrogen, Total NCS in g/kg for &lt;2 mm soil fraction,\nph_kcl: pH, KCl Suspension for &lt;2 mm soil fraction,\nph_h2o: pH, 1:1 Soil-Water Suspension for &lt;2 mm soil fraction,\nph_cacl2: pH, CaCl2 Suspension for &lt;2 mm soil fraction,\nsum_of_cations_cec_pH_8_2: Cation Exchange Capacity, Summary, in cmol(+)/kg for &lt;2 mm soil fraction,\ncec_nh4_ph_7: Cation Exchange Capacity, NH4 prep, in cmol(+)/kg for &lt;2 mm soil fraction,\necec_base_plus_aluminum: Cation Exchange Capacity, Effective, CMS derived value default, standa prep in cmol(+)/kg for &lt;2 mm soil fraction,\ntotal_frag_wt_pct_gt_2_mm_ws: Coarse fragments in % wt for &gt;2 mm soil fraction,\nbulk_density_oven_dry: Bulk density (Oven Dry) in g/cm3 (4A1h),\nca_ext: Calcium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nmg_ext: Magnesium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nna_ext: Sodium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nk_ext: Potassium, Extractable in mg/kg for &lt;2 mm soil fraction (usually Mehlich3),\nec_water_extractable: Electrical Conductivity, Saturation Extract in dS/m for &lt;2 mm soil fraction,\nec_predict_one_to_two: Electrical Conductivity, Predict, 1:2 (w/w) in dS/m for &lt;2 mm soil fraction,",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html#data-import",
    "href": "025-import_chemical_data.html#data-import",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "The November 2024 version contains 67,367 sites. This is the world largest open soil laboratory database to date.\n\nNational Cooperative Soil Survey, (2020). National Cooperative Soil Survey Characterization Database. Data download URL: http://ncsslabdatamart.sc.egov.usda.gov/\nNauman, T.W., Kienast‐Brown, S., Roecker, S.M., Brungard, C., White, D., Philippe, J., & Thompson, J.A. (2024). Soil landscapes of the United States (SOLUS): Developing predictive soil property maps of the conterminous United States using hybrid training sets. Soil Sci. Soc. Am. J. https://doi.org/10.1002/saj2.20769\n\nThis data set is continuously updated.\n\nif(!exists(\"chemsprops.NCSS\")){\n  #nccs.xy = terra::vect(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/ncss_labdata_locations.gpkg\")\n  #ncss.site &lt;- dplyr::bind_cols(as.data.frame(nccs.xy), geom(nccs.xy))\n  ncss.site &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/ncss_labdata_locations.csv.gz\")\n  ## Rows: 67367 Columns: 88\n  #plot(ncss.site[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  ncss.chem &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_chemical_properties.csv.gz\")\n  ## Rows: 325740 Columns: 210\n  #summary(ncss.chem$organic_carbon_walkley_black)\n  ncss.phys &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_physical_properties.csv.gz\")\n  ## Rows: 406281 Columns: 123\n  ncss.layer &lt;- vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/NCSS_lab_layer.csv.gz\")\n  ## Rows: 417656 Columns: 24\n  ncss.horizons = dplyr::full_join(dplyr::full_join(ncss.layer, ncss.phys, by = c(\"labsampnum\",\"layer_key\")), ncss.chem, by = c(\"labsampnum\",\"layer_key\"))\n  summary(ncss.horizons$estimated_organic_matter)\n  ## translate to SOC DC\n  ## https://doi.org/10.1016/j.geoderma.2021.115547\n  ## SOC = 1.3 * WBC\n  ## Wills et al., 2013 (https://doi.org/10.2136/sssaj2012.0168)\n  ## SOC  = 0.86 * WBC + 0.25, n=13,800, R2=0.93\n  ncss.horizons$organic_carbon = ifelse(ncss.horizons$organic_carbon_walkley_black &lt; 0, 0, (ncss.horizons$organic_carbon_walkley_black * 1.3) * 10)  ## g/kg\n  #ggplot(ncss.horizons, aes(organic_carbon+1)) + geom_histogram() + scale_x_log10()\n  #summary(ncss.horizons$organic_carbon)\n  ncss.horizons$bulk_density_oven_dry = ifelse(ncss.horizons$bulk_density_oven_dry &lt; 0.05 | ncss.horizons$bulk_density_oven_dry &gt; 2.4, NA, ncss.horizons$bulk_density_oven_dry)\n  #hist(ncss.horizons$bulk_density_oven_dry, col=\"grey\", breaks=40)\n  ncss.horizons$total_frag_wt_pct_gt_2_mm_ws = ifelse(ncss.horizons$total_frag_wt_pct_gt_2_mm_ws &gt; 99, NA, ncss.horizons$total_frag_wt_pct_gt_2_mm_ws)\n  ncss.horizons$oc_d = signif( ncss.horizons$organic_carbon / 1000 * ncss.horizons$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(ncss.horizons$total_frag_wt_pct_gt_2_mm_ws), 0, ncss.horizons$total_frag_wt_pct_gt_2_mm_ws))/100, 3)\n  ncss.horizons$ca_ext = signif(ncss.horizons$ca_nh4_ph_7 * 200, 4)\n  ncss.horizons$mg_ext = signif(ncss.horizons$mg_nh4_ph_7 * 121, 3)\n  ncss.horizons$na_ext = signif(ncss.horizons$na_nh4_ph_7 * 230, 3)\n  ncss.horizons$k_ext = signif(ncss.horizons$k_nh4_ph_7 * 391, 3)\n  ncss.horizons$total_nitrogen_ncs = ncss.horizons$total_nitrogen_ncs * 10\n  ## bind into single table\n  #str(which(!ncss.horizons$site_key %in% ncss.site$site_key))\n  chemsprops.NCSS = dplyr::full_join(ncss.site[,site.names], ncss.horizons[,hor.names])\n  chemsprops.NCSS$site_obsdate = format(as.Date(chemsprops.NCSS$site_obsdate, format=\"%Y/%m/%d\"), \"%Y-%m-%d\")\n  #summary(as.Date(chemsprops.NCSS$site_obsdate))\n  #summary(substr(chemsprops.NCSS$site_obsdate, 1, 4)&gt;1999 & !is.na(chemsprops.NCSS$oc_d))\n  ## ONLY 200 records &gt;1999 with SOC and BD!\n  chemsprops.NCSS$source_db = \"USDA_NCSS\"\n  #dim(chemsprops.NCSS)\n  ## 477516      36\n  chemsprops.NCSS$confidence_degree = 1\n  chemsprops.NCSS$project_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  chemsprops.NCSS$citation_url = \"http://ncsslabdatamart.sc.egov.usda.gov/\"\n  chemsprops.NCSS = complete.vars(chemsprops.NCSS, sel=c(\"hzn_top\", \"hzn_bot\", \"organic_carbon\", \"clay_total\", \"ecec_base_plus_aluminum\", \"ph_h2o\", \"ec_predict_one_to_two\", \"k_ext\"), remove.duplicates = FALSE)\n  #summary(chemsprops.NCSS$oc_d)\n  #summary(chemsprops.NCSS$organic_carbon)\n  saveRDS.gz(chemsprops.NCSS, \"/mnt/diskstation/data/Soil_points/INT/USDA_NCSS/chemsprops.NCSS.rds\")\n}\n\nNew names:\n• `` -&gt; `...1`\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 67367 Columns: 88\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (58): pedlabsampnum, upedonid, priority, priority2, samp_name, samp_clas...\ndbl (24): ...1, OBJECTID, objectid_1, pedon_key, site_key, peiid, labdatades...\nlgl  (6): SSL_taxpartsizemod, SSL_taxother, SSL_osdtypelocflag, samp_taxfamh...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 325740 Columns: 210\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (52): labsampnum, prep_code, ca_nh4_ph_7_method, mg_nh4_ph_7_method, na_...\ndbl (74): OBJECTID, objectid_1, layer_key, result_source_key, ca_nh4_ph_7, m...\nlgl (84): iron_kcl_extractable, iron_kcl_extractable_method, ph_oxidized, ph...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 406281 Columns: 123\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (20): labsampnum, prep_code, texture_lab, particle_size_method, bulk_den...\ndbl (57): OBJECTID, objectid_1, layer_key, result_source_key, clay_total, si...\nlgl (46): bulk_density_tenth_bar, bulk_density_tenth_bar_method, bulk_densit...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 417656 Columns: 24\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (10): labsampnum, layer_type, layer_field_label_1, layer_field_label_2, ...\ndbl (12): OBJECTID, objectid_1, layer_key, project_key, site_key, pedon_key,...\nlgl  (2): hzn_prime, hzn_desgn_other\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nJoining with `by = join_by(site_key)`\n\n\nWarning in dplyr::full_join(ncss.site[, site.names], ncss.horizons[, hor.names]): Detected an unexpected many-to-many relationship between `x` and `y`.\nℹ Row 1 of `x` matches multiple rows in `y`.\nℹ Row 56038 of `y` matches multiple rows in `x`.\nℹ If a many-to-many relationship is expected, set `relationship =\n  \"many-to-many\"` to silence this warning.\n\ndim(chemsprops.NCSS)\n\n[1] 352969     39\n\n## [1] 352969     39\n\n\n\n\n\nSmith, D.B., Cannon, W.F., Woodruff, L.G., Solano, Federico, Kilburn, J.E., and Fey, D.L., (2013). Geochemical and mineralogical data for soils of the conterminous United States. U.S. Geological Survey Data Series 801, 19 p., http://pubs.usgs.gov/ds/801/.\nGrossman, J. N. (2004). The National Geochemical Survey-database and documentation. U.S. Geological Survey Open-File Report 2004-1001. DOI:10.3133/ofr20041001.\nNote: NGS focuses on stream-sediment samples, but also contains many soil samples.\n\n\nif(!exists(\"chemsprops.USGS.NGS\")){\n  ngs.points &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/site.txt\", sep=\",\")\n  ## 4857 pnts\n  ngs.layers &lt;- lapply(c(\"top5cm.txt\", \"ahorizon.txt\", \"chorizon.txt\"), function(i){read.csv(paste0(\"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/\", i), sep=\",\")})\n  ngs.layers = plyr::rbind.fill(ngs.layers)\n  #dim(ngs.layers)\n  # 14571  126\n  #summary(ngs.layers$tot_carb_pct)\n  #lattice::xyplot(c_org_pct ~ c_tot_pct, ngs.layers, scales=list(x = list(log = 2), y = list(log = 2)))\n  #lattice::xyplot(c_org_pct ~ tot_clay_pct, ngs.layers, scales=list(y = list(log = 2)))\n  ngs.layers$total_carbon_ncs = ngs.layers$c_tot_pct * 10\n  ## \"The sample was combusted in an oxygen atmosphere at 1,370 ºC to oxidize C to carbon dioxide (CO2)\"\n  ngs.layers$organic_carbon = ngs.layers$c_org_pct * 10 \n  ngs.layers$hzn_top = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][1]})\n  ngs.layers$hzn_bot = sapply(ngs.layers$depth_cm, function(i){strsplit(i, \"-\")[[1]][2]})\n  #summary(ngs.layers$tot_clay_pct)\n  #summary(ngs.layers$k_pct) ## very high numbers?\n  ## question is if the geochemical element results are compatible with e.g. k_ext?\n  t.ngs = c(\"lab_id\", \"site_id\", \"horizon\", \"hzn_top\", \"hzn_bot\", \"tot_clay_pct\", \"total_carbon_ncs\", \"organic_carbon\")\n  ngs.m = plyr::join(ngs.points, ngs.layers[!is.na(ngs.layers$c_org_pct),t.ngs])\n  ngs.m$site_obsdate = as.Date(ngs.m$colldate, format=\"%Y-%m-%d\") \n  #summary(substr(ngs.m$site_obsdate, 1, 4)&gt;1999)\n  ngs.h.lst &lt;- c(\"site_id\", \"quad\", \"site_obsdate\", \"longitude\", \"latitude\", \"SSL_classification_name\", \"lab_id\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"horizon\", \"tex_psda\", \"texture_lab\", \"tot_clay_pct\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = ngs.h.lst[which(!ngs.h.lst %in% names(ngs.m))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ngs.m[,i] = NA } }\n  chemsprops.USGS.NGS = ngs.m[,ngs.h.lst]\n  chemsprops.USGS.NGS$source_db = \"USGS.NGS\"\n  chemsprops.USGS.NGS$confidence_degree = 1\n  chemsprops.USGS.NGS$project_url = \"https://mrdata.usgs.gov/ds-801/\"\n  chemsprops.USGS.NGS$citation_url = \"https://pubs.usgs.gov/ds/801/\"\n  chemsprops.USGS.NGS = complete.vars(chemsprops.USGS.NGS, sel = c(\"tot_clay_pct\", \"organic_carbon\"), coords = c(\"longitude\", \"latitude\"))\n  #summary(chemsprops.USGS.NGS$organic_carbon)\n  saveRDS.gz(chemsprops.USGS.NGS, \"/mnt/diskstation/data/Soil_points/USA/geochemical/ds-801-csv/chemsprops.USGS.NGS.rds\")\n}\n\nJoining by: site_id\n\ndim(chemsprops.USGS.NGS)\n\n[1] 9447   39\n\n## [1] 9447   39\n\n\n\n\n\nLeenaars, J. G., Van Oostrum, A. J. M., & Ruiperez Gonzalez, M. (2014). Africa soil profiles database version 1.2. A compilation of georeferenced and standardized legacy soil profile data for Sub-Saharan Africa (with dataset). Wageningen: ISRIC Report 2014/01; 2014. Data download URL: https://data.isric.org/\n\n\nif(!exists(\"chemsprops.AfSPDB\")){\n  library(foreign)\n  afspdb.profiles &lt;- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Profiles.dbf\", as.is=TRUE)\n  afspdb.layers &lt;- read.dbf(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/AfSP012Qry_Layers.dbf\", as.is=TRUE)\n  afspdb.s.lst &lt;- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\")\n  #summary(afspdb.layers$BlkDens)\n  ## add missing columns\n  for(j in 1:ncol(afspdb.layers)){ \n    if(is.numeric(afspdb.layers[,j])) { \n      afspdb.layers[,j] &lt;- ifelse(afspdb.layers[,j] &lt; 0, NA, afspdb.layers[,j]) \n    }\n  }\n  afspdb.layers$ca_ext = afspdb.layers$ExCa * 200\n  afspdb.layers$mg_ext = afspdb.layers$ExMg * 121\n  afspdb.layers$na_ext = afspdb.layers$ExNa * 230\n  afspdb.layers$k_ext = afspdb.layers$ExK * 391\n  #summary(afspdb.layers$k_ext)\n  afspdb.m = plyr::join(afspdb.profiles[,afspdb.s.lst], afspdb.layers)\n  #summary(afspdb.m$OrgC)\n  afspdb.m$oc_d = signif(afspdb.m$OrgC * afspdb.m$BlkDens * (100 - ifelse(is.na(afspdb.m$CfPc), 0, afspdb.m$CfPc))/100, 3)\n  #summary(afspdb.m$oc_d)\n  #summary(afspdb.m$T_Year)\n  afspdb.m$T_Year = ifelse(afspdb.m$T_Year &lt; 0, NA, afspdb.m$T_Year)\n  afspdb.h.lst &lt;- c(\"ProfileID\", \"FldMnl_ID\", \"T_Year\", \"X_LonDD\", \"Y_LatDD\", \"USDA\", \"LayerID\", \"LyrObj\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"texture_description\", \"LabTxtr\", \"Clay\", \"Silt\", \"Sand\", \"OrgC\", \"oc_d\", \"TotC\", \"TotalN\", \"PHKCl\", \"PHH2O\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"EC\", \"ec_12pre\")\n  x.na = afspdb.h.lst[which(!afspdb.h.lst %in% names(afspdb.m))]\n  if(length(x.na)&gt;0){ for(i in x.na){ afspdb.m[,i] = NA } }\n  chemsprops.AfSPDB = afspdb.m[,afspdb.h.lst]\n  chemsprops.AfSPDB$source_db = \"AfSPDB\"\n  chemsprops.AfSPDB$confidence_degree = 5\n  chemsprops.AfSPDB$project_url = \"https://www.isric.org/projects/africa-soil-profiles-database-afsp\"\n  chemsprops.AfSPDB$citation_url = \"https://www.isric.org/sites/default/files/isric_report_2014_01.pdf\"\n  chemsprops.AfSPDB = complete.vars(chemsprops.AfSPDB, sel = c(\"LabTxtr\",\"OrgC\",\"Clay\",\"Ecec\",\"PHH2O\",\"EC\",\"k_ext\"), coords = c(\"X_LonDD\", \"Y_LatDD\"))\n  saveRDS.gz(chemsprops.AfSPDB, \"/mnt/diskstation/data/Soil_points/AF/AfSIS_SPDB/chemsprops.AfSPDB.rds\")\n}\n\nJoining by: ProfileID\n\ndim(chemsprops.AfSPDB)\n\n[1] 68833    39\n\n## [1] 68833    39\n\n\n\n\n\nTowett, E. K., Shepherd, K. D., Tondoh, J. E., Winowiecki, L. A., Lulseged, T., Nyambura, M., … & Cadisch, G. (2015). Total elemental composition of soils in Sub-Saharan Africa and relationship with soil forming factors. Geoderma Regional, 5, 157-168. https://doi.org/10.1016/j.geodrs.2015.06.002\nAfSIS Soil Chemistry produced by World Agroforestry Centre (ICRAF), Quantitative Engineering Design (QED), Center for International Earth Science Information Network (CIESIN), The International Center for Tropical Agriculture (CIAT), Crop Nutrition Laboratory Services (CROPNUTS) and Rothamsted Research (RRES). Data download URL: https://registry.opendata.aws/afsis/\n\n\nif(!exists(\"chemsprops.AfSIS1\")){\n  afsis1.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Georeferences/georeferences.csv\")\n  afsis1.xy$Sampling.date = 2011\n  afsis1.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/2009-2013/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  afsis1.hor = plyr::rbind.fill(lapply(afsis1.lst, read.csv))\n  tansis.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Georeferences/georeferences.csv\")\n  #summary(tansis.xy$Sampling.date)\n  tansis.xy$Sampling.date = 2018\n  tansis.lst = list.files(\"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/tansis/Wet_Chemistry\", pattern=glob2rx(\"*.csv$\"), full.names = TRUE, recursive = TRUE)\n  tansis.hor = plyr::rbind.fill(lapply(tansis.lst, read.csv))\n  afsis1t.df = plyr::rbind.fill(list(plyr::join(afsis1.hor, afsis1.xy, by=\"SSN\"), plyr::join(tansis.hor, tansis.xy, by=\"SSN\")))\n  afsis1t.df$UpDpth = ifelse(afsis1t.df$Depth==\"sub\", 20, 0)\n  afsis1t.df$LowDpth = ifelse(afsis1t.df$Depth==\"sub\", 50, 20)\n  afsis1t.df$LayerNr = ifelse(afsis1t.df$Depth==\"sub\", 2, 1)\n  #summary(afsis1t.df$C...Org)\n  afsis1t.df$oc = rowMeans(afsis1t.df[,c(\"C...Org\", \"X.C\")], na.rm=TRUE) * 10\n  afsis1t.df$c_tot = afsis1t.df$Total.carbon\n  afsis1t.df$n_tot = rowMeans(afsis1t.df[,c(\"Total.nitrogen\", \"X.N\")], na.rm=TRUE) * 10\n  afsis1t.df$ph_h2o = rowMeans(afsis1t.df[,c(\"PH\", \"pH\")], na.rm=TRUE)\n  ## multiple texture fractions - which one is the total clay, sand, silt?\n  ## Clay content for water dispersed particles-recorded after 4 minutes of ultrasonication\n  #summary(afsis1t.df$Psa.w4clay)\n  #plot(afsis1t.df[,c(\"Longitude\", \"Latitude\")])\n  afsis1.h.lst &lt;- c(\"SSN\", \"Site\", \"Sampling.date\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"Soil.material\", \"layer_key\", \"LayerNr\", \"UpDpth\", \"LowDpth\", \"HorDes\", \"texture_description\", \"LabTxtr\", \"Psa.w4clay\", \"Psa.w4silt\", \"Psa.w4sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"PHKCl\", \"ph_h2o\", \"PHCaCl2\", \"CecSoil\", \"cec_nh4\", \"Ecec\", \"CfPc\" , \"BlkDens\", \"ca_ext\", \"M3.Mg\", \"M3.Na\", \"M3.K\", \"EC\", \"ec_12pre\")\n  x.na = afsis1.h.lst[which(!afsis1.h.lst %in% names(afsis1t.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ afsis1t.df[,i] = NA } }\n  chemsprops.AfSIS1 = afsis1t.df[,afsis1.h.lst]\n  chemsprops.AfSIS1$source_db = \"AfSIS1\"\n  chemsprops.AfSIS1$confidence_degree = 2\n  chemsprops.AfSIS1$project_url = \"https://registry.opendata.aws/afsis/\"\n  chemsprops.AfSIS1$citation_url = \"https://doi.org/10.1016/j.geodrs.2015.06.002\"\n  chemsprops.AfSIS1 = complete.vars(chemsprops.AfSIS1, sel = c(\"Psa.w4clay\",\"oc\",\"ph_h2o\",\"M3.K\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.AfSIS1, \"/mnt/diskstation/data/Soil_points/AF/AfSIS_SSL/chemsprops.AfSIS1.rds\")\n}\ndim(chemsprops.AfSIS1)\n\n[1] 4369   39\n\n## [1] 4369   39\n\n\n\n\n\nISDA’s repository contains open soil analysis data for the African continent: https://doi.org/10.17605/OSF.IO/A69R5 Note: Year of sampling is not specified, hence of limited use for spatiotemporal modeling.\n\n\nif(!exists(\"chemsprops.isda\")){\n  isda.xy = read.csv(\"/mnt/diskstation/data/Soil_points/AF/ISDA/iSDA_soil_data.csv\")\n  #summary(as.Date(isda.xy$end_date, format=\"%d/%m/%Y\"))\n  #summary(as.factor(isda.xy$source))\n  #library(\"ggplot2\")\n  #library(\"scales\")\n  # ggplot(isda.xy, aes(as.POSIXct(Sampling.date), ..count..)) + \n  #   geom_histogram() +\n  #   theme_bw() + xlab(NULL) +\n  #   scale_x_datetime(breaks = date_breaks(\"3 months\"),\n  #                    labels = date_format(\"%Y-%b\"),\n  #                    limits = c(as.POSIXct(\"2008-01-01\"), \n  #                               as.POSIXct(\"2020-12-31\")) )\n  #head(isda.xy)\n  #plot(isda.xy[,c(\"longitude\", \"latitude\")])\n  isda.xy$labsampnum = paste0(\"ISDA.\", 1:nrow(isda.xy))\n  isda.h.lst &lt;- c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude\", \n              \"latitude\", \"SSL_classification_name\", \"labsampnum\",\n              \"layer_key\", \"layer_sequence\", \"horizon_upper\", \n              \"horizon_lower\", \"hzn_desgn\", \"texture_description\",\n              \"texture_lab\", \"clay_total\", \"silt_total\", \"sand_total\",\n              \"carbon_organic\", \"oc_d\", \"carbon_total\", \"nitrogen_total\", \"ph_kcl\", \"ph\",\n              \"ph_cacl2\", \"sum_of_cations_cec_pH_8_2\",\n              \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \"total_frag_wt_pct_gt_2_mm_ws\",\n              \"bulk_density_oven_dry\", \"calcium_extractable\", \"magnesium_extractable\", \"sodium_extractable\",\n              \"potassium_extractable\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = isda.h.lst[which(!isda.h.lst %in% names(isda.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ isda.xy[,i] = NA } }\n  chemsprops.isda = isda.xy[,isda.h.lst]\n  chemsprops.isda$source_db = \"ISDA\"\n  chemsprops.isda$confidence_degree = 4\n  chemsprops.isda$project_url = \"https://www.isda-africa.com/\"\n  chemsprops.isda$citation_url = \"https://doi.org/10.17605/OSF.IO/A69R5\"\n  chemsprops.isda = complete.vars(chemsprops.isda, sel = c(\"carbon_organic\",\"ph\"), coords = c(\"longitude\", \"latitude\"))\n  saveRDS.gz(chemsprops.isda, \"/mnt/diskstation/data/Soil_points/AF/ISDA/chemsprops.isda.rds\")\n}\ndim(chemsprops.isda)\n\n[1] 49225    39\n\n## [1] 49225    39\n\n\n\n\n\nIversen CM, McCormack ML, Baer JK, Powell AS, Chen W, Collins C, Fan Y, Fanin N, Freschet GT, Guo D, Hogan JA, Kou L, Laughlin DC, Lavely E, Liese R, Lin D, Meier IC, Montagnoli A, Roumet C, See CR, Soper F, Terzaghi M, Valverde-Barrantes OJ, Wang C, Wright SJ, Wurzburger N, Zadworny M. (2021). Fine-Root Ecology Database (FRED): A Global Collection of Root Trait Data with Coincident Site, Vegetation, Edaphic, and Climatic Data, Version 3. Oak Ridge National Laboratory, TES SFA, U.S. Department of Energy, Oak Ridge, Tennessee, U.S.A. Access on-line at: https://doi.org/10.25581/ornlsfa.014/1459186.\n\n\nif(!exists(\"chemsprops.FRED\")){\n  Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  fred = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", skip = 10, col_names=FALSE)\n  ## 57,190 x 1,164\n  #nm.fred = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Column_Definitions_20210423-091040.csv\", header=TRUE)\n  nm.fred0 = read.csv(\"/mnt/diskstation/data/Soil_points/INT/FRED/FRED3_Entire_Database_2021.csv\", nrows=2)\n  names(fred) = make.names(t(nm.fred0)[,1])\n  ## 1164 columns!\n  #summary(fred$Soil.organic.C.content)\n  fred.h.lst = c(\"Notes_Row.ID\", \"Data.source_DOI\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"Soil.horizon\", \"Soil.texture\", \"texture_lab\", \"Soil.texture_Fraction.clay\", \"Soil.texture_Fraction.silt\", \"Soil.texture_Fraction.sand\", \"Soil.organic.C.content\", \"oc_d\", \"c_tot\", \"Soil.N.content\", \"ph_kcl\", \"Soil.pH_Water\", \"Soil.pH_Salt\", \"Soil.cation.exchange.capacity..CEC.\", \"cec_nh4\", \"Soil.effective.cation.exchange.capacity..ECEC.\", \"wpg2\", \"Soil.bulk.density\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  fred$site_obsdate = as.integer(rowMeans(fred[,c(\"Sample.collection_Year.ending.collection\", \"Sample.collection_Year.beginning.collection\")], na.rm=TRUE))\n  #summary(fred$site_obsdate)\n  fred$longitude_decimal_degrees = ifelse(is.na(fred$Longitude), fred$Longitude_Estimated, fred$Longitude)\n  fred$latitude_decimal_degrees = ifelse(is.na(fred$Latitude), fred$Latitude_Estimated, fred$Latitude)\n  #names(fred)[grep(\"Notes_Row\", names(fred))]\n  #summary(fred[,grep(\"clay\", names(fred))])\n  #summary(fred[,grep(\"cation.exchange\", names(fred))])\n  #summary(fred[,grep(\"organic.C\", names(fred))])\n  #summary(fred$Soil.organic.C.content)\n  #summary(fred$Soil.bulk.density)\n  #summary(as.factor(fred$Soil.horizon))\n  fred$hzn_bot = ifelse(is.na(fred$Soil.depth_Lower.sampling.depth), fred$Soil.depth - 5, fred$Soil.depth_Lower.sampling.depth)\n  fred$hzn_top = ifelse(is.na(fred$Soil.depth_Upper.sampling.depth), fred$Soil.depth + 5, fred$Soil.depth_Upper.sampling.depth)\n  fred$oc_d = signif(fred$Soil.organic.C.content / 1000 * fred$Soil.bulk.density * 1000, 3)\n  #summary(fred$oc_d)  \n  x.na = fred.h.lst[which(!fred.h.lst %in% names(fred))]\n  if(length(x.na)&gt;0){ for(i in x.na){ fred[,i] = NA } }\n  chemsprops.FRED = fred[,fred.h.lst]\n  #plot(chemsprops.FRED[,4:5])\n  chemsprops.FRED$source_db = \"FRED\"\n  chemsprops.FRED$confidence_degree = 5\n  chemsprops.FRED$project_url = \"https://roots.ornl.gov/\"\n  chemsprops.FRED$citation_url = \"https://doi.org/10.25581/ornlsfa.014/1459186\"\n  chemsprops.FRED = complete.vars(chemsprops.FRED, sel = c(\"Soil.organic.C.content\", \"Soil.texture_Fraction.clay\", \"Soil.pH_Water\"))\n  ## many duplicates\n  saveRDS.gz(chemsprops.FRED, \"/mnt/diskstation/data/Soil_points/INT/FRED/chemsprops.FRED.rds\")  \n}\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 57190 Columns: 1164\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (54): X3, X4, X5, X6, X7, X8, X9, X10, X11, X12, X13, X14, X15, X17, X1...\ndbl (271): X1, X2, X30, X31, X32, X35, X36, X43, X44, X45, X46, X47, X48, X4...\nlgl (839): X16, X20, X37, X38, X39, X42, X52, X53, X54, X55, X56, X57, X58, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.FRED)\n\n[1] 14537    39\n\n## [1] 14537  39\n\n\n\n\n\nGuerrero‐Ramírez, N. R., Mommer, L., Freschet, G. T., Iversen, C. M., McCormack, M. L., Kattge, J., … & Weigelt, A. (2021). Global root traits (GRooT) database. Global ecology and biogeography, 30(1), 25-37. https://dx.doi.org/10.1111/geb.13179\n\n\nif(!exists(\"chemsprops.GROOT\")){\n  #Sys.setenv(\"VROOM_CONNECTION_SIZE\" = 131072 * 2)\n  GROOT = read.csv(\"/mnt/diskstation/data/Soil_points/INT/GRooT/GRooTFullVersion.csv\")\n  ## 114,222 x 73\n  #summary(GROOT$soilCarbon)\n  #summary(!is.na(GROOT$soilCarbon))\n  #summary(GROOT$soilOrganicMatter)\n  #summary(GROOT$soilNitrogen)\n  #summary(GROOT$soilpH)\n  #summary(as.factor(GROOT$soilTexture))\n  #lattice::xyplot(soilCarbon ~ soilpH, GROOT, par.settings = list(plot.symbol = list(col=scales::alpha(\"black\", 0.6), fill=scales::alpha(\"red\", 0.6), pch=21, cex=0.6)), scales = list(y=list(log=TRUE, equispaced.log=FALSE)), ylab=\"SOC\", xlab=\"pH\")\n  GROOT$site_obsdate = as.Date(paste0(GROOT$year, \"-01-01\"), format=\"%Y-%m-%d\")\n  GROOT$hzn_top = 0\n  GROOT$hzn_bot = 30\n  GROOT.h.lst = c(\"locationID\", \"originalID\", \"site_obsdate\", \"decimalLongitud\", \"decimalLatitude\", \"SSL_classification_name\", \"GRooTID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"soilTexture\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"soilCarbon\", \"oc_d\", \"c_tot\", \"soilNitrogen\", \"ph_kcl\", \"soilpH\", \"ph_cacl2\", \"soilCationExchangeCapacity\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = GROOT.h.lst[which(!GROOT.h.lst %in% names(GROOT))]\n  if(length(x.na)&gt;0){ for(i in x.na){ GROOT[,i] = NA } }\n  chemsprops.GROOT = GROOT[,GROOT.h.lst]\n  chemsprops.GROOT$source_db = \"GROOT\"\n  chemsprops.GROOT$confidence_degree = 8\n  chemsprops.GROOT$project_url = \"https://groot-database.github.io/GRooT/\"\n  chemsprops.GROOT$citation_url = \"https://dx.doi.org/10.1111/geb.13179\"\n  chemsprops.GROOT = complete.vars(chemsprops.GROOT, sel = c(\"soilCarbon\", \"soilpH\"), coords = c(\"decimalLongitud\", \"decimalLatitude\"))\n  saveRDS.gz(chemsprops.GROOT, \"/mnt/diskstation/data/Soil_points/INT/GRooT/chemsprops.GROOT.rds\")\n}\ndim(chemsprops.GROOT)\n\n[1] 16271    39\n\n## [1] 16271  39\n\n\n\n\n\nBond-Lamberty, B. and Thomson, A. (2010). A global database of soil respiration data, Biogeosciences, 7, 1915–1926, https://doi.org/10.5194/bg-7-1915-2010\n\n\nif(!exists(\"chemsprops.SRDB\")){\n  srdb = read.csv(\"/mnt/diskstation/data/Soil_points/INT/SRDB/srdb-data.csv\")\n  ## 10366 x 85\n  srdb.h.lst = c(\"Site_ID\", \"Notes\", \"Study_midyear\", \"Longitude\", \"Latitude\",  \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psd\", \"texture_lab\", \"Soil_clay\", \"Soil_silt\", \"Soil_sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Soil_BD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  #summary(srdb$Study_midyear)\n  srdb$hzn_bot = ifelse(is.na(srdb$C_soildepth), 100, srdb$C_soildepth)\n  srdb$hzn_top = 0\n  #summary(srdb$Soil_clay)\n  #summary(srdb$C_soilmineral)\n  srdb$oc_d = signif(srdb$C_soilmineral / 1000 / (srdb$hzn_bot/100), 3)\n  #summary(srdb$oc_d) \n  #summary(srdb$Soil_BD)\n  srdb$oc = srdb$oc_d / srdb$Soil_BD\n  #summary(srdb$oc)\n  x.na = srdb.h.lst[which(!srdb.h.lst %in% names(srdb))]\n  if(length(x.na)&gt;0){ for(i in x.na){ srdb[,i] = NA } }\n  chemsprops.SRDB = srdb[,srdb.h.lst]\n  #plot(chemsprops.SRDB[,4:5])\n  chemsprops.SRDB$source_db = \"SRDB\"\n  chemsprops.SRDB$confidence_degree = 5\n  chemsprops.SRDB$project_url = \"https://github.com/bpbond/srdb/\"\n  chemsprops.SRDB$citation_url = \"https://doi.org/10.5194/bg-7-1915-2010\"\n  chemsprops.SRDB = complete.vars(chemsprops.SRDB, sel = c(\"oc\", \"Soil_clay\", \"Soil_BD\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.SRDB, \"/mnt/diskstation/data/Soil_points/INT/SRDB/chemsprops.SRDB.rds\")\n}\ndim(chemsprops.SRDB)\n\n[1] 3337   39\n\n## [1] 3337   39\n\n\n\n\n\nWieder, W. R., Pierson, D., Earl, S., Lajtha, K., Baer, S., Ballantyne, F., … & Weintraub, S. (2020). SoDaH: the SOils DAta Harmonization database, an open-source synthesis of soil data from research networks, version 1.0. Earth System Science Data Discussions, 1-19. https://doi.org/10.5194/essd-2020-195. Data download URL: https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4\nWieder, W.R., D. Pierson, S.R. Earl, K. … et al, (2020). SOils DAta Harmonization database (SoDaH): an open-source synthesis of soil data from research networks ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/9733f6b6d2ffd12bf126dc36a763e0b4 (Accessed 2024-11-19).\n\n\nif(!exists(\"chemsprops.SoDaH\")){\n  sodah.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/SoDaH/521_soils_data_harmonization_6e8416fa0c9a2c2872f21ba208e6a919.csv\")\n  #head(sodah.hor)\n  #summary(sodah.hor$coarse_frac)\n  #summary(sodah.hor$lyr_soc)\n  #summary(sodah.hor$lyr_som_WalkleyBlack/1.724)\n  #summary(as.factor(sodah.hor$observation_date))\n  sodah.hor$site_obsdate = as.integer(substr(sodah.hor$observation_date, 1, 4))\n  sodah.hor$oc = ifelse(is.na(sodah.hor$lyr_soc), sodah.hor$lyr_som_WalkleyBlack/1.724* 1.3, sodah.hor$lyr_soc) * 10 \n  sodah.hor$n_tot = sodah.hor$lyr_n_tot * 10\n  sodah.hor$oc_d = signif(sodah.hor$oc / 1000 * sodah.hor$bd_samp * 1000 * (100 - ifelse(is.na(sodah.hor$coarse_frac), 0, sodah.hor$coarse_frac))/100, 3)\n  sodah.hor$site_key = paste(sodah.hor$network, sodah.hor$location_name, sep=\"_\")\n  sodah.hor$labsampnum = make.unique(paste(sodah.hor$network, sodah.hor$location_name, sodah.hor$L1, sep=\"_\"))\n  #summary(sodah.hor$oc_d)\n  sodah.h.lst = c(\"site_key\", \"data_file\", \"observation_date\", \"long\", \"lat\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"layer_top\", \"layer_bot\", \"hzn\", \"profile_texture_class\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"coarse_frac\", \"bd_samp\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\", \"source_db\", \"confidence_degree\")\n  x.na = sodah.h.lst[which(!sodah.h.lst %in% names(sodah.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sodah.hor[,i] = NA } }\n  chemsprops.SoDaH = sodah.hor[,sodah.h.lst]\n  #plot(chemsprops.SoDaH[,4:5])\n  chemsprops.SoDaH$source_db = \"SoDaH\"\n  chemsprops.SoDaH$confidence_degree = 3\n  chemsprops.SoDaH$project_url = \"https://lter.github.io/som-website\"\n  chemsprops.SoDaH$citation_url = \"https://doi.org/10.5194/essd-2020-195\"\n  chemsprops.SoDaH = complete.vars(chemsprops.SoDaH, sel = c(\"oc\", \"clay\", \"ph_h2o\"), coords = c(\"long\", \"lat\"))\n  saveRDS.gz(chemsprops.SoDaH, \"/mnt/diskstation/data/Soil_points/INT/SoDaH/chemsprops.SoDaH.rds\")\n}\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 293592 Columns: 157\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (62): google_dir, data_file, curator_PersonName, curator_organization, ...\ndbl  (63): lat, long, elevation, map, mat, tx_start, aspect_deg, slope, npp,...\nlgl  (31): depth_water, lit_c, lit_n, lit_p, lit_cn, lit_lig, bnpp_notes, L5...\ndate  (1): modification_date\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SoDaH)\n\n[1] 55760    39\n\n## [1] 55760    39\n\n\n\n\n\nBatjes, N.H. (2019). Harmonized soil profile data for applications at global and continental scales: updates to the WISE database. Soil Use and Management 5:124–127. Data download URL: https://files.isric.org/public/wise/WD-WISE.zip\n\n\nif(!exists(\"chemsprops.WISE\")){\n  wise.site &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_SITE.csv\", stringsAsFactors = FALSE)\n  #fao.90.lst = lapply(levels(as.factor(wise.site$FAO_90)), function(i){sumcor(wise.site, \"FAO_90\", \"USCL\", i)})\n  #fao.90.uscl = do.call(rbind, fao.90.lst)\n  #write.csv(fao.90.uscl, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/correlation_FAO.90_USCL.csv\")\n  wise.s.lst &lt;- c(\"WISE3_id\", \"PITREF\", \"DATEYR\", \"LONDD\", \"LATDD\", \"USCL\")\n  wise.site$LONDD = as.numeric(wise.site$LONDD)\n  wise.site$LATDD = as.numeric(wise.site$LATDD)\n  wise.layer &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/WISE3_HORIZON.csv\", stringsAsFactors = FALSE)\n  wise.layer$ca_ext = signif(wise.layer$EXCA * 200, 4)\n  wise.layer$mg_ext = signif(wise.layer$EXMG * 121, 3)\n  wise.layer$na_ext = signif(wise.layer$EXNA * 230, 3)\n  wise.layer$k_ext = signif(wise.layer$EXK * 391, 3)\n  wise.layer$oc_d = signif(wise.layer$ORGC / 1000 * wise.layer$BULKDENS * 1000 * (100 - ifelse(is.na(wise.layer$GRAVEL), 0, wise.layer$GRAVEL))/100, 3)\n  wise.h.lst &lt;- c(\"WISE3_ID\", \"labsampnum\", \"layer_key\", \"HONU\", \"TOPDEP\", \"BOTDEP\", \"DESIG\", \"tex_psda\", \"texture_lab\", \"CLAY\", \"SILT\", \"SAND\", \"ORGC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKCL\", \"PHH2O\", \"PHCACL2\", \"CECSOIL\", \"cec_nh4\", \"ecec\", \"GRAVEL\" , \"BULKDENS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ECE\", \"ec_12pre\")\n  x.na = wise.h.lst[which(!wise.h.lst %in% names(wise.layer))]\n  if(length(x.na)&gt;0){ for(i in x.na){ wise.layer[,i] = NA } }\n  chemsprops.WISE = merge(wise.site[,wise.s.lst], wise.layer[,wise.h.lst], by.x=\"WISE3_id\", by.y=\"WISE3_ID\")\n  chemsprops.WISE$source_db = \"ISRIC_WISE\"\n  chemsprops.WISE$confidence_degree = 4\n  chemsprops.WISE$project_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"  \n  chemsprops.WISE$citation_url = \"http://dx.doi.org/10.1111/j.1475-2743.2009.00202.x\"\n  chemsprops.WISE = complete.vars(chemsprops.WISE, sel = c(\"ORGC\",\"CLAY\",\"PHH2O\",\"CECSOIL\",\"k_ext\"), coords = c(\"LONDD\", \"LATDD\"))\n  saveRDS.gz(chemsprops.WISE, \"/mnt/diskstation/data/Soil_points/INT/ISRIC_WISE/chemsprops.WISE.rds\")\n}\ndim(chemsprops.WISE)\n\n[1] 37443    39\n\n## [1] 37443    39\n\n\n\n\n\nReimann, C., Fabian, K., Birke, M., Filzmoser, P., Demetriades, A., Négrel, P., … & Anderson, M. (2018). GEMAS: Establishing geochemical background and threshold for 53 chemical elements in European agricultural soil. Applied Geochemistry, 88, 302-318. Data download URL: http://gemas.geolba.ac.at/\n\n\nif(!exists(\"chemsprops.GEMAS\")){\n  gemas.samples &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/EU/GEMAS/GEMAS.csv\", stringsAsFactors = FALSE)\n  ## GEMAS, agricultural soil, 0-20 cm, air dried, &lt;2 mm, aqua regia Data from ACME, total C, TOC, CEC, ph_CaCl2\n  gemas.samples$hzn_top = 0\n  gemas.samples$hzn_bot = 20\n  gemas.samples$oc = gemas.samples$TOC * 10\n  #summary(gemas.samples$oc)\n  gemas.samples$c_tot = gemas.samples$C_tot * 10\n  gemas.samples$site_obsdate = 2009\n  gemas.h.lst &lt;- c(\"ID\", \"COUNRTY\", \"site_obsdate\", \"XCOO\", \"YCOO\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"TYPE\", \"tex_psda\", \"texture_lab\", \"clay\", \"silt\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = gemas.h.lst[which(!gemas.h.lst %in% names(gemas.samples))]\n  if(length(x.na)&gt;0){ for(i in x.na){ gemas.samples[,i] = NA } }\n  chemsprops.GEMAS &lt;- gemas.samples[,gemas.h.lst]\n  chemsprops.GEMAS$source_db = \"GEMAS_2009\"\n  chemsprops.GEMAS$confidence_degree = 2\n  chemsprops.GEMAS$project_url = \"http://gemas.geolba.ac.at/\"\n  chemsprops.GEMAS$citation_url = \"https://doi.org/10.1016/j.apgeochem.2017.01.021\"\n  chemsprops.GEMAS = complete.vars(chemsprops.GEMAS, sel = c(\"oc\",\"clay\",\"pH_CaCl2\"), coords = c(\"XCOO\", \"YCOO\"))\n  saveRDS.gz(chemsprops.GEMAS, \"/mnt/diskstation/data/Soil_points/EU/GEMAS/chemsprops.GEMAS.rds\")\n}\ndim(chemsprops.GEMAS)\n\n[1] 4131   39\n\n## [1] 4131   39\n\n\n\n\n\nOrgiazzi, A., Ballabio, C., Panagos, P., Jones, A., & Fernández‐Ugalde, O. (2018). LUCAS Soil, the largest expandable soil dataset for Europe: a review. European Journal of Soil Science, 69(1), 140-153. Data download URL: https://esdac.jrc.ec.europa.eu/content/lucas-2009-topsoil-data\n\n\nif(!exists(\"chemsprops.LUCAS\")){\n  lucas.samples &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_TOPSOIL_v1.xlsx\", sheet = 1)\n  lucas.samples$site_obsdate &lt;- \"2009\"\n  #summary(lucas.samples$N)\n  lucas.ro &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Romania.xlsx\", sheet = 1)\n  lucas.ro$site_obsdate &lt;- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.ro))]\n  lucas.ro = plyr::rename(lucas.ro, replace=c(\"Soil.ID\"=\"sample_ID\", \"GPS_X_LONG\"=\"GPS_LONG\", \"GPS_Y_LAT\"=\"GPS_LAT\", \"pHinH2O\"=\"pH_in_H2O\", \"pHinCaCl2\"=\"pH_in_CaCl\"))\n  lucas.bu &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/Bulgaria.xlsx\", sheet = 1)\n  lucas.bu$site_obsdate &lt;- \"2012\"\n  names(lucas.samples)[which(!names(lucas.samples) %in% names(lucas.bu))]\n  #lucas.ch &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_2015_Topsoil_data_of_Switzerland-with-coordinates.xlsx_.xlsx\", sheet = 1, startRow = 2)\n  #lucas.ch = plyr::rename(lucas.ch, replace=c(\"Soil_ID\"=\"sample_ID\", \"GPS_.LAT\"=\"GPS_LAT\", \"pH.in.H2O\"=\"pH_in_H2O\", \"pH.in.CaCl2\"=\"pH_in_CaCl\", \"Calcium.carbonate/.g.kg–1\"=\"CaCO3\", \"Silt/.g.kg–1\"=\"silt\", \"Sand/.g.kg–1\"=\"sand\", \"Clay/.g.kg–1\"=\"clay\", \"Organic.carbon/.g.kg–1\"=\"OC\"))\n  ## Double readings?\n  lucas.t = plyr::rbind.fill(list(lucas.samples, lucas.ro, lucas.bu))\n  lucas.h.lst &lt;- c(\"POINT_ID\", \"usiteid\", \"site_obsdate\", \"GPS_LONG\", \"GPS_LAT\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_in_H2O\", \"pH_in_CaCl\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas.h.lst[which(!lucas.h.lst %in% names(lucas.t))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas.t[,i] = NA } }\n  chemsprops.LUCAS &lt;- lucas.t[,lucas.h.lst]\n  chemsprops.LUCAS$source_db = \"LUCAS_2009\"\n  chemsprops.LUCAS$hzn_top &lt;- 0\n  chemsprops.LUCAS$hzn_bot &lt;- 20\n  chemsprops.LUCAS$OC = ifelse(as.numeric(chemsprops.LUCAS$OC)&lt;0, 0, as.numeric(chemsprops.LUCAS$OC))\n  chemsprops.LUCAS$confidence_degree = 2\n  chemsprops.LUCAS$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS = complete.vars(chemsprops.LUCAS, sel = c(\"OC\",\"clay\",\"pH_in_H2O\"), coords = c(\"GPS_LONG\", \"GPS_LAT\"))\n  saveRDS.gz(chemsprops.LUCAS, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS.rds\")\n}\n\nWarning in ifelse(as.numeric(chemsprops.LUCAS$OC) &lt; 0, 0,\nas.numeric(chemsprops.LUCAS$OC)): NAs introduced by coercion\nWarning in ifelse(as.numeric(chemsprops.LUCAS$OC) &lt; 0, 0,\nas.numeric(chemsprops.LUCAS$OC)): NAs introduced by coercion\n\ndim(chemsprops.LUCAS)\n\n[1] 21272    39\n\n## [1] 21272    39\n\n\nif(!exists(\"chemsprops.LUCAS2\")){\n  #lucas2015.samples &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.xlsx\", sheet = 1)\n  lucas2015.v = terra::vect(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS_Topsoil_2015_20200323.shp\")\n  #head(as.data.frame(lucas2015.xy))\n  lucas2015.xy = dplyr::bind_cols(as.data.frame(lucas2015.v), geom(lucas2015.v))\n  ## https://www.aqion.de/site/130\n  ## 1 mS/m = 100 mS/cm | 1 dS/m = 1 mS/cm = 1 mS/m / 100\n  lucas2015.xy$ec_satp = lucas2015.xy$EC / 100\n  lucas2015.h.lst &lt;- c(\"Point_ID\", \"LC0_Desc\", \"site_obsdate\", \"x\", \"y\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_H20\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas2015.h.lst[which(!lucas2015.h.lst %in% names(lucas2015.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas2015.xy[,i] = NA } }\n  chemsprops.LUCAS2 &lt;- lucas2015.xy[,lucas2015.h.lst]\n  chemsprops.LUCAS2$source_db = \"LUCAS_2015\"\n  chemsprops.LUCAS2$hzn_top &lt;- 0\n  chemsprops.LUCAS2$hzn_bot &lt;- 20\n  chemsprops.LUCAS2$site_obsdate &lt;- \"2015\"\n  chemsprops.LUCAS2$confidence_degree = 2\n  chemsprops.LUCAS2$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS2$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS2 = complete.vars(chemsprops.LUCAS2, sel = c(\"OC\",\"Clay\",\"pH_H20\"), coords = c(\"x\", \"y\"))\n  saveRDS.gz(chemsprops.LUCAS2, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS2.rds\")\n}\ndim(chemsprops.LUCAS2)\n\n[1] 21859    39\n\n## [1] 21859    39\n\n\nif(!exists(\"chemsprops.LUCAS3\")){\n  lucas2018.xy &lt;- readxl::read_excel(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/LUCAS-SOIL-2018.xls\", sheet = 1)\n  rem.LOD = function(x){ as.numeric(ifelse(x==\"&lt; LOD\", 0, as.numeric(x)))}\n  lucas2018.bd = read.csv(\"/mnt/diskstation/data/Soil_points/EU/LUCAS/BulkDensity_2018_final-2.csv\")\n  lucas2018.xy$BD = dplyr::left_join(lucas2018.xy, lucas2018.bd, join_by(POINTID == POINT_ID))$BD.0.20\n  lucas2018.xy$BD = ifelse(lucas2018.xy$BD &lt; 0.04 | lucas2018.xy$BD &gt; 2.4, NA, lucas2018.xy$BD)\n  ## 1 mS/m = 100 mS/cm | 1 dS/m = 1 mS/cm = 1 mS/m / 100\n  #summary(!is.na(lucas2018.xy$`OC (20-30 cm)`))\n  lucas2018.xy$pH_H2O = as.numeric(lucas2018.xy$pH_H2O)\n  lucas2018.xy$OC = rem.LOD(lucas2018.xy$OC)\n  #summary(lucas2018.xy$OC)\n  lucas2018.xy$K = rem.LOD(lucas2018.xy$K)\n  lucas2018.xy$oc_d = signif(lucas2018.xy$OC/1000 * lucas2018.xy$BD*1000, 3)\n  #summary(lucas2018.xy$oc_d)\n  lucas2018.xy$site_obsdate = as.Date(lucas2018.xy$SURVEY_DATE, format = \"%d/%m/%y\")\n  lucas2018.xy$ec_satp = as.numeric(lucas2018.xy$EC) / 100\n  lucas2018.h.lst &lt;- c(\"Point_ID\", \"LC0_Desc\", \"site_obsdate\", \"TH_LONG\", \"TH_LAT\", \"SSL_classification_name\", \"sample_ID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"Clay\", \"Silt\", \"Sand\", \"OC\", \"oc_d\", \"c_tot\", \"N\", \"ph_kcl\", \"pH_H20\", \"pH_CaCl2\", \"CEC\", \"cec_nh4\", \"ecec\", \"coarse\", \"BD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"K\", \"ec_satp\", \"ec_12pre\")\n  x.na = lucas2018.h.lst[which(!lucas2018.h.lst %in% names(lucas2018.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ lucas2018.xy[,i] = NA } }\n  chemsprops.LUCAS3 &lt;- lucas2018.xy[,lucas2018.h.lst]\n  chemsprops.LUCAS3$source_db = \"LUCAS_2018\"\n  chemsprops.LUCAS3$hzn_top &lt;- 0\n  chemsprops.LUCAS3$hzn_bot &lt;- 20\n  chemsprops.LUCAS3$confidence_degree = 2\n  chemsprops.LUCAS3$project_url = \"https://esdac.jrc.ec.europa.eu/\"\n  chemsprops.LUCAS3$citation_url = \"https://doi.org/10.1111/ejss.12499\"\n  chemsprops.LUCAS3 = complete.vars(chemsprops.LUCAS3, sel = c(\"OC\",\"pH_H20\",\"BD\"), coords = c(\"TH_LONG\", \"TH_LAT\"))\n  saveRDS.gz(chemsprops.LUCAS3, \"/mnt/diskstation/data/Soil_points/EU/LUCAS/chemsprops.LUCAS3.rds\")\n}\n\nWarning: Expecting numeric in K15399 / R15399C11: got '&lt; LOD'\n\n\nWarning in ifelse(x == \"&lt; LOD\", 0, as.numeric(x)): NAs introduced by coercion\nWarning in ifelse(x == \"&lt; LOD\", 0, as.numeric(x)): NAs introduced by coercion\n\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.LUCAS3)\n\n[1] 18982    39\n\n## [1] 18982    39\n\n\n\n\n\nSanderman, J., Hengl, T., Fiske, G., Solvik, K., Adame, M. F., Benson, L., … & Duncan, C. (2018). A global map of mangrove forest soil carbon at 30 m spatial resolution. Environmental Research Letters, 13(5), 055002. Data download URL: https://dataverse.harvard.edu/dataset.xhtml?persistentId=doi:10.7910/DVN/OCYUIT\nMaxwell, T. L., Hengl, T., Parente, L. L., Minarik, R., Worthington, T. A., Bunting, P., … & Landis, E. (2023). Global mangrove soil organic carbon stocks dataset at 30 m resolution for the year 2020 based on spatiotemporal predictive machine learning. Data in Brief, 50, 109621. https://doi.org/10.1016/j.dib.2023.109621\n\n\nif(!exists(\"chemsprops.Mangroves\")){\n  mng.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_sites.csv\", skip=1)\n  mng.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_soc_database_v10_horizons.csv\", skip=1)\n  mng.2022 = read.csv(\"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/mangrove_C_2022_update.csv\")\n  mng.2022$CD_calc = mng.2022$OC /100 * as.numeric(mng.2022$BD_reported)\n  mng.2022.f = plyr::rename(mng.2022, replace = list(\"Year_collected\"=\"Year_sampled\", \"Longitude\"=\"Longitude_Adjusted\", \"Latitude\"=\"Latitude_Adjusted\", \"BD_reported\"=\"BD_final\", \"OC\"=\"OC_final\"))\n  mngALL = plyr::join(mng.hors, mng.profs, by=c(\"Site.name\"))\n  mngALL = plyr::rbind.fill(mngALL, mng.2022)\n  mngALL$oc = mngALL$OC_final * 10\n  mngALL$oc_d = mngALL$CD_calc * 1000\n  mngALL$hzn_top = mngALL$U_depth * 100\n  mngALL$hzn_bot = mngALL$L_depth * 100\n  mngALL$wpg2 = 0\n  #summary(mngALL$BD_reported) ## some very high values 3.26 t/m3\n  mngALL$Year = ifelse(is.na(mngALL$Year_sampled), mngALL$Years_collected, mngALL$Year_sampled)\n  mng.col = c(\"Site.name\", \"Site..\", \"Year\", \"Longitude_Adjusted\", \"Latitude_Adjusted\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD_reported\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")  \n  x.na = mng.col[which(!mng.col %in% names(mngALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ mngALL[,i] = NA } }\n  chemsprops.Mangroves = mngALL[,mng.col]\n  chemsprops.Mangroves$source_db = \"MangrovesDB\"\n  chemsprops.Mangroves$confidence_degree = 4\n  chemsprops.Mangroves$project_url = \"http://maps.oceanwealth.org/mangrove-restoration/\"\n  chemsprops.Mangroves$citation_url = \"https://doi.org/10.1088/1748-9326/aabe1c\"\n  chemsprops.Mangroves = complete.vars(chemsprops.Mangroves, sel = c(\"oc\",\"BD_reported\"), coords = c(\"Longitude_Adjusted\", \"Latitude_Adjusted\"))\n  #head(chemsprops.Mangroves)\n  mng.rm = chemsprops.Mangroves$Site.name[chemsprops.Mangroves$Site.name %in% mngALL$Site.name[grep(\"N\", mngALL$OK.to.release., ignore.case = FALSE)]]\n  saveRDS.gz(chemsprops.Mangroves, \"/mnt/diskstation/data/Soil_points/INT/TNC_mangroves/chemsprops.Mangroves.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.Mangroves)\n\n[1] 7987   39\n\n## [1] 7987   39\n\n\n\n\nPeatland soil measurements (points) from the literature described in:\n\nMurdiyarso, D., Roman-Cuesta, R. M., Verchot, L. V., Herold, M., Gumbricht, T., Herold, N., & Martius, C. (2017). New map reveals more peat in the tropics (Vol. 189). CIFOR. https://doi.org/10.17528/cifor/006452\n\n\nif(!exists(\"chemsprops.Peatlands\")){\n  cif.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/SOC_literature_CIFOR_v1.csv\")\n  #summary(cif.hors$BD..g.cm..)\n  #summary(cif.hors$SOC)\n  #summary(cif.hors$TOC.content....)\n  #summary(!is.na(cif.hors$modelling.x))\n  cif.hors$oc = cif.hors$SOC * 10\n  cif.hors$wpg2 = 0\n  cif.hors$c_tot = cif.hors$TOC.content.... * 10\n  cif.hors$oc_d = cif.hors$C.density..kg.C.m..\n  cif.hors$site_obsdate = as.integer(substr(cif.hors$year, 1, 4))-1\n  cif.hors$SSL_classification_name = ifelse(cif.hors$TAXNUSDA==\"\", paste(cif.hors$TAXOUSDA), paste(cif.hors$TAXNUSDA))\n  #summary(as.factor(cif.hors$SSL_classification_name))\n  cif.col = c(\"SOURCEID\", \"usiteid\", \"site_obsdate\", \"modelling.x\", \"modelling.y\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Upper\", \"Lower\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BD..g.cm..\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cif.col[which(!cif.col %in% names(cif.hors))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cif.hors[,i] = NA } }\n  chemsprops.Peatlands = cif.hors[,cif.col]\n  chemsprops.Peatlands$source_db = \"CIFOR\"\n  chemsprops.Peatlands$confidence_degree = 4\n  chemsprops.Peatlands$project_url = \"https://www.cifor.org/\"\n  chemsprops.Peatlands$citation_url = \"https://doi.org/10.17528/cifor/006452\"\n  chemsprops.Peatlands = complete.vars(chemsprops.Peatlands, sel = c(\"oc\", \"BD..g.cm..\", \"SSL_classification_name\", \"c_tot\"), coords = c(\"modelling.x\", \"modelling.y\"))\n  saveRDS.gz(chemsprops.Peatlands, \"/mnt/diskstation/data/Soil_points/INT/CIFOR_peatlands/chemsprops.Peatlands.rds\")\n}\ndim(chemsprops.Peatlands)\n\n[1] 2968   39\n\n## [1] 2968  39\n\n\n\n\n\nHerrick, J. E., Urama, K. C., Karl, J. W., Boos, J., Johnson, M. V. V., Shepherd, K. D., … & Kosnik, C. (2013). The Global Land-Potential Knowledge System (LandPKS): Supporting Evidence-based, Site-specific Land Use and Management through Cloud Computing, Mobile Applications, and Crowdsourcing. Journal of Soil and Water Conservation, 68(1), 5A-12A. Data download URL: http://portal.landpotential.org/#/landpksmap\n\n\n\n\n\n\nLandPKS sites in 2024.\n\n\n\n\n\nif(!exists(\"chemsprops.LandPKS\")){\n  pks = plyr::rbind.fill(\n            vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/LandPKS/Export_LandInfo_Data_1.csv\"), \n            vroom::vroom(\"/mnt/diskstation/data/Soil_points/INT/LandPKS/Export_LandInfo_Data_2.csv\"))\n  #str(pks)\n  ## 55483 obs. of  52 variables\n  #summary(as.factor(pks$BedrockDepth))\n  pks.hor = data.frame(rock_fragments = \n                         c(pks$`RockFragments0-1cm`,\n                           pks$`RockFragments1-10cm`,\n                           pks$`RockFragments10-20cm`,\n                           pks$`RockFragments20-50cm`,\n                           pks$`RockFragments50-70cm`,\n                           pks$`RockFragments70-100cm`,\n                           pks$`RockFragments100-120cm`), \n                       tex_field = \n                         c(pks$`Texture0-1cm`, \n                           pks$`Texture1-10cm`, \n                           pks$`Texture10-20cm`, \n                           pks$`Texture20-50cm`, \n                           pks$`Texture50-70cm`, \n                           pks$`Texture70-100cm`, \n                           pks$`Texture100-120cm`))\n  pks.hor$hzn_top = c(rep(0, nrow(pks)), \n                      rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)))\n  pks.hor$hzn_bot = c(rep(1, nrow(pks)), \n                      rep(10, nrow(pks)), \n                      rep(20, nrow(pks)), \n                      rep(50, nrow(pks)), \n                      rep(70, nrow(pks)), \n                      rep(100, nrow(pks)), \n                      rep(120, nrow(pks)))\n  pks.hor$longitude_decimal_degrees = rep(as.numeric(pks$Longitude), 7)\n  pks.hor$latitude_decimal_degrees = rep(as.numeric(pks$Latitude), 7)\n  pks.hor$depth_bedrock = rep(as.numeric(pks$BedrockDepth), 7)\n  pks.hor$site_obsdate = rep(pks$DateCreated_GMT, 7)\n  pks.hor$site_key = rep(pks$ID, 7)\n  #summary(as.factor(pks.hor$tex_field))\n  tex.tr = data.frame(tex_field=c(\"CLAY\", \"CLAY LOAM\", \"LOAM\", \"LOAMY SAND\", \"SAND\", \"SANDY CLAY\", \"SANDY CLAY LOAM\", \"SANDY LOAM\", \"SILT LOAM\", \"SILTY CLAY\", \"SILTY CLAY LOAM\"), \n                      clay_tot_psa=c(62.4, 34.0, 19.0, 5.8, 3.3, 41.7, 27.0, 10.0, 13.1, 46.7, 34.0), \n                      silt_tot_psa=c(17.8, 34.0, 40.0, 12.0, 5.0, 6.7, 13.0, 25.0, 65.7, 46.7, 56.0), \n                      sand_tot_psa=c(19.8, 32.0, 41.0, 82.2, 91.7, 51.6, 60.0, 65.0, 21.2, 6.7, 10.0))\n  pks.hor$clay_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$clay_tot_psa\n  pks.hor$silt_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$silt_tot_psa\n  pks.hor$sand_tot_psa = plyr::join(pks.hor[\"tex_field\"], tex.tr)$sand_tot_psa\n  #summary(as.factor(pks.hor$rock_fragments))\n  pks.hor$wpg2 = ifelse(pks.hor$rock_fragments==\"&gt;60%\", 65, ifelse(pks.hor$rock_fragments==\"35-60%\", 47.5, ifelse(pks.hor$rock_fragments==\"15-35%\", 25, ifelse(pks.hor$rock_fragments==\"1-15%\" | pks.hor$rock_fragments==\"0-15%\", 5, ifelse(pks.hor$rock_fragments==\"0-1%\", 0.5, NA)))))\n  #head(pks.hor)\n  ## very shallow or very rocky soils\n  pks.hor$oc = ifelse(pks.hor$depth_bedrock&lt;10 | pks.hor$rock_fragments &gt; 60, 0.5, NA)\n  pks.col = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\",\"hzn_top\",\"hzn_bot\",\"hzn_desgn\", \"tex_field\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = pks.col[which(!pks.col %in% names(pks.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ pks.hor[,i] = NA } }\n  chemsprops.LandPKS = pks.hor[,pks.col]\n  chemsprops.LandPKS$source_db = \"LandPKS\"\n  chemsprops.LandPKS$confidence_degree = 8\n  chemsprops.LandPKS$project_url = \"http://portal.landpotential.org\"\n  chemsprops.LandPKS$citation_url = \"https://doi.org/10.2489/jswc.68.1.5A\"\n  chemsprops.LandPKS = complete.vars(chemsprops.LandPKS, sel = c(\"clay_tot_psa\",\"wpg2\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))\n  #plot(chemsprops.LandPKS[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")], pch=\"+\")\n  saveRDS.gz(chemsprops.LandPKS, \"/mnt/diskstation/data/Soil_points/INT/LandPKS/chemsprops.LandPKS.rds\")\n}\n\nRows: 23973 Columns: 52\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (52): ID, Name, RecorderName, Latitude, Longitude, DateCreated_GMT, Land...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 31510 Columns: 52\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (46): Name, RecorderName, LandUse, GrazingAnimals, Flooding, Slope, Slo...\ndbl   (4): ID, Latitude, Longitude, BedrockDepth\nlgl   (1): Grazed\ndttm  (1): DateCreated_GMT\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n\nJoining by: tex_field\nJoining by: tex_field\nJoining by: tex_field\n\ndim(chemsprops.LandPKS)\n\n[1] 165044     39\n\n## [1] 165044    39\n\n\n\n\n\nRussian Federation: The Unified State Register of Soil Resources (EGRPR). Data download URL: http://egrpr.esoil.ru/content/1DB.html Note: these are only historic data and it is not clear if the locations are synthetic or actual soil profiles.\n\n\nif(!exists(\"chemsprops.EGRPR\")){\n  russ.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Russia/EGRPR/Russia_EGRPR_soil_pedons.csv\")\n  russ.HOR$SOURCEID = paste(russ.HOR$CardID, russ.HOR$SOIL_ID, sep=\"_\")\n  russ.HOR$wpg2 = russ.HOR$TEXTSTNS\n  russ.HOR$SNDPPT &lt;- russ.HOR$TEXTSAF + russ.HOR$TEXSCM\n  russ.HOR$SLTPPT &lt;- russ.HOR$TEXTSIC + russ.HOR$TEXTSIM + 0.8 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  russ.HOR$CLYPPT &lt;- russ.HOR$TEXTCL + 0.2 * ifelse(is.na(russ.HOR$TEXTSIF), 0, russ.HOR$TEXTSIF)\n  ## Correct texture fractions:\n  sumTex &lt;- rowSums(russ.HOR[,c(\"SLTPPT\",\"CLYPPT\",\"SNDPPT\")])\n  russ.HOR$SNDPPT &lt;- russ.HOR$SNDPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$SLTPPT &lt;- russ.HOR$SLTPPT / ((sumTex - russ.HOR$CLYPPT) /(100 - russ.HOR$CLYPPT))\n  russ.HOR$oc &lt;- rowMeans(data.frame(x1=russ.HOR$CORG * 10, x2=russ.HOR$ORGMAT/1.724 * 10), na.rm=TRUE)\n  russ.HOR$oc_d = signif(russ.HOR$oc / 1000 * russ.HOR$DVOL * 1000 * (100 - ifelse(is.na(russ.HOR$wpg2), 0, russ.HOR$wpg2))/100, 3)\n  russ.HOR$n_tot &lt;- russ.HOR$NTOT * 10\n  russ.HOR$ca_ext = russ.HOR$EXCA * 200\n  russ.HOR$mg_ext = russ.HOR$EXMG * 121\n  russ.HOR$na_ext = russ.HOR$EXNA * 230\n  russ.HOR$k_ext = russ.HOR$EXK * 391\n  ## Sampling year not available but with high confidence &lt;2000\n  russ.HOR$site_obsdate = \"1982\"\n  russ.sel.h &lt;- c(\"SOURCEID\", \"SOIL_ID\", \"site_obsdate\", \"LONG\", \"LAT\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HORNMB\", \"HORTOP\", \"HORBOT\", \"HISMMN\", \"tex_psda\", \"texture_lab\", \"CLYPPT\", \"SLTPPT\", \"SNDPPT\", \"oc\", \"oc_d\", \"c_tot\", \"NTOT\", \"PHSLT\", \"PHH2O\", \"ph_cacl2\", \"CECST\", \"cec_nh4\", \"ecec\", \"wpg2\", \"DVOL\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = russ.sel.h[which(!russ.sel.h %in% names(russ.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ russ.HOR[,i] = NA } }\n  chemsprops.EGRPR = russ.HOR[,russ.sel.h]\n  chemsprops.EGRPR$source_db = \"Russia_EGRPR\"\n  chemsprops.EGRPR$confidence_degree = 5\n  chemsprops.EGRPR$project_url = \"http://egrpr.esoil.ru/\"\n  chemsprops.EGRPR$citation_url = \"https://doi.org/10.19047/0136-1694-2016-86-115-123\"\n  chemsprops.EGRPR &lt;- complete.vars(chemsprops.EGRPR, sel=c(\"oc\", \"CLYPPT\"), coords = c(\"LONG\", \"LAT\"))\n  saveRDS.gz(chemsprops.EGRPR, \"/mnt/diskstation/data/Soil_points/Russia/EGRPR/chemsprops.EGRPR.rds\")\n}\ndim(chemsprops.EGRPR)\n\n[1] 4506   39\n\n## [1] 4506   39\n\n\n\n\n\nAgriculture and Agri-Food Canada National Pedon Database. Data download URL: https://open.canada.ca/data/en/\n\n\nif(!exists(\"chemsprops.NPDB\")){\n  NPDB.nm = c(\"NPDB_V2_sum_source_info.csv\",\"NPDB_V2_sum_chemical.csv\", \"NPDB_V2_sum_horizons_raw.csv\", \"NPDB_V2_sum_physical.csv\")\n  NPDB.HOR = plyr::join_all(lapply(paste0(\"/mnt/diskstation/data/Soil_points/Canada/NPDB/\", NPDB.nm), read.csv), type = \"full\")\n  NPDB.HOR$HISMMN = paste0(NPDB.HOR$HZN_MAS, NPDB.HOR$HZN_SUF, NPDB.HOR$HZN_MOD)\n  NPDB.HOR$CARB_ORG[NPDB.HOR$CARB_ORG==9] &lt;- NA\n  NPDB.HOR$N_TOTAL[NPDB.HOR$N_TOTAL==9] &lt;- NA\n  NPDB.HOR$oc = NPDB.HOR$CARB_ORG * 10\n  NPDB.HOR$oc_d = signif(NPDB.HOR$oc / 1000 * NPDB.HOR$BULK_DEN * 1000 * (100 - ifelse(is.na(NPDB.HOR$VC_SAND), 0, NPDB.HOR$VC_SAND))/100, 3)\n  NPDB.HOR$ca_ext = NPDB.HOR$EXCH_CA * 200\n  NPDB.HOR$mg_ext = NPDB.HOR$EXCH_MG * 121\n  NPDB.HOR$na_ext = NPDB.HOR$EXCH_NA * 230\n  NPDB.HOR$k_ext = NPDB.HOR$EXCH_K * 391\n  npdb.sel.h = c(\"PEDON_ID\", \"usiteid\", \"CAL_YEAR\", \"DD_LONG\", \"DD_LAT\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"U_DEPTH\", \"L_DEPTH\", \"HISMMN\", \"tex_psda\", \"texture_lab\", \"T_CLAY\", \"T_SILT\", \"T_SAND\", \"oc\", \"oc_d\", \"c_tot\", \"N_TOTAL\", \"ph_kcl\", \"PH_H2O\", \"PH_CACL2\", \"CEC\", \"cec_nh4\", \"ecec\", \"VC_SAND\", \"BULK_DEN\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = npdb.sel.h[which(!npdb.sel.h %in% names(NPDB.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ NPDB.HOR[,i] = NA } }\n  chemsprops.NPDB = NPDB.HOR[,npdb.sel.h]\n  chemsprops.NPDB$source_db = \"Canada_NPDB\"\n  chemsprops.NPDB$confidence_degree = 2\n  chemsprops.NPDB$project_url = \"https://open.canada.ca/data/en/\"\n  chemsprops.NPDB$citation_url = \"https://open.canada.ca/data/en/dataset/6457fad6-b6f5-47a3-9bd1-ad14aea4b9e0\"\n  chemsprops.NPDB &lt;- complete.vars(chemsprops.NPDB, sel=c(\"oc\", \"PH_H2O\", \"T_CLAY\"), coords = c(\"DD_LONG\", \"DD_LAT\"))\n  saveRDS.gz(chemsprops.NPDB, \"/mnt/diskstation/data/Soil_points/Canada/NPDB/chemsprops.NPDB.rds\")\n}\n\nJoining by: PEDON_ID\n\n\nJoining by: PEDON_ID, LAYER_ID, U_DEPTH, L_DEPTH\nJoining by: PEDON_ID, LAYER_ID, U_DEPTH, L_DEPTH\n\ndim(chemsprops.NPDB)\n\n[1] 16405    39\n\n## [1] 16405    39\n\n\n\n\n\nShaw, C., Hilger, A., Filiatrault, M., & Kurz, W. (2018). A Canadian upland forest soil profile and carbon stocks database. Ecology, 99(4), 989-989. Data download URL: https://esajournals.onlinelibrary.wiley.com/action/downloadSupplement?doi=10.1002%2Fecy.2159&file=ecy2159-sup-0001-DataS1.zip\n\n*Organic horizons have negative values, the first mineral soil horizon has a value of 0 cm, and other mineral soil horizons have positive values. This needs to be corrected before the values can be bind with other international sets.\n\nif(!exists(\"chemsprops.CUFS\")){\n  ## Reading of the .dat file was tricky \n  cufs.HOR = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/PROFILES.csv\", stringsAsFactors = FALSE)\n  cufs.HOR$LOWER_HZN_LIMIT =cufs.HOR$UPPER_HZN_LIMIT + cufs.HOR$HZN_THICKNESS\n  ## Correct depth (Canadian data can have negative depths for soil horizons):\n  z.min.cufs &lt;- ddply(cufs.HOR, .(LOCATION_ID), summarize, aggregated = min(UPPER_HZN_LIMIT, na.rm=TRUE))\n  z.shift.cufs &lt;- join(cufs.HOR[\"LOCATION_ID\"], z.min.cufs, type=\"left\")$aggregated\n  ## fixed shift\n  z.shift.cufs &lt;- ifelse(z.shift.cufs&gt;0, 0, z.shift.cufs)\n  cufs.HOR$hzn_top &lt;- cufs.HOR$UPPER_HZN_LIMIT - z.shift.cufs\n  cufs.HOR$hzn_bot &lt;- cufs.HOR$LOWER_HZN_LIMIT - z.shift.cufs\n  cufs.SITE = read.csv(\"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/SITES.csv\", stringsAsFactors = FALSE)\n  #str(cufs.SITE)\n  can.tbl = read.csv(\"./correlation/soil_types_correlation_table_Canada.csv\")\n  cufs.SITE$SSL_classification_name = dplyr::left_join(cufs.SITE[\"GGSG\"], can.tbl, by=c(\"GGSG\"=\"CSSC_Class\"))$TAXOUSDA\n  cufs.HOR$longitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LONGITUDE\n  cufs.HOR$latitude_decimal_degrees = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$LATITUDE\n  cufs.HOR$site_obsdate = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$YEAR_SAMPLED\n  cufs.HOR$usiteid = plyr::join(cufs.HOR[\"LOCATION_ID\"], cufs.SITE)$RELEASE_SOURCE_SITEID\n  #summary(cufs.HOR$ORG_CARB_PCT)\n  #hist(cufs.HOR$ORG_CARB_PCT, breaks=45)\n  cufs.HOR$oc = cufs.HOR$ORG_CARB_PCT*10\n  #cufs.HOR$c_tot = cufs.HOR$oc + ifelse(is.na(cufs.HOR$CARBONATE_CARB_PCT), 0, cufs.HOR$CARBONATE_CARB_PCT*10)\n  cufs.HOR$n_tot = cufs.HOR$TOT_NITRO_PCT*10\n  cufs.HOR$ca_ext = cufs.HOR$EXCH_Ca * 200\n  cufs.HOR$mg_ext = cufs.HOR$EXCH_Mg * 121\n  cufs.HOR$na_ext = cufs.HOR$EXCH_Na * 230\n  cufs.HOR$k_ext = cufs.HOR$EXCH_K * 391\n  cufs.HOR$ph_cacl2 = cufs.HOR$pH\n  cufs.HOR$ph_cacl2[!cufs.HOR$pH_H2O_CACL2==\"CACL2\"] = NA\n  cufs.HOR$ph_h2o = cufs.HOR$pH\n  cufs.HOR$ph_h2o[!cufs.HOR$pH_H2O_CACL2==\"H2O\"] = NA\n  #summary(cufs.HOR$CF_VOL_PCT) ## is NA == 0??\n  cufs.HOR$wpg2 = ifelse(cufs.HOR$CF_CORR_FACTOR==1, 0, cufs.HOR$CF_VOL_PCT)\n  cufs.HOR$oc_d = signif(cufs.HOR$oc / 1000 * cufs.HOR$BULK_DENSITY * 1000 * (100 - ifelse(is.na(cufs.HOR$wpg2), 0, cufs.HOR$wpg2))/100, 3)\n  cufs.sel.h = c(\"LOCATION_ID\", \"usiteid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HZN_SEQ_NO\", \"hzn_top\", \"hzn_bot\", \"HORIZON\", \"TEXT_CLASS\", \"texture_lab\", \"CLAY_PCT\", \"SILT_PCT\", \"SAND_PCT\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"CEC_CALCULATED\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK_DENSITY\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELEC_COND\", \"ec_12pre\")\n  x.na = cufs.sel.h[which(!cufs.sel.h %in% names(cufs.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cufs.HOR[,i] = NA } }\n  chemsprops.CUFS = cufs.HOR[,cufs.sel.h]\n  chemsprops.CUFS$source_db = \"Canada_CUFS\"\n  chemsprops.CUFS$confidence_degree = 1\n  chemsprops.CUFS$project_url = \"https://cfs.nrcan.gc.ca/publications/centre/nofc\"\n  chemsprops.CUFS$citation_url = \"https://doi.org/10.1002/ecy.2159\"\n  chemsprops.CUFS &lt;- complete.vars(chemsprops.CUFS, sel=c(\"oc\", \"ph_h2o\", \"CLAY_PCT\"))\n  saveRDS.gz(chemsprops.CUFS, \"/mnt/diskstation/data/Soil_points/Canada/CUFSDB/chemsprops.CUFS.rds\")\n}\n\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\nJoining by: LOCATION_ID\n\ndim(chemsprops.CUFS)\n\n[1] 15873    39\n\n## [1] 15873    39\n\n\n\n\n\nEstop-Aragones, C.; Fisher, J.P.; Cooper, M.A.; Thierry, A.; Treharne, R.; Murton, J.B.; Phoenix, G.K.; Charman, D.J.; Williams, M.; Hartley, I.P. (2016). Bulk density, carbon and nitrogen content in soil profiles from permafrost in subarctic Canada. NERC Environmental Information Data Centre. https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952. Data download URL:\n\n\nif(!exists(\"chemsprops.CAPERM\")){\n  caperm.HOR = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Canada/NorthCanada/Bulk_density_CandNcontent_profiles_all_sites.csv\")\n  #measurements::conv_unit(\"-99 36 15.7\", from = \"deg_min_sec\", to = \"dec_deg\")\n  #caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", gsub('\\\"W', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_West, \"UTF-8\", \"UTF-8\", sub=' ')), fixed = TRUE)), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$longitude_decimal_degrees = as.numeric(measurements::conv_unit(paste0(\"-\", caperm.HOR$Cordinates_West), from = \"deg_min_sec\", to = \"dec_deg\"))\n  #caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(gsub('\\\"N', '', gsub('o', '', gsub(\"'\", ' ', iconv(caperm.HOR$Coordinates_North, \"UTF-8\", \"UTF-8\", sub=' '))), fixed = TRUE), from = \"deg_min_sec\", to = \"dec_deg\"))\n  caperm.HOR$latitude_decimal_degrees = as.numeric(measurements::conv_unit(caperm.HOR$Cordinates_North, from = \"deg_min_sec\", to = \"dec_deg\"))\n  #plot(caperm.HOR[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")])\n  caperm.HOR$site_obsdate = \"2013\"\n  caperm.HOR$site_key = make.unique(caperm.HOR$Soil.core)\n  #summary(as.factor(caperm.HOR$Soil_depth_cm))\n  caperm.HOR$hzn_top = caperm.HOR$Soil_depth_cm-1\n  caperm.HOR$hzn_bot = caperm.HOR$Soil_depth_cm+1\n  caperm.HOR$bulk_density_oven_dry = caperm.HOR$Bulk_density_gdrysoil_cm3wetsoil\n  caperm.HOR$organic_carbon = caperm.HOR$Ccontent_percentage_on_drymass * 10\n  caperm.HOR$total_nitrogen_ncs = caperm.HOR$Ncontent_percentage_on_drymass * 10\n  caperm.HOR$oc_d = signif(caperm.HOR$organic_carbon / 1000 * caperm.HOR$bulk_density_oven_dry * 1000, 3)\n  x.na = col.names[which(!col.names %in% names(caperm.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ caperm.HOR[,i] = NA } }\n  chemsprops.CAPERM = caperm.HOR[,col.names]\n  chemsprops.CAPERM$source_db = \"Canada_subarctic\"\n  chemsprops.CAPERM$confidence_degree = 2\n  chemsprops.CAPERM$project_url = \"http://arp.arctic.ac.uk/projects/carbon-cycling-linkages-permafrost-systems-cyclops/\"\n  chemsprops.CAPERM$citation_url = \"https://doi.org/10.5285/efa2a84b-3505-4221-a7da-12af3cdc1952\"\n  chemsprops.CAPERM &lt;- complete.vars(chemsprops.CAPERM, sel=c(\"organic_carbon\", \"total_nitrogen_ncs\"))\n  saveRDS.gz(chemsprops.CAPERM, \"/mnt/diskstation/data/Soil_points/Canada/NorthCanada/chemsprops.CAPERM.rds\")\n}\n\nRows: 2931 Columns: 10\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (6): Soil.core, Remarks, soil.type_Org_Min_Blend_Rock, Cordinates_North,...\ndbl (4): Soil_depth_cm, Bulk_density_gdrysoil_cm3wetsoil, Ncontent_percentag...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.CAPERM)\n\n[1] 1381   39\n\n## [1] 1381   39\n\n\n\n\n\nDijkshoorn, K., van Engelen, V., & Huting, J. (2008). Soil and landform properties for LADA partner countries. ISRIC report 2008/06 and GLADA report 2008/03, ISRIC – World Soil Information and FAO, Wageningen. Data download URL: https://files.isric.org/public/soter/CN-SOTER.zip\n\n\nif(!exists(\"chemsprops.CNSOTER\")){\n  sot.sites = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Profile.csv\")\n  st.cor = read.csv('./correlation/soil_type_correlation_ISRIC_WISE.csv')\n  sot.sites$SSL_classification_name = paste0( dplyr::left_join(sot.sites[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90\"), multiple = \"first\")$Class_1, \" / \",\n                       dplyr::left_join(sot.sites[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90\"), multiple = \"first\")$Class_2)           \n  #summary(as.factor(sot.sites$SSL_classification_name))\n  sot.horizons = read.csv(\"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/CHINA_SOTERv1_Horizon.csv\")\n  sot.HOR = plyr::join_all(list(sot.sites, sot.horizons), type = \"full\")\n  sot.HOR$oc = sot.HOR$SOCA * 10\n  sot.HOR$ca_ext = sot.HOR$EXCA * 200\n  sot.HOR$mg_ext = sot.HOR$EXMG * 121\n  sot.HOR$na_ext = sot.HOR$EXNA * 230\n  sot.HOR$k_ext = sot.HOR$EXCK * 391\n  ## upper depth missing needs to be derived manually\n  sot.HOR$hzn_top = NA\n  sot.HOR$hzn_top[2:nrow(sot.HOR)] &lt;- sot.HOR$HBDE[1:(nrow(sot.HOR)-1)]\n  sot.HOR$hzn_top &lt;- ifelse(sot.HOR$hzn_top &gt; sot.HOR$HBDE, 0, sot.HOR$hzn_top)\n  sot.HOR$hzn_top &lt;- ifelse(sot.HOR$HONU==1 & is.na(sot.HOR$hzn_top), 0, sot.HOR$hzn_top)\n  sot.HOR$oc_d = signif(sot.HOR$oc / 1000 * sot.HOR$BULK * 1000 * (100 - ifelse(is.na(sot.HOR$SDVC), 0, sot.HOR$SDVC))/100, 3)\n  sot.sel.h = c(\"PRID\", \"PDID\", \"SAYR\", \"LNGI\", \"LATI\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HONU\", \"hzn_top\",  \"HBDE\", \"HODE\", \"PSCL\", \"texture_lab\", \"CLPC\", \"STPC\", \"SDTO\", \"oc\", \"oc_d\", \"TOTC\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"SDVC\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = sot.sel.h[which(!sot.sel.h %in% names(sot.HOR))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sot.HOR[,i] = NA } }\n  chemsprops.CNSOT = sot.HOR[,sot.sel.h]\n  chemsprops.CNSOT$source_db = \"China_SOTER\"\n  chemsprops.CNSOT$confidence_degree = 8\n  chemsprops.CNSOT$project_url = \"https://www.isric.org/explore/soter\"\n  chemsprops.CNSOT$citation_url = \"https://isric.org/sites/default/files/isric_report_2008_06.pdf\"\n  chemsprops.CNSOT &lt;- complete.vars(chemsprops.CNSOT, sel=c(\"TOTC\", \"PHAQ\", \"CLPC\"), coords = c(\"LNGI\", \"LATI\"))\n  saveRDS.gz(chemsprops.CNSOT, \"/mnt/diskstation/data/Soil_points/China/China_SOTERv1/chemsprops.CNSOT.rds\")\n}\n\nJoining by: PRID, INFR\n\ndim(chemsprops.CNSOT)\n\n[1] 5115   39\n\n## [1] 5115   39\n\n\n\n\n\nDíaz-Guadarrama, S., Varón-Ramírez, V. M., Lizarazo, I., Guevara, M., Angelini, M., Araujo-Carrillo, G. A., … & Rubiano, Y. (2024). Improving the Latin America and Caribbean Soil Information System (SISLAC) database enhances its usability and scalability. Earth System Science Data, 16(3), 1229-1246. https://doi.org/10.5194/essd-16-1229-2024\n\n\nif(!exists(\"chemsprops.SISLAC\")){\n  sis.hor = read.csv(\"/mnt/diskstation/data/Soil_points/SA/SISLAC/sislac_v2.csv\", stringsAsFactors = FALSE)\n  #str(sis.hor)\n  #summary(as.factor(sis.hor$source))\n  ## Remove some redundant records:\n  sis.hor = sis.hor[!sis.hor$source %in% c(\"WoSIS July 2016 Snapshot\", \"CHLSOC: the Chilean Soil Organic Carbon database\", \"Harmonized soil database of Ecuador (HESD)\", \"México Serie-2\"),]\n  #dim(sis.hor)\n  ## 96421 rows\n  ## SOC for Uruguay do not match the original soil profile data (see e.g. http://www.mgap.gub.uy/sites/default/files/multimedia/skmbt_c45111090914030.pdf)\n  ## compare with:\n  #sis.hor[sis.hor$perfil_id==\"23861\",]\n  #summary(sis.hor$organic_carbon)\n  ## Some erratic values with SOC % &gt; 100%!\n  sis.hor$oc = ifelse(sis.hor$organic_carbon &gt; 80, NA, sis.hor$organic_carbon * 10)\n  #ggplot(sis.hor, aes(oc+1)) + geom_histogram() + scale_x_log10()\n  #summary(sis.hor$bulk_density)\n  #summary(sis.hor$coarse_fragments)\n  sis.hor$oc_d = signif(sis.hor$oc / 1000 * sis.hor$bulk_density * 1000 * (100 - ifelse(is.na(sis.hor$coarse_fragments), 0, sis.hor$coarse_fragments))/100, 3)\n  #summary(sis.hor$oc_d)\n  sis.hor$site_obsdate = format(as.Date(sis.hor$fecha, format=\"%d/%m/%Y\"), \"%Y-%m-%d\")\n  sis.hor$n_tot = sis.hor$n * 10\n  #summary(sis.hor$k)\n  sis.hor$ca_ext = sis.hor$ca * 200\n  sis.hor$mg_ext = sis.hor$mg * 121\n  sis.hor$k_ext = sis.hor$k * 391\n  #summary(as.factor(substr(sis.hor$site_obsdate, 1, 4)))\n  ## 71407 thousand with year 1900 / many with 1905? Typos?\n  sis.sel.h = c(\"profile_id\", \"profile_identifier\", \"site_obsdate\", \"longitude\", \"latitude\", \"SSL_classification_name\", \"layer_identifier\", \"layer_id\", \"layer_sequence\", \"top\", \"bottom\", \"designation\", \"textura\", \"texture_lab\", \"clay\", \"silt\", \"sand\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"coarse_fragments\", \"analitico_densidad_aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = sis.sel.h[which(!sis.sel.h %in% names(sis.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sis.hor[,i] = NA } }\n  chemsprops.SISLAC = sis.hor[,sis.sel.h]\n  chemsprops.SISLAC$source_db = \"SISLAC\"\n  chemsprops.SISLAC$confidence_degree = 6\n  chemsprops.SISLAC$project_url = \"https://github.com/DiazSergio/Revised-SISLAC-Database-Version1.2\"\n  chemsprops.SISLAC$citation_url = \"https://doi.org/10.5194/essd-16-1229-2024\"\n  chemsprops.SISLAC &lt;- complete.vars(chemsprops.SISLAC, sel=c(\"oc\",\"ph\",\"clay\"), coords = c(\"longitude\", \"latitude\"))\n  saveRDS.gz(chemsprops.SISLAC, \"/mnt/diskstation/data/Soil_points/SA/SISLAC/chemsprops.SISLAC.rds\")\n}\ndim(chemsprops.SISLAC)\n\n[1] 92121    39\n\n## [1] 92121    39\n\n\n\n\n\nSamuel-Rosa, A., Dalmolin, R. S. D., Moura-Bueno, J. M., Teixeira, W. G., & Alba, J. M. F. (2020). Open legacy soil survey data in Brazil: geospatial data quality and how to improve it. Scientia Agricola, 77(1). https://doi.org/10.1590/1678-992x-2017-0430\nFree Brazilian Repository for Open Soil Data – febr. Data download URL: http://www.ufsm.br/febr/ and/or https://samuel-rosa.github.io/project/febr/#estou-procurando-dados\n\n\nif(!exists(\"chemsprops.FEBR\")){\n  #remotes::install_github(repo = \"laboratorio-de-pedometria/febr-package\")\n  #library(febr)\n  ## download up-to-date copy of data\n  #febr.lab = febr::layer(dataset = \"all\", variable=\"all\")\n  #febr.lab = febr::observation(dataset = \"all\")\n  #febr.md = febr::metadata(data.set = c(\"ctb0003\", \"ctb0002\"))\n  febr.hor = read.csv(gzfile(\"/mnt/diskstation/data/Soil_points/Brasil/FEBR/febr-superconjunto.txt.gz\"), stringsAsFactors = FALSE, dec = \",\", sep = \";\")\n  ## Rows: 50470 Columns: 40\n  #head(febr.hor)\n  #summary(febr.hor$coord_x)\n  #summary(as.factor(febr.hor$coord_fonte))\n  #summary(as.numeric(febr.hor$carbono))\n  #summary(as.numeric(febr.hor$ph))\n  #summary(as.numeric(febr.hor$dsi))\n  #summary(febr.hor$dsi) ## bulk density of total soil\n  febr.hor$organic_carbon = as.numeric(febr.hor$carbono)\n  febr.hor$bulk_density_oven_dry = as.numeric(febr.hor$dsi)\n  febr.hor$ph_h2o = ifelse(febr.hor$ph&lt;30|febr.hor$ph&gt;90, NA, febr.hor$ph/10)\n  febr.hor$clay_tot_psa = febr.hor$argila /10\n  febr.hor$sand_tot_psa = febr.hor$areia /10\n  febr.hor$silt_tot_psa = febr.hor$silte /10\n  febr.hor$wpg2 = (1000-febr.hor$terrafina)/10\n  febr.hor$oc_d = signif(febr.hor$organic_carbon / 1000 * febr.hor$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(febr.hor$wpg2), 0, febr.hor$wpg2))/100, 3)\n  #summary(febr.hor$oc_d)\n  #br.sm = summary(as.factor(febr.hor$taxon_sibcs))\n  #br.tax = as.data.frame(br.sm)\n  #br.tax$levels = attr(br.sm, \"names\")\n  #write.csv(br.tax, \"/mnt/diskstation/data/Soil_points/Brasil/FEBR/febr_taxon_sibcs.csv\")\n  febr.tax = read.csv(\"./correlation/soil_type_correlation_BR_FEBR.csv\")\n  febr.hor$SSL_classification_name = dplyr::left_join(febr.hor[\"taxon_sibcs\"], febr.tax, by=c(\"taxon_sibcs\"=\"levels\"), multiple = \"first\")$SSL_classification_name\n  febr.hor$SSL_classification_name = ifelse(is.na(febr.hor$taxon_st), febr.hor$SSL_classification_name, febr.hor$taxon_st)\n  #summary(as.factor(febr.hor$SSL_classification_name))\n  febr.sel.h &lt;- c(\"observacao_id\", \"usiteid\", \"observacao_data\", \"coord_x\", \"coord_y\", \"SSL_classification_name\", \"sisb_id\", \"layer_key\", \"camada_id\", \"profund_sup\", \"profund_inf\", \"camada_nome\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"organic_carbon\", \"oc_d\", \"c_tot\", \"total_carbon_ncs\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = febr.sel.h[which(!febr.sel.h %in% names(febr.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ febr.hor[,i] = NA } }\n  chemsprops.FEBR = febr.hor[,febr.sel.h]\n  chemsprops.FEBR$source_db = \"FEBR\"\n  chemsprops.FEBR$confidence_degree = 4\n  chemsprops.FEBR$project_url = \"http://www.ufsm.br/febr/\"\n  chemsprops.FEBR$citation_url = \"https://doi.org/10.1590/1678-992x-2017-0430\"\n  chemsprops.FEBR &lt;- complete.vars(chemsprops.FEBR, sel=c(\"organic_carbon\", \"ph_h2o\", \"clay_tot_psa\", \"bulk_density_oven_dry\"), coords = c(\"coord_x\", \"coord_y\"))\n  saveRDS.gz(chemsprops.FEBR, \"/mnt/diskstation/data/Soil_points/Brasil/FEBR/chemsprops.FEBR.rds\")\n}\ndim(chemsprops.FEBR)\n\n[1] 24420    39\n\n## [1] 24420    39\n\n\n\n\n\nPOLIDORO, J., COELHO, M., CARVALHO FILHO, A. D., LUMBRERAS, J., de OLIVEIRA, A. P., VASQUES, G. D. M., … & BREFIN, M. (2021). Programa Nacional de Levantamento e Interpretação de Solos do Brasil (PronaSolos): diretrizes para implementação. Embrapa Solos-Documentos (INFOTECA-E).\nDownload URL:http://geoinfo.cnps.embrapa.br/documents/3013/download\n\n\nif(!exists(\"chemsprops.PRONASOLOS\")){\n  pronas.hor = as.data.frame(sf::read_sf(\"/mnt/diskstation/data/Soil_points/Brasil/Pronasolos/Perfis_PronaSolos_20201202v2.shp\"))\n  ## 34,464 rows\n  #head(pronas.hor)\n  #summary(as.numeric(pronas.hor$carbono_or))\n  #summary(as.numeric(pronas.hor$densidade_))\n  #summary(as.numeric(pronas.hor$argila))\n  #summary(as.numeric(pronas.hor$cascalho))\n  #summary(as.numeric(pronas.hor$ph_h2o))\n  #summary(as.numeric(pronas.hor$complexo_2))\n  ## A lot of errors / typos e.g. very high values and 0 values!!\n  #pronas.hor$data_colet[1:50]\n  pronas.in.name = c(\"sigla\", \"codigo_pon\", \"data_colet\", \"gcs_latitu\", \"gcs_longit\", \"simbolo_ho\", \"profundida\", \n                     \"profundi_1\", \"cascalho\", \"areia_tota\", \"silte\", \"argila\", \"densidade_\", \"ph_h2o\", \"ph_kcl\", \n                     \"complexo_s\", \"complexo_1\", \"complexo_2\", \"complexo_3\", \"valor_s\", \"carbono_or\", \"nitrogenio\",\n                     \"condutivid\", \"classe_tex\")\n  #pronas.in.name[which(!pronas.in.name %in% names(pronas.hor))]\n  pronas.x = as.data.frame(pronas.hor[,pronas.in.name])\n  pronas.out.name = c(\"site_key\", \"usiteid\", \"site_obsdate\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\",\n                      \"hzn_desgn\", \"hzn_bot\", \"hzn_top\", \"total_frag_wt_pct_gt_2_mm_ws\", \"sand_total\", \"silt_total\", \n                      \"clay_total\", \"bulk_density_oven_dry\", \"ph_h2o\", \"ph_kcl\", \"ca_ext\",\n                      \"mg_ext\", \"k_ext\", \"na_ext\", \"sum_of_cations_cec_pH_8_2\", \"organic_carbon\", \"total_nitrogen_ncs\", \"ec_water_extractable\", \"texture_description\")\n  ## translate values\n  pronas.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(pronas.in.name)))\n  pronas.fun.lst[[which(pronas.in.name==\"sigla\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"codigo_pon\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"data_colet\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"simbolo_ho\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"classe_tex\")]] = \"paste(x)\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_s\")]] = \"as.numeric(x)*200\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_1\")]] = \"as.numeric(x)*121\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_2\")]] = \"as.numeric(x)*391\"\n  pronas.fun.lst[[which(pronas.in.name==\"complexo_3\")]] = \"as.numeric(x)*230\"\n  pronas.fun.lst[[which(pronas.in.name==\"areia_tota\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"silte\")]] = \"round(as.numeric(x)/10, 1)\"\n  pronas.fun.lst[[which(pronas.in.name==\"argila\")]] = \"round(as.numeric(x)/10, 1)\"\n  ## save translation rules:\n  #write.csv(data.frame(pronas.in.name, pronas.out.name, unlist(pronas.fun.lst)), \"pronas_soilab_transvalues.csv\")\n  pronas.soil = transvalues(pronas.x, pronas.out.name, pronas.in.name, pronas.fun.lst)\n  ## a lot of NA's\n  #summary(pronas.soil$organic_carbon)\n  pronas.soil$bulk_density_oven_dry &lt;- ifelse(pronas.soil$bulk_density_oven_dry &lt; 0.05, NA, pronas.soil$bulk_density_oven_dry)\n  pronas.soil$total_frag_wt_pct_gt_2_mm_ws &lt;- ifelse(pronas.soil$total_frag_wt_pct_gt_2_mm_ws &lt; 0 | pronas.soil$total_frag_wt_pct_gt_2_mm_ws &gt; 100, NA, pronas.soil$total_frag_wt_pct_gt_2_mm_ws)\n  #summary(pronas.soil$bulk_density_oven_dry)\n  pronas.soil$oc_d = signif(pronas.soil$organic_carbon / 1000 * pronas.soil$bulk_density_oven_dry * 1000 * (100 - ifelse(is.na(pronas.soil$total_frag_wt_pct_gt_2_mm_ws), 0, pronas.soil$total_frag_wt_pct_gt_2_mm_ws))/100, 3)\n  #summary(pronas.soil$oc_d)\n  x.na = col.names[which(!col.names %in% names(pronas.soil))]\n  if(length(x.na)&gt;0){ for(i in x.na){ pronas.soil[,i] = NA } }\n  chemsprops.PRONASOLOS = pronas.soil[,col.names]\n  chemsprops.PRONASOLOS$source_db = \"PRONASOLOS\"\n  chemsprops.PRONASOLOS$confidence_degree = 2\n  chemsprops.PRONASOLOS$project_url = \"https://geoportal.cprm.gov.br/pronasolos/\"\n  chemsprops.PRONASOLOS$citation_url = \"https://www.infoteca.cnptia.embrapa.br/infoteca/handle/doc/1135056\"\n  chemsprops.PRONASOLOS &lt;- complete.vars(chemsprops.PRONASOLOS, sel=c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.PRONASOLOS, \"/mnt/diskstation/data/Soil_points/Brasil/Pronasolos/chemsprops.PRONASOLOS.rds\")\n}\n\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\n\ndim(chemsprops.PRONASOLOS)\n\n[1] 32708    39\n\n## [1] 32708    39\n\n\n\n\n\nVásquez-Toxcón, A.O., H. Tobías Vásquez, and M. Guevara, (2023). Guatemala Soil Organic Carbon Database (0 to 30 cm, 1965-2010). ver 1. Environmental Data Initiative. https://doi.org/10.6073/pasta/8dd15238c604c3ac75daf985548bd05c (Accessed 2024-11-24).\n\nVásquez, A., Varón‐Ramírez, V. M., Tobías, H., & Guevara, M. (2024). Guatemala soil organic carbon database (GTMSOC). European Journal of Soil Science, 75(1), e13450. https://doi.org/10.1111/ejss.13450\n\n\nif(!exists(\"chemsprops.Guatemala\")){\n  gua.df = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Guatemala/GTMSOCBD.csv\")\n  ## Rows: 910 Columns: 12\n  #str(gua.site)\n  #summary(as.factor(gua.site$SOC_Method))\n  ## measured using wet-oxidation method (Walley-Black)\n  gua.df$oc = gua.df$SOC * 1.3\n  ## Values are about 50-100% higher than in other countries\n  #summary(gua.df$CF)\n  gua.df$wpg2 = ifelse(is.na(gua.df$CF), 0, gua.df$CF)\n  gua.df$oc_d = signif(gua.df$oc / 1000 * gua.df$BD * 1000 * (100 - gua.df$wpg2)/100, 3)\n  gua.df$LIMSUP = 0; gua.df$LIMINF = 30\n  #summary(gua.df$oc_d)\n  gua.sel.h = c(\"ID\", \"upedonid\", \"Date\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"LIMSUP\", \"LIMINF\", \"hzn_desgn\", \"texture_description\", \"texture_lab\", \"clay_total\", \"silt_total\", \"sand_total\",  \n              \"oc\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"CF\", \"BD\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = gua.sel.h[which(!gua.sel.h %in% names(gua.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ gua.df[,i] = NA } }\n  chemsprops.Guatemala = gua.df[,gua.sel.h]\n  chemsprops.Guatemala$source_db = \"Guatemala_GTMSOC\"\n  chemsprops.Guatemala$confidence_degree = 2\n  chemsprops.Guatemala$project_url = \"https://doi.org/10.6073/pasta/8dd15238c604c3ac75daf985548bd05c\"\n  chemsprops.Guatemala$citation_url = \"https://doi.org/10.1111/ejss.13450\"\n  chemsprops.Guatemala &lt;- complete.vars(chemsprops.Guatemala, sel=c(\"oc\",\"BD\"), coords = c(\"Longitude\", \"Latitude\"))\n  saveRDS.gz(chemsprops.Guatemala, \"/mnt/diskstation/data/Soil_points/Guatemala/chemsprops.Guatemala.rds\")\n}\n\nRows: 910 Columns: 12\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \";\"\nchr (5): ID, SOC_Method, BD_Method, Data_Source, Primary_Information\ndbl (6): Longitude, Latitude, SOC, BD, CF, Date\nlgl (1): CF_Method\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.Guatemala)\n\n[1] 910  39\n\n## [1] 910   39\n\n\n\n\n\nArmas, D.I., M. Guevara, F. Bezares, R. Vargas, P. Durante, V.H. Osorio, W.A. Jimenez, and C. Oyonarte. (2022). Harmonized Soil Database of Ecuador 2021 ver 3. Environmental Data Initiative. https://doi.org/10.6073/pasta/1560e803953c839e7aedef78ff7d3f6c (Accessed 2024-11-24).\n\nArmas, D., Guevara, M., Bezares, F., Vargas, R., Durante, P., Osorio, V., Jiménez, W., and Oyonarte, C. (2023). Harmonized Soil Database of Ecuador (HESD): data from 2009 to 2015, Earth Syst. Sci. Data, 15, 431–445, https://doi.org/10.5194/essd-15-431-2023\n\n\nif(!exists(\"chemsprops.Ecuador\")){\n  ecu.site = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Ecuador/Harmonized_Soil_Database_of_Ecuador_profile_v0.2EDI.csv\")\n  #summary(ecu.site$CORX)\n  ecu.xy = terra::vect(ecu.site[,c(\"CORX\",\"CORY\")], geom=c(\"CORX\", \"CORY\"), crs=\"EPSG:32717\")\n  ecu.ll = terra::project(ecu.xy, \"EPSG:4326\")\n  ecu.site$longitude_decimal_degrees = geom(ecu.ll)[,\"x\"]\n  ecu.site$latitude_decimal_degrees = geom(ecu.ll)[,\"y\"]\n  #plot(ecu.site[,c(\"longitude_decimal_degrees\",\"latitude_decimal_degrees\")], pch=\"+\", asp=1)\n  ecu.site$site_obsdate = as.Date(ecu.site$FEMU, format=\"%d/%m/%y\")\n  ecu.site$site_obsdate[nchar(ecu.site$FEMU)&gt;8] &lt;- as.Date(ecu.site$FEMU, format=\"%d/%m/%Y\")[nchar(ecu.site$FEMU)&gt;8]\n  ##summary(ecu.site$site_obsdate)\n  ecu.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Ecuador/Harmonized_Soil_Database_of_Ecuador_horizon_v0.2.csv\")\n  ecu.df = dplyr::left_join(ecu.hor, ecu.site, by=\"ID_PER\", multiple=\"first\")\n  ## measured using wet-oxidation method (Walley-Black)\n  ecu.df$oc = ecu.df$CO * 1.3\n  #summary(ecu.df$oc)\n  #summary(ecu.df$DA)\n  #summary(ecu.df$KDIS) # centimolePerKilogram\n  ecu.df$ca_ext = ecu.df$CADIS * 200\n  ecu.df$mg_ext = ecu.df$MGDIS * 121\n  ecu.df$na_ext = ecu.df$NACC * 230\n  ecu.df$k_ext = ecu.df$KDIS * 391\n  #summary(as.factor(ecu.df$FR_CL))\n  ecu.df$wpg2 = ifelse(ecu.df$FR_CL==\"0-2\", 1, \n                       ifelse(ecu.df$FR_CL==\" 02-05\", 3.5, \n                       ifelse(ecu.df$FR_CL==\" 05-15\", 10, \n                       ifelse(ecu.df$FR_CL==\"15-40\", 27.5, \n                       ifelse(ecu.df$FR_CL==\"40-80\", 60, \n                       ifelse(ecu.df$FR_CL==\"&gt; 80\", 90, 0))))))\n  ecu.df$wpg2 = ifelse(is.na(ecu.df$wpg2), 0, ecu.df$wpg2)\n  #summary(ecu.df$wpg2)\n  ecu.df$oc_d = signif(ecu.df$oc / 1000 * ecu.df$DA * 1000 * (100 - ecu.df$wpg2)/100, 3)\n  #summary(ecu.df$oc_d)\n  ecu.sel.h = c(\"ID_PER\", \"ID_NAC\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"STSG\", \"ID_HOR\", \"layer_key\", \"ORDHOR\", \"LIMSUP\", \"LIMINF\", \"HMOR\", \"texture_description\", \"texture_lab\", \"ARCILLA\", \"LIMO\", \"ARENA\", \"oc\", \"oc_d\", \"c_tot\", \"NTOT\", \"ph_kcl\", \"PHAQ\", \"ph_cacl2\", \"SBCC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"DA\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"CESS\", \"ec_12pre\")\n  x.na = ecu.sel.h[which(!ecu.sel.h %in% names(ecu.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ecu.df[,i] = NA } }\n  chemsprops.Ecuador = ecu.df[,ecu.sel.h]\n  chemsprops.Ecuador$source_db = \"Ecuador_HESD\"\n  chemsprops.Ecuador$confidence_degree = 2\n  chemsprops.Ecuador$project_url = \"https://doi.org/10.6073/pasta/1560e803953c839e7aedef78ff7d3f6c\"\n  chemsprops.Ecuador$citation_url = \"https://doi.org/10.5194/essd-15-431-2023\"\n  chemsprops.Ecuador &lt;- complete.vars(chemsprops.Ecuador, sel=c(\"oc\",\"PHAQ\",\"ARCILLA\",\"DA\"))\n  saveRDS.gz(chemsprops.Ecuador, \"/mnt/diskstation/data/Soil_points/Ecuador/chemsprops.Ecuador.rds\")\n}\n\nRows: 13542 Columns: 24\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (17): ID_NAC, COLP, STSG, STGG, STOD, RTS, RHS, LITO, GEOF, TUSO, TVEG, ...\ndbl  (7): ID_PER, CORX, CORY, ALT, PRES, PEND, FRGG\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\n\nRows: 51673 Columns: 56\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr  (4): Hmor, MSHOR, SUBHOR, FR_CL\ndbl (40): ID_PER, ID_HOR, CORX, CORY, ORDHOR, DISHOR, LIMSUP, LIMINF, ROOTS,...\nlgl (12): pHSS, CESS, NASS, KSS, CASS, MGSS, SBSS, CARSS, SULSS, CLSS, PSI, RAS\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\n\nWarning: One or more parsing issues, call `problems()` on your data frame for details,\ne.g.:\n  dat &lt;- vroom(...)\n  problems(dat)\n\ndim(chemsprops.Ecuador)\n\n[1] 30188    39\n\n## [1] 30188    39\n\n\n\n\n\nPaz-Pellat, F., & Velázquez-Rodríguez, A. S. (2018). Base de datos de perfiles de suelos en México. Elementos para Políticas Públicas, 2(3), 210-235. https://www.elementospolipub.org/ojs/index.php/epp/issue/view/3\n\n\nif(!exists(\"chemsprops.MexicoINEGI\")){\n  mex.xy = terra::vect(\"/mnt/diskstation/data/Soil_points/Mexico/INEGI/perfiles_serieii.shp\", crs=\"EPSG:6362\")\n  mex.ll &lt;- terra::project(mex.xy, \"EPSG:4326\")\n  #plot(mex.ll)\n  mex.df = as.data.frame(mex.xy)\n  mex.df$site_key = sapply(mex.df$ID_PERFIL, function(i){strsplit(i, \"-\")}[[1]][1])\n  ## 4428\n  mex.df$longitude_decimal_degrees = geom(mex.ll)[,\"x\"]\n  mex.df$latitude_decimal_degrees = geom(mex.ll)[,\"y\"]\n  ##summary(mex.df$CO) ## Carbono orgánico, método de Walkley y Black\n  mex.df$oc = mex.df$CO * 10 * 1.3\n  #summary(mex.df$K)\n  mex.df$ca_ext = mex.df$CA * 200\n  mex.df$mg_ext = mex.df$MG * 121\n  mex.df$na_ext = mex.df$`NA` * 230\n  mex.df$k_ext = mex.df$K * 391\n  mex.df$site_obsdate = format(as.Date(mex.df$FECHA, format=\"%d/%m/%Y\"), \"%Y-%m-%d\")\n  ## pH del horizonte, método del potenciómetro, relación con agua 1:1\n  mex.sel.h = c(\"site_key\", \"IDHOJA\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"ID_PERFIL\", \"layer_key\", \"horizonte\", \"LIM_SUP\", \"LIM_INF\", \"NOMEN_HTE\", \"CLAS_TEXT\", \"texture_lab\", \"R\", \"L\", \"A\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pHKCl\", \"PH\", \"ph_cacl2\", \"CIC\", \"cec_nh4\", \"ecec\", \"wpg2\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"CE\", \"ec_12pre\")\n  x.na = mex.sel.h[which(!mex.sel.h %in% names(mex.df))]\n  if(length(x.na)&gt;0){ for(i in x.na){ mex.df[,i] = NA } }\n  chemsprops.MexicoINEGI = mex.df[,mex.sel.h]\n  chemsprops.MexicoINEGI$source_db = \"MexicoINEGI\"\n  chemsprops.MexicoINEGI$confidence_degree = 4\n  chemsprops.MexicoINEGI$project_url = \"https://www.inegi.org.mx/\"\n  chemsprops.MexicoINEGI$citation_url = \"https://www.elementospolipub.org/ojs/index.php/epp/article/view/16\"\n  chemsprops.MexicoINEGI &lt;- complete.vars(chemsprops.MexicoINEGI, sel=c(\"oc\",\"PH\",\"R\"))\n  saveRDS.gz(chemsprops.MexicoINEGI, \"/mnt/diskstation/data/Soil_points/Mexico/INEGI/chemsprops.MexicoINEGI.rds\")\n}\ndim(chemsprops.MexicoINEGI)\n\n[1] 16820    39\n\n## [1] 16820    39\n\n\n\n\n\nMata, R., Vázquez, A., Rosales, A., & Salazar, D. (2012). Mapa digital de suelos de Costa Rica. Asociación Costarricense de la Ciencia del Suelo, San José, CRC. Escala, 1, 200000. Data download URL: http://www.cia.ucr.ac.cr/wp-content/recursosnaturales/Base%20perfiles%20de%20suelos%20v1.1.rar\nMata-Chinchilla, R., & Castro-Chinchilla, J. (2019). Geoportal de suelos de Costa Rica como Bien Público al servicio del país. Revista Tecnología En Marcha, 32(7), Pág. 51-56. https://doi.org/10.18845/tm.v32i7.4259\n\n\nif(!exists(\"chemsprops.CostaRica\")){\n  cr.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Costa_Rica/Base_de_datos_version_1.2.3.csv\", stringsAsFactors = FALSE)\n  #plot(cr.hor[,c(\"X\",\"Y\")], pch=\"+\", asp=1)\n  cr.hor$usiteid = paste(cr.hor$Provincia, cr.hor$Cantón, cr.hor$Id, sep=\"_\")\n  #summary(cr.hor$Corg.)\n  cr.hor$oc = cr.hor$Corg. * 10\n  cr.hor$Densidad.Aparente = as.numeric(paste0(cr.hor$Densidad.Aparente))\n  #summary(cr.hor$K)\n  cr.hor$ca_ext = cr.hor$Ca * 200\n  cr.hor$mg_ext = cr.hor$Mg * 121\n  #cr.hor$na_ext = cr.hor$Na * 230\n  cr.hor$k_ext = cr.hor$K * 391\n  cr.hor$wpg2 = NA\n  cr.hor$oc_d = signif(cr.hor$oc / 1000 * cr.hor$Densidad.Aparente * 1000 * (100 - ifelse(is.na(cr.hor$wpg2), 0, cr.hor$wpg2))/100, 3)\n  #summary(cr.hor$oc_d)\n  cr.sel.h = c(\"Id\", \"usiteid\", \"Fecha\", \"X\", \"Y\", \"Sub.Grupo\", \"labsampnum\", \"layer_key\", \"horizonte\", \"prof_inicio\", \"prof_final\", \"id_hz\", \"Clase.Textural\", \"texture_lab\", \"ARCILLA\", \"LIMO\", \"ARENA\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pHKCl\", \"pH_H2O\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"Densidad.Aparente\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = cr.sel.h[which(!cr.sel.h %in% names(cr.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ cr.hor[,i] = NA } }\n  chemsprops.CostaRica = cr.hor[,cr.sel.h]\n  chemsprops.CostaRica$source_db = \"CostaRica\"\n  chemsprops.CostaRica$confidence_degree = 4\n  chemsprops.CostaRica$project_url = \"http://www.cia.ucr.ac.cr\"\n  chemsprops.CostaRica$citation_url = \"https://doi.org/10.18845/tm.v32i7.42\"\n  chemsprops.CostaRica &lt;- complete.vars(chemsprops.CostaRica, sel=c(\"oc\",\"pH_H2O\",\"ARCILLA\",\"Densidad.Aparente\"), coords = c(\"X\", \"Y\"))\n  saveRDS.gz(chemsprops.CostaRica, \"/mnt/diskstation/data/Soil_points/Costa_Rica/chemsprops.CostaRica.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.CostaRica)\n\n[1] 2051   39\n\n## [1] 2051   39\n\n\n\n\n\nDewan, M. L., & Famouri, J. (1964). The soils of Iran. Food and Agriculture Organization of the United Nations.\n\nHengl, T., Toomanian, N., Reuter, H. I., & Malakouti, M. J. (2007). Methods to interpolate soil categorical variables from profile observations: Lessons from Iran. Geoderma, 140(4), 417-427.\nMohammad, H. B. (2000). Soil resources and use potentiality map of Iran. Soil and Water Research Institute, Teheran, Iran.\n\n\nif(!exists(\"chemsprops.IRANSPDB\")){\n  na.s = c(\"?\",\"\",\"?.\",\"??\", -2147483647, -1.00e+308, \"&lt;NA&gt;\")\n  iran.hor = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbana.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:12]\n  names(iran.hor) = c(\"site_key\", \"hzn_desgn\", \"hzn_top\", \"hzn_bot\", \"ph_h2o\", \"ec_water_extractable\", \"oc\", \"CACO\", \"PBS\", \"sand_total\", \"silt_total\", \"clay_total\")\n  iran.hor$hzn_top = ifelse(is.na(iran.hor$hzn_top) & iran.hor$hzn_desgn==\"A\", 0, iran.hor$hzn_top)\n  iran.hor2 = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sdbhor.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)[,1:8]\n  names(iran.hor2) = c(\"site_key\", \"layer_sequence\", \"DESI\", \"hzn_top\", \"hzn_bot\", \"M_colour\", \"texture_description\", \"hzn_desgn\")\n  iran.site = read.csv(\"/mnt/diskstation/data/Soil_points/Iran/iran_sgdb.txt\", stringsAsFactors = FALSE, na.strings = na.s, header = FALSE)\n  names(iran.site) = c(\"usiteid\", \"latitude_decimal_degrees\", \"longitude_decimal_degrees\", \"FAO\", \"Tax\", \"site_key\")\n  st.cor = read.csv('./correlation/soil_types_correlation_full_data_FAO74_US_CPSS.csv')\n  st.cor$Correlation_ = toupper(st.cor$Correlation)\n  iran.site$SSL_classification_name = dplyr::left_join(iran.site[\"FAO\"], st.cor, by=c(\"FAO\"=\"Correlation_\"), multiple = \"first\")$SoilUnitDUS\n  summary(as.factor(iran.site$SSL_classification_name))\n  iran.db = plyr::join_all(list(iran.site, iran.hor, iran.hor2))\n  iran.db$organic_carbon = iran.db$oc * 10\n  #summary(iran.db$oc)\n  x.na = col.names[which(!col.names %in% names(iran.db))]\n  if(length(x.na)&gt;0){ for(i in x.na){ iran.db[,i] = NA } }\n  chemsprops.IRANSPDB = iran.db[,col.names]\n  chemsprops.IRANSPDB$source_db = \"Iran_SPDB\"\n  chemsprops.IRANSPDB$confidence_degree = 4\n  chemsprops.IRANSPDB$project_url = \"\"\n  chemsprops.IRANSPDB$citation_url = \"https://doi.org/10.1016/j.geoderma.2007.04.022\"\n  chemsprops.IRANSPDB &lt;- complete.vars(chemsprops.IRANSPDB, sel=c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.IRANSPDB, \"/mnt/diskstation/data/Soil_points/Iran/chemsprops.IRANSPDB.rds\")\n}\n\nJoining by: site_key\n\n\nJoining by: site_key, hzn_desgn, hzn_top, hzn_bot\n\ndim(chemsprops.IRANSPDB)\n\n[1] 4941   39\n\n## [1] 4941   39\n\n\n\n\n\nHugelius, G., Bockheim, J. G., Camill, P., Elberling, B., Grosse, G., Harden, J. W., … & Michaelson, G. (2013). A new data set for estimating organic carbon storage to 3 m depth in soils of the northern circumpolar permafrost region. Earth System Science Data (Online), 5(2). Data download URL: http://dx.doi.org/10.5879/ECDS/00000002\n\nNote: this data set show extremely high SOC content (average 30%). It appears that this was a purposive survey i.e. surveyors were looking for peatlands and gelisols with high SOC content.\n\nif(!exists(\"chemsprops.NCSCD\")){\n  ncscd.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/NCSCD/Harden_etal_2012_Hugelius_etal_2013_cleaned_data.csv\", stringsAsFactors = FALSE)\n  ## To translate LOI % into OC %: OC % = (−0.0013 × LOI %2 ) + (0.637 × LOI %)) was used\n  ## for mineral soils: OC % = (−0.00005 × LOI %3 ) + (0.0059× LOI %2 ) + (0.362 × LOI %))\n  ncscd.hors$oc = as.numeric(ncscd.hors$X.C)*10\n  ## mean OC content 30%!!\n  #summary(ncscd.hors$oc)\n  #hist(ncscd.hors$Layer.thickness.cm, breaks = 45)\n  ncscd.hors$Layer.thickness.cm = ifelse(ncscd.hors$Layer.thickness.cm&lt;0, NA, ncscd.hors$Layer.thickness.cm)\n  ncscd.hors$hzn_bot = ncscd.hors$Basal.Depth.cm + ncscd.hors$Layer.thickness.cm\n  ncscd.hors$db_od = as.numeric(ncscd.hors$bulk.density.g.cm.3)\n  ## BD &gt;2.4t/m3 -&gt; rock\n  ncscd.hors$db_od = ifelse(ncscd.hors$db_od&gt;2.4, NA, ncscd.hors$db_od)\n  ## Can we assume no coarse fragments?\n  ncscd.hors$wpg2 = 0\n  ncscd.hors$oc_d = signif(ncscd.hors$oc / 1000 * ncscd.hors$db_od * 1000 * (100 - ifelse(is.na(ncscd.hors$wpg2), 0, ncscd.hors$wpg2))/100, 3)\n  ## very high values &gt;40 kg/m3\n  ncscd.hors$site_obsdate = format(as.Date(ncscd.hors$Sample.date, format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  #summary(ncscd.hors$db_od)\n  ncscd.hors$Great.Group = ifelse(is.na(ncscd.hors$Great.Group), ncscd.hors$Suborder, ncscd.hors$Great.Group)\n  ncscd.col = c(\"Profile.ID\", \"citation\", \"site_obsdate\", \"Long\", \"Lat\", \"Great.Group\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Basal.Depth.cm\", \"hzn_bot\", \"Horizon.type\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ncscd.col[which(!ncscd.col %in% names(ncscd.hors))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ncscd.hors[,i] = NA } }\n  chemsprops.NCSCD = ncscd.hors[,ncscd.col]\n  chemsprops.NCSCD$source_db = \"NCSCD\"\n  chemsprops.NCSCD$confidence_degree = 10\n  chemsprops.NCSCD$project_url = \"https://bolin.su.se/data/ncscd/\"\n  chemsprops.NCSCD$citation_url = \"https://doi.org/10.5194/essd-5-393-2013\"\n  chemsprops.NCSCD = complete.vars(chemsprops.NCSCD, sel = c(\"oc\",\"db_od\"), coords = c(\"Long\", \"Lat\"))\n  #str(levels(as.factor(chemsprops.NCSCD$Profile.ID)))\n  ## 1476 unique sites\n  # openair::scatterPlot(chemsprops.NCSCD, x = \"oc\", y = \"db_od\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, # log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"Bulk density [t/m3]\")\n  # openair::scatterPlot(chemsprops.NCSCD, x = \"oc\", y = \"oc_d\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n  saveRDS.gz(chemsprops.NCSCD, \"/mnt/diskstation/data/Soil_points/INT/NCSCD/chemsprops.NCSCD.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.NCSCD)\n\n[1] 7371   39\n\n## [1] 7371   39\n\n\n\n\n\n\nRelationship between SOC [kg/m3] and BD for NCSCD data set.\n\n\n\n\n\n\n\n\nCSIRO (2020). CSIRO National Soil Site Database. v4. CSIRO. Data Collection. https://data.csiro.au/collections/collection/CIcsiro:7526v004. Data download URL: https://doi.org/10.25919/5eeb2a56eac12 (available upon request)\n\nSearle, R. (2014). The Australian site data collation to support the GlobalSoilMap. GlobalSoilMap: Basis of the global spatial soil information system, 127.\n\n\nif(!exists(\"chemsprops.NatSoil\")){\n  library(Hmisc) \n  cmdb &lt;- mdb.get(\"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612.mdb\")\n  #str(cmdb$SITES)\n  au.obs = cmdb$OBSERVATIONS[,c(\"s.id\", \"o.location.notes\", \"o.date.desc\", \"o.latitude.GDA94\", \"o.longitude.GDA94\", \"o.soil.taxonomy\")]\n  au.obs$o.soil.taxonomy = paste(au.obs$o.soil.taxonomy)\n  csiro.tax = read.csv(\"./tabular/CSIRO_codes_taxonomy.csv\")\n  au.obs$SSL_classification_name = dplyr::left_join(au.obs[\"o.soil.taxonomy\"], csiro.tax, by=c(\"o.soil.taxonomy\"=\"Code\"), multiple = \"first\")$SSL_classification_name\n  #summary(as.factor(au.obs$SSL_classification_name))\n  ## only about 300 profiles with USDA classification\n  au.obs = au.obs[!is.na(au.obs$o.longitude.GDA94),]\n  coordinates(au.obs) &lt;- ~o.longitude.GDA94+o.latitude.GDA94\n  proj4string(au.obs) &lt;- CRS(\"+proj=longlat +ellps=GRS80 +no_defs\")\n  au.xy &lt;- data.frame(spTransform(au.obs, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  #plot(au.xy[,c(\"coords.x1\", \"coords.x2\")])\n  ## all variables in one column and need to be sorted based on the lab method\n  #summary(cmdb$LAB_METHODS$LABM.SHORT.NAME)\n  #write.csv(cmdb$LAB_METHODS, \"/mnt/diskstation/data/Soil_points/Australia/CSIRO/NatSoil_v2_20200612_lab_methods.csv\")\n  lab.tbl = list(\n          c(\"6_DC\", \"6A1\", \"6A1_UC\", \"6B1\", \"6B2\", \"6B2a\", \"6B2b\", \"6B3\", \"6B4\", \"6B4a\", \"6B4b\", \"6Z\"), # %\n          c(\"6B3a\"), # g/kg\n          c(\"6H4\", \"6H4_SCaRP\"), # %\n          c(\"7_C_B\", \"7_NR\", \"7A1\", \"7A2\", \"7A2a\", \"7A2b\", \"7A3\", \"7A4\", \"7A5\", \"7A6\", \"7A6a\", \"7A6b\", \"7A6b_MCLW\"),  # g/kg\n          c(\"4A1\", \"4_NR\", \"4A_C_2.5\", \"4A_C_1\", \"4G1\"),\n          c(\"4C_C_1\", \"4C1\", \"4C2\", \"23A\"),\n          c(\"4B_C_2.5\", \"4B1\", \"4B2\"),\n          c(\"P10_NR_C\", \"P10_HYD_C\", \"P10_PB_C\", \"P10_PB1_C\", \"P10_CF_C\", \"P10_I_C\"),\n          c(\"P10_NR_Z\", \"P10_HYD_Z\", \"P10_PB_Z\", \"P10_PB1_Z\", \"P10_CF_Z\", \"P10_I_Z\"),\n          c(\"P10_NR_S\", \"P10_HYD_S\", \"P10_PB_S\", \"P10_PB1_S\", \"P10_CF_S\", \"P10_I_S\"),\n          c(\"15C1modCEC\", \"15_HSK_CEC\", \"15J_CEC\"),\n          c(\"15I1\", \"15I2\", \"15I3\", \"15I4\", \"15D3_CEC\"),\n          c(\"15_BASES\", \"15_NR\", \"15J_H\", \"15J1\"),\n          c(\"2Z2_Grav\", \"P10_GRAV\"),\n          c(\"503.08a\", \"P3A_NR\", \"P3A1\", \"P3A1_C4\", \"P3A1_CLOD\", \"P3A1_e\"),\n          c(\"18F1_CA\"),\n          c(\"18F1_MG\"),\n          c(\"18F1_NA\"),\n          c(\"18F1_K\", \"18F2\", \"18A1mod\", \"18_NR\", \"18A1\", \"18A1_NR\", \"18B1\", \"18B2\"),\n          c(\"3_C_B\", \"3_NR\", \"3A_TSS\"),\n          c(\"3A_C_2.5\", \"3A1\")\n          )\n  names(lab.tbl) = c(\"oc\", \"ocP\", \"c_tot\", \"n_tot\", \"ph_h2o\", \"ph_kcl\", \"ph_cacl2\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  val.lst = lapply(1:length(lab.tbl), function(i){\n       x &lt;- cmdb$LAB_RESULTS[cmdb$LAB_RESULTS$labm.code %in% lab.tbl[[i]], c(\"agency.code\", \"proj.code\", \"labm.code\", \"s.id\", \"o.id\", \"h.no\", \"labr.value\")]; \n       names(x)[7] &lt;- names(lab.tbl)[i]; return(x) })\n  names(val.lst) = names(lab.tbl)\n  val.lst$oc$oc = val.lst$oc$oc * 10\n  summary(as.factor(val.lst$oc$labm.code))\n  ## 6_DC    6A1 6A1_UC    6B1    6B2   6B2b    6B3     6Z \n  ##  403  15403   8094    119   5447      4   5735   1899 \n  ## 6_DC = Organic carbon (%) - Dry combustion\n  ## 6A1_UC = Organic carbon (%) - Uncorrected Walkley and Black method\n  val.lst$oc$oc[val.lst$oc$labm.code == \"6A1_UC\"] = val.lst$oc$oc[val.lst$oc$labm.code == \"6A1_UC\"] * 1.3\n  #summary(val.lst$oc$oc)\n  #str(val.lst, max.level = 1)\n  for(i in 1:length(val.lst)){ val.lst[[i]]$h.id &lt;- paste(val.lst[[i]]$agency.code, val.lst[[i]]$proj.code, val.lst[[i]]$s.id, val.lst[[i]]$o.id, val.lst[[i]]$h.no, sep=\"_\") }\n  au.hor &lt;- plyr::join_all(lapply(val.lst, function(x){x[,7:8]}), match=\"first\")\n  #str(as.factor(au.hor$h.id))\n  cmdb$HORIZONS$h.id = paste(cmdb$HORIZONS$agency.code, cmdb$HORIZONS$proj.code, cmdb$HORIZONS$s.id, cmdb$HORIZONS$o.id, cmdb$HORIZONS$h.no, sep=\"_\")\n  cmdb$HORIZONS$hzn_desgn = paste(cmdb$HORIZONS$h.desig.master, cmdb$HORIZONS$h.desig.subdiv, cmdb$HORIZONS$h.desig.suffix, sep=\"\")\n  au.horT &lt;- plyr::join_all(list(cmdb$HORIZONS[,c(\"h.id\",\"s.id\",\"h.no\",\"h.texture\",\"hzn_desgn\",\"h.upper.depth\",\"h.lower.depth\")], au.hor, au.xy))\n  au.horT$site_obsdate = format(as.Date(au.horT$o.date.desc, format=\"%d%m%Y\"), \"%Y-%m-%d\")\n  #summary(as.Date(au.horT$site_obsdate))\n  au.horT$sand_tot_psa = ifelse(is.na(au.horT$sand_tot_psa), 100-(au.horT$clay_tot_psa + au.horT$silt_tot_psa), au.horT$sand_tot_psa)\n  au.horT$hzn_top = au.horT$h.upper.depth*100\n  au.horT$hzn_bot = au.horT$h.lower.depth*100\n  #summary(au.horT$oc)\n  au.horT$oc_d = signif(au.horT$oc / 1000 * au.horT$db_od * 1000 * (100 - ifelse(is.na(au.horT$wpg2), 0, au.horT$wpg2))/100, 3)\n  #summary(au.horT$oc_d)\n  au.cols.n = c(\"s.id\", \"o.location.notes\", \"site_obsdate\", \"coords.x1\", \"coords.x2\", \"SSL_classification_name\", \"h.id\", \"layer_key\", \"h.no\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"h.texture\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = au.cols.n[which(!au.cols.n %in% names(au.horT))]\n  if(length(x.na)&gt;0){ for(i in x.na){ au.horT[,i] = NA } }\n  chemsprops.NatSoil = au.horT[,au.cols.n]\n  chemsprops.NatSoil$source_db = \"CSIRO_NatSoil\"\n  chemsprops.NatSoil$confidence_degree = 3\n  chemsprops.NatSoil$project_url = \"https://www.csiro.au/en/Do-business/Services/Enviro/Soil-archive\"\n  chemsprops.NatSoil$citation_url = \"https://doi.org/10.25919/5eeb2a56eac12\"\n  chemsprops.NatSoil = complete.vars(chemsprops.NatSoil, sel = c(\"oc\",\"db_od\",\"clay_tot_psa\",\"ph_h2o\"), coords = c(\"coords.x1\", \"coords.x2\"))\n  saveRDS.gz(chemsprops.NatSoil, \"/mnt/diskstation/data/Soil_points/Australia/CSIRO/chemsprops.NatSoil.rds\")\n}\n\n\nAttaching package: 'Hmisc'\n\n\nThe following objects are masked from 'package:plyr':\n\n    is.discrete, summarize\n\n\nThe following objects are masked from 'package:terra':\n\n    describe, mask, units, zoom\n\n\nThe following objects are masked from 'package:dplyr':\n\n    src, summarize\n\n\nThe following objects are masked from 'package:base':\n\n    format.pval, units\n\n\n14 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n27 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 \n14 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 \n17 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 \n114 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 44 45 46 47 48 49 50 51 52 53 54 55 56 57 58 59 60 61 62 63 64 65 66 67 68 69 70 71 72 73 74 75 76 77 78 79 80 81 82 83 84 85 86 87 88 89 90 91 92 93 94 95 96 97 98 99 100 101 102 103 104 105 106 107 108 109 110 111 112 113 114 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n12 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 \n43 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 27 28 29 30 31 32 33 34 35 36 37 38 39 40 41 42 43 \n11 variables; Processing variable:1 2 3 4 5 6 7 8 9 10 11 \n\n\nJoining by: h.id\n\n\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\nJoining by: h.id\n\n\nJoining by: s.id\n\ndim(chemsprops.NatSoil)\n\n[1] 89754    39\n\n## [1] 89754    39\n\n\n\n\n\nCoetzee, M. E. (2001). NAMSOTER, a SOTER database for Namibia. Agroecological Zoning, 458.\nCoetzee, M. E. (2009). Chemical characterisation of the soils of East Central Namibia (Doctoral dissertation, Stellenbosch: University of Stellenbosch).\n\n\nif(!exists(\"chemsprops.NAMSOTER\")){\n  nam.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_profiles.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  #nam.sm = summary(as.factor(nam.profs$CLAF))\n  #nam.tax = as.data.frame(nam.sm)\n  #nam.tax$levels = attr(nam.sm, \"names\")\n  #write.csv(nam.tax, \"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/namsoter_taxon_wrb.csv\")\n  st.cor = read.csv('./correlation/soil_type_correlation_ISRIC_WISE.csv')\n  st.cor$FAO_90_ = gsub(\"SOLS\", \"SOL\", toupper(st.cor$FAO_90.1))\n  nam.profs$SSL_classification_name = paste0( dplyr::left_join(nam.profs[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90_\"), multiple = \"first\")$Class_1, \" / \",\n                    dplyr::left_join(nam.profs[\"CLAF\"], st.cor, by=c(\"CLAF\"=\"FAO_90_\"), multiple = \"first\")$Class_2)\n  #summary(as.factor(nam.profs$SSL_classification_name))\n  nam.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Namibia/NAMSOTER/Namibia_all_horizons.csv\", na.strings = c(\"-9999\", \"999\", \"9999\", \"NA\"))\n  #summary(nam.hors$TOTN)\n  #summary(nam.hors$TOTC)\n  nam.hors$hzn_top &lt;- NA\n  nam.hors$hzn_top &lt;- ifelse(nam.hors$HONU==1, 0, nam.hors$hzn_top)\n  h.lst &lt;- lapply(1:7, function(x){which(nam.hors$HONU==x)})\n  for(i in 2:7){\n    sel &lt;- match(nam.hors$PRID[h.lst[[i]]], nam.hors$PRID[h.lst[[i-1]]])\n    nam.hors$hzn_top[h.lst[[i]]] &lt;- nam.hors$HBDE[h.lst[[i-1]]][sel]\n  }\n  nam.hors$HBDE &lt;- ifelse(is.na(nam.hors$HBDE), nam.hors$hzn_top+50, nam.hors$HBDE)\n  #summary(nam.hors$HBDE)\n  namALL = plyr::join(nam.hors, nam.profs, by=c(\"PRID\"))\n  namALL$k_ext = namALL$EXCK * 391\n  namALL$ca_ext = namALL$EXCA * 200\n  namALL$mg_ext = namALL$EXMG * 121\n  namALL$na_ext = namALL$EXNA * 230\n  #summary(namALL$MINA)\n  namALL$BULK &lt;- ifelse(namALL$BULK&gt;2.4, NA, namALL$BULK)\n  namALL$wpg2 = ifelse(namALL$MINA==\"D\", 80, ifelse(namALL$MINA==\"A\", 60, ifelse(namALL$MINA==\"M\", 25, ifelse(namALL$MINA==\"C\", 10, ifelse(namALL$MINA==\"V\", 1, ifelse(namALL$MINA==\"F\", 2.5, ifelse(namALL$MINA==\"M/A\", 40, ifelse(namALL$MINA==\"C/M\", 15, 0))))))))\n  #hist(namALL$wpg2)\n  ## TOTC: Organic Carbon (Colourimetric Walkey-Black Method) (SOP Soil-125)\n  namALL$oc = namALL$TOTC * 1.3\n  namALL$oc_d = signif(namALL$oc / 1000 * namALL$BULK * 1000 * (100 - ifelse(is.na(namALL$wpg2), 0, namALL$wpg2))/100, 3)\n  #summary(namALL$oc_d)\n  #summary(namALL$PHAQ) ## Check - high ph! mean = 7.9\n  namALL$site_obsdate = 2000\n  nam.col = c(\"PRID\", \"SLID\", \"site_obsdate\", \"LONG\", \"LATI\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"HONU\", \"hzn_top\", \"HBDE\", \"HODE\", \"PSCL\", \"texture_lab\", \"CLPC\", \"STPC\", \"SDTO\", \"TOTC\", \"oc_d\", \"c_tot\", \"TOTN\", \"PHKC\", \"PHAQ\", \"ph_cacl2\", \"CECS\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BULK\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ELCO\", \"ec_12pre\")\n  x.na = nam.col[which(!nam.col %in% names(namALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ namALL[,i] = NA } }\n  chemsprops.NAMSOTER = namALL[,nam.col]\n  chemsprops.NAMSOTER$source_db = \"NAMSOTER\"\n  chemsprops.NAMSOTER$confidence_degree = 2\n  chemsprops.NAMSOTER$project_url = \"\"\n  chemsprops.NAMSOTER$citation_url = \"https://edepot.wur.nl/485173\"\n  chemsprops.NAMSOTER = complete.vars(chemsprops.NAMSOTER, sel = c(\"TOTC\",\"CLPC\",\"PHAQ\"), coords = c(\"LONG\", \"LATI\"))\n  saveRDS.gz(chemsprops.NAMSOTER, \"/mnt/diskstation/data/Soil_points/Namibia/chemsprops.NAMSOTER.rds\")\n}\ndim(chemsprops.NAMSOTER)\n\n[1] 2955   39\n\n## [1] 2955   39\n\n\n\n\n\nZinke, P. J., Millemann, R. E., & Boden, T. A. (1986). Worldwide organic soil carbon and nitrogen data. Carbon Dioxide Information Center, Environmental Sciences Division, Oak Ridge National Laboratory. Data download URL: https://dx.doi.org/10.3334/CDIAC/lue.ndp018\nNote: poor spatial location accuracy i.e. &lt;10 km. Bulk density for many points has been estimated not measured. Sampling year has not been but literature indicates: 1965, 1974, 1976, 1978, 1979, 1984. Most of samples come from natural vegetation (undisturbed) areas.\n\n\nif(!exists(\"chemsprops.ISCND\")){\n  ndp.profs &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/INT/ISCND/ndp018.csv\", na.strings = c(\"-9999\", \"?\", \"NA\"), stringsAsFactors = FALSE)\n  names(ndp.profs) = c(\"PROFILE\", \"CODE\", \"CARBON\", \"NITROGEN\", \"LAT\", \"LONG\", \"ELEV\", \"SOURCE\", \"HOLDRIGE\", \"OLSON\", \"PARENT\")\n  for(j in c(\"CARBON\",\"NITROGEN\",\"ELEV\")){  ndp.profs[,j] &lt;- as.numeric(ndp.profs[,j])   }\n  #summary(ndp.profs$CARBON)\n  lat.s  &lt;- grep(\"S\", ndp.profs$LAT) # lat.n &lt;- grep(\"N\", ndp.profs$LAT)\n  ndp.profs$latitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LAT))\n  ndp.profs$latitude_decimal_degrees[lat.s] = ndp.profs$latitude_decimal_degrees[lat.s] * -1\n  lon.w &lt;- grep(\"W\", ndp.profs$LONG) # lon.e  &lt;- grep(\"E\", ndp.profs$LONG, fixed = TRUE)\n  ndp.profs$longitude_decimal_degrees = as.numeric(gsub(\"[^0-9.-]\", \"\", ndp.profs$LONG))\n  ndp.profs$longitude_decimal_degrees[lon.w] = ndp.profs$longitude_decimal_degrees[lon.w] * -1\n  #plot(ndp.profs[,c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\")])\n  ndp.profs$hzn_top = 0; ndp.profs$hzn_bot = 100\n  ## Sampling years from the doc: 1965, 1974, 1976, 1978, 1979, 1984 \n  ndp.profs$site_obsdate = \"1982\"\n  ndp.col = c(\"PROFILE\", \"CODE\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"CARBON\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = ndp.col[which(!ndp.col %in% names(ndp.profs))]\n  if(length(x.na)&gt;0){ for(i in x.na){ ndp.profs[,i] = NA } }\n  chemsprops.ISCND = ndp.profs[,ndp.col]\n  chemsprops.ISCND$source_db = \"ISCND\"\n  chemsprops.ISCND$confidence_degree = 8\n  chemsprops.ISCND$project_url = \"https://iscn.fluxdata.org/data/\"\n  chemsprops.ISCND$citation_url = \"https://dx.doi.org/10.3334/CDIAC/lue.ndp018\"\n  chemsprops.ISCND = complete.vars(chemsprops.ISCND, sel = c(\"CARBON\"), coords = c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\"))  \n  saveRDS.gz(chemsprops.ISCND, \"/mnt/diskstation/data/Soil_points/INT/ISCND/chemsprops.ISCND.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.ISCND)\n\n[1] 4114   39\n\n## [1] 4114   39\n\n\n\n\n\nManies, K., Waldrop, M., and Harden, J. (2020): Generalized models to estimate carbon and nitrogen stocks of organic soil horizons in Interior Alaska, Earth Syst. Sci. Data, 12, 1745–1757, https://doi.org/10.5194/essd-12-1745-2020, Data download URL: https://doi.org/10.5066/P960N1F9\n\n\nif(!exists(\"chemsprops.Alaska\")){\n  al.gps &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Site_GPS_coordinates_v1-1.csv\", stringsAsFactors = FALSE)\n  ## Different datums!\n  #summary(as.factor(al.gps$Datum))\n  al.gps1 = al.gps[al.gps$Datum==\"NAD83\",]\n  coordinates(al.gps1) = ~ Longitude + Latitude\n  proj4string(al.gps1) = \"+proj=longlat +datum=NAD83\"\n  al.gps0 = spTransform(al.gps1, CRS(\"+proj=longlat +datum=WGS84\"))\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Longitude\"] = al.gps0@coords[,1]\n  al.gps[which(al.gps$Datum==\"NAD83\"),\"Latitude\"] = al.gps0@coords[,2]\n  al.gps$site = al.gps$Site\n  al.hor &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/Generalized_models_for_CandN_Alaska_v1-1.csv\", stringsAsFactors = FALSE)\n  al.hor$hzn_top = al.hor$depth - as.numeric(al.hor$thickness)\n  al.hor$site_obsdate = format(as.Date(al.hor$date, format = \"%m/%d/%Y\"), \"%Y-%m-%d\")\n  ## \"We analyzed soil samples for total C and N using a Carlo Erba NA1500 elemental analyzer (Fisons Instruments). \n  ## Samples were combusted in the presence of excess oxygen.\"\n  al.hor$oc = as.numeric(al.hor$carbon) * 10\n  al.hor$n_tot = as.numeric(al.hor$nitrogen) * 10\n  al.hor$oc_d = as.numeric(al.hor$Cdensity) * 1000\n  #summary(al.hor$oc_d)\n  al.horA = plyr::join(al.hor, al.gps, by=c(\"site\"))\n  al.col = c(\"profile\", \"description\", \"site_obsdate\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"sampleID\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"depth\", \"Hcode\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"BDfine\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = al.col[which(!al.col %in% names(al.horA))]\n  if(length(x.na)&gt;0){ for(i in x.na){ al.horA[,i] = NA } }\n  chemsprops.Alaska = al.horA[,al.col]\n  chemsprops.Alaska$source_db = \"Alaska_interior\"\n  chemsprops.Alaska$confidence_degree = 1\n  chemsprops.Alaska$project_url = \"https://www.usgs.gov/centers/gmeg\"\n  chemsprops.Alaska$citation_url = \"https://doi.org/10.5194/essd-12-1745-2020\"\n  chemsprops.Alaska = complete.vars(chemsprops.Alaska, sel = c(\"oc\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))\n  # openair::scatterPlot(chemsprops.Alaska, x = \"oc\", y = \"oc_d\",\n  #                    method = \"hexbin\", col = \"increment\",\n  #                    log.x = TRUE, log.y = TRUE,\n  #                    xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n  saveRDS.gz(chemsprops.Alaska, \"/mnt/diskstation/data/Soil_points/USA/Alaska_Interior/chemsprops.Alaska.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.Alaska)\n\n[1] 4013   39\n\n## [1] 4013   39\n\n\n\n\n\n\nRelationship between SOC [kg/m3] and SOC [g/kg] for the Alaska data set.\n\n\n\n\n\n\n\n\nMartinović J., (2000) “Tla u Hrvatskoj”, Monografija, Državna uprava za zaštitu prirode i okoliša, str. 269, Zagreb. ISBN: 9536793059\nBašić F., (2014) “The Soils of Croatia”. World Soils Book Series, Springer Science & Business Media, 179 pp. ISBN: 9400758154\n\n\nif(!exists(\"chemsprops.bpht\")){\n  bpht.site &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_sites_1997.csv\", stringsAsFactors = FALSE)\n  bpht.hors &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Croatia/WBSoilHR_1997.csv\", stringsAsFactors = FALSE)\n  ## filter typos\n  for(j in c(\"GOR\", \"DON\", \"MKP\", \"PH1\", \"PH2\", \"MSP\", \"MP\", \"MG\", \"HUM\", \"EXTN\", \"EXTP\", \"EXTK\", \"CAR\")){\n    bpht.hors[,j] = as.numeric(bpht.hors[,j])\n  }\n  ## Convert to the USDA standard\n  bpht.hors$sand_tot_psa &lt;- bpht.hors$MSP * 0.8 + bpht.hors$MKP\n  bpht.hors$silt_tot_psa &lt;- bpht.hors$MP + bpht.hors$MSP * 0.2\n  bpht.hors$oc &lt;- signif(bpht.hors$HUM/1.724 * 10, 3)\n  ## summary(bpht.hors$sand_tot_psa)\n  bpht.s.lst &lt;- c(\"site_key\", \"UZORAK\", \"Cro16.30_X\", \"Cro16.30_Y\", \"FITOC\", \"STIJENA\", \"HID_DREN\", \"DUBINA\")\n  bpht.hor = plyr::join(bpht.site[,bpht.s.lst], bpht.hors)\n  bpht.hor$wpg2 = bpht.hor$STIJENA\n  bpht.hor$DON &lt;- ifelse(is.na(bpht.hor$DON), bpht.hor$GOR+50, bpht.hor$DON)\n  bpht.hor$depth &lt;- bpht.hor$GOR + (bpht.hor$DON - bpht.hor$GOR)/2\n  bpht.hor = bpht.hor[!is.na(bpht.hor$depth),]\n  bpht.hor$wpg2[which(bpht.hor$GOR&lt;30)] &lt;- bpht.hor$wpg2[which(bpht.hor$GOR&lt;30)]*.3\n  bpht.hor$sample_key = make.unique(paste(bpht.hor$PEDOL_ID, bpht.hor$OZN, sep=\"_\"))\n  bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"] &lt;- bpht.hor$sand_tot_psa[bpht.hor$sample_key==\"805_Amo\"]/10\n  ## convert N, P, K\n  #summary(bpht.hor$EXTK) -- measurements units?\n  bpht.hor$p_ext = bpht.hor$EXTP * 4.364\n  bpht.hor$k_ext = bpht.hor$EXTK * 8.3013\n  bpht.hor = bpht.hor[!is.na(bpht.hor$`Cro16.30_X`),]\n  ## coordinates:\n  bpht.pnts = SpatialPointsDataFrame(bpht.hor[,c(\"Cro16.30_X\",\"Cro16.30_Y\")], bpht.hor[\"site_key\"], proj4string = CRS(\"+proj=tmerc +lat_0=0 +lon_0=16.5 +k=0.9999 +x_0=2500000 +y_0=0 +ellps=bessel +towgs84=550.499,164.116,475.142,5.80967,2.07902,-11.62386,0.99999445824 +units=m\"))\n  bpht.pnts.ll &lt;- spTransform(bpht.pnts, CRS(\"+proj=longlat +datum=WGS84\"))\n  bpht.hor$longitude_decimal_degrees = bpht.pnts.ll@coords[,1]\n  bpht.hor$latitude_decimal_degrees = bpht.pnts.ll@coords[,2] \n  bpht.h.lst &lt;- c('site_key', 'OZ_LIST_PROF', 'UZORAK', 'longitude_decimal_degrees', 'latitude_decimal_degrees', \"SSL_classification_name\", 'labsampnum', \"layer_key\", 'layer_sequence', 'GOR', 'DON', 'OZN', 'TT', \"texture_lab\", 'MG', 'silt_tot_psa', 'sand_tot_psa', 'oc', 'oc_d', 'c_tot', 'EXTN', 'PH2', 'PH1', 'ph_cacl2', 'cec_sum', 'cec_nh4', 'ecec', 'wpg2', 'db_od', 'ca_ext', 'mg_ext', 'na_ext', 'k_ext', 'ec_satp', 'ec_12pre')\n  x.na = bpht.h.lst[which(!bpht.h.lst %in% names(bpht.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ bpht.hor[,i] = NA } }\n  chemsprops.bpht = bpht.hor[,bpht.h.lst]\n  chemsprops.bpht$source_db = \"Croatian_Soil_Pedon\"\n  chemsprops.bpht$confidence_degree = 1\n  chemsprops.bpht$project_url = \"http://www.haop.hr/\"\n  chemsprops.bpht$citation_url = \"https://books.google.nl/books?id=k_a2MgAACAAJ\"\n  chemsprops.bpht = complete.vars(chemsprops.bpht, sel = c(\"oc\",\"MG\",\"PH1\",\"k_ext\"))\n  saveRDS.gz(chemsprops.bpht, \"/mnt/diskstation/data/Soil_points/Croatia/chemsprops.bpht.rds\")\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n\nJoining by: site_key\n\ndim(chemsprops.bpht)\n\n[1] 5757   39\n\n## [1] 5757   39\n\n\n\n\n\nSanderman, J., (2017) “Remnant native SOC database”, Soil carbon profile data from paired land use comparisons, https://doi.org/10.7910/DVN/QQQM8V/8MSBNI, Harvard Dataverse, V1\n\nSanderman, J., Hengl, T., & Fiske, G. J. (2017). Soil carbon debt of 12,000 years of human land use. Proceedings of the National Academy of Sciences, 114(36), 9575-9580. https://doi.org/10.1073/pnas.1706103114\n\n\nif(!exists(\"chemsprops.RemnantSOC\")){\n  rem.hor &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 3)\n  rem.site &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 2)\n  rem.ref &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/remnant+native+SOC+database+for+release.xlsx\", sheet = 4)\n  rem.site = plyr::join(rem.site, rem.ref[,c(\"Source.No.\",\"DOI\",\"Sample_year\")], by=c(\"Source.No.\"))\n  rem.site$Site = rem.site$Site.ID\n  rem.horA = plyr::join(rem.hor, rem.site, by=c(\"Site\"))\n  rem.horA$hzn_top = rem.horA$'U_depth.(m)'*100\n  rem.horA$hzn_bot = rem.horA$'L_depth.(m)'*100\n  ## Estimated BD = bulk density estimated by simple pedotransfer function (BD = 1.5833*EXP(-0.012*OC); see SI of paper)\n  rem.horA$db_od = ifelse(is.na(as.numeric(rem.horA$'measured.BD.(Mg/m3)')), as.numeric(rem.horA$'estimated.BD.(Mg/m3)'), as.numeric(rem.horA$'measured.BD.(Mg/m3)'))\n  rem.horA$oc_d = signif(rem.horA$'OC.(g/kg)' * rem.horA$db_od, 3)\n  #summary(rem.horA$oc_d)\n  rem.col = c(\"Source.No.\", \"Site\", \"Sample_year\", \"Longitude\", \"Latitude\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"OC.(g/kg)\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = rem.col[which(!rem.col %in% names(rem.horA))]\n  if(length(x.na)&gt;0){ for(i in x.na){ rem.horA[,i] = NA } }\n  chemsprops.RemnantSOC = rem.horA[,rem.col]\n  chemsprops.RemnantSOC$source_db = \"WHRC_remnant_SOC\"\n  chemsprops.RemnantSOC$confidence_degree = 8\n  chemsprops.RemnantSOC$project_url = \"https://www.woodwellclimate.org/research-area/carbon/\"\n  chemsprops.RemnantSOC$citation_url = \"http://dx.doi.org/10.1073/pnas.1706103114\"\n  chemsprops.RemnantSOC = complete.vars(chemsprops.RemnantSOC, sel = c(\"OC.(g/kg)\",\"oc_d\"), coords = c(\"Longitude\", \"Latitude\"))  \n  saveRDS.gz(chemsprops.RemnantSOC, \"/mnt/diskstation/data/Soil_points/INT/WHRC_remnant_SOC/chemsprops.RemnantSOC.rds\")\n}\n\nWarning in ifelse(is.na(as.numeric(rem.horA$\"measured.BD.(Mg/m3)\")),\nas.numeric(rem.horA$\"estimated.BD.(Mg/m3)\"), : NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(rem.horA$\"measured.BD.(Mg/m3)\")),\nas.numeric(rem.horA$\"estimated.BD.(Mg/m3)\"), : NAs introduced by coercion\n\ndim(chemsprops.RemnantSOC)\n\n[1] 1631   39\n\n## [1] 1631   39\n\n\n\n\n\nJian, J., Du, X., & Stewart, R. D. (2020). A database for global soil health assessment. Scientific Data, 7(1), 1-8. https://doi.org/10.1038/s41597-020-0356-3. Data download URL: https://github.com/jinshijian/SoilHealthDB\n\nNote: some information is available about column names (see: https://www.nature.com/articles/s41597-020-0356-3/tables/3) but detailed explanation is missing.\n\nif(!exists(\"chemsprops.SoilHealthDB\")){\n  shdb.hor &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/INT/SoilHealthDB/SoilHealthDB_V2.xlsx\", sheet = 1, na.strings = c(\"NA\", \"NotAvailable\", \"Not-available\"))\n  #summary(as.factor(shdb.hor$SoilFamily))\n  #summary(as.factor(shdb.hor$SamplingDepth))\n  shdb.hor$hzn_top = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][1] }))\n  shdb.hor$hzn_bot = as.numeric(sapply(shdb.hor$SamplingDepth, function(i){ strsplit(i, \"-to-\")[[1]][2] }))\n  shdb.hor$hzn_top = ifelse(is.na(shdb.hor$hzn_top), 0, shdb.hor$hzn_top)\n  shdb.hor$hzn_bot = ifelse(is.na(shdb.hor$hzn_bot), 15, shdb.hor$hzn_bot)\n  shdb.hor$oc = as.numeric(shdb.hor$BackgroundSOC) * 10\n  shdb.hor$oc_d = signif(shdb.hor$oc * shdb.hor$SoilBD, 3)\n  #summary(shdb.hor$oc_d)\n  for(j in c(\"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"SoilpH\", \"Longitude\", \"Latitude\")){   shdb.hor[,j]  &lt;- as.numeric(shdb.hor[,j])   }\n  shdb.hor$ClayPerc = ifelse(is.na(shdb.hor$ClayPerc), 100-(shdb.hor$SiltPerc+shdb.hor$SandPerc), shdb.hor$ClayPerc)\n  #summary(shdb.hor$oc_d)\n  shdb.col = c(\"StudyID\", \"ExperimentID\", \"SamplingYear\", \"Longitude\", \"Latitude\", \"SoilFamily\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"hzn_top\", \"hzn_bot\", \"hzn_desgn\", \"Texture\", \"texture_lab\", \"ClayPerc\", \"SiltPerc\", \"SandPerc\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"SoilpH\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"wpg2\", \"SoilBD\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = shdb.col[which(!shdb.col %in% names(shdb.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ shdb.hor[,i] = NA } }\n  chemsprops.SoilHealthDB = shdb.hor[,shdb.col]\n  chemsprops.SoilHealthDB$source_db = \"SoilHealthDB\"\n  chemsprops.SoilHealthDB$confidence_degree = 8\n  chemsprops.SoilHealthDB$project_url = \"https://github.com/jinshijian/SoilHealthDB\"\n  chemsprops.SoilHealthDB$citation_url = \"https://doi.org/10.1038/s41597-020-0356-3\"\n  chemsprops.SoilHealthDB = complete.vars(chemsprops.SoilHealthDB, sel = c(\"ClayPerc\", \"SoilpH\", \"oc\", \"SoilFamily\"), coords = c(\"Longitude\", \"Latitude\"))  \n  saveRDS.gz(chemsprops.SoilHealthDB, \"/mnt/diskstation/data/Soil_points/INT/SoilHealthDB/chemsprops.SoilHealthDB.rds\")\n}\n\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SoilHealthDB)\n\n[1] 5050   39\n\n## [1] 5050   39\n\n\n\n\n\nLedo, A., Hillier, J., Smith, P. et al. (2019) A global, empirical, harmonised dataset of soil organic carbon changes under perennial crops. Sci Data 6, 57. https://doi.org/10.1038/s41597-019-0062-1. Data download URL: https://doi.org/10.6084/m9.figshare.7637210.v2\n\nNote: Many missing years for PREVIOUS SOC AND SOIL CHARACTERISTICS.\n\nif(!exists(\"chemsprops.SOCPDB\")){\n  library(\"readxl\")\n  socpdb &lt;- readxl::read_excel(\"/mnt/diskstation/data/Soil_points/INT/SOCPDB/SOC_perennials_DATABASE.xls\", skip=1, sheet = 1)\n  #names(socpdb)\n  #summary(as.factor(socpdb$USDA))\n  #summary(as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(is.na(as.numeric(socpdb$year_measure)), as.numeric(socpdb$yearPpub)-5, as.numeric(socpdb$year_measure))\n  socpdb$year_measure = ifelse(socpdb$year_measure&lt;1960, NA, socpdb$year_measure)\n  socpdb$depth_current = socpdb$soil_to_cm_current - socpdb$soil_from_cm_current\n  socpdb = socpdb[socpdb$depth_current&gt;5,]\n  socpdb$SOC_g_kg_current = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)), as.numeric(socpdb$SOC_Mg_ha_current) / (socpdb$depth_current/100 * as.numeric(socpdb$bulk_density_Mg_m3_current) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_current))\n  socpdb$depth_previous = socpdb$soil_to_cm_previous - socpdb$soil_from_cm_previous\n  socpdb$SOC_g_kg_previous = ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)), as.numeric(socpdb$SOC_Mg_ha_previous) / (socpdb$depth_previous/100 * as.numeric(socpdb$Bulkdensity_previous) * 1000) * 10, as.numeric(socpdb$SOC_g_kg_previous))\n  hor.b = which(names(socpdb) %in% c(\"ID\", \"plotID\", \"Longitud\", \"Latitud\", \"year_measure\", \"years_since_luc\", \"USDA\", \"original_source\"))\n  socpdb1 = socpdb[,c(hor.b, grep(\"_current\", names(socpdb)))]\n  #summary(as.numeric(socpdb1$years_since_luc))\n  ## 10 yrs median\n  socpdb1$site_obsdate = socpdb1$year_measure\n  socpdb2 = socpdb[,c(hor.b, grep(\"_previous\", names(socpdb)))]\n  socpdb2$site_obsdate = socpdb2$year_measure - ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10, as.numeric(socpdb2$years_since_luc))\n  colnames(socpdb2) &lt;- sub(\"_previous\", \"_current\", colnames(socpdb2))\n  nm.socpdb = c(\"site_key\", \"upedonid\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \"sand_total\", \"organic_carbon\", \"ph_h2o\", \"bulk_density_oven_dry\")\n  sel.socdpb1 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"USDA\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"bulk_density_Mg_m3_current\")\n  sel.socdpb2 = c(\"ID\", \"original_source\", \"site_obsdate\", \"Longitud\", \"Latitud\", \"USDA\", \"soil_from_cm_current\", \"soil_to_cm_current\", \"%clay_current\", \"%silt_current\", \"%sand_current\", \"SOC_g_kg_current\", \"ph_current\", \"Bulkdensity_current\")   \n  socpdbALL = as.data.frame(dplyr::bind_rows(lapply(list(socpdb1[,sel.socdpb1], socpdb2[,sel.socdpb2]), function(i){ dplyr::mutate_all(setNames(i, nm.socpdb), as.character) })))\n  for(j in which(names(socpdbALL) %in% c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \"sand_total\", \"organic_carbon\", \"ph_h2o\", \"bulk_density_oven_dry\"))){ socpdbALL[,j] &lt;- as.numeric(socpdbALL[,j]) }\n  #summary(socpdbALL$organic_carbon) ## mean = 15\n  #summary(socpdbALL$bulk_density_oven_dry)\n  #summary(socpdbALL$ph_h2o)\n  socpdbALL$oc_d = signif(socpdbALL$organic_carbon * socpdbALL$bulk_density_oven_dry, 3)\n  #summary(socpdbALL$oc_d)\n  x.na = col.names[which(!col.names %in% names(socpdbALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ socpdbALL[,i] = NA } }\n  chemsprops.SOCPDB &lt;- socpdbALL[,col.names]\n  chemsprops.SOCPDB$source_db = \"SOCPDB\"\n  chemsprops.SOCPDB$confidence_degree = 5\n  chemsprops.SOCPDB$project_url = \"https://africap.info/\"\n  chemsprops.SOCPDB$citation_url = \"https://doi.org/10.1038/s41597-019-0062-1\"\n  chemsprops.SOCPDB = complete.vars(chemsprops.SOCPDB, sel = c(\"organic_carbon\",\"ph_h2o\",\"clay_total\"))\n  saveRDS.gz(chemsprops.SOCPDB, \"/mnt/diskstation/data/Soil_points/INT/SOCPDB/chemsprops.SOCPDB.rds\")\n}\n\nWarning: Expecting numeric in AP1137 / R1137C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1138 / R1138C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1139 / R1139C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1140 / R1140C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1141 / R1141C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1142 / R1142C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1143 / R1143C42: got 'YES'\n\n\nWarning: Expecting numeric in AP1144 / R1144C42: got 'YES'\n\n\nWarning: Expecting numeric in I1305 / R1305C9: got 'NA'\n\n\nWarning: Expecting numeric in J1305 / R1305C10: got 'NA'\n\n\nWarning: Expecting numeric in I1306 / R1306C9: got 'NA'\n\n\nWarning: Expecting numeric in J1306 / R1306C10: got 'NA'\n\n\nWarning: Expecting numeric in I1307 / R1307C9: got 'NA'\n\n\nWarning: Expecting numeric in J1307 / R1307C10: got 'NA'\n\n\nWarning: Expecting numeric in I1308 / R1308C9: got 'NA'\n\n\nWarning: Expecting numeric in J1308 / R1308C10: got 'NA'\n\n\nWarning: Expecting numeric in I1309 / R1309C9: got 'NA'\n\n\nWarning: Expecting numeric in J1309 / R1309C10: got 'NA'\n\n\nWarning: Expecting numeric in I1310 / R1310C9: got 'NA'\n\n\nWarning: Expecting numeric in J1310 / R1310C10: got 'NA'\n\n\nWarning: Expecting numeric in I1311 / R1311C9: got 'NA'\n\n\nWarning: Expecting numeric in J1311 / R1311C10: got 'NA'\n\n\nWarning: Expecting numeric in I1312 / R1312C9: got 'NA'\n\n\nWarning: Expecting numeric in J1312 / R1312C10: got 'NA'\n\n\nWarning: Expecting numeric in I1317 / R1317C9: got 'NA'\n\n\nWarning: Expecting numeric in J1317 / R1317C10: got 'NA'\n\n\nWarning: Expecting numeric in I1318 / R1318C9: got 'NA'\n\n\nWarning: Expecting numeric in J1318 / R1318C10: got 'NA'\n\n\nWarning: Expecting numeric in I1319 / R1319C9: got 'NA'\n\n\nWarning: Expecting numeric in J1319 / R1319C10: got 'NA'\n\n\nWarning: Expecting numeric in I1320 / R1320C9: got 'NA'\n\n\nWarning: Expecting numeric in J1320 / R1320C10: got 'NA'\n\n\nWarning: Expecting numeric in I1321 / R1321C9: got 'NA'\n\n\nWarning: Expecting numeric in J1321 / R1321C10: got 'NA'\n\n\nWarning: Expecting numeric in I1322 / R1322C9: got 'NA'\n\n\nWarning: Expecting numeric in J1322 / R1322C10: got 'NA'\n\n\nWarning: Expecting numeric in I1323 / R1323C9: got 'NA'\n\n\nWarning: Expecting numeric in J1323 / R1323C10: got 'NA'\n\n\nWarning: Expecting numeric in I1324 / R1324C9: got 'NA'\n\n\nWarning: Expecting numeric in J1324 / R1324C10: got 'NA'\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$year_measure)),\nas.numeric(socpdb$yearPpub) - : NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$year_measure)),\nas.numeric(socpdb$yearPpub) - : NAs introduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_current)),\nas.numeric(socpdb$SOC_Mg_ha_current)/(socpdb$depth_current/100 * : NAs\nintroduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb$SOC_g_kg_previous)),\nas.numeric(socpdb$SOC_Mg_ha_previous)/(socpdb$depth_previous/100 * : NAs\nintroduced by coercion\n\n\nWarning in ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10,\nas.numeric(socpdb2$years_since_luc)): NAs introduced by coercion\nWarning in ifelse(is.na(as.numeric(socpdb2$years_since_luc)), 10,\nas.numeric(socpdb2$years_since_luc)): NAs introduced by coercion\n\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\ndim(chemsprops.SOCPDB)\n\n[1] 2416   39\n\n## [1] 2416   39\n\n\n\n\n\nPoeplau, C., Jacobs, A., Don, A., Vos, C., Schneider, F., Wittnebel, M., … & Flessa, H. (2020). Stocks of organic carbon in German agricultural soils—Key results of the first comprehensive inventory. Journal of Plant Nutrition and Soil Science, 183(6), 665-681. https://doi.org/10.1002/jpln.202000113. Data download URL: https://doi.org/10.3220/DATA20200203151139\n\nNote: For protection of data privacy, the coordinate was randomly generated within a radius of 4-km around the planned sampling point. This data is hence probably not suitable for spatial analysis, predictive soil mapping.\n\nif(!exists(\"chemsprops.BZE_LW\")){\n  site.de &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/SITE.xlsx\", sheet = 1)\n  site.de$site_obsdate = format(as.Date(paste0(\"01-\", site.de$Sampling_month, \"-\", site.de$Sampling_year), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.de.xy = site.de[,c(\"PointID\",\"xcoord\",\"ycoord\")]\n  ## 3104\n  bze.cor = read.csv('./correlation/soil_type_correlation_BZE.csv')\n  site.de$SSL_classification_name = paste0( dplyr::left_join(site.de[\"Specific.soil.subtype\"], bze.cor, by=c(\"Specific.soil.subtype\"=\"bze_subtype\"), multiple = \"first\")$USDA_1, \" / \",\n                    dplyr::left_join(site.de[\"Specific.soil.subtype\"], bze.cor, by=c(\"Specific.soil.subtype\"=\"bze_subtype\"), multiple = \"first\")$USDA_2)\n  #summary(as.factor(site.de$SSL_classification_name))\n  coordinates(site.de.xy) &lt;- ~xcoord+ycoord\n  proj4string(site.de.xy) &lt;- CRS(\"+proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs\")\n  site.de.ll &lt;- data.frame(spTransform(site.de.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.de$longitude_decimal_degrees = site.de.ll[,2]\n  site.de$latitude_decimal_degrees = site.de.ll[,3]\n  hor.de &lt;- openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1)\n  #hor.de = plyr::join(openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/LABORATORY_DATA.xlsx\", sheet = 1), openxlsx::read.xlsx(\"/mnt/diskstation/data/Soil_points/Germany/HORIZON_DATA.xlsx\", sheet = 1), by=\"PointID\")\n  ## 17,189 rows\n  horALL.de = plyr::join(hor.de, site.de, by=\"PointID\")\n  ## Sand content [Mass-%]; grain size 63-2000µm (DIN ISO 11277)\n  horALL.de$sand_tot_psa &lt;- horALL.de$gS + horALL.de$mS + horALL.de$fS + 0.2 * horALL.de$gU\n  horALL.de$silt_tot_psa &lt;- horALL.de$fU + horALL.de$mU + 0.8 * horALL.de$gU\n  ## Convert millisiemens/meter [mS/m] to microsiemens/centimeter [μS/cm, uS/cm]\n  horALL.de$ec_satp = horALL.de$EC_H2O / 10\n  hor.sel.de &lt;- c(\"PointID\", \"Main.soil.type\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Layer.upper.limit\", \"Layer.lower.limit\", \"hzn_desgn\", \"Soil.texture.class\", \"texture_lab\", \"Clay\", \"silt_tot_psa\", \"sand_tot_psa\", \"TOC\", \"oc_d\", \"TC\", \"TN\", \"ph_kcl\", \"pH_H2O\", \"pH_CaCl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"Rock.fragment.fraction\", \"BD_FS\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  #summary(horALL.de$TOC) ## mean = 12.3\n  #summary(horALL.de$BD_FS) ## mean = 1.41\n  #summary(horALL.de$pH_H2O)\n  horALL.de$oc_d = signif(horALL.de$TOC * horALL.de$BD_FS * (1-horALL.de$Rock.fragment.fraction/100), 3)\n  #summary(horALL.de$oc_d)\n  x.na = hor.sel.de[which(!hor.sel.de %in% names(horALL.de))]\n  if(length(x.na)&gt;0){ for(i in x.na){ horALL.de[,i] = NA } }\n  chemsprops.BZE_LW &lt;- horALL.de[,hor.sel.de]\n  chemsprops.BZE_LW$source_db = \"BZE_LW\"\n  chemsprops.BZE_LW$confidence_degree = 3\n  chemsprops.BZE_LW$project_url = \"https://www.thuenen.de/de/ak/\"\n  chemsprops.BZE_LW$citation_url = \"https://doi.org/10.1002/jpln.202000113\"\n  chemsprops.BZE_LW = complete.vars(chemsprops.BZE_LW, sel = c(\"TOC\", \"pH_H2O\", \"Clay\"))\n  saveRDS.gz(chemsprops.BZE_LW, \"/mnt/diskstation/data/Soil_points/Germany/chemsprops.BZE_LW.rds\")\n}\ndim(chemsprops.BZE_LW)\n\n[1] 17189    39\n\n## [1] 17189    39\n\n\n\n\n\nBeckers, V., Jacxsens, P., Van De Vreken, Ph., Van Meirvenne, M., Van Orshoven, J. (2011). Gebruik en installatie van de bodemdatabank AARDEWERK-Vlaanderen-2010. Spatial Applications Division Leuven, Belgium. Data download URL: https://www.dov.vlaanderen.be/geonetwork/home/api/records/78e15dd4-8070-4220-afac-258ea040fb30\nOttoy, S., Beckers, V., Jacxsens, P., Hermy, M., & Van Orshoven, J. (2015). Multi-level statistical soil profiles for assessing regional soil organic carbon stocks. Geoderma, 253, 12-20. https://doi.org/10.1016/j.geoderma.2015.04.001\n\n\nif(!exists(\"chemsprops.Vlaanderen2010\")){\n  site.vl &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Profiel.csv\")\n  site.vl$site_obsdate = format(as.Date(sapply(site.vl$Profilering_Datum, function(i){strsplit(i, \" \")[[1]][1]}), format=\"%d-%m-%Y\"), \"%Y-%m-%d\")\n  site.vl.xy = site.vl[,c(\"ID\",\"Coordinaat_Lambert72_X\",\"Coordinaat_Lambert72_Y\")]\n  ## 7020\n  site.vl.xy = site.vl.xy[complete.cases(site.vl.xy),]\n  coordinates(site.vl.xy) &lt;- ~Coordinaat_Lambert72_X+Coordinaat_Lambert72_Y\n  proj4string(site.vl.xy) &lt;- CRS(\"+init=epsg:31300\")\n  site.vl.ll &lt;- data.frame(spTransform(site.vl.xy, CRS(\"+proj=longlat +ellps=WGS84 +datum=WGS84\")))\n  site.vl$longitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$coords.x1\n  site.vl$latitude_decimal_degrees = join(site.vl[\"ID\"], site.vl.ll, by=\"ID\")$coords.x2\n  site.vl$Profiel_ID = site.vl$ID\n  hor.vl &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/Aardewerk-Vlaanderen-2010_Horizont.csv\")\n  ## 42,529 rows\n  horALL.vl = plyr::join(hor.vl, site.vl, by=\"Profiel_ID\")\n  horALL.vl$oc = horALL.vl$Humus*10 /1.724\n  #summary(horALL.vl$oc) ## mean = 7.8\n  #summary(horALL.vl$pH_H2O)\n  horALL.vl$hzn_top &lt;- rowSums(horALL.vl[,c(\"Diepte_grens_boven1\", \"Diepte_grens_boven2\")], na.rm=TRUE)/2\n  horALL.vl$hzn_bot &lt;- rowSums(horALL.vl[,c(\"Diepte_grens_onder1\",\"Diepte_grens_onder2\")], na.rm=TRUE)/2\n  horALL.vl$sand_tot_psa &lt;- horALL.vl$T50_100 + horALL.vl$T100_200 + horALL.vl$T200_500 + horALL.vl$T500_1000 + horALL.vl$T1000_2000\n  horALL.vl$silt_tot_psa &lt;- horALL.vl$T2_10 + horALL.vl$T10_20 + horALL.vl$T20_50\n  horALL.vl$tex_psda = paste0(horALL.vl$HorizontTextuur_code1, horALL.vl$HorizontTextuur_code2)\n  ## some corrupt coordinates\n  horALL.vl &lt;- horALL.vl[horALL.vl$latitude_decimal_degrees &gt; 50.6,]\n  hor.sel.vl &lt;- c(\"Profiel_ID\", \"Bodemgroep\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"Hor_nr\", \"hzn_top\", \"hzn_bot\", \"Naam\", \"tex_psda\", \"texture_lab\", \"T0_2\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"pH_KCl\", \"pH_H2O\", \"ph_cacl2\", \"Sorptiecapaciteit_Totaal\", \"cec_nh4\", \"ecec\", \"Tgroter_dan_2000\", \"db_od\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = hor.sel.vl[which(!hor.sel.vl %in% names(horALL.vl))]\n  if(length(x.na)&gt;0){ for(i in x.na){ horALL.vl[,i] = NA } }\n  chemsprops.Vlaanderen &lt;- horALL.vl[,hor.sel.vl]\n  chemsprops.Vlaanderen$source_db = \"Vlaanderen\"\n  chemsprops.Vlaanderen$confidence_degree = 2\n  chemsprops.Vlaanderen$project_url = \"https://www.dov.vlaanderen.be\"\n  chemsprops.Vlaanderen$citation_url = \"https://doi.org/10.1016/j.geoderma.2015.04.001\"\n  chemsprops.Vlaanderen = complete.vars(chemsprops.Vlaanderen, sel = c(\"oc\", \"pH_H2O\", \"T0_2\"))\n  saveRDS.gz(chemsprops.Vlaanderen, \"/mnt/diskstation/data/Soil_points/Belgium/Vlaanderen/chemsprops.Vlaanderen.rds\")\n}\n\nWarning in CPL_crs_from_input(x): GDAL Message 1: +init=epsg:XXXX syntax is\ndeprecated. It might return a CRS with a non-EPSG compliant axis order.\n\ndim(chemsprops.Vlaanderen)\n\n[1] 41364    39\n\n## [1] 41364    39\n\n\n\n\n\nHelfenstein, A., Mulder, V. L., Hack-ten Broeke, M. J. D., van Doorn, M., Teuling, K., Walvoort, D. J. J., and Heuvelink, G. B. M. (2024): BIS-4D: mapping soil properties and their uncertainties at 25 m resolution in the Netherlands, Earth Syst. Sci. Data, 16, 2941–2970. https://doi.org/10.5194/essd-16-2941-2024\n\nNote: Data download https://doi.org/10.4121/c90215b3-bdc6-4633-b721-4c4a0259d6dc.v4\n\nif(!exists(\"chemsprops.NLBIS\")){\n  ## Tabular datasets of each georeferenced soil property point data are provided as separate CSV files for each soil property.\n  nlbis.lst = list.files(\"/mnt/diskstation/data/Soil_points/Netherlands/BIS\", pattern=glob2rx(\"*.csv.gz\"), full.names = TRUE)\n  nlbis.hor = plyr::join_all(lapply(nlbis.lst, function(i){vroom::vroom(gzfile(i))}), type=\"full\")\n  #str(nlbis.hor)\n  ## 1,145,381 obs. of  21 variables\n  ## this is relatively large lab data set; it would create imbalance in the bind, so better to trim-down\n  ## year of sampling\n  #summary(as.factor(nlbis.hor$year))\n  nlbis.hor = nlbis.hor[nlbis.hor$year&gt;1999,]\n  #plot(nlbis.hor[,c(\"X\",\"Y\")], pch=\"+\", asp=1)\n  ## LOI method - harmonization: https://doi.org/10.1111/ejss.12558\n  #nlbis.hor$organic_carbon = nlbis.hor$SOM_per / 1.72 * 10\n  nlbis.hor$organic_carbon = (0.513*nlbis.hor$SOM_per-0.047*nlbis.hor$clay_per+0.00025*nlbis.hor$clay_per^2 )*10\n  nlbis.hor$organic_carbon = ifelse(nlbis.hor$organic_carbon &lt; 0, 0, nlbis.hor$organic_carbon)\n  #summary(nlbis.hor$organic_carbon)\n  nlbis.xy = terra::vect(nlbis.hor[,c(\"X\",\"Y\")], geom=c(\"X\",\"Y\"), crs=\"EPSG:28992\")\n  nlbis.ll = terra::project(nlbis.xy, \"EPSG:4326\")\n  nlbis.hor$longitude_decimal_degrees = geom(nlbis.ll)[,\"x\"]\n  nlbis.hor$latitude_decimal_degrees = geom(nlbis.ll)[,\"y\"]\n  nlbis.hor$cec_nh4_ph_7 = nlbis.hor$CEC / 10\n  #summary(nlbis.hor$d_upper)\n  ##    Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  ##   0.000   2.907  17.442  83.267  58.140 575.581   22417 \n  nlbis.hor$oc_d = signif(nlbis.hor$organic_carbon * nlbis.hor$BD_gcm3, 3)\n  #summary(nlbis.hor$oc_d)\n  #  Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n  #  2.79   13.10   24.40   29.87   43.18   83.70  238090  \n  nlbis.name = c(\"site_id\", \"upedonid\", \"year\", \"longitude_decimal_degrees\", \n               \"latitude_decimal_degrees\", \"SSL_classification_name\",  \n               \"sample_id\", \"layer_key\", \"hor_nr\", \"d_upper\", \"d_lower\", \n              \"hor\", \"texture_description\", \"texture_lab\", \"clay_per\", \"silt_per\", \n              \"sand_per\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"N_tot_mgkg\", \n              \"pH_KCl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"BD_gcm3\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = nlbis.name[which(!nlbis.name %in% names(nlbis.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ nlbis.hor[,i] = NA } }\n  chemsprops.NLBIS = nlbis.hor[,nlbis.name]\n  chemsprops.NLBIS$source_db = \"Netherlands.BIS\"\n  chemsprops.NLBIS$confidence_degree = 2\n  chemsprops.NLBIS$project_url = \"https://git.wageningenur.nl/helfe001/bis-4d\"\n  chemsprops.NLBIS$citation_url = \"https://doi.org/10.5194/essd-16-2941-2024, 2024\"\n  chemsprops.NLBIS = complete.vars(chemsprops.NLBIS, sel = c(\"organic_carbon\", \"pH_KCl\"))\n  saveRDS.gz(chemsprops.NLBIS, \"/mnt/diskstation/data/Soil_points/Netherlands/chemsprops.NLBIS.rds\")\n}\n\nRows: 15871 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, BD_gcm3\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 3815 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, CEC\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 631726 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, clay_per\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 5739 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, N_tot_mgkg\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 6084 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, P_ox_mmolkg\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 15248 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, pH_KCl\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 12918 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, sand_per\nlgl (2): sample_id, hor_nr\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 12912 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (2): BIS_tbl, BIS_type\ndbl (8): site_id, X, Y, d_upper, d_lower, d_mid, year, silt_per\nlgl (3): sample_id, hor_nr, hor\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 855950 Columns: 13\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \",\"\nchr (3): BIS_tbl, BIS_type, hor\ndbl (9): site_id, X, Y, hor_nr, d_upper, d_lower, d_mid, year, SOM_per\nlgl (1): sample_id\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\nJoining by: BIS_tbl, BIS_type, sample_id, site_id, X, Y, hor_nr, hor, d_upper, d_lower, d_mid, year\n\ndim(chemsprops.NLBIS)\n\n[1] 116533     39\n\n## [1] 215947     39\n\n\n\n\n\nPfeiffer, M., Padarian, J., Osorio, R., Bustamante, N., Olmedo, G. F., Guevara, M., et al. (2020) CHLSOC: the Chilean Soil Organic Carbon database, a multi-institutional collaborative effort. Earth Syst. Sci. Data, 12, 457–468, https://doi.org/10.5194/essd-12-457-2020. Data download URL: https://doi.org/10.17605/OSF.IO/NMYS3\n\n\nif(!exists(\"chemsprops.CHLSOC\")){\n  chl.hor &lt;- read.csv(\"/mnt/diskstation/data/Soil_points/Chile/CHLSOC/CHLSOC_v1.0.csv\", stringsAsFactors = FALSE)\n  #summary(chl.hor$oc)\n  chl.hor$oc = chl.hor$oc*10\n  #summary(chl.hor$bd)\n  chl.hor$oc_d = signif(chl.hor$oc  * chl.hor$bd * (100 - ifelse(is.na(chl.hor$crf), 0, chl.hor$crf))/100, 3)\n  #summary(chl.hor$oc_d)\n  chl.col = c(\"ProfileID\", \"usiteid\", \"year\", \"long\", \"lat\", \"SSL_classification_name\", \"labsampnum\", \"layer_key\", \"layer_sequence\", \"top\", \"bottom\", \"hzn_desgn\", \"tex_psda\", \"texture_lab\", \"clay_tot_psa\", \"silt_tot_psa\", \"sand_tot_psa\", \"oc\", \"oc_d\", \"c_tot\", \"n_tot\", \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \"cec_sum\", \"cec_nh4\", \"ecec\", \"crf\", \"bd\", \"ca_ext\", \"mg_ext\", \"na_ext\", \"k_ext\", \"ec_satp\", \"ec_12pre\")\n  x.na = chl.col[which(!chl.col %in% names(chl.hor))]\n  if(length(x.na)&gt;0){ for(i in x.na){ chl.hor[,i] = NA } }\n  chemsprops.CHLSOC = chl.hor[,chl.col]\n  chemsprops.CHLSOC$source_db = \"Chilean_SOCDB\"\n  chemsprops.CHLSOC$confidence_degree = 4\n  chemsprops.CHLSOC$project_url = \"https://doi.org/10.17605/OSF.IO/NMYS3\"\n  chemsprops.CHLSOC$citation_url = \"https://doi.org/10.5194/essd-12-457-2020\"\n  chemsprops.CHLSOC = complete.vars(chemsprops.CHLSOC, sel = c(\"oc\", \"bd\"), coords = c(\"long\", \"lat\"))\n  saveRDS.gz(chemsprops.CHLSOC, \"/mnt/diskstation/data/Soil_points/Chile/chemsprops.CHLSOC.rds\")\n}\ndim(chemsprops.CHLSOC)\n\n[1] 16903    39\n\n## [1] 16903    39\n\n\n\n\n\nLilly, A., Bell, J.S., Hudson, G., Nolan, A.J. & Towers. W. (Compilers) (2010). National soil inventory of Scotland (NSIS_1); site location, sampling and profile description protocols. (1978-1988). Technical Bulletin. Macaulay Institute, Aberdeen. https://doi.org/10.5281/zenodo.4650230. Data download URL: https://www.hutton.ac.uk/learning/natural-resource-datasets/soilshutton/soils-maps-scotland/download\n\n\nif(!exists(\"chemsprops.ScotlandNSIS1\")){\n  sco.xy = read.csv(\"/mnt/diskstation/data/Soil_points/Scotland/NSIS_10km.csv\")\n  coordinates(sco.xy) = ~ easting + northing\n  proj4string(sco.xy) = \"EPSG:27700\"\n  sco.ll = as.data.frame(spTransform(sco.xy, CRS(\"EPSG:4326\")))\n  sco.ll$site_obsdate = as.numeric(sapply(sco.ll$profile_da, function(x){substr(x, nchar(x)-3, nchar(x))}))\n  #hist(sco.ll$site_obsdate[sco.ll$site_obsdate&gt;1000])\n  ## no points after 1990!!\n  #summary(sco.ll$exch_k)\n  sco.in.name = c(\"profile_id\", \"site_obsdate\", \"coords.x1\", \"coords.x2\", \"horz_top\", \"horz_botto\", \n                  \"horz_symb\", \"sample_id\", \"texture_ps\",\n                  \"sand_int\", \"silt_int\", \"clay\", \"carbon\", \"nitrogen\", \"ph_h2o\", \"exch_ca\", \n                  \"exch_mg\", \"exch_na\", \"exch_k\", \"sum_cation\")\n  #sco.in.name[which(!sco.in.name %in% names(sco.ll))]\n  sco.x = as.data.frame(sco.ll[,sco.in.name])\n  #sco.x = sco.x[!sco.x$sample_id==0,]\n  #summary(sco.x$carbon)\n  sco.out.name = c(\"site_key\", \"site_obsdate\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \n                     \"hzn_bot\", \"hzn_top\", \"hzn_desgn\", \"labsampnum\", \"tex_psda\", \"sand_total\", \"silt_total\", \n                      \"clay_total\", \"organic_carbon\", \"total_nitrogen_ncs\", \"ph_h2o\", \"ca_ext\",\n                      \"mg_ext\", \"na_ext\", \"k_ext\", \"sum_of_cations_cec_pH_8_2\")\n  ## translate values\n  sco.fun.lst = as.list(rep(\"as.numeric(x)*1\", length(sco.in.name)))\n  sco.fun.lst[[which(sco.in.name==\"profile_id\")]] = \"paste(x)\"\n  sco.fun.lst[[which(sco.in.name==\"exch_ca\")]] = \"as.numeric(x)*200\"\n  sco.fun.lst[[which(sco.in.name==\"exch_mg\")]] = \"as.numeric(x)*121\"\n  sco.fun.lst[[which(sco.in.name==\"exch_k\")]] = \"as.numeric(x)*391\"\n  sco.fun.lst[[which(sco.in.name==\"exch_na\")]] = \"as.numeric(x)*230\"\n  sco.fun.lst[[which(sco.in.name==\"carbon\")]] = \"as.numeric(x)*10\"\n  sco.fun.lst[[which(sco.in.name==\"nitrogen\")]] = \"as.numeric(x)*10\"\n  ## save translation rules:\n  #write.csv(data.frame(sco.in.name, sco.out.name, unlist(sco.fun.lst)), \"scotland_soilab_transvalues.csv\")\n  sco.soil = transvalues(sco.x, sco.out.name, sco.in.name, sco.fun.lst)\n  x.na = col.names[which(!col.names %in% names(sco.soil))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sco.soil[,i] = NA } }\n  chemsprops.ScotlandNSIS1 = sco.soil[,col.names]\n  chemsprops.ScotlandNSIS1$source_db = \"ScotlandNSIS1\"\n  chemsprops.ScotlandNSIS1$confidence_degree = 2\n  chemsprops.ScotlandNSIS1$project_url = \"http://soils.environment.gov.scot/\"\n  chemsprops.ScotlandNSIS1$citation_url = \"https://doi.org/10.5281/zenodo.4650230\"\n  chemsprops.ScotlandNSIS1 = complete.vars(chemsprops.ScotlandNSIS1, sel = c(\"organic_carbon\", \"ph_h2o\", \"clay_total\"))\n  saveRDS.gz(chemsprops.ScotlandNSIS1, \"/mnt/diskstation/data/Soil_points/Scotland/chemsprops.ScotlandNSIS1.rds\")\n}\n\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\nWarning in eval(parse(text = fun.lst[[i]])): NAs introduced by coercion\n\ndim(chemsprops.ScotlandNSIS1)\n\n[1] 3091   39\n\n## [1] 3091   39\n\n\n\n\n\nDuchesne, L., Ouimet, R., (2021). Digital mapping of soil texture in ecoforest polygons in Quebec, Canada. PeerJ 9:e11685 https://doi.org/10.7717/peerj.11685. Data download URL: https://doi.org/10.7717/peerj.11685/supp-1\n\n\nif(!exists(\"chemsprops.QuebecTEX\")){\n  que.xy = read.csv(gzfile(\"/mnt/diskstation/data/Soil_points/Canada/Quebec/RawData.csv.gz\"))\n  #summary(as.factor(que.xy$Horizon))\n  ## horizon depths were not measured - we assume 15-30 and 30-80\n  que.xy$hzn_top = ifelse(que.xy$Horizon==\"B\", 15, 30)\n  que.xy$hzn_bot = ifelse(que.xy$Horizon==\"B\", 30, 80)\n  que.xy$site_key = que.xy$usiteid\n  que.xy$latitude_decimal_degrees = que.xy$Latitude\n  que.xy$longitude_decimal_degrees = que.xy$Longitude\n  que.xy$hzn_desgn = que.xy$Horizon\n  ## sampling year is unknown but the paper indicates 'The data come from 3 different provincial forest inventory programs... inventoried by provincial forestry authorities since 1970'\n  que.xy$site_obsdate = 2000\n  que.xy$sand_total = que.xy$PC_Sand\n  que.xy$silt_total = que.xy$PC_Silt\n  que.xy$clay_total = que.xy$PC_Clay\n  x.na = col.names[which(!col.names %in% names(que.xy))]\n  if(length(x.na)&gt;0){ for(i in x.na){ que.xy[,i] = NA } }\n  chemsprops.QuebecTEX = que.xy[,col.names]\n  chemsprops.QuebecTEX$source_db = \"QuebecTEX\"\n  chemsprops.QuebecTEX$confidence_degree = 4\n  chemsprops.QuebecTEX$project_url = \"\"\n  chemsprops.QuebecTEX$citation_url = \"https://doi.org/10.7717/peerj.11685\"\n  chemsprops.QuebecTEX = complete.vars(chemsprops.QuebecTEX, sel = c(\"clay_total\"))\n  saveRDS.gz(chemsprops.QuebecTEX, \"/mnt/diskstation/data/Soil_points/Canada/chemsprops.QuebecTEX.rds\")\n}\ndim(chemsprops.QuebecTEX)\n\n[1] 29570    39\n\n## [1] 29570    39\n\n\n\n\n\nZorn, M., Breg Valjavec, M., Komac, B., Volk Bahun, M., & Hrvatin, M. (2020). Soils of Slovenia. The Geography of Slovenia: Small But Diverse, 91-107. https://doi.org/10.1007/978-3-030-14066-3_6 Data download: https://rkg.gov.si/vstop/\n\n\nif(!exists(\"chemsprops.Slovenia\")){\n  slo.xy = read_sf(\"/mnt/diskstation/data/Soil_points/Slovenia/PedoloskiProfili.shp\")\n  slo.sf = sf::st_transform(slo.xy, \"epsg:4326\")\n  slo.df = data.frame(cbind(as.data.frame(slo.sf), st_coordinates(slo.sf)))\n  slo.hor = foreign::read.dbf(\"/mnt/diskstation/data/Soil_points/Slovenia/Horizonti_v_PedoloskihProfilih.DBF\", as.is=TRUE)\n  sloALL = dplyr::left_join(slo.hor, slo.df)\n  sloALL = sloALL[!is.na(sloALL$X.1),]\n  ## [1] 11509    71\n  #plot(sloALL[,c(\"X.1\",\"Y.1\")], pch=\"+\")\n  ## year of sampling\n  #summary(as.factor(sloALL$LETO))\n  ## Walkely-Black: K2Cr2O7/H2SO4\n  sloALL$organic_carbon = ifelse(sloALL$OGLJ==0 & (sloALL$PHH==0), NA, sloALL$OGLJ) * 1.3 * 10\n  sloALL$total_nitrogen_ncs = ifelse(sloALL$DUSIK==0 & (sloALL$PHH==0), NA, sloALL$DUSIK) * 10\n  sloALL$ph_kcl = ifelse(sloALL$PHK &lt; 2 | sloALL$PHK &gt; 9.5, NA, sloALL$PHK)\n  sloALL$ph_h2o = ifelse(sloALL$PHH &lt; 2 | sloALL$PHH &gt; 9.5, NA, sloALL$PHH)\n  sloALL$ph_cacl2 = ifelse(sloALL$PHCA &lt; 2 | sloALL$PHCA &gt; 9.5, NA, sloALL$PHCA)\n  sloALL$sum_of_cations_cec_pH_8_2 = ifelse(sloALL$S==0 & sloALL$PHH==0, NA, sloALL$S)\n  #summary(as.factor(sloALL$SKELET))\n  ## increadible &gt;1000 differnt ways coarse fragments were entered!\n  sloALL$total_frag_wt_pct_gt_2_mm_ws = ifelse(sloALL$SKELET==\"5%\", 5, \n                                        ifelse(sloALL$SKELET==\"10%\", 10,\n                                        ifelse(sloALL$SKELET==\"20%\", 20, \n                                        ifelse(sloALL$SKELET==\"30%\", 30,\n                                        ifelse(sloALL$SKELET==\"40%\", 40,\n                                        ifelse(sloALL$SKELET==\"50%\", 50,\n                                        ifelse(sloALL$SKELET==\"60%\", 60,\n                                        ifelse(sloALL$SKELET==\"70%\", 70,\n                                        ifelse(sloALL$SKELET==\"5-10%\", 7.5,\n                                        ifelse(sloALL$SKELET==\"/\", 0, NA))))))))))\n  sloALL$sand_total &lt;- sloALL$PES * 0.8 + sloALL$MELJG\n  sloALL$silt_total = 100 - (sloALL$sand_total + sloALL$GLINA)\n  slo.name = c(\"ZPP\", \"SPP\", \"LETO\", \"X.1\", \"Y.1\", \"SSL_classification_name\",  \n               \"LABST\", \"layer_key\", \"layer_sequence\", \"GLZG\", \"GLSP\", \n              \"HORIZ\", \"TRZ\", \"texture_lab\", \"GLINA\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = slo.name[which(!slo.name %in% names(sloALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ sloALL[,i] = NA } }\n  chemsprops.Slovenia = sloALL[,slo.name]\n  chemsprops.Slovenia$source_db = \"Slovenia.SPDB\"\n  chemsprops.Slovenia$confidence_degree = 2\n  chemsprops.Slovenia$project_url = \"https://rkg.gov.si/vstop/\"\n  chemsprops.Slovenia$citation_url = \"https://doi.org/10.1007/978-3-030-14066-3_6\"\n  chemsprops.Slovenia = complete.vars(chemsprops.Slovenia, sel = c(\"organic_carbon\", \"ph_h2o\", \"GLINA\"), coords = c(\"X.1\", \"Y.1\"))\n  saveRDS.gz(chemsprops.Slovenia, \"/mnt/diskstation/data/Soil_points/Slovenia/chemsprops.Slovenia.rds\")\n}\n\nField name: 'NA' changed to: 'NA.'\n\n\nJoining with `by = join_by(ZPP)`\n\ndim(chemsprops.Slovenia)\n\n[1] 11509    39\n\n## [1] 11509    39\n\n\n\n\n\nRamos, T. B., Horta, A., Gonçalves, M. C., Pires, F. P., Duffy, D., & Martins, J. C. (2017). The INFOSOLO database as a first step towards the development of a soil information system in Portugal. Catena, 158, 390-412. http://dx.doi.org/10.1016/j.catena.2017.07.020\n\nNote: INFOSOLO project https://projects.iniav.pt/infosolo/\n\nif(!exists(\"chemsprops.INFOSOLO\")){\n  port.nam = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/description.txt\", col_names = FALSE)[-c(5:6),]\n  port.site = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/soil.txt\", col_names = make.names(port.nam$X2[port.nam$X3==\"Soil\"]))\n  hor.nm.port = make.names(port.nam$X2[port.nam$X3==\"Properties\"])\n  port.hor = vroom::vroom(\"/mnt/diskstation/data/Soil_points/Portugal/properties.txt\", col_names = c(\"ID2\", \"ID1\", hor.nm.port[-1]), na = c(\"\", \"\\\\N\"))\n  portALL = dplyr::left_join(port.hor, port.site, by = \"ID1\")\n  ## [1] 9934   51\n  #plot(portALL[,c(\"Long\",\"Lat\")], pch=\"+\", asp=1)\n  ## year of sampling\n  #summary(as.factor(portALL$Year))\n  portALL$organic_carbon = portALL$OC * 10\n  ## 41 Walkley-Black\n  portALL$organic_carbon[which(portALL$OC_M==41)] = portALL$organic_carbon[which(portALL$OC_M==41)] * 1.3\n  portALL$oc_d = signif(portALL$organic_carbon * portALL$BD * (100 - ifelse(is.na(portALL$Coarse), 0, portALL$Coarse))/100, 3)\n  #summary(portALL$oc_d)\n  portALL$sand_total &lt;- portALL$FS * 0.8 + portALL$CS\n  portALL$silt_total = 100 - (portALL$sand_total + portALL$C)\n  portALL$k_ext = portALL$K...28 * 391\n  portALL$ca_ext = portALL$Ca * 200\n  portALL$mg_ext = portALL$Mg * 121\n  portALL$na_ext = portALL$Na * 230\n  port.name = c(\"Profile_ID\", \"ID1\", \"Year\", \"Long\", \"Lat\", \"SSL_classification_name\",  \n               \"labsampnum\", \"layer_key\", \"layer_sequence\", \"Hor_top\", \"Hor_bot\", \n              \"Hor_name\", \"texture_description\", \"texture_lab\", \"C\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"N\", \n              \"ph_kcl\", \"pH\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"CEC\", \"ecec_base_plus_aluminum\", \n              \"Coarse\", \"BD\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")\n  x.na = port.name[which(!port.name %in% names(portALL))]\n  if(length(x.na)&gt;0){ for(i in x.na){ portALL[,i] = NA } }\n  chemsprops.PT.INFOSOLO = portALL[,port.name]\n  chemsprops.PT.INFOSOLO$source_db = \"Portugal.INFOSOLO\"\n  chemsprops.PT.INFOSOLO$confidence_degree = 2\n  chemsprops.PT.INFOSOLO$project_url = \"https://projects.iniav.pt/infosolo/\"\n  chemsprops.PT.INFOSOLO$citation_url = \"http://dx.doi.org/10.1016/j.catena.2017.07.020\"\n  chemsprops.PT.INFOSOLO = complete.vars(chemsprops.PT.INFOSOLO, sel = c(\"organic_carbon\", \"pH\", \"C\"), coords = c(\"Long\", \"Lat\"))\n  saveRDS.gz(chemsprops.PT.INFOSOLO, \"/mnt/diskstation/data/Soil_points/Portugal/chemsprops.PT.INFOSOLO.rds\")\n}\n\nRows: 60 Columns: 5\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (4): X2, X3, X4, X5\ndbl (1): X1\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nRows: 3461 Columns: 16\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr (10): Profile_ID, Soil, Qualifier.2, Qualifier.3, WRB, Parent.Material, ...\ndbl  (6): ID1, Long, Lat, Year, Qualifier.1, Land.Use\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\nNew names:\nRows: 9934 Columns: 36\n── Column specification ────────────────────────────────────────────────────────\nDelimiter: \"\\t\"\nchr  (1): Hor_name\ndbl (35): ID2, ID1, Hor_top, Hor_bot, Coarse, CS, FS, Si, C, Texture_M, BD, ...\n\nℹ Use `spec()` to retrieve the full column specification for this data.\nℹ Specify the column types or set `show_col_types = FALSE` to quiet this message.\n\ndim(chemsprops.PT.INFOSOLO)\n\n[1] 9934   39\n\n## [1] 9934   39\n\n\n\n\n\nPotash, E., Guan, K., Margenot, A. J., Lee, D., Boe, A., Douglass, M., … & Zumpf, C. (2023). Multi-site evaluation of stratified and balanced sampling of soil organic carbon stocks in agricultural fields. Geoderma, 438, 116587. https://doi.org/10.1016/j.geoderma.2023.116587 data download: https://doi.org/10.6084/m9.figshare.23669304\n\nNote: This is relatively small data set focused on 8 commercial fields / farms.\n\nif(!exists(\"chemsprops.Potash2023\")){\n  multisite.xy = read.csv(\"/mnt/landmark/Soil_points/USA/Multi_site_evaluation/locations.csv\")\n  multisite.lb = read.csv(\"/mnt/landmark/Soil_points/USA/Multi_site_evaluation/measurements.csv\")\n  multisite.lb$oc_d = round(as.numeric(multisite.lb$SOCc) * 10 * multisite.lb$BD, 2)\n  #summary(multisite.lb$oc_d)\n  multisite.lb$organic_carbon = multisite.lb$SOCc*10\n  multisite.lb$site_key = multisite.lb$location_id\n  multisite.lb$bulk_density_oven_dry = multisite.lb$BD\n  multisite.lb$site_obsdate = 2021\n  multisite.lb$hzn_top = multisite.lb$sample_depth_min\n  multisite.lb$hzn_bot = multisite.lb$sample_depth_max\n  multisite.xy$longitude_decimal_degrees = multisite.xy$X\n  multisite.xy$latitude_decimal_degrees = multisite.xy$Y\n  multisite.lb$longitude_decimal_degrees = plyr::join(multisite.lb[\"location_id\"], multisite.xy, match = \"first\")$longitude_decimal_degrees\n  multisite.lb$latitude_decimal_degrees = plyr::join(multisite.lb[\"location_id\"], multisite.xy, match = \"first\")$latitude_decimal_degrees\n  x.na = col.names[which(!col.names %in% names(multisite.lb))]\n  if(length(x.na)&gt;0){ for(i in x.na){ multisite.lb[,i] = NA } }\n  chemsprops.Potash2023 = multisite.lb[,col.names]\n  chemsprops.Potash2023$source_db = \"Potash_et_al_2023\"\n  chemsprops.Potash2023$project_url = \"https://sustainability.illinois.edu/new-method-shows-promise-for-accurate-efficient-soil-carbon-estimates/\"\n  chemsprops.Potash2023$citation_url = \"https://doi.org/10.1016/j.geoderma.2023.116587\"\n  saveRDS.gz(chemsprops.Potash2023, \"/mnt/diskstation/data/Soil_points/USA/Multi_site_evaluation/chemsprops.Potash2023.rds\")\n}\n\nJoining by: location_id\nJoining by: location_id\n\ndim(chemsprops.Potash2023)\n\n[1] 3977   39\n\n## [1] 3977   39\n\n\n\n\n\nStanimirova, R., Tarrio, K., Turlej, K., McAvoy, K., Stonebrook, S., Hu, K. T., … & Friedl, M. A. (2023). A global land cover training dataset from 1984 to 2020. Scientific Data, 10(1), 879. https://doi.org/10.1038/s41597-023-02798-5\n\nNote: Pseudo-observations based on GLANCE points; use only class “6” which is sand surface;\n\nif(!exists(\"chemsprops.GLANCE\")){\n  ## 0 soil organic carbon + 99% sand content (deserts)\n  bare = read_sf(\"/mnt/landmark/GLANCE/bu_glance_training_dataV1.gpkg\")\n  ## Level 2 land cover value (integer): 1 (Water), 2 (Ice/snow), 3 (Developed), 4 (Soil), \n  ## 5 (Rock), 6 (Beach/sand), 7 (Deciduous), 8 (Evergreen), 9 (Mixed), 10 (Shrub), \n  ## 11 (Grassland), 12 (Agriculture), and 13 (Moss/lichen). NaN values present.\n  #bare = bare[(bare$Glance_Class_ID_level2==5|bare$Glance_Class_ID_level2==6),]\n  bare = bare[bare$Glance_Class_ID_level2==6,]\n  #plot(bare[\"Dataset_Code\"])\n  #write_sf(bare, \"bu_glance_sand_barerock_V1.gpkg\")\n  #plot(bare[\"Glance_Class_ID_level2\"])\n  #str(bare)\n  ## 3085 points\n  bare.df = data.table::data.table(cbind(as.data.frame(bare), st_coordinates(bare)))\n  ## Extend to start end periods:\n  bare.ex = as.data.frame(data.table::setDT(bare.df)[ , list(site_key=Glance_ID, X=X, Y=Y, longitude_decimal_degrees=Lon, latitude_decimal_degrees=Lat, site_obsdate = seq(Start_Year, End_Year)), by = 1:nrow(bare.df)])\n  ## 50220\n  ## insert zeros for all nutrients except for the once we are not sure:\n  ## http://www.decodedscience.org/chemistry-sahara-sand-elements-dunes/45828\n  bare.ex$oc_d = 0\n  bare.ex$organic_carbon = 0\n  bare.ex$total_carbon_ncs = 0\n  bare.ex$total_nitrogen_ncs = 0\n  bare.ex$k_ext = 0\n  bare.ex$mg_ext = 0\n  bare.ex$clay_total = 0\n  bare.ex$sand_total = 99\n  bare.ex$silt_total = 1\n  bare.ex$bulk_density_oven_dry = 1.6\n  bare.ex$source_db = \"GLANCE\"\n  bare.ex$hzn_top = 0\n  bare.ex$hzn_bot = 30\n  bare.ex$source_db = \"GLanCE.points\"\n  bare.ex$confidence_degree = 4\n  x.na = col.names[which(!col.names %in% names(bare.ex))]\n  if(length(x.na)&gt;0){ for(i in x.na){ bare.ex[,i] = NA } }\n  chemsprops.SIM = bare.ex[,col.names]\n  chemsprops.SIM$project_url = \"https://doi.org/10.34911/rdnt.x4xfh3\"\n  chemsprops.SIM$citation_url = \"https://doi.org/10.1038/s41597-023-02798-5\"\n  saveRDS.gz(chemsprops.SIM, \"/mnt/diskstation/data/Soil_points/INT/chemsprops.SIM.rds\")\n}\ndim(chemsprops.SIM)\n\n[1] 50220    39\n\n## [1] 50220    39\n\nOther potential large soil profile DBs of interest:\n\nShangguan, W., Dai, Y., Liu, B., Zhu, A., Duan, Q., Wu, L., … & Chen, D. (2013). A China data set of soil properties for land surface modeling. Journal of Advances in Modeling Earth Systems, 5(2), 212-224. https://doi.org/10.1002/jame.20026\n\nSalković, E., Djurović, I., Knežević, M., Popović-Bugarin, V., & Topalović, A. (2018). Digitization and mapping of national legacy soil data of Montenegro. Soil and Water Research, 13(2), 83-89. https://doi.org/10.17221/81/2017-SWR",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html#bind-all-datasets",
    "href": "025-import_chemical_data.html#bind-all-datasets",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "ds.n = ls(pattern=glob2rx(\"chemsprops.*\"))\n## 49 data sets\nnm.l = lapply(ds.n, function(i){ names(get(i)) })\n#x = lapply(nm.l, length)\nnm.df = data.frame(do.call(rbind, nm.l))\nnm.df$data.set = ds.n\n#write.csv(nm.df, \"/mnt/diskstation/data/Soil_points/chemsprops.validate_column.names.csv\")\ntot_sprops = dplyr::bind_rows(lapply(ds.n, function(i){ mutate_all(setNames(get(i), col.names), as.character) }))\n## convert to numeric:\nfor(j in c(\"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"layer_sequence\", \n           \"hzn_top\", \"hzn_bot\", \"clay_total\", \"silt_total\", \n              \"sand_total\", \"organic_carbon\", \"oc_d\", \"total_carbon_ncs\", \"total_nitrogen_ncs\", \n              \"ph_kcl\", \"ph_h2o\", \"ph_cacl2\", \n              \"sum_of_cations_cec_pH_8_2\", \"cec_nh4_ph_7\", \"ecec_base_plus_aluminum\", \n              \"total_frag_wt_pct_gt_2_mm_ws\", \"bulk_density_oven_dry\", \"ca_ext\", \"mg_ext\", \n              \"na_ext\", \"k_ext\", \"ec_water_extractable\", \"ec_predict_one_to_two\")){\n  tot_sprops[,j] = as.numeric(tot_sprops[,j])\n}\n\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\nWarning: NAs introduced by coercion\n\n#head(tot_sprops)\n\nClean up typos and physically impossible values:\n\ntex.rm = rowSums(tot_sprops[,c(\"clay_total\", \"silt_total\", \"sand_total\")])\nsummary(tex.rm)\n\n   Min. 1st Qu.  Median    Mean 3rd Qu.    Max.    NA's \n-2997.0   100.0   100.0   100.2   100.0  2997.0  505078 \n\nfor(j in c(\"clay_total\", \"silt_total\", \"sand_total\", \"total_frag_wt_pct_gt_2_mm_ws\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;100|tot_sprops[,j]&lt;0, NA, tot_sprops[,j])\n  tot_sprops[,j] = ifelse(tex.rm&lt;99|is.na(tex.rm)|tex.rm&gt;101, NA, tot_sprops[,j])\n}\nfor(j in c(\"ph_h2o\",\"ph_kcl\",\"ph_cacl2\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;12|tot_sprops[,j]&lt;2, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$db_od)\nfor(j in c(\"bulk_density_oven_dry\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;2.4|tot_sprops[,j]&lt;0.03, NA, tot_sprops[,j])\n}\n#hist(tot_sprops$oc)\nfor(j in c(\"organic_carbon\")){\n  tot_sprops[,j] = ifelse(tot_sprops[,j]&gt;800|tot_sprops[,j]&lt;0, NA, tot_sprops[,j])\n}\n\nFill-in the missing depths:\n\n## soil layer depth (middle)\ntot_sprops$hzn_depth = tot_sprops$hzn_top + (tot_sprops$hzn_bot-tot_sprops$hzn_top)/2\nsummary(is.na(tot_sprops$hzn_depth))\n\n   Mode   FALSE    TRUE \nlogical 1492760   32464 \n\n## Note: large number of horizons without a depth\ntot_sprops = tot_sprops[!is.na(tot_sprops$hzn_depth),]\n#quantile(tot_sprops$hzn_depth, c(0.01,0.99), na.rm=TRUE)\ntot_sprops$hzn_depth = ifelse(tot_sprops$hzn_depth&lt;0, 10, ifelse(tot_sprops$hzn_depth&gt;800, 800, tot_sprops$hzn_depth))\n#hist(tot_sprops$hzn_depth, breaks=45)\n\nSummary number of points per data source:\n\nsummary(as.factor(tot_sprops$source_db))\n\n             AfSIS1              AfSPDB     Alaska_interior              BZE_LW \n               4369               68794                4011               17189 \n        Canada_CUFS         Canada_NPDB    Canada_subarctic       Chilean_SOCDB \n              15873               15297                1381               16887 \n        China_SOTER               CIFOR           CostaRica Croatian_Soil_Pedon \n               5115                 577                2037                5757 \n      CSIRO_NatSoil        Ecuador_HESD                FEBR                FRED \n              89645               30167               24353               12758 \n         GEMAS_2009       GLanCE.points               GROOT    Guatemala_GTMSOC \n               4131               50220               16271                 910 \n          Iran_SPDB               ISCND                ISDA          ISRIC_WISE \n               4859                4114               49225               37443 \n            LandPKS          LUCAS_2009          LUCAS_2015          LUCAS_2018 \n             165044               21272               21859               18982 \n        MangrovesDB         MexicoINEGI            NAMSOTER               NCSCD \n               7986               16820                2943                7348 \n    Netherlands.BIS   Portugal.INFOSOLO   Potash_et_al_2023          PRONASOLOS \n             116533                9934                3977               32615 \n          QuebecTEX        Russia_EGRPR       ScotlandNSIS1              SISLAC \n              29570                4506                3091               92121 \n      Slovenia.SPDB              SOCPDB               SoDaH        SoilHealthDB \n              11509                2416               30559                5050 \n               SRDB           USDA_NCSS            USGS.NGS          Vlaanderen \n               3337              351511                9399               41364 \n   WHRC_remnant_SOC \n               1631 \n\n\nAdd unique row identifier\n\ntot_sprops$uuid = openssl::md5(make.unique(paste(\"OpenLandMap\", tot_sprops$site_key, tot_sprops$layer_sequence, sep=\"_\")))\n\nand unique location based on the Open Location Code:\n\ntot_sprops$olc_id = olctools::encode_olc(tot_sprops$latitude_decimal_degrees, tot_sprops$longitude_decimal_degrees, 11)\nlength(levels(as.factor(tot_sprops$olc_id)))\n\n[1] 337870\n\n## 364,939\n\n\ntot_sprops.pnts = tot_sprops[!duplicated(tot_sprops$olc_id),c(\"site_key\", \"source_db\", \"longitude_decimal_degrees\", \"latitude_decimal_degrees\", \"site_obsdate\", \"olc_id\", \"project_url\", \"citation_url\")]\ncoordinates(tot_sprops.pnts) &lt;- ~ longitude_decimal_degrees + latitude_decimal_degrees\nproj4string(tot_sprops.pnts) &lt;- \"EPSG:4326\"\n\nDensity of points per 100 x 100 km grid (IGH projection):\n\ng1 = terra::vect(\"/mnt/diskstation/data/Soil_points/tiles_GH_100km_land.gpkg\")\nov.g1 = terra::extract(g1[\"ID\"], terra::project(terra::vect(tot_sprops.pnts), crs(g1)))\ng1.c = summary(as.factor(ov.g1$ID), maxsum = length(levels(as.factor(ov.g1$ID))))\ng1.df = data.frame(count=g1.c, ID=attr(g1.c, \"names\"))\ng1$count = dplyr::left_join(data.frame(ID=g1$ID), g1.df)$count \n#plot(g1[\"count\"])\nwriteVector(g1[\"count\"], \"/mnt/diskstation/data/Soil_points/tiles_GH_100km_pnt.dens.gpkg\", overwrite=TRUE)\n\n\n\n\n\n\nDensity of points based on 100 by 100 km blocks in IGH projection.\n\n\n\n\nRemove points falling in the sea or similar:\n\n#mask = terra::rast(\"./layers1km/lcv_landmask_esacci.lc.l4_c_1km_s0..0cm_2000..2015_v1.0.tif\")\n#mask = terra::rast(\"/mnt/diskstation/data/LandGIS/layers250m/lcv_landmask_esacci.lc.l4_c_250m_s0..0cm_2000..2015_v1.0.tif\")\nmask = terra::rast(\"/mnt/diskstation/data/Soil_points/land.cover_copernicus_c_100m_s_20150101_20151231_go_epsg.4326_v3.0.1.tif\")\nov.sprops &lt;- terra::extract(mask, terra::vect(tot_sprops.pnts)) ## TAKES 1 mins\n#summary(as.factor(ov.sprops[,2]))\nif(sum(is.na(ov.sprops[,2]) | ov.sprops[,2]==200)&gt;0){\n  rem.lst = which(is.na(ov.sprops[,2]) | ov.sprops[,2]==200)\n  rem.sp = tot_sprops.pnts$site_key[rem.lst]\n  tot_sprops.pnts = tot_sprops.pnts[-rem.lst,]\n}\n## final number of unique spatial locations:\nnrow(tot_sprops.pnts)\n\n[1] 336442\n\n## 363511\n\n\n\n\nHave in mind that some datasets only represent top-soil (e.g. LUCAS) while other cover the whole soil depth, hence higher mean values for some regions (Europe) should be considered within the context of diverse soil depths.\n\nlibrary(ggplot2)\nggplot(tot_sprops, aes(x=source_db, y=log1p(organic_carbon))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 483108 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsel.db = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"Canada_NPDB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"hzn_depth\", y = \"organic_carbon\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"depth in cm\")\n\n\n\n\n\n\n\n\nNote: Canada dataset also shows SOC content for peatlands.\n\nggplot(tot_sprops, aes(x=source_db, y=bulk_density_oven_dry)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1212118 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db,], x = \"organic_carbon\", y = \"bulk_density_oven_dry\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, ylab=\"Bulk density\", xlab=\"SOC [g/kg]\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(oc_d))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1231449 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsel.db0 = c(\"ISRIC_WISE\", \"Canada_CUFS\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\", \"CSIRO_NatSoil\")\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"organic_carbon\", y = \"oc_d\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, xlab=\"SOC [g/kg]\", ylab=\"SOC [kg/m3]\")\n\n\n\n\n\n\n\n\nNote: SOC (%) and SOC density (kg/m3) are almost linear relationship (curving toward fixed value), except for organic soils (especially litter) where relationship is slightly shifted.\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"organic_carbon\", \n                     y = \"total_nitrogen_ncs\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x=TRUE, log.y=TRUE, \n                     xlab=\"SOC [g/kg]\", ylab=\"N total [g/kg]\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=ph_h2o)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 678238 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\", \"CSIRO_NatSoil\", \"PRONASOLOS\"),], x = \"ph_kcl\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", xlab=\"soil pH KCl\", ylab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"hzn_depth\", y = \"ph_h2o\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.x = TRUE, log.y=TRUE, ylab=\"soil pH H2O\", xlab=\"depth in cm\")\n\n\n\n\n\n\n\n\nNote: there seems to be no apparent correlation between soil pH and soil depth.\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% c(\"ISRIC_WISE\", \"USDA_NCSS\", \"AfSPDB\", \"PRONASOLOS\"),], x = \"ph_h2o\", y = \"sum_of_cations_cec_pH_8_2\", method = \"hexbin\", \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"CEC\", xlab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], x = \"ph_h2o\", y = \"organic_carbon\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"soil pH H2O\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=clay_total)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 522290 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(tot_sprops[tot_sprops$source_db %in% sel.db0,], y = \"clay_total\", x = \"sand_total\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", ylab=\"clay %\", xlab=\"sand %\")\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(sum_of_cations_cec_pH_8_2))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(sum_of_cations_cec_pH_8_2): NaNs produced\n\n\nWarning: Removed 1051862 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(total_nitrogen_ncs))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(total_nitrogen_ncs): NaNs produced\n\n\nWarning: Removed 988470 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(k_ext))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning in log1p(k_ext): NaNs produced\n\n\nWarning: Removed 832905 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nggplot(tot_sprops, aes(x=source_db, y=log1p(ec_water_extractable))) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 1343643 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nsprops_yrs = tot_sprops[!is.na(tot_sprops$site_obsdate),c(\"site_obsdate\", \"source_db\", \"organic_carbon\")]\nsprops_yrs$year = as.numeric(substr(x=sprops_yrs$site_obsdate, 1, 4))\n\nWarning: NAs introduced by coercion\n\nsprops_yrs$year = ifelse(sprops_yrs$year &lt;1960, NA, ifelse(sprops_yrs$year&gt;2024, NA, sprops_yrs$year))\n\n\nggplot(sprops_yrs, aes(x=source_db, y=year)) + geom_boxplot() + theme(axis.text.x = element_text(angle = 90, hjust = 1))\n\nWarning: Removed 157859 rows containing non-finite outside the scale range\n(`stat_boxplot()`).\n\n\n\n\n\n\n\n\n\n\nopenair::scatterPlot(sprops_yrs[sprops_yrs$source_db %in% sel.db0,], y = \"organic_carbon\", x = \"year\", method = \"hexbin\",  \n                     col = \"increment\", type = \"source_db\", log.y=TRUE, ylab=\"SOC [g/kg]\", xlab=\"Sampling year\")\n\n\n\n\n\n\n\n\n\n\n\nAdd layer_sequence where missing since this is needed to be able to convert to wide format:\n\n#summary(tot_sprops$layer_sequence)\ntot_sprops$dsiteid = paste(tot_sprops$source_db, tot_sprops$site_key, tot_sprops$site_obsdate, sep=\"_\")\nif(!exists(\"l.s1\")){\n  library(dplyr)\n  ## Note: takes &gt;1 mins\n  l.s1 &lt;- tot_sprops[,c(\"dsiteid\",\"hzn_depth\")] %&gt;% group_by(dsiteid) %&gt;% mutate(layer_sequence.f = data.table::frank(hzn_depth, ties.method = \"first\"))\n  tot_sprops$layer_sequence.f = ifelse(is.na(tot_sprops$layer_sequence), l.s1$layer_sequence.f, tot_sprops$layer_sequence)\n  tot_sprops$layer_sequence.f = ifelse(tot_sprops$layer_sequence.f&gt;6, 6, tot_sprops$layer_sequence.f)\n}\n\nConvert long table to wide table format so that each depth gets unique column (note: the most computational / time-consuming step usually):\n\nif(!exists(\"tot_sprops.w\")){\n  library(data.table)\n  tot_sprops.w = data.table::dcast( as.data.table(tot_sprops), \n                formula = olc_id ~ layer_sequence.f, \n                value.var = c(\"uuid\", hor.names[-which(hor.names %in% c(\"site_key\", \"layer_sequence\"))]), \n                ## \"labsampnum\", \"hzn_desgn\", \"tex_psda\" \n                #fun=function(x){ mean(x, na.rm=TRUE) }, \n                ## Note: does not work for characters\n                fun=function(x){ x[1] },\n                verbose = FALSE)\n  ## remove \"0\" layers added automatically but containing no values\n  tot_sprops.w = tot_sprops.w[,grep(\"*_0$\", colnames(tot_sprops.w)):=NULL]\n}\n\n\nAttaching package: 'data.table'\n\n\nThe following object is masked from 'package:terra':\n\n    shift\n\n\nThe following objects are masked from 'package:lubridate':\n\n    hour, isoweek, mday, minute, month, quarter, second, wday, week,\n    yday, year\n\n\nThe following objects are masked from 'package:dplyr':\n\n    between, first, last\n\n\nThe following object is masked from 'package:purrr':\n\n    transpose\n\ntot_sprops_w.pnts = tot_sprops.pnts\ntot_sprops_w.pnts@data = plyr::join(tot_sprops.pnts@data, tot_sprops.w)\n\nJoining by: olc_id\n\n\nWrite all soil profiles using a wide format:\n\nsel.rm.pnts  &lt;- tot_sprops_w.pnts$source_db==\"LUCAS_2009\" | tot_sprops_w.pnts$source_db==\"LUCAS_2015\" | tot_sprops_w.pnts$site_key %in% mng.rm | tot_sprops_w.pnts$site_key %in% rem.sp\nout.gpkg = \"./out/gpkg/sol_chem.pnts_horizons.gpkg\"\n#unlink(out.gpkg)\nif(!file.exists(out.gpkg)){\n  sf::st_write(st_as_sf(tot_sprops_w.pnts), \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_horizons.gpkg\", \"sol_chem.pnts_horizons\", driver=\"GPKG\")\n  sf::st_write(st_as_sf(tot_sprops_w.pnts[!sel.rm.pnts,]), out.gpkg, \"sol_chem.pnts_horizons\", driver=\"GPKG\")\n}\n\n\n\n\nRemove points that are not allowed to be distributed publicly:\n\nsel.rm  &lt;- tot_sprops$source_db==\"LUCAS_2009\" | tot_sprops$source_db==\"LUCAS_2015\" | tot_sprops$source_db==\"LUCAS_2018\" | tot_sprops$site_key %in% mng.rm | tot_sprops$site_key %in% rem.sp\ntot_sprops.s = tot_sprops[!sel.rm,] \n\nPlot in Goode Homolozine projection and save final objects:\n\nif(!file.exists(\"./img/sol_chem.pnts_sites.png\")){\n  tot_sprops.pnts_sf &lt;- st_as_sf(tot_sprops.pnts[1], crs=4326)\n  plot_gh(tot_sprops.pnts_sf, out.pdf=\"./img/sol_chem.pnts_sites.pdf\")\n  ## extremely slow --- takes 15mins\n  system(\"pdftoppm ./img/sol_chem.pnts_sites.pdf ./img/sol_chem.pnts_sites -png -f 1 -singlefile\")\n  system(\"convert -crop 1280x575+36+114 ./img/sol_chem.pnts_sites.png ./img/sol_chem.pnts_sites.png\")\n}\n\n\n\n\n\n\nSoil profiles and soil samples with chemical and physical properties global compilation.",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  },
  {
    "objectID": "025-import_chemical_data.html#save-final-analysis-ready-objects",
    "href": "025-import_chemical_data.html#save-final-analysis-ready-objects",
    "title": "Soil chemical and physical properties",
    "section": "",
    "text": "saveRDS.gz(tot_sprops.s, \"./out/rds/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_horizons.rds\")\nsaveRDS.gz(tot_sprops.pnts, \"/mnt/diskstation/data/Soil_points/sol_chem.pnts_sites.rds\")\n#library(farff)\n#writeARFF(tot_sprops.s, \"./out/arff/sol_chem.pnts_horizons.arff\", overwrite = TRUE)\n## compressed CSV\n#write.csv(tot_sprops.s, file=gzfile(\"./out/csv/sol_chem.pnts_horizons.csv.gz\"))\n## regression matrix:\n#saveRDS.gz(rm.sol, \"./out/rds/sol_chem.pnts_horizons_rm.rds\")\n\nSave temp object:\n\nsave.image.pigz(file=\"soilchem.RData\")",
    "crumbs": [
      "Home",
      "Data import",
      "Soil chemical and physical properties"
    ]
  }
]